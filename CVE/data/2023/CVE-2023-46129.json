{"publishedDate": "2023-10-31T00:15Z", "lastModifiedDate": "2024-11-21T08:27Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-46129", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic key handling library, nkeys, recently gained support for encryption, not just for signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling logic mistakenly passed an array by value into an internal function, where the function mutated that buffer to populate the encryption key to use. As a result, all encryption was actually to an all-zeros key. This affects encryption only, not signing.  \nFIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue. No known workarounds are available. For any application handling auth callouts in Go, if using the nkeys library, update the dependency, recompile and deploy that in lockstep."}, {"lang": "es", "value": "NATS.io es una tecnolog\u00eda de comunicaci\u00f3n distribuida pub-sub de c\u00f3digo abierto de alto rendimiento, creada para la nube, local, IoT y computaci\u00f3n de borde. La librer\u00eda de manejo de claves criptogr\u00e1ficas, nkeys, recientemente obtuvo soporte para cifrado, no solo para firma/autenticaci\u00f3n. Esto se utiliza en nats-server 2.10 (septiembre de 2023) y versiones posteriores para llamadas de autenticaci\u00f3n. En las versiones 0.4.0 a 0.4.5 de nkeys, correspondientes a las versiones 2.10.0 a 2.10.3 del servidor NATS, la l\u00f3gica de manejo de cifrado `xkeys` de la librer\u00eda nkeys pas\u00f3 por error una matriz por valor a una funci\u00f3n interna, donde la funci\u00f3n mut\u00f3 ese b\u00fafer. para completar la clave de cifrado que se utilizar\u00e1. Como resultado, todo el cifrado se realiz\u00f3 en realidad con una clave de todos ceros. Esto afecta \u00fanicamente al cifrado, no a la firma. SOLUCI\u00d3N: COMPLETE EL IMPACTO EN LA SEGURIDAD DE LA LLAMADA DE AUTENCI\u00d3N DEL SERVIDOR NATS. La librer\u00eda nkeys Go 0.4.6, correspondiente a NATS Server 2.10.4, tiene un parche para este problema. No hay workarounds conocidos disponibles. Para cualquier aplicaci\u00f3n que maneje llamadas de autenticaci\u00f3n en Go, si usa la librer\u00eda nkeys, actualice la dependencia, vuelva a compilarla e implementarla al mismo tiempo."}]}, "references": {"reference_data": [{"url": "http://www.openwall.com/lists/oss-security/2023/10/31/1", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R3UETKPUB3V5JS5TLZOF3SMTGT5K5APS/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ULQQONMSCQSH5Z5OWFFQHCGEZ3NL4DRJ/", "name": "", "refsource": "", "tags": []}, {"url": "http://www.openwall.com/lists/oss-security/2023/10/31/1", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R3UETKPUB3V5JS5TLZOF3SMTGT5K5APS/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ULQQONMSCQSH5Z5OWFFQHCGEZ3NL4DRJ/", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-321"}, {"lang": "en", "value": "CWE-325"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "baseScore": 7.5, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:nats:nats_server:*:*:*:*:*:*:*:*", "matchCriteriaId": "BBB8F9C2-3395-4D22-BA0C-8462D6E076A6", "cpe_name": [], "versionStartIncluding": "2.10.0", "versionEndExcluding": "2.10.4"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:nats:nkeys:*:*:*:*:*:*:*:*", "matchCriteriaId": "EBAF8F73-D62A-4371-916F-0296A4B975B5", "cpe_name": [], "versionStartIncluding": "0.4.0", "versionEndExcluding": "0.4.6"}]}]}}