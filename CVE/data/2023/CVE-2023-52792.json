{"publishedDate": "2024-05-21T16:15Z", "lastModifiedDate": "2025-09-23T20:10Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-52792", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/region: Do not try to cleanup after cxl_region_setup_targets() fails\n\nCommit 5e42bcbc3fef (\"cxl/region: decrement ->nr_targets on error in\ncxl_region_attach()\") tried to avoid 'eiw' initialization errors when\n->nr_targets exceeded 16, by just decrementing ->nr_targets when\ncxl_region_setup_targets() failed.\n\nCommit 86987c766276 (\"cxl/region: Cleanup target list on attach error\")\nextended that cleanup to also clear cxled->pos and p->targets[pos]. The\ninitialization error was incidentally fixed separately by:\nCommit 8d4285425714 (\"cxl/region: Fix port setup uninitialized variable\nwarnings\") which was merged a few days after 5e42bcbc3fef.\n\nBut now the original cleanup when cxl_region_setup_targets() fails\nprevents endpoint and switch decoder resources from being reused:\n\n1) the cleanup does not set the decoder's region to NULL, which results\n   in future dpa_size_store() calls returning -EBUSY\n2) the decoder is not properly freed, which results in future commit\n   errors associated with the upstream switch\n\nNow that the initialization errors were fixed separately, the proper\ncleanup for this case is to just return immediately. Then the resources\nassociated with this target get cleanup up as normal when the failed\nregion is deleted.\n\nThe ->nr_targets decrement in the error case also helped prevent\na p->targets[] array overflow, so add a new check to prevent against\nthat overflow.\n\nTested by trying to create an invalid region for a 2 switch * 2 endpoint\ntopology, and then following up with creating a valid region."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: cxl/region: no intente realizar la limpieza despu\u00e9s de que cxl_region_setup_targets() falle. Confirme 5e42bcbc3fef (\"cxl/region: decrement -&gt;nr_targets on error in cxl_region_attach()\") intent\u00f3 evitar ' Los mismos errores de inicializaci\u00f3n cuando -&gt;nr_targets excedieron 16, simplemente disminuyendo -&gt;nr_targets cuando cxl_region_setup_targets() fall\u00f3. La confirmaci\u00f3n 86987c766276 (\"cxl/region: Limpiar lista de objetivos al adjuntar error\") extendi\u00f3 esa limpieza para borrar tambi\u00e9n cxled-&gt;pos y p-&gt;targets[pos]. El error de inicializaci\u00f3n se solucion\u00f3 por separado mediante: Commit 8d4285425714 (\"cxl/region: Reparar advertencias de variables no inicializadas de configuraci\u00f3n de puerto\") que se fusion\u00f3 unos d\u00edas despu\u00e9s de 5e42bcbc3fef. Pero ahora la limpieza original cuando falla cxl_region_setup_targets() impide que se reutilicen los recursos del decodificador de conmutador y punto final: 1) la limpieza no establece la regi\u00f3n del decodificador en NULL, lo que da como resultado que futuras llamadas a dpa_size_store() devuelvan -EBUSY 2) el decodificador no liberado correctamente, lo que resulta en futuros errores de confirmaci\u00f3n asociados con el conmutador ascendente. Ahora que los errores de inicializaci\u00f3n se solucionaron por separado, la limpieza adecuada para este caso es simplemente regresar inmediatamente. Luego, los recursos asociados con este objetivo se limpian normalmente cuando se elimina la regi\u00f3n fallida. La disminuci\u00f3n de -&gt;nr_targets en el caso de error tambi\u00e9n ayud\u00f3 a evitar un desbordamiento de la matriz p-&gt;targets[], as\u00ed que agregue una nueva verificaci\u00f3n para evitar ese desbordamiento. Probado intentando crear una regi\u00f3n no v\u00e1lida para una topolog\u00eda de 2 conmutadores * 2 puntos finales y luego creando una regi\u00f3n v\u00e1lida."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/0718588c7aaa7a1510b4de972370535b61dddd0d", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/07ffcd8ec79cf7383e1e45815f4842fd357991c2", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/9090c5537c93cd0811ab7bfbd925b57addfffb60", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/90db4c1d5ebaf574d3c3065c055977982c378a83", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/0718588c7aaa7a1510b4de972370535b61dddd0d", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/07ffcd8ec79cf7383e1e45815f4842fd357991c2", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/9090c5537c93cd0811ab7bfbd925b57addfffb60", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/90db4c1d5ebaf574d3c3065c055977982c378a83", "name": "", "refsource": "", "tags": ["Patch"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-908"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "baseScore": 5.5, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "06B6ACCF-31F1-4421-964C-7F3C54F0E3E2", "cpe_name": [], "versionStartIncluding": "6.0", "versionEndExcluding": "6.1.64"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "674C4F82-C336-4B49-BF64-1DE422E889C4", "cpe_name": [], "versionStartIncluding": "6.2", "versionEndExcluding": "6.5.13"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "B58252FA-A49C-411F-9B28-DC5FE44BC5A0", "cpe_name": [], "versionStartIncluding": "6.6", "versionEndExcluding": "6.6.3"}]}]}}