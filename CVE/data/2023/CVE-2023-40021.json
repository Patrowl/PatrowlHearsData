{"publishedDate": "2023-08-16T21:15Z", "lastModifiedDate": "2024-11-21T08:18Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-40021", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Oppia is an online learning platform. When comparing a received CSRF token against the expected token, Oppia uses the string equality operator (`==`), which is not safe against timing attacks. By repeatedly submitting invalid tokens, an attacker can brute-force the expected CSRF token character by character. Once they have recovered the token, they can then submit a forged request on behalf of a logged-in user and execute privileged actions on that user's behalf. In particular the function to validate received CSRF tokens is at `oppia.core.controllers.base.CsrfTokenManager.is_csrf_token_valid`. An attacker who can lure a logged-in Oppia user to a malicious website can perform any change on Oppia that the user is authorized to do, including changing profile information; creating, deleting, and changing explorations; etc. Note that the attacker cannot change a user's login credentials. An attack would need to complete within 1 second because every second, the time used in computing the token changes. This issue has been addressed in commit `b89bf80837` which has been included in release `3.3.2-hotfix-2`. Users are advised to upgrade. There are no known workarounds for this vulnerability."}]}, "references": {"reference_data": [{"url": "https://github.com/oppia/oppia/blob/3a05c3558a292f3db9e658e60e708c266c003fd0/core/controllers/base.py#L964-L990", "name": "", "refsource": "", "tags": ["Product"]}, {"url": "https://github.com/oppia/oppia/commit/b89bf808378c1236874b5797a7bda32c77b4af23", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/oppia/oppia/pull/18769", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/oppia/oppia/security/advisories/GHSA-49jp-pjc3-2532", "name": "", "refsource": "", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://github.com/oppia/oppia/blob/3a05c3558a292f3db9e658e60e708c266c003fd0/core/controllers/base.py#L964-L990", "name": "", "refsource": "", "tags": ["Product"]}, {"url": "https://github.com/oppia/oppia/commit/b89bf808378c1236874b5797a7bda32c77b4af23", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/oppia/oppia/pull/18769", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/oppia/oppia/security/advisories/GHSA-49jp-pjc3-2532", "name": "", "refsource": "", "tags": ["Exploit", "Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-203"}, {"lang": "en", "value": "CWE-208"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.6, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N", "baseScore": 5.3, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:oppia:oppia:*:*:*:*:*:*:*:*", "matchCriteriaId": "87F65B5D-6454-4E3C-A7A5-F1FEEC6DC78C", "cpe_name": [], "versionStartIncluding": "1.1.0", "versionEndExcluding": "3.3.2"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:oppia:oppia:3.3.2:-:*:*:*:*:*:*", "matchCriteriaId": "7B0060B6-6E1F-4B0F-8A6B-3437450C94C3", "cpe_name": []}]}]}}