{"publishedDate": "2024-05-21T16:15Z", "lastModifiedDate": "2024-11-21T08:40Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-52843", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nllc: verify mac len before reading mac header\n\nLLC reads the mac header with eth_hdr without verifying that the skb\nhas an Ethernet header.\n\nSyzbot was able to enter llc_rcv on a tun device. Tun can insert\npackets without mac len and with user configurable skb->protocol\n(passing a tun_pi header when not configuring IFF_NO_PI).\n\n    BUG: KMSAN: uninit-value in llc_station_ac_send_test_r net/llc/llc_station.c:81 [inline]\n    BUG: KMSAN: uninit-value in llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111\n    llc_station_ac_send_test_r net/llc/llc_station.c:81 [inline]\n    llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111\n    llc_rcv+0xc5d/0x14a0 net/llc/llc_input.c:218\n    __netif_receive_skb_one_core net/core/dev.c:5523 [inline]\n    __netif_receive_skb+0x1a6/0x5a0 net/core/dev.c:5637\n    netif_receive_skb_internal net/core/dev.c:5723 [inline]\n    netif_receive_skb+0x58/0x660 net/core/dev.c:5782\n    tun_rx_batched+0x3ee/0x980 drivers/net/tun.c:1555\n    tun_get_user+0x54c5/0x69c0 drivers/net/tun.c:2002\n\nAdd a mac_len test before all three eth_hdr(skb) calls under net/llc.\n\nThere are further uses in include/net/llc_pdu.h. All these are\nprotected by a test skb->protocol == ETH_P_802_2. Which does not\nprotect against this tun scenario.\n\nBut the mac_len test added in this patch in llc_fixup_skb will\nindirectly protect those too. That is called from llc_rcv before any\nother LLC code.\n\nIt is tempting to just add a blanket mac_len check in llc_rcv, but\nnot sure whether that could break valid LLC paths that do not assume\nan Ethernet header. 802.2 LLC may be used on top of non-802.3\nprotocols in principle. The below referenced commit shows that used\nto, on top of Token Ring.\n\nAt least one of the three eth_hdr uses goes back to before the start\nof git history. But the one that syzbot exercises is introduced in\nthis commit. That commit is old enough (2008), that effectively all\nstable kernels should receive this."}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: llc: verificar mac len antes de leer el encabezado de mac. LLC lee el encabezado de mac con eth_hdr sin verificar que el skb tenga un encabezado de Ethernet. Syzbot pudo ingresar llc_rcv en un dispositivo tun. Tun puede insertar paquetes sin mac len y con el protocolo skb-&gt; configurable por el usuario (pasando un encabezado tun_pi cuando no se configura IFF_NO_PI). ERROR: KMSAN: valor uninit en llc_station_ac_send_test_r net/llc/llc_station.c:81 [en l\u00ednea] BUG: KMSAN: valor uninit en llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111 llc_station_ac_send_test_r net/llc/llc_station. c:81 [en l\u00ednea] llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111 llc_rcv+0xc5d/0x14a0 net/llc/llc_input.c:218 __netif_receive_skb_one_core net/core/dev.c:5523 __netif_receive_skb+ 0x1a6 /0x5a0 net/core/dev.c:5637 netif_receive_skb_internal net/core/dev.c:5723 [en l\u00ednea] netif_receive_skb+0x58/0x660 net/core/dev.c:5782 tun_rx_batched+0x3ee/0x980 drivers/net/tun.c :1555 tun_get_user+0x54c5/0x69c0 drivers/net/tun.c:2002 Agregue una prueba mac_len antes de las tres llamadas eth_hdr(skb) en net/llc. Hay m\u00e1s usos en include/net/llc_pdu.h. Todos estos est\u00e1n protegidos por un protocolo de prueba skb-&gt;== ETH_P_802_2. Lo cual no protege contra este escenario tun. Pero la prueba mac_len agregada en este parche en llc_fixup_skb tambi\u00e9n los proteger\u00e1 indirectamente. Esto se llama desde llc_rcv antes que cualquier otro c\u00f3digo LLC. Es tentador simplemente agregar una verificaci\u00f3n general de mac_len en llc_rcv, pero no estoy seguro de si eso podr\u00eda interrumpir las rutas LLC v\u00e1lidas que no asumen un encabezado Ethernet. En principio, 802.2 LLC se puede utilizar adem\u00e1s de protocolos que no sean 802.3. La confirmaci\u00f3n a la que se hace referencia a continuaci\u00f3n muestra que sol\u00eda hacerlo, adem\u00e1s de Token Ring. Al menos uno de los tres usos de eth_hdr se remonta a antes del inicio del historial de git. Pero el que ejercita syzbot se introduce en este compromiso. Ese compromiso es lo suficientemente antiguo (2008), por lo que efectivamente todos los n\u00facleos estables deber\u00edan recibirlo."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/0a720d0259ad3521ec6c9e4199f9f6fc75bac77a", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/352887b3edd007cf9b0abc30fe9d98622acd859b", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/3a2653828ffc6101aef80bf58d5b77484239f779", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7b3ba18703a63f6fd487183b9262b08e5632da1b", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/900a4418e3f66a32db6baaf23f92b99c20ae6535", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9a3f9054a5227d7567cba1fb821df48ccecad10c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/cbdcdf42d15dac74c7287679fb2a9d955f8feb1f", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f980e9a57dfb9530f1f4ee41a2420f2a256d7b29", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ff5cb6a4f0c6d7fbdc84858323fb4b7af32cfd79", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/0a720d0259ad3521ec6c9e4199f9f6fc75bac77a", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/352887b3edd007cf9b0abc30fe9d98622acd859b", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/3a2653828ffc6101aef80bf58d5b77484239f779", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7b3ba18703a63f6fd487183b9262b08e5632da1b", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/900a4418e3f66a32db6baaf23f92b99c20ae6535", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9a3f9054a5227d7567cba1fb821df48ccecad10c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/cbdcdf42d15dac74c7287679fb2a9d955f8feb1f", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f980e9a57dfb9530f1f4ee41a2420f2a256d7b29", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ff5cb6a4f0c6d7fbdc84858323fb4b7af32cfd79", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}