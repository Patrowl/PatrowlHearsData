{"publishedDate": "2023-11-21T21:15Z", "lastModifiedDate": "2024-11-21T08:31Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-48230", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Cap'n Proto is a data interchange format and capability-based RPC system. In versions 1.0 and 1.0.1, when using the KJ HTTP library with WebSocket compression enabled, a buffer underrun can be caused by a remote peer. The underrun always writes a constant value that is not attacker-controlled, likely resulting in a crash, enabling a remote denial-of-service attack. Most Cap'n Proto and KJ users are unlikely to have this functionality enabled and so unlikely to be affected. Maintainers suspect only the Cloudflare Workers Runtime is affected.\n\nIf KJ HTTP is used with WebSocket compression enabled, a malicious peer may be able to cause a buffer underrun on a heap-allocated buffer. KJ HTTP is an optional library bundled with Cap'n Proto, but is not directly used by Cap'n Proto. WebSocket compression is disabled by default. It must be enabled via a setting passed to the KJ HTTP library via `HttpClientSettings` or `HttpServerSettings`. The bytes written out-of-bounds are always a specific constant 4-byte string `{ 0x00, 0x00, 0xFF, 0xFF }`. Because this string is not controlled by the attacker, maintainers believe it is unlikely that remote code execution is possible. However, it cannot be ruled out. This functionality first appeared in Cap'n Proto 1.0. Previous versions are not affected.\n\nThis issue is fixed in Cap'n Proto 1.0.1.1."}, {"lang": "es", "value": "Cap'n Proto es un formato de intercambio de datos y un sistema RPC basado en capacidades. En las versiones 1.0 y 1.0.1, cuando se utiliza la librer\u00eda HTTP KJ con la compresi\u00f3n WebSocket habilitada, un par remoto puede provocar una insuficiencia de datos del b\u00fafer. La insuficiencia de datos siempre escribe un valor constante que no est\u00e1 controlado por el atacante, lo que probablemente provoca un bloqueo y permite un ataque remoto de denegaci\u00f3n de servicio. Es poco probable que la mayor\u00eda de los usuarios de Cap'n Proto y KJ tengan habilitada esta funcionalidad y, por lo tanto, es poco probable que se vean afectados. Los mantenedores sospechan que Cloudflare Workers Runtime se ve afectado. Si se utiliza KJ HTTP con la compresi\u00f3n WebSocket habilitada, un par malintencionado puede provocar una insuficiencia de datos en un b\u00fafer asignado en heap. KJ HTTP es una librer\u00eda opcional incluida con Cap'n Proto, pero Cap'n Proto no la utiliza directamente. La compresi\u00f3n WebSocket est\u00e1 deshabilitada de forma predeterminada. Debe habilitarse mediante una configuraci\u00f3n pasada a la librer\u00eda HTTP KJ mediante `HttpClientSettings` o `HttpServerSettings`. Los bytes escritos fuera de los l\u00edmites son siempre una cadena constante espec\u00edfica de 4 bytes `{ 0x00, 0x00, 0xFF, 0xFF }`. Debido a que el atacante no controla esta cadena, los mantenedores creen que es poco probable que sea posible la ejecuci\u00f3n remota de c\u00f3digo. Sin embargo, no se puede descartar. Esta funcionalidad apareci\u00f3 por primera vez en Cap'n Proto 1.0. Las versiones anteriores no se ven afectadas. Este problema se solucion\u00f3 en Cap'n Proto 1.0.1.1."}]}, "references": {"reference_data": [{"url": "https://github.com/capnproto/capnproto/commit/75c5c1499aa6e7690b741204ff9af91cce526c59", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/capnproto/capnproto/commit/e7f22da9c01286a2b0e1e5fbdf3ec9ab3aa128ff", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/capnproto/capnproto/security/advisories/GHSA-r89h-f468-62w3", "name": "", "refsource": "", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://github.com/capnproto/capnproto/commit/75c5c1499aa6e7690b741204ff9af91cce526c59", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/capnproto/capnproto/commit/e7f22da9c01286a2b0e1e5fbdf3ec9ab3aa128ff", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/capnproto/capnproto/security/advisories/GHSA-r89h-f468-62w3", "name": "", "refsource": "", "tags": ["Exploit", "Patch", "Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-124"}, {"lang": "en", "value": "CWE-787"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:capnproto:capnproto:1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "7CA487D0-FD4A-4967-A786-E193A410B278", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:capnproto:capnproto:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "C3CBABE2-2DD5-4576-B461-3D18E52DC2B2", "cpe_name": []}]}]}}