{"publishedDate": "2023-04-04T22:15Z", "lastModifiedDate": "2024-11-21T07:56Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2023-28841", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Moby is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (`dockerd`), which is developed as moby/moby is commonly referred to as *Docker*.\n\nSwarm Mode, which is compiled in and delivered by default in `dockerd` and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of SwarmKit and supporting network code.\n\nThe `overlay` network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of VXLAN, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with the VXLAN metadata, including a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.\n\nEncrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the IPsec Encapsulating Security Payload protocol in Transport mode. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.\n\nWhen setting an endpoint up on an encrypted overlay network, Moby installs three iptables (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the `u32` iptables extension provided by the `xt_u32` kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.\n\nAn iptables rule designates outgoing VXLAN datagrams with a VNI that corresponds to an encrypted overlay network for IPsec encapsulation.\n\nEncrypted overlay networks on affected platforms silently transmit unencrypted data. As a result, `overlay` networks may appear to be functional, passing traffic as expected, but without any of the expected confidentiality or data integrity guarantees.\n\nIt is possible for an attacker sitting in a trusted position on the network to read all of the application traffic that is moving across the overlay network, resulting in unexpected secrets or user data disclosure. Thus, because many database protocols, internal APIs, etc. are not protected by a second layer of encryption, a user may use Swarm encrypted overlay networks to provide confidentiality, which due to this vulnerability this is no longer guaranteed.\n\nPatches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.\n\nSome workarounds are available. Close the VXLAN port (by default, UDP port 4789) to outgoing traffic at the Internet boundary in order to prevent unintentionally leaking unencrypted traffic over the Internet, and/or ensure that the `xt_u32` kernel module is available on all nodes of the Swarm cluster."}, {"lang": "es", "value": "Moby es un framework de contenedores de c\u00f3digo abierto desarrollado por Docker Inc. que se distribuye como Docker, Mirantis Container Runtime y varios otros proyectos/productos posteriores. El componente Moby daemon (`dockerd`), que se desarrolla como moby/moby, se conoce com\u00fanmente como *Docker*. El modo Swarm, que se compila y entrega de forma predeterminada en \"dockerd\" y, por lo tanto, est\u00e1 presente en la mayor\u00eda de las principales versiones de Moby, es un orquestador de contenedores simple e integrado que se implementa mediante una combinaci\u00f3n de SwarmKit y c\u00f3digo de red de soporte. El controlador de red \"superpuesto\" es una caracter\u00edstica central del modo Swarm, que proporciona LAN virtuales aisladas que permiten la comunicaci\u00f3n entre contenedores y servicios en todo el cl\u00faster. Este controlador es una implementaci\u00f3n/usuario de VXLAN, que encapsula tramas de capa de enlace (Ethernet) en datagramas UDP que etiquetan la trama con los metadatos de VXLAN, incluido un ID de red VXLAN (VNI) que identifica la red superpuesta de origen. Adem\u00e1s, el controlador de red superpuesta admite un modo cifrado opcional, desactivado de forma predeterminada, que resulta especialmente \u00fatil cuando los paquetes VXLAN atraviesan una red que no es de confianza entre nodos. Las redes superpuestas cifradas funcionan encapsulando los datagramas VXLAN mediante el uso del protocolo IPsec Encapsulating Security Payload en modo Transporte. Al implementar la encapsulaci\u00f3n IPSec, las redes superpuestas cifradas obtienen propiedades adicionales de autenticaci\u00f3n de origen mediante prueba criptogr\u00e1fica, integridad de datos mediante suma de verificaci\u00f3n y confidencialidad mediante cifrado.Al configurar un endpoint en una red superpuesta cifrada, Moby instala tres reglas de iptables (firewall del kernel de Linux) que aplican IPSec tanto entrante como saliente. Estas reglas se basan en la extensi\u00f3n iptables `u32` proporcionada por el m\u00f3dulo del kernel `xt_u32` para filtrar directamente el campo VNI de un paquete VXLAN, de modo que las garant\u00edas IPSec se puedan aplicar en redes superpuestas cifradas sin interferir con otras redes superpuestas u otros usuarios de VXLAN. Una regla de iptables designa datagramas VXLAN salientes con un VNI que corresponde a una red superpuesta cifrada para encapsulaci\u00f3n IPsec. Las redes superpuestas cifradas en las plataformas afectadas transmiten silenciosamente datos no cifrados. Como resultado, las redes \"superpuestas\" pueden parecer funcionales, pasando el tr\u00e1fico como se esperaba, pero sin ninguna de las garant\u00edas esperadas de confidencialidad o integridad de los datos. Es posible que un atacante ubicado en una posici\u00f3n confiable en la red lea todo el tr\u00e1fico de aplicaciones que se mueve a trav\u00e9s de la red superpuesta, lo que resulta en secretos inesperados o divulgaci\u00f3n de datos del usuario. Por lo tanto, debido a que muchos protocolos de bases de datos, API internas, etc. no est\u00e1n protegidos por una segunda capa de cifrado, un usuario puede utilizar redes superpuestas cifradas Swarm para proporcionar confidencialidad, que debido a esta vulnerabilidad ya no est\u00e1 garantizada. Los parches est\u00e1n disponibles en las versiones 23.0.3 y 20.10.24 de Moby. Como las versiones 20.10 de Mirantis Container Runtime tienen numeraci\u00f3n diferente, los usuarios de esa plataforma deben actualizar a la versi\u00f3n 20.10.16. Algunos workarounds est\u00e1n disponibles. Cierre el puerto VXLAN (de forma predeterminada, el puerto UDP 4789) al tr\u00e1fico saliente en el l\u00edmite de Internet para evitar fugas involuntarias de tr\u00e1fico no cifrado a trav\u00e9s de Internet y/o aseg\u00farese de que el m\u00f3dulo del kernel `xt_u32` est\u00e9 disponible en todos los nodos del grupo Swarm."}]}, "references": {"reference_data": [{"url": "https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207", "name": "", "refsource": "", "tags": ["Product"]}, {"url": "https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/moby/moby/issues/43382", "name": "", "refsource": "", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/moby/moby/pull/45118", "name": "", "refsource": "", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp", "name": "", "refsource": "", "tags": ["Not Applicable"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237", "name": "", "refsource": "", "tags": ["Mitigation", "Vendor Advisory"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p", "name": "", "refsource": "", "tags": ["Not Applicable"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207", "name": "", "refsource": "", "tags": ["Product"]}, {"url": "https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/moby/moby/issues/43382", "name": "", "refsource": "", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/moby/moby/pull/45118", "name": "", "refsource": "", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp", "name": "", "refsource": "", "tags": ["Not Applicable"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237", "name": "", "refsource": "", "tags": ["Mitigation", "Vendor Advisory"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p", "name": "", "refsource": "", "tags": ["Not Applicable"]}, {"url": "https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-311"}, {"lang": "en", "value": "CWE-636"}, {"lang": "en", "value": "CWE-755"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.2, "impactScore": 4.0, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N", "baseScore": 6.8, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*", "matchCriteriaId": "E7027BE5-D31C-40E5-81A4-A91028A687B3", "cpe_name": [], "versionStartIncluding": "1.12.0", "versionEndExcluding": "20.10.24"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*", "matchCriteriaId": "911C8E32-9EC6-4AAD-93CD-C1880D06E3AD", "cpe_name": [], "versionStartIncluding": "23.0.0", "versionEndExcluding": "23.0.3"}]}]}}