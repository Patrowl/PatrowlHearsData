{"publishedDate": "2018-12-28T16:29Z", "lastModifiedDate": "2024-11-21T03:40Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2018-1000888", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915 vulnerability in the Archive_Tar class. There are several file operations with `$v_header['filename']` as parameter (such as file_exists, is_file, is_dir, etc). When extract is called without a specific prefix path, we can trigger unserialization by crafting a tar file with `phar://[path_to_malicious_phar_file]` as path. Object injection can be used to trigger destruct in the loaded PHP classes, e.g. the Archive_Tar class itself. With Archive_Tar object injection, arbitrary file deletion can occur because `@unlink($this->_temp_tarname)` is called. If another class with useful gadget is loaded, it may possible to cause remote code execution that can result in files being deleted or possibly modified. This vulnerability appears to have been fixed in 1.4.4."}, {"lang": "es", "value": "PEAR Archive_Tar, en versiones 1.4.3 y anteriores, contiene vulnerabilidades CWE-502 y CWE-915 en la clase Archive_Tar. Hay varias operaciones de archivo con \"$v_header['filename']\" como par\u00e1metro (como file_exists, is_file, is_dir, etc.). Cuando se llama a extract sin una ruta de prefijo espec\u00edfica, podemos desencadenar la deserializaci\u00f3n manipulando un archivo tar con \"phar://[path_to_malicious_phar_file]\" como ruta. La inyecci\u00f3n de objetos puede emplearse para desencadenar destruct en las clases PHP cargadas, como en la propia clase Archive_Tar. Con la inyecci\u00f3n del objeto Archive_Tar, puede ocurrir un borrado de archivos arbitrarios debido a que se llama a \"@unlink($this->_temp_tarname)\". Si se carga otra clase con un gadget \u00fatil, podr\u00eda ser posible provocar la ejecuci\u00f3n remota de c\u00f3digo que puede resultar en que los archivos se eliminen o modifiquen. La vulnerabilidad parece haber sido solucionada en la versi\u00f3n 1.4.4."}]}, "references": {"reference_data": [{"url": "https://blog.ripstech.com/2018/new-php-exploitation-technique/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf", "name": "", "refsource": "", "tags": ["Exploit", "Technical Description", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2019/02/msg00020.html", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://pear.php.net/bugs/bug.php?id=23782", "name": "", "refsource": "", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://pear.php.net/package/Archive_Tar/download/", "name": "", "refsource": "", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://security.gentoo.org/glsa/202006-14", "name": "", "refsource": "", "tags": []}, {"url": "https://usn.ubuntu.com/3857-1/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2019/dsa-4378", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/46108/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://blog.ripstech.com/2018/new-php-exploitation-technique/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf", "name": "", "refsource": "", "tags": ["Exploit", "Technical Description", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2019/02/msg00020.html", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://pear.php.net/bugs/bug.php?id=23782", "name": "", "refsource": "", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://pear.php.net/package/Archive_Tar/download/", "name": "", "refsource": "", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://security.gentoo.org/glsa/202006-14", "name": "", "refsource": "", "tags": []}, {"url": "https://usn.ubuntu.com/3857-1/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2019/dsa-4378", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/46108/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-502"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "baseScore": 6.8, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 8.6, "impactScore": 6.4, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 5.9, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:php:pear_archive_tar:*:*:*:*:*:*:*:*", "matchCriteriaId": "AA4A9202-16C6-4AA6-A5F0-59F4E6B1F2A3", "cpe_name": [], "versionEndIncluding": "1.4.3"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*", "matchCriteriaId": "F7016A2A-8365-4F1A-89A2-7A19F2BCAE5B", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*", "matchCriteriaId": "07C312A0-CD2C-4B9C-B064-6409B25C278F", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252", "cpe_name": []}]}]}}