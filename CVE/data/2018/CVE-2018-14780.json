{"publishedDate": "2018-08-15T18:29Z", "lastModifiedDate": "2024-11-21T03:49Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2018-14780", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An out-of-bounds read issue was discovered in the Yubico-Piv 1.5.0 smartcard driver. The file lib/ykpiv.c contains the following code in the function `_ykpiv_fetch_object()`: {% highlight c %} if(sw == SW_SUCCESS) { size_t outlen; int offs = _ykpiv_get_length(data + 1, &outlen); if(offs == 0) { return YKPIV_SIZE_ERROR; } memmove(data, data + 1 + offs, outlen); *len = outlen; return YKPIV_OK; } else { return YKPIV_GENERIC_ERROR; } {% endhighlight %} -- in the end, a `memmove()` occurs with a length retrieved from APDU data. This length is not checked for whether it is outside of the APDU data retrieved. Therefore the `memmove()` could copy bytes behind the allocated data buffer into this buffer."}, {"lang": "es", "value": "Se ha descubierto una vulnerabilidad de lectura fuera de l\u00edmites en el controlador de tarjetas inteligentes de Yubico-Piv 1.5.0. El archivo lib/ykpiv.c contiene el siguiente c\u00f3digo en la funci\u00f3n \"_ykpiv_fetch_object()\": {% highlight c %} if(sw == SW_SUCCESS) { size_t outlen; int offs = _ykpiv_get_length(data + 1, outlen); if(offs == 0) { return YKPIV_SIZE_ERROR; } memmove(data, data + 1 + offs, outlen); *len = outlen; return YKPIV_OK; } else { return YKPIV_GENERIC_ERROR; } {% endhighlight %} -- Al final, ocurre un \"memmove()\" con una longitud recuperada de los datos APDU. No se comprueba si la longitud es de fuera de los datos APDU recuperados. Por lo tanto, \"memmove()\" podr\u00eda copiar bytes de detr\u00e1s del b\u00fafer de datos asignado en este b\u00fafer."}]}, "references": {"reference_data": [{"url": "http://www.openwall.com/lists/oss-security/2018/08/14/2", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4276-1/", "name": "", "refsource": "", "tags": []}, {"url": "https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.yubico.com/support/security-advisories/ysa-2018-03/", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2018/08/14/2", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4276-1/", "name": "", "refsource": "", "tags": []}, {"url": "https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.yubico.com/support/security-advisories/ysa-2018-03/", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-125"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:N/A:N", "baseScore": 2.1, "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE"}, "exploitabilityScore": 3.9, "impactScore": 2.9, "severity": "LOW", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 0.9, "impactScore": 3.6, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "baseScore": 4.6, "baseSeverity": "MEDIUM", "attackVector": "PHYSICAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:*:*:*:*:*:*:*:*", "matchCriteriaId": "1E9E1480-3B52-4116-A0AC-6D40EF27C705", "cpe_name": [], "versionEndExcluding": "1.4.2"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "78648DEA-0B05-450B-9B69-5A90E0F03B12", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2b:*:*:*:*:*:*:*", "matchCriteriaId": "F27386DA-D798-442B-AB7A-9F3A8D5298E7", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2c:*:*:*:*:*:*:*", "matchCriteriaId": "BA320FD3-AE57-4CC3-A00B-915CAE53A9CB", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2d:*:*:*:*:*:*:*", "matchCriteriaId": "1DCA5A56-4979-4981-ABDC-F6243FEDAA48", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2e:*:*:*:*:*:*:*", "matchCriteriaId": "A6ABF3B7-521E-42C4-85A9-A867BE87F8E2", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2f:*:*:*:*:*:*:*", "matchCriteriaId": "6A9DE0A5-2B2D-4669-89F2-306C97445ADB", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_manager:1.4.2g:*:*:*:*:*:*:*", "matchCriteriaId": "8A6DCD14-7271-40E3-A9C5-B20EFF6B7495", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:piv_tool:*:*:*:*:*:*:*:*", "matchCriteriaId": "B3DA5613-3B1C-434A-950B-101FE9BEE7A9", "cpe_name": [], "versionEndExcluding": "1.6.0"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:yubico:smart_card_minidriver:*:*:*:*:*:*:*:*", "matchCriteriaId": "60A34CF9-F5B7-4874-961D-22915C55D60F", "cpe_name": [], "versionEndIncluding": "3.7.3.160"}]}]}}