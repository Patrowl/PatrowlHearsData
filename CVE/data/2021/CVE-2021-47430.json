{"publishedDate": "2024-05-21T15:15Z", "lastModifiedDate": "2024-11-21T06:36Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-47430", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/entry: Clear X86_FEATURE_SMAP when CONFIG_X86_SMAP=n\n\nCommit\n\n  3c73b81a9164 (\"x86/entry, selftests: Further improve user entry sanity checks\")\n\nadded a warning if AC is set when in the kernel.\n\nCommit\n\n  662a0221893a3d (\"x86/entry: Fix AC assertion\")\n\nchanged the warning to only fire if the CPU supports SMAP.\n\nHowever, the warning can still trigger on a machine that supports SMAP\nbut where it's disabled in the kernel config and when running the\nsyscall_nt selftest, for example:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 0 PID: 49 at irqentry_enter_from_user_mode\n  CPU: 0 PID: 49 Comm: init Tainted: G                T 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014\n  RIP: 0010:irqentry_enter_from_user_mode\n  ...\n  Call Trace:\n   ? irqentry_enter\n   ? exc_general_protection\n   ? asm_exc_general_protection\n   ? asm_exc_general_protectio\n\nIS_ENABLED(CONFIG_X86_SMAP) could be added to the warning condition, but\neven this would not be enough in case SMAP is disabled at boot time with\nthe \"nosmap\" parameter.\n\nTo be consistent with \"nosmap\" behaviour, clear X86_FEATURE_SMAP when\n!CONFIG_X86_SMAP.\n\nFound using entry-fuzz + satrandconfig.\n\n [ bp: Massage commit message. ]"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: x86/entry: borra X86_FEATURE_SMAP cuando CONFIG_X86_SMAP=n confirmaci\u00f3n 3c73b81a9164 (\"x86/entry, selftests: mejora a\u00fan m\u00e1s las comprobaciones de seguridad de entrada del usuario\") agreg\u00f3 una advertencia si AC est\u00e1 configurado en el n\u00facleo. La confirmaci\u00f3n 662a0221893a3d (\"x86/entry: Reparar aserci\u00f3n de AC\") cambi\u00f3 la advertencia para que solo se active si la CPU admite SMAP. Sin embargo, la advertencia a\u00fan puede activarse en una m\u00e1quina que admite SMAP pero donde est\u00e1 deshabilitado en la configuraci\u00f3n del kernel y cuando se ejecuta la autoprueba syscall_nt, por ejemplo: ------------[ cortar aqu\u00ed ]--- --------- ADVERTENCIA: CPU: 0 PID: 49 en irqentry_enter_from_user_mode CPU: 0 PID: 49 Comm: init Tainted: GT 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905 Nombre del hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 01/04/2014 RIP: 0010:irqentry_enter_from_user_mode... Seguimiento de llamadas:? irqentry_enter? exc_general_protection? asm_exc_general_protection? Se podr\u00eda agregar asm_exc_general_protectio IS_ENABLED(CONFIG_X86_SMAP) a la condici\u00f3n de advertencia, pero incluso esto no ser\u00eda suficiente en caso de que SMAP est\u00e9 deshabilitado en el momento del arranque con el par\u00e1metro \"nosmap\". Para ser coherente con el comportamiento de \"nosmap\", borre X86_FEATURE_SMAP cuando !CONFIG_X86_SMAP. Encontrado usando Entry-fuzz + satrandconfig. [pb: mensaje de confirmaci\u00f3n de masaje. ]"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/3958b9c34c2729597e182cc606cc43942fd19f7c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/4e9ec1c65da98c293f75d83755dfa5e03075a6d0", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f2447f6587b8ffe42ba04d14ce67d429a1163e5e", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/3958b9c34c2729597e182cc606cc43942fd19f7c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/4e9ec1c65da98c293f75d83755dfa5e03075a6d0", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f2447f6587b8ffe42ba04d14ce67d429a1163e5e", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}