{"publishedDate": "2021-12-27T18:15Z", "lastModifiedDate": "2024-11-21T06:29Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-43856", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Wiki.js is a wiki app built on Node.js. Wiki.js 2.5.263 and earlier is vulnerable to stored cross-site scripting through non-image file uploads for file types that can be viewed directly inline in the browser. By creating a malicious file which can execute inline JS when viewed in the browser (e.g. XML files), a malicious Wiki.js user may stage a stored cross-site scripting attack. This allows the attacker to execute malicious JavaScript when the file is viewed directly by other users. The file must be opened directly by the user and will not trigger directly in a normal Wiki.js page. A patch in version 2.5.264 fixes this vulnerability by adding an optional (enabled by default) force download flag to all non-image file types, preventing the file from being viewed inline in the browser. As a workaround, disable file upload for all non-trusted users. --- Thanks to @Haxatron for reporting this vulnerability. Initially reported via https://huntr.dev/bounties/266bff09-00d9-43ca-a4bb-bb540642811f/"}, {"lang": "es", "value": "Wiki.js es una aplicaci\u00f3n wiki construida sobre Node.js. Wiki.js versiones 2.5.263 y anteriores, son vulnerables a un ataque de tipo cross-site scripting almacenado por medio de una carga de archivos que no son de imagen para los tipos de archivos que pueden ser visualizados directamente en l\u00ednea en el navegador. Al crear un archivo malicioso que puede ejecutar JS en l\u00ednea cuando es visualizado en el navegador (por ejemplo, archivos XML), un usuario malicioso de Wiki.js puede realizar un ataque de tipo cross-site scripting almacenado. Esto permite al atacante ejecutar JavaScript malicioso cuando el archivo es visto directamente por otros usuarios. El archivo debe ser abierto directamente por el usuario y no ser\u00e1 desencadenado directamente en una p\u00e1gina Wiki.js normal. Un parche en la versi\u00f3n 2.5.264 corrige esta vulnerabilidad al a\u00f1adir un flag  de descarga opcional forzado (habilitada por defecto) para todos los tipos de archivos que no sean de imagen, impidiendo que el archivo sea visualizado en l\u00ednea en el navegador. Como soluci\u00f3n, deshabilite la carga de archivos para todos los usuarios que no sean confiables. --- Gracias a @Haxatron por reportar esta vulnerabilidad. Informado inicialmente por medio de https://huntr.dev/bounties/266bff09-00d9-43ca-a4bb-bb540642811f/"}]}, "references": {"reference_data": [{"url": "https://github.com/Requarks/wiki/commit/79bdd4409316adf649806de3e22352297f85cee0", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Requarks/wiki/releases/tag/2.5.264", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/Requarks/wiki/security/advisories/GHSA-rhpf-929m-7fm2", "name": "", "refsource": "", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/Requarks/wiki/commit/79bdd4409316adf649806de3e22352297f85cee0", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Requarks/wiki/releases/tag/2.5.264", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/Requarks/wiki/security/advisories/GHSA-rhpf-929m-7fm2", "name": "", "refsource": "", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-79"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "baseScore": 3.5, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}, "exploitabilityScore": 6.8, "impactScore": 2.9, "severity": "LOW", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}, "baseMetricV3": {"exploitabilityScore": 2.3, "impactScore": 2.7, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "baseScore": 5.4, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:requarks:wiki.js:*:*:*:*:*:*:*:*", "matchCriteriaId": "1F3F2ADB-A69D-403D-9A61-51A8644F42E0", "cpe_name": [], "versionEndExcluding": "2.5.264"}]}]}}