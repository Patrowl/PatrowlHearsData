{"publishedDate": "2021-10-07T19:15Z", "lastModifiedDate": "2024-11-21T06:25Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-41130", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Extensible Service Proxy, a.k.a. ESP is a proxy which enables API management capabilities for JSON/REST or gRPC API services. ESPv1 can be configured to authenticate a JWT token. Its verified JWT claim is passed to the application by HTTP header \"X-Endpoint-API-UserInfo\", the application can use it to do authorization. But if there are two \"X-Endpoint-API-UserInfo\" headers from the client, ESPv1 only replaces the first one, the 2nd one will be passed to the application. An attacker can send two \"X-Endpoint-API-UserInfo\" headers, the second one with a fake JWT claim. Application may use the fake JWT claim to do the authorization. This impacts following ESPv1 usages: 1) Users have configured ESPv1 to do JWT authentication with Google ID Token as described in the referenced google endpoint document. 2) Users backend application is using the info in the \"X-Endpoint-API-UserInfo\" header to do the authorization. It has been fixed by v1.58.0. You need to patch it in the following ways: * If your docker image is using tag \":1\", needs to re-start the container to pick up the new version. The tag \":1\" will automatically point to the latest version. * If your docker image tag pings to a specific minor version, e.g. \":1.57\". You need to update it to \":1.58\" and re-start the container. There are no workaround for this issue."}, {"lang": "es", "value": "Extensible Service Proxy, tambi\u00e9n se conoce como ESP, es un proxy que permite la administraci\u00f3n de la API para los servicios JSON/REST o gRPC. ESPv1 puede ser configurado para autenticar un token JWT. Su reclamaci\u00f3n JWT verificada se pasa a la aplicaci\u00f3n mediante el encabezado HTTP \"X-Endpoint-API-UserInfo\", la aplicaci\u00f3n puede usarla para hacer la autorizaci\u00f3n. Pero si presenta dos encabezados \"X-Endpoint-API-UserInfo\" del cliente, ESPv1 s\u00f3lo reemplaza la primera, la segunda ser\u00e1 pasada a la aplicaci\u00f3n. Un atacante puede enviar dos encabezados \"X-Endpoint-API-UserInfo\", la segunda con una reclamaci\u00f3n JWT falsa. La aplicaci\u00f3n puede usar la reclamaci\u00f3n JWT falsa para hacer la autorizaci\u00f3n. Esto afecta a los siguientes usos de ESPv1: 1) Los usuarios han configurado ESPv1 para hacer la autenticaci\u00f3n JWT con Google ID Token como se describe en el documento de Google Endpoint referenciado. 2) La aplicaci\u00f3n backend de los usuarios usa la informaci\u00f3n del encabezado \"X-Endpoint-API-UserInfo\" para realizar la autorizaci\u00f3n. Se ha corregido en la versi\u00f3n 1.58.0. Es necesario parchearlo de las siguientes maneras: * Si su imagen docker est\u00e1 usando la etiqueta \":1\", necesita reiniciar el contenedor para recoger la nueva versi\u00f3n. La etiqueta \":1\" apuntar\u00e1 autom\u00e1ticamente a la \u00faltima versi\u00f3n. * Si la etiqueta de su imagen docker apunta a una versi\u00f3n menor espec\u00edfica, por ejemplo \":1.57\". Debe actualizarla a \":1.58\" y reiniciar el contenedor. No se presenta ninguna soluci\u00f3n para este problema"}]}, "references": {"reference_data": [{"url": "https://cloud.google.com/endpoints/docs/openapi/authenticating-users-google-id", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/commit/e310c4f91d229a072507f80c73811489b4cdff27", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/releases/tag/v1.58.0", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/security/advisories/GHSA-43wx-8qmj-9r9q", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://cloud.google.com/endpoints/docs/openapi/authenticating-users-google-id", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/commit/e310c4f91d229a072507f80c73811489b4cdff27", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/releases/tag/v1.58.0", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/cloudendpoints/esp/security/advisories/GHSA-43wx-8qmj-9r9q", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-290"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:N", "baseScore": 4.9, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}, "exploitabilityScore": 6.8, "impactScore": 4.9, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 2.5, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "baseScore": 5.4, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:google:extensible_service_proxy:*:*:*:*:*:*:*:*", "matchCriteriaId": "DB5147A5-A760-4866-AA59-9D0463B68A64", "cpe_name": [], "versionEndExcluding": "1.58.0"}]}]}}