{"publishedDate": "2021-12-17T19:15Z", "lastModifiedDate": "2024-11-21T06:29Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-43840", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "message_bus is a messaging bus for Ruby processes and web clients. In versions prior to 3.3.7 users who deployed message bus with diagnostics features enabled (default off) are vulnerable to a path traversal bug, which could lead to disclosure of secret information on a machine if an unintended user were to gain access to the diagnostic route. The impact is also greater if there is no proxy for your web application as the number of steps up the directories is not bounded. For deployments which uses a proxy, the impact varies. For example, If a request goes through a proxy like Nginx with `merge_slashes` enabled, the number of steps up the directories that can be read is limited to 3 levels. This issue has been patched in version 3.3.7. Users unable to upgrade should ensure that MessageBus::Diagnostics is disabled."}, {"lang": "es", "value": "message_bus es un bus de mensajer\u00eda para procesos Ruby y clientes web. En las versiones anteriores a 3.3.7, los usuarios que desplegaron el bus de mensajes con las caracter\u00edsticas de diagn\u00f3stico habilitadas (por defecto deshabilitadas) son vulnerables a un bug de salto de ruta, que podr\u00eda conllevar a una revelaci\u00f3n de informaci\u00f3n secreta en una m\u00e1quina si un usuario no intencionado accediera a la ruta de diagn\u00f3stico. El impacto tambi\u00e9n es mayor si no se presenta un proxy para su aplicaci\u00f3n web, ya que el n\u00famero de pasos por los directorios no est\u00e1 limitado. Para las implementaciones que usan un proxy, el impacto var\u00eda. Por ejemplo, si una petici\u00f3n pasa por un proxy como Nginx con \"merge_slashes\" habilitado, el n\u00famero de pasos hacia arriba en los directorios que pueden ser le\u00eddos est\u00e1 limitado a 3 niveles. Este problema ha sido parcheado en la versi\u00f3n 3.3.7. Los usuarios que no puedan actualizarse deber\u00e1n asegurarse de que MessageBus::Diagnostics est\u00e1 deshabilitado"}]}, "references": {"reference_data": [{"url": "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-22"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N", "baseScore": 3.5, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE"}, "exploitabilityScore": 6.8, "impactScore": 2.9, "severity": "LOW", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "baseScore": 6.5, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:discourse:message_bus:*:*:*:*:*:ruby:*:*", "matchCriteriaId": "1BFAB388-520F-4B06-8DC0-2F6821BA0898", "cpe_name": [], "versionEndExcluding": "3.3.7"}]}]}}