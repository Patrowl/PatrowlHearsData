{"publishedDate": "2021-04-15T22:15Z", "lastModifiedDate": "2024-11-21T05:48Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-21405", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Lotus is an Implementation of the Filecoin protocol written in Go. BLS signature validation in lotus uses blst library method VerifyCompressed. This method accepts signatures in 2 forms: \"serialized\", and \"compressed\", meaning that BLS signatures can be provided as either of 2 unique byte arrays. Lotus block validation functions perform a uniqueness check on provided blocks. Two blocks are considered distinct if the CIDs of their blockheader do not match. The CID method for blockheader includes the BlockSig of the block. The result of these issues is that it would be possible to punish miners for valid blocks, as there are two different valid block CIDs available for each block, even though this must be unique. By switching from the go based `blst` bindings over to the bindings in `filecoin-ffi`, the code paths now ensure that all signatures are compressed by size and the way they are deserialized. This happened in https://github.com/filecoin-project/lotus/pull/5393."}, {"lang": "es", "value": "Lotus es una implementaci\u00f3n del protocolo Filecoin escrito en Go.&#xa0;La validaci\u00f3n de la firma BLS en lotus utiliza el m\u00e9todo de biblioteca blst VerifyCompressed.&#xa0;Este m\u00e9todo acepta firmas en 2 formas: \"serialized\" y \"compressed\", lo que significa que las firmas BLS se pueden proporcionar como cualquiera de las 2 matrices de bytes \u00fanicas.&#xa0;Las funciones de validaci\u00f3n de bloques de Lotus realizan una verificaci\u00f3n de unicidad en los bloques proporcionados.&#xa0;Dos bloques se consideran distintos si los CID de su encabezado de bloque no coinciden.&#xa0;El m\u00e9todo CID para blockheader incluye el BlockSig del bloque.&#xa0;El resultado de estos problemas es que ser\u00eda posible castigar a los mineros por bloques v\u00e1lidos, ya que hay dos CID de bloque v\u00e1lidos diferentes disponibles para cada bloque, aunque este debe ser \u00fanico.&#xa0;Al cambiar de los enlaces `blst` basados ??en go a los enlaces en `filecoin-ffi`,&#xa0;las rutas de c\u00f3digo ahora garantizan que todas las firmas est\u00e9n comprimidas por tama\u00f1o y la forma en que se deserializan.&#xa0;Esto ocurri\u00f3 en https://github.com/filecoin-project/lotus/pull/5393"}]}, "references": {"reference_data": [{"url": "https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/filecoin-project/lotus/pull/5393", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/filecoin-project/lotus/pull/5393", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-347"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "baseScore": 5.0, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}, "exploitabilityScore": 10.0, "impactScore": 2.9, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "baseScore": 7.5, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:filecoin:lotus:*:*:*:*:*:*:*:*", "matchCriteriaId": "2E70B8AC-AD64-4FD9-9EDE-EB9C83587B69", "cpe_name": [], "versionEndExcluding": "1.5.0"}]}]}}