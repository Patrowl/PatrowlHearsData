{"publishedDate": "2021-08-03T14:15Z", "lastModifiedDate": "2024-11-21T06:13Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-36159", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "libfetch before 2021-07-26, as used in apk-tools, xbps, and other products, mishandles numeric strings for the FTP and HTTP protocols. The FTP passive mode implementation allows an out-of-bounds read because strtol is used to parse the relevant numbers into address bytes. It does not check if the line ends prematurely. If it does, the for-loop condition checks for the '\\0' terminator one byte too late."}, {"lang": "es", "value": "libfetch versiones anteriores al 26-07-2021, como se usa en apk-tools, xbps, y otros productos, maneja inapropiadamente las cadenas num\u00e9ricas para los protocolos FTP y HTTP. La implementaci\u00f3n del modo pasivo de FTP permite una lectura fuera de l\u00edmites porque strtol se usa para analizar los n\u00fameros relevantes en bytes de direcci\u00f3n. No comprueba si la l\u00ednea termina prematuramente. Si lo hace, la condici\u00f3n para bucle comprueba el terminador \"\\0\" un byte demasiado tarde"}]}, "references": {"reference_data": [{"url": "https://github.com/freebsd/freebsd-src/commits/main/lib/libfetch", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://gitlab.alpinelinux.org/alpine/apk-tools/-/issues/10749", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cdev.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cusers.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cdev.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cusers.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/freebsd/freebsd-src/commits/main/lib/libfetch", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://gitlab.alpinelinux.org/alpine/apk-tools/-/issues/10749", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cdev.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cusers.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cdev.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cusers.kafka.apache.org%3E", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-125"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:P", "baseScore": 6.4, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 10.0, "impactScore": 4.9, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.2, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H", "baseScore": 9.1, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:freebsd:libfetch:*:*:*:*:*:*:*:*", "matchCriteriaId": "181F9AFF-1B2E-4F70-B497-F7BCDF2499C2", "cpe_name": [], "versionEndExcluding": "2021-07-26"}]}]}}