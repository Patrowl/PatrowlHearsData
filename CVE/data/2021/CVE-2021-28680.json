{"publishedDate": "2021-12-07T21:15Z", "lastModifiedDate": "2024-11-21T06:00Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2021-28680", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "The devise_masquerade gem before 1.3 allows certain attacks when a password's salt is unknown. An application that uses this gem to let administrators masquerade/impersonate users loses one layer of security protection compared to a situation where Devise (without this extension) is used. If the server-side secret_key_base value became publicly known (for instance if it is committed to a public repository by mistake), there are still other protections in place that prevent an attacker from impersonating any user on the site. When masquerading is not used in a plain Devise application, one must know the password salt of the target user if one wants to encrypt and sign a valid session cookie. When devise_masquerade is used, however, an attacker can decide which user the \"back\" action will go back to without knowing that user's password salt and simply knowing the user ID, by manipulating the session cookie and pretending that a user is already masqueraded by an administrator."}, {"lang": "es", "value": "devise_masquerade gem versiones anteriores a 1.3, permite determinados ataques cuando se desconoce el salt de una contrase\u00f1a. Una aplicaci\u00f3n que usa esta gema para permitir a administradores enmascarar/impersonar a usuarios pierde una capa de protecci\u00f3n de seguridad en comparaci\u00f3n con una situaci\u00f3n en la que se usa Devise (sin esta extensi\u00f3n). Si el valor de secret_key_base del lado del servidor se hace p\u00fablicamente conocido (por ejemplo, si es comprometido a un repositorio p\u00fablico por error), todav\u00eda se presentan otras protecciones en el lugar que impiden a un atacante hacerse pasar por cualquier usuario en el sitio. Cuando no se usa el enmascaramiento en una aplicaci\u00f3n devise_masquerade, uno debe conocer el salt de la contrase\u00f1a del usuario objetivo si quiere cifrar y firmar una cookie de sesi\u00f3n v\u00e1lida. Sin embargo, cuando es usada devise_masquerade, un atacante puede decidir a qu\u00e9 usuario volver\u00e1 la acci\u00f3n \"back\" sin conocer el salt de la contrase\u00f1a de ese usuario y simplemente conociendo el ID del usuario, al manipular la cookie de sesi\u00f3n y fingiendo que un usuario ya est\u00e1 enmascarado por un administrador"}]}, "references": {"reference_data": [{"url": "https://github.com/oivoodoo/devise_masquerade/issues/83", "name": "", "refsource": "", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://labanskoller.se/blog/2021/03/23/the-devise-extension-that-peeled-off-one-layer-of-the-security-onion-cve-2021-28680/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/oivoodoo/devise_masquerade/issues/83", "name": "", "refsource": "", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://labanskoller.se/blog/2021/03/23/the-devise-extension-that-peeled-off-one-layer-of-the-security-onion-cve-2021-28680/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "baseScore": 6.8, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 8.6, "impactScore": 6.4, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.2, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.1, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:devise_masquerade_project:devise_masquerade:*:*:*:*:*:ruby:*:*", "matchCriteriaId": "79CC6B34-9869-474E-8C73-627B70DF22ED", "cpe_name": [], "versionEndExcluding": "1.3.0"}]}]}}