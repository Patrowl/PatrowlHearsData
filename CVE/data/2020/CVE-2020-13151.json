{"publishedDate": "2020-08-05T13:15Z", "lastModifiedDate": "2024-11-21T05:00Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2020-13151", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "Aerospike Community Edition 4.9.0.5 allows for unauthenticated submission and execution of user-defined functions (UDFs), written in Lua, as part of a database query. It attempts to restrict code execution by disabling os.execute() calls, but this is insufficient. Anyone with network access can use a crafted UDF to execute arbitrary OS commands on all nodes of the cluster at the permission level of the user running the Aerospike service."}, {"lang": "es", "value": "Aerospike Community Edition versi\u00f3n 4.9.0.5, permite el env\u00edo y la ejecuci\u00f3n no autenticada de funciones definidas por el usuario (UDF), escritas en Lua, como parte de una consulta de base de datos. Intenta restringir la ejecuci\u00f3n del c\u00f3digo al deshabilitar las llamadas a la funci\u00f3n os.execute(), pero esto es insuficiente. Cualquier persona con acceso a la red puede utilizar una UDF dise\u00f1ada para ejecutar comandos arbitrarios de Sistema Operativo en todos los nodos del cl\u00faster en el nivel de permiso del usuario que ejecuta el servicio de Aerospike"}]}, "references": {"reference_data": [{"url": "http://packetstormsecurity.com/files/160106/Aerospike-Database-5.1.0.3-Remote-Command-Execution.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/160451/Aerospike-Database-UDF-Lua-Code-Execution.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://b4ny4n.github.io/network-pentest/2020/08/01/cve-2020-13151-poc-aerospike.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.aerospike.com/docs/operations/configure/security/access-control/index.html#create-users-and-assign-roles", "name": "", "refsource": "", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/download/server/notes.html#5.1.0.3", "name": "", "refsource": "", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/enterprise/download/server/notes.html#5.1.0.3", "name": "", "refsource": "", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://packetstormsecurity.com/files/160106/Aerospike-Database-5.1.0.3-Remote-Command-Execution.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/160451/Aerospike-Database-UDF-Lua-Code-Execution.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://b4ny4n.github.io/network-pentest/2020/08/01/cve-2020-13151-poc-aerospike.html", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.aerospike.com/docs/operations/configure/security/access-control/index.html#create-users-and-assign-roles", "name": "", "refsource": "", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/download/server/notes.html#5.1.0.3", "name": "", "refsource": "", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/enterprise/download/server/notes.html#5.1.0.3", "name": "", "refsource": "", "tags": ["Release Notes", "Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-78"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "baseScore": 10.0, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE"}, "exploitabilityScore": 10.0, "impactScore": 10.0, "severity": "HIGH", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "DDD39672-A99B-418B-B1F0-D4A7140B6B87", "cpe_name": [], "versionEndExcluding": "4.5.3.21"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "318A7CDD-9791-45CC-9F17-24A81D48D6C5", "cpe_name": [], "versionStartIncluding": "4.6.0.1", "versionEndExcluding": "4.6.0.19"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "AD4254DC-DD44-468D-A71C-ACD54AA33F32", "cpe_name": [], "versionStartIncluding": "4.7.0.1", "versionEndExcluding": "4.7.0.17"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "A90BBE74-9DC4-4AA4-97F8-6FCC227F733D", "cpe_name": [], "versionStartIncluding": "4.8.0.1", "versionEndExcluding": "4.8.0.13"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "C23279C2-82B4-4614-8FDC-EFDC6D9E3637", "cpe_name": [], "versionStartIncluding": "4.9.0.1", "versionEndExcluding": "4.9.0.10"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "matchCriteriaId": "CD99C634-6C21-4CC0-99B9-71F122789F33", "cpe_name": [], "versionStartIncluding": "5.0.0.1", "versionEndExcluding": "5.0.0.7"}]}]}}