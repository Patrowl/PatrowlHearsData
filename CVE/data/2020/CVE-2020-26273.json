{"publishedDate": "2020-12-16T02:15Z", "lastModifiedDate": "2024-11-21T05:19Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2020-26273", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "osquery is a SQL powered operating system instrumentation, monitoring, and analytics framework. In osquery before version 4.6.0, by using sqlite's ATTACH verb, someone with administrative access to osquery can cause reads and writes to arbitrary sqlite databases on disk. This _does_ allow arbitrary files to be created, but they will be sqlite databases. It does not appear to allow existing non-sqlite files to be overwritten. This has been patched in osquery 4.6.0. There are several mitigating factors and possible workarounds. In some deployments, the people with access to these interfaces may be considered administrators. In some deployments, configuration is managed by a central tool. This tool can filter for the `ATTACH` keyword. osquery can be run as non-root user. Because this also limits the desired access levels, this requires deployment specific testing and configuration."}, {"lang": "es", "value": "osquery es un framework de instrumentaci\u00f3n, monitoreo y an\u00e1lisis del sistema operativo basado en SQL.&#xa0;En osquery versiones anteriores a 4.6.0, al usar el verbo ATTACH de sqlite, alguien con acceso administrativo a osquery puede causar lecturas y escrituras en bases de datos sqlite arbitrarias sobre el disco.&#xa0;Este _does_ permite que archivos arbitrarios sean creados, pero ser\u00e1n bases de datos sqlite.&#xa0;No parece permitir que se sobrescriban los archivos existentes que no son sqlite.&#xa0;Esto ha sido parcheado en osquery versi\u00f3n 4.6.0.&#xa0;Se presentan varios factores atenuantes y posibles soluciones.&#xa0;En algunas implementaciones, las personas con acceso a estas interfaces pueden considerarse administradores.&#xa0;En algunas implementaciones, la configuraci\u00f3n es administrada por una herramienta central.&#xa0;Esta herramienta puede filtrar por la palabra clave \"ATTACH\".&#xa0;osquery puede ser ejecutado como usuario no root.&#xa0;Porque esto tambi\u00e9n limita los niveles de acceso deseados, esto requiere pruebas y configuraci\u00f3n espec\u00edfica de la implementaci\u00f3n"}]}, "references": {"reference_data": [{"url": "https://github.com/osquery/osquery/commit/c3f9a3dae22d43ed3b4f6a403cbf89da4cba7c3c", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/releases/tag/4.6.0", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/security/advisories/GHSA-4g56-2482-x7q8", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md#remote-command-execution-using-sqlite-command---load_extension", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/commit/c3f9a3dae22d43ed3b4f6a403cbf89da4cba7c3c", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/releases/tag/4.6.0", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/security/advisories/GHSA-4g56-2482-x7q8", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md#remote-command-execution-using-sqlite-command---load_extension", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-77"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:N", "baseScore": 3.6, "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}, "exploitabilityScore": 3.9, "impactScore": 4.9, "severity": "LOW", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.0, "impactScore": 2.7, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "baseScore": 5.2, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*", "matchCriteriaId": "EFC05C69-965B-4F5A-B25C-F8CDBF5002ED", "cpe_name": [], "versionEndExcluding": "4.6.0"}]}]}}