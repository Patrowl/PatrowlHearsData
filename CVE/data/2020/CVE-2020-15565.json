{"publishedDate": "2020-07-07T13:15Z", "lastModifiedDate": "2024-11-21T05:05Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2020-15565", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered in Xen through 4.13.x, allowing x86 Intel HVM guest OS users to cause a host OS denial of service or possibly gain privileges because of insufficient cache write-back under VT-d. When page tables are shared between IOMMU and CPU, changes to them require flushing of both TLBs. Furthermore, IOMMUs may be non-coherent, and hence prior to flushing IOMMU TLBs, a CPU cache also needs writing back to memory after changes were made. Such writing back of cached data was missing in particular when splitting large page mappings into smaller granularity ones. A malicious guest may be able to retain read/write DMA access to frames returned to Xen's free pool, and later reused for another purpose. Host crashes (leading to a Denial of Service) and privilege escalation cannot be ruled out. Xen versions from at least 3.2 onwards are affected. Only x86 Intel systems are affected. x86 AMD as well as Arm systems are not affected. Only x86 HVM guests using hardware assisted paging (HAP), having a passed through PCI device assigned, and having page table sharing enabled can leverage the vulnerability. Note that page table sharing will be enabled (by default) only if Xen considers IOMMU and CPU large page size support compatible."}, {"lang": "es", "value": "Se detect\u00f3 un problema en Xen versiones hasta 4.13.x, que permit\u00eda a usuarios de Sistemas Operativos invitados Intel HVM x86 causar una denegaci\u00f3n de servicio del Sistema Operativo host o posiblemente alcanzar privilegios debido a la insuficiente reescritura de cach\u00e9 en VT-d. Cuando las tablas de p\u00e1ginas se comparten entre IOMMU y la CPU, los cambios en ellas requieren el vaciado de ambos TLB. Adem\u00e1s, los IOMMU pueden no ser coherentes y, por lo tanto, antes de vaciar los TLB de IOMMU, una memoria cach\u00e9 de la CPU tambi\u00e9n necesita volver a escribirse en la memoria despu\u00e9s de realizar los cambios. Tal escritura de datos en cach\u00e9 faltaba en particular al dividir las asignaciones de p\u00e1ginas grandes en las de granularidad m\u00e1s peque\u00f1as. Un hu\u00e9sped malicioso puede retener el acceso de lectura/escritura de DMA a los marcos devueltos al grupo gratuito de Xen y luego reutilizarlos para otro prop\u00f3sito. Los bloqueos del host (conllevan a una Denegaci\u00f3n de Servicio) y una escalada de privilegios no puede ser descartada. Las versiones Xen de al menos 3.2 en adelante est\u00e1n afectadas. Solo est\u00e1n afectados los sistemas Intel x86. Los sistemas x86 AMD y Arm no est\u00e1n afectados. Solo los invitados x86 HVM que usan paginaci\u00f3n asistida por hardware (HAP), que tienen asignado un dispositivo PCI pasado y que tienen habilitado el uso compartido de tablas de p\u00e1ginas pueden aprovechar la vulnerabilidad. Tenga en cuenta que el uso compartido de la tabla de p\u00e1ginas ser\u00e1 habilitada (por defecto) solo si Xen considera que IOMMU y la CPU de gran tama\u00f1o de p\u00e1gina son compatibles"}]}, "references": {"reference_data": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00024.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00031.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/07/07/4", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://xenbits.xen.org/xsa/advisory-321.html", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MXESCOVI7AVRNC7HEAMFM7PMEO6D3AUH/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VB3QJJZV23Z2IDYEMIHELWYSQBUEW6JP/", "name": "", "refsource": "", "tags": []}, {"url": "https://security.gentoo.org/glsa/202007-02", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4723", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00024.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00031.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/07/07/4", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://xenbits.xen.org/xsa/advisory-321.html", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MXESCOVI7AVRNC7HEAMFM7PMEO6D3AUH/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VB3QJJZV23Z2IDYEMIHELWYSQBUEW6JP/", "name": "", "refsource": "", "tags": []}, {"url": "https://security.gentoo.org/glsa/202007-02", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4723", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-400"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:C", "baseScore": 6.1, "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "COMPLETE"}, "exploitabilityScore": 3.9, "impactScore": 8.5, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.0, "impactScore": 6.0, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:x86:*", "matchCriteriaId": "92B5308D-B467-453A-B0AB-BE4CBD7C5D96", "cpe_name": [], "versionStartIncluding": "3.2.0", "versionEndIncluding": "4.13.1"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:opensuse:leap:15.2:*:*:*:*:*:*:*", "matchCriteriaId": "B009C22E-30A4-4288-BCF6-C3E81DEAF45A", "cpe_name": []}]}]}}