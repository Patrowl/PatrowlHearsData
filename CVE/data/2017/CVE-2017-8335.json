{"publishedDate": "2019-06-18T19:15Z", "lastModifiedDate": "2024-11-21T03:33Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-8335", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered on Securifi Almond, Almond+, and Almond 2015 devices with firmware AL-R096. The device provides a user with the capability of setting name for wireless network. These values are stored by the device in NVRAM (Non-volatile RAM). It seems that the POST parameters passed in this request to set up names on the device do not have a string length check on them. This allows an attacker to send a large payload in the \"mssid_1\" POST parameter. The device also allows a user to view the name of the Wifi Network set by the user. While processing this request, the device calls a function named \"getCfgToHTML\" at address 0x004268A8 which retrieves the value set earlier by \"mssid_1\" parameter as SSID2 and this value then results in overflowing the stack set up for this function and allows an attacker to control $ra register value on the stack which allows an attacker to control the device by executing a payload of an attacker's choice. If the firmware version AL-R096 is dissected using binwalk tool, we obtain a cpio-root archive which contains the filesystem set up on the device that contains all the binaries. The binary \"goahead\" is the one that has the vulnerable function that recieves the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows a MIPS little endian format. The function sub_00420F38 in IDA pro is identified to be receiving the values sent in the POST parameter \"mssid_1\" at address 0x0042BA00 and then sets in the NVRAM at address 0x0042C314. The value is later retrieved in the function \"getCfgToHTML\" at address 0x00426924 and this results in overflowing the buffer due to \"strcat\" function that is utilized by this function."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en los dispositivos Securifi Almond, Almond + y Almond 2015 con firmware AL-R096. El dispositivo proporciona al usuario la capacidad de configurar el nombre de la red inal\u00e1mbrica. Estos valores son almacenados por el dispositivo en NVRAM (RAM no vol\u00e1til). Parece que los par\u00e1metros POST pasados en esta solicitud para configurar nombres en el dispositivo no tienen una verificaci\u00f3n de longitud de cadena en ellos. Esto permite que un atacante env\u00ede una gran carga \u00fatil en el par\u00e1metro POST \"mssid_1\". El dispositivo tambi\u00e9n permite que un usuario vea el nombre de la red Wifi configurada por el usuario. Mientras procesa esta solicitud, el dispositivo llama a una funci\u00f3n llamada \"getCfgToHTML\" en la direcci\u00f3n 0x004268A8 que recupera el valor establecido anteriormente por el par\u00e1metro \"mssid_1\" como SSID2 y este valor produce un desbordamiento de la configuraci\u00f3n de pila para esta funci\u00f3n y permite que un atacante controle Valor de registro de $ra en la pila que permite a un atacante controlar el dispositivo ejecutando una carga \u00fatil a elecci\u00f3n del atacante. Si la versi\u00f3n de firmware AL-R096 se disecciona con la herramienta binwalk, obtenemos un archivo cpio-root que contiene el sistema de archivos configurado en el dispositivo que contiene todos los archivos binarios. El binario \"goahead\" es el que tiene la funci\u00f3n vulnerable que recibe los valores enviados por la solicitud POST. Si abrimos este binario en IDA-pro, notaremos que esto sigue un formato MIPS little endian. La funci\u00f3n sub_00420F38 en IDA pro est\u00e1 identificada para recibir los valores enviados en el par\u00e1metro POST \"mssid_1\" en la direcci\u00f3n 0x0042BA00 y luego se establece en la NVRAM en la direcci\u00f3n 0x0042C314. El valor se recupera posteriormente en la funci\u00f3n \"getCfgToHTML\" en la direcci\u00f3n 0x00426924 y esto provoca el desbordamiento del b\u00fafer debido a la funci\u00f3n \"strcat\" que utiliza esta funci\u00f3n."}]}, "references": {"reference_data": [{"url": "http://packetstormsecurity.com/files/153227/Securifi-Almond-2015-Buffer-Overflow-Command-Injection-XSS-CSRF.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Securifi_Almond_plus_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/153227/Securifi-Almond-2015-Buffer-Overflow-Command-Injection-XSS-CSRF.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Securifi_Almond_plus_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-119"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "baseScore": 6.0, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 6.8, "impactScore": 6.4, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}, "baseMetricV3": {"exploitabilityScore": 2.1, "impactScore": 5.9, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "baseScore": 8.0, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond_2015_firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "208D57C5-306D-4759-9A80-9FC41EAABAF9", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond_2015:-:*:*:*:*:*:*:*", "matchCriteriaId": "927187D5-C000-4DC3-BECA-7872D2294820", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond\\+firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "006ED0DA-A55E-419B-ADE6-F116A64DBE45", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond\\+:-:*:*:*:*:*:*:*", "matchCriteriaId": "D3472E5F-5B79-4D36-B6AF-DFAE3021B803", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond_firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "43B428E1-51D5-48DA-B852-93434A9A8945", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond:-:*:*:*:*:*:*:*", "matchCriteriaId": "1EF61C46-EE6E-4592-B912-93D733A82095", "cpe_name": []}]}]}}