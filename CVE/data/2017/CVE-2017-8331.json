{"publishedDate": "2019-06-18T20:15Z", "lastModifiedDate": "2024-11-21T03:33Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-8331", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered on Securifi Almond, Almond+, and Almond 2015 devices with firmware AL-R096. The device provides a user with the capability of adding new port forwarding rules to the device. It seems that the POST parameters passed in this request to set up routes on the device can be set in such a way that would result in passing commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version AL-R096 is dissected using binwalk tool, we obtain a cpio-root archive which contains the filesystem set up on the device that contains all the binaries. The binary \"goahead\" is the one that has the vulnerable function that recieves the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows a MIPS little endian format. The function sub_43C280in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter \"ip_address\" is extracted at address 0x0043C2F0. The POST parameter \"ipaddress\" is concatenated at address 0x0043C958 and this is passed to a \"system\" function at address 0x00437284. This allows an attacker to provide the payload of his/her choice and finally take control of the device."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en los dispositivos Securifi Almond, Almond + y Almond 2015 con firmware AL-R096. El dispositivo proporciona a un usuario la capacidad de agregar nuevas reglas de reenv\u00edo de puertos al dispositivo. Parece que los par\u00e1metros POST pasados ??en esta solicitud para configurar rutas en el dispositivo se pueden configurar de tal manera que resulten en pasar comandos a una API de \"sistema\" en la funci\u00f3n y, por lo tanto, dar como resultado la inyecci\u00f3n de comandos en el dispositivo. Si la versi\u00f3n de firmware AL-R096 se disecciona con la herramienta binwalk, obtenemos un archivo cpio-root que contiene el sistema de archivos configurado en el dispositivo que contiene todos los archivos binarios. El binario \"goahead\" es el que tiene la funci\u00f3n vulnerable que recibe los valores enviados por la solicitud POST. Si abrimos este binario en IDA-pro, notaremos que esto sigue un formato MIPS little endian. La funci\u00f3n sub_43C280in IDA pro est\u00e1 identificada para recibir los valores enviados en la solicitud POST y el valor establecido en el par\u00e1metro POST \"direcci\u00f3n_ip\" se extrae en la direcci\u00f3n 0x0043C2F0. El par\u00e1metro POST \"ipaddress\" se concatena en la direcci\u00f3n 0x0043C958 y se pasa a una funci\u00f3n de \"sistema\" en la direcci\u00f3n 0x00437284. Esto permite que un atacante proporcione la carga \u00fatil de su elecci\u00f3n y finalmente tome el control del dispositivo."}]}, "references": {"reference_data": [{"url": "http://packetstormsecurity.com/files/153227/Securifi-Almond-2015-Buffer-Overflow-Command-Injection-XSS-CSRF.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Securifi_Almond_plus_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/153227/Securifi-Almond-2015-Buffer-Overflow-Command-Injection-XSS-CSRF.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Securifi_Almond_plus_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-77"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "baseScore": 6.5, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 8.0, "impactScore": 6.4, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 5.9, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond_2015_firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "208D57C5-306D-4759-9A80-9FC41EAABAF9", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond_2015:-:*:*:*:*:*:*:*", "matchCriteriaId": "927187D5-C000-4DC3-BECA-7872D2294820", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond\\+firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "006ED0DA-A55E-419B-ADE6-F116A64DBE45", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond\\+:-:*:*:*:*:*:*:*", "matchCriteriaId": "D3472E5F-5B79-4D36-B6AF-DFAE3021B803", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:securifi:almond_firmware:al-r096:*:*:*:*:*:*:*", "matchCriteriaId": "43B428E1-51D5-48DA-B852-93434A9A8945", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:securifi:almond:-:*:*:*:*:*:*:*", "matchCriteriaId": "1EF61C46-EE6E-4592-B912-93D733A82095", "cpe_name": []}]}]}}