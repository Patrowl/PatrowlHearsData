{"publishedDate": "2017-11-27T10:29Z", "lastModifiedDate": "2025-04-20T01:37Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-4995", "ASSIGNER": "security_alert@emc.com"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered in Pivotal Spring Security 4.2.0.RELEASE through 4.2.2.RELEASE, and Spring Security 5.0.0.M1. When configured to enable default typing, Jackson contained a deserialization vulnerability that could lead to arbitrary code execution. Jackson fixed this vulnerability by blacklisting known \"deserialization gadgets.\" Spring Security configures Jackson with global default typing enabled, which means that (through the previous exploit) arbitrary code could be executed if all of the following is true: (1) Spring Security's Jackson support is being leveraged by invoking SecurityJackson2Modules.getModules(ClassLoader) or SecurityJackson2Modules.enableDefaultTyping(ObjectMapper); (2) Jackson is used to deserialize data that is not trusted (Spring Security does not perform deserialization using Jackson, so this is an explicit choice of the user); and (3) there is an unknown (Jackson is not blacklisting it already) \"deserialization gadget\" that allows code execution present on the classpath. Jackson provides a blacklisting approach to protecting against this type of attack, but Spring Security should be proactive against blocking unknown \"deserialization gadgets\" when Spring Security enables default typing."}, {"lang": "es", "value": "Se ha descubierto un problema en Pivotal Spring Security 4.2.0.RELEASE through 4.2.2.RELEASE y Spring Security 5.0.0.M1. Al estar configurado para habilitar la escritura por defecto, Jackson conten\u00eda una vulnerabilidad de deserializaci\u00f3n que podr\u00eda conducir a la ejecuci\u00f3n de c\u00f3digo arbitrario. Jackson solucion\u00f3 esta vulnerabilidad poniendo los \"deserialization gadgets\" conocidos en una lista negra. Spring Security configura Jackson con la escritura global habilitada por defecto , lo que significa que (a trav\u00e9s del exploit anterior) se podr\u00eda ejecutar c\u00f3digo arbitrario si lo siguiente es cierto: (1) La compatilibidad de Spring Security con Jackson se aprovecha invocando SecurityJackson2Modules.getModules(ClassLoader) o SecurityJackson2Modules.enableDefaultTyping(ObjectMapper); (2) Jackson se usa para deserializar datos no fiables (Spring Security no realiza la deserializaci\u00f3n con Jackson, por lo que esta es una elecci\u00f3n expl\u00edcita del usuario); y (3) hay un \"deserialization gadget\" desconocido (Jackson a\u00fan no lo ha puesto en su lista negra) que permite la ejecuci\u00f3n de c\u00f3digo presente en classpath. Jackson proporciona un enfoque de listas negras para protegerse contra este tipo de ataque, pero Spring Security deber\u00eda ser proactivo contra el bloqueo de \"deserialization gadgets\" desconocidos cuando Spring Security habilita la escritura por defecto."}]}, "references": {"reference_data": [{"url": "http://www.securityfocus.com/bid/99080", "name": "", "refsource": "", "tags": ["Broken Link"]}, {"url": "https://lists.apache.org/thread.html/4641ed8616ccc2c1fbddac2c3dc9900c96387bc226eaf0232d61909b%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r42ac3e39e6265db12d9fc6ae1cd4b5fea7aed9830dc6f6d58228fed7%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rf7f87810c38dc9abf9f93989f76008f504cbf7c1a355214640b2d04c%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://pivotal.io/security/cve-2017-4995", "name": "", "refsource": "", "tags": ["Issue Tracking", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/99080", "name": "", "refsource": "", "tags": ["Broken Link"]}, {"url": "https://lists.apache.org/thread.html/4641ed8616ccc2c1fbddac2c3dc9900c96387bc226eaf0232d61909b%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r42ac3e39e6265db12d9fc6ae1cd4b5fea7aed9830dc6f6d58228fed7%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/rf7f87810c38dc9abf9f93989f76008f504cbf7c1a355214640b2d04c%40%3Ccommits.cassandra.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://pivotal.io/security/cve-2017-4995", "name": "", "refsource": "", "tags": ["Issue Tracking", "Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-502"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "baseScore": 6.8, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 8.6, "impactScore": 6.4, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.2, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.1, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:vmware:spring_security:4.2.0:release:*:*:*:*:*:*", "matchCriteriaId": "338A64C7-7CF3-4E9C-AA2E-7EEB4B4446EC", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:vmware:spring_security:4.2.1:release:*:*:*:*:*:*", "matchCriteriaId": "38B442B7-B032-482B-853A-02B9C7E265B5", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:vmware:spring_security:4.2.2:release:*:*:*:*:*:*", "matchCriteriaId": "C578BCAA-6E53-4F55-A6EC-76E966093FB7", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:vmware:spring_security:5.0.0:m1:*:*:*:*:*:*", "matchCriteriaId": "B4EDB685-4E0A-4587-8464-B25A671E218D", "cpe_name": []}]}]}}