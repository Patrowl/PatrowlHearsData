{"publishedDate": "2020-06-18T14:15Z", "lastModifiedDate": "2024-11-21T03:35Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-9106", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered in adns before 1.5.2. adns_rr_info mishandles a bogus *datap. The general pattern for formatting integers is to sprintf into a fixed-size buffer. This is correct if the input is in the right range; if it isn't, the buffer may be overrun (depending on the sizes of the types on the current platform). Of course the inputs ought to be right. And there are pointers in there too, so perhaps one could say that the caller ought to check these things. It may be better to require the caller to make the pointer structure right, but to have the code here be defensive about (and tolerate with an error but without crashing) out-of-range integer values. So: it should defend each of these integer conversion sites with a check for the actual permitted range, and return adns_s_invaliddata if not. The lack of this check causes the SOA sign extension bug to be a serious security problem: the sign extended SOA value is out of range, and overruns the buffer when reconverted. This is related to sign extending SOA 32-bit integer fields, and use of a signed data type."}, {"lang": "es", "value": "Se detect\u00f3 un problema en adns versiones anteriores a 1.5.2. adns_rr_info maneja inapropiadamente un *datap falso. El patr\u00f3n general para formatear enteros es sprintf en un b\u00fafer de tama\u00f1o fijo. Esto es correcto si la entrada est\u00e1 en el rango correcto; de lo contrario, el b\u00fafer puede estar desbordado (dependiendo del tama\u00f1o de los tipos en la plataforma actual). Por supuesto, las entradas deben ser correctas. Y existen indicadores all\u00ed tambi\u00e9n, as\u00ed que quiz\u00e1s se podr\u00eda decir que la persona que llama debe comprobar estas cosas. Puede ser mejor requerir que la persona que llama haga que la estructura del puntero sea correcta, pero que el c\u00f3digo aqu\u00ed sea defensivo sobre (y tolere con un error pero sin bloquear) valores enteros fuera de rango. Por lo tanto: debe defender cada uno de estos sitios de conversi\u00f3n de enteros con una comprobaci\u00f3n del rango real permitido y devolver adns_s_invaliddata si no lo hace. La falta de esta comprobaci\u00f3n hace que el error de extensi\u00f3n de signo de SOA sea un problema de seguridad grave: el valor de SOA extendido de signo est\u00e1 fuera de rango y supera el b\u00fafer cuando se reconvierte. Esto est\u00e1 relacionado con el signo que extiende los campos enteros SOA de 32 bits y el uso de un tipo de datos con signo"}]}, "references": {"reference_data": [{"url": "http://www.chiark.greenend.org.uk/ucgi/~ianmdlvl/git?p=adns.git", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "http://www.chiark.greenend.org.uk/ucgi/~ianmdlvl/git?p=adns.git%3Ba=blob%3Bf=changelog", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRVHN3GGVNQWAOL3PWC5FLAV7HUESLZR/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UGFZ4SPV6KFQK6ZNUZFB5Y32OYFOM5YJ/", "name": "", "refsource": "", "tags": []}, {"url": "https://www.chiark.greenend.org.uk/pipermail/adns-announce/2020/000004.html", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "http://www.chiark.greenend.org.uk/ucgi/~ianmdlvl/git?p=adns.git", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "http://www.chiark.greenend.org.uk/ucgi/~ianmdlvl/git?p=adns.git%3Ba=blob%3Bf=changelog", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRVHN3GGVNQWAOL3PWC5FLAV7HUESLZR/", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UGFZ4SPV6KFQK6ZNUZFB5Y32OYFOM5YJ/", "name": "", "refsource": "", "tags": []}, {"url": "https://www.chiark.greenend.org.uk/pipermail/adns-announce/2020/000004.html", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-119"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "baseScore": 5.0, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 10.0, "impactScore": 2.9, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "baseScore": 7.5, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:gnu:adns:*:*:*:*:*:*:*:*", "matchCriteriaId": "F69A58A4-C51A-493B-A5C9-8C7471A0BFF3", "cpe_name": [], "versionEndExcluding": "1.5.2"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956", "cpe_name": []}]}]}}