{"publishedDate": "2019-07-02T21:15Z", "lastModifiedDate": "2024-11-21T03:33Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-8416", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "An issue was discovered on D-Link DCS-1100 and DCS-1130 devices. The device runs a custom daemon on UDP port 5978 which is called \"dldps2121\" and listens for broadcast packets sent on 255.255.255.255. This daemon handles custom D-Link UDP based protocol that allows D-Link mobile applications and desktop applications to discover D-Link devices on the local network. The binary processes the received UDP packets sent from any device in \"main\" function. One path in the function traverses towards a block of code that processing of packets which does an unbounded copy operation which allows to overflow the buffer. The custom protocol created by Dlink follows the following pattern: Packetlen, Type of packet; M=MAC address of device or broadcast; D=Device Type;C=base64 encoded command string;test=1111 We can see at address function starting at address 0x0000DBF8 handles the entire UDP packet and performs an insecure copy using strcpy function at address 0x0000DC88. This results in overflowing the stack pointer after 1060 characters and thus allows to control the PC register and results in code execution. The same form of communication can be initiated by any process including an attacker process on the mobile phone or the desktop and this allows a third-party application on the device to execute commands on the device without any authentication by sending just 1 UDP packet with custom base64 encoding."}, {"lang": "es", "value": "Se detect\u00f3 un problema en los dispositivos DCS-1100 y DCS-1130 de D-Link. El dispositivo ejecuta un demonio personalizado en el puerto UDP 5978 que se llama \"dldps2121\" y escucha los paquetes de difusi\u00f3n enviados en 255.255.255.255. Este demonio maneja el protocolo basado en UDP D-Link personalizado que permite a las aplicaciones m\u00f3viles de D-Link y las aplicaciones de escritorio detectar dispositivos D-Link en la red local. El binario procesa los paquetes UDP recibidos, enviados desde cualquier dispositivo en la funci\u00f3n \"main\". Una ruta (path) en la funci\u00f3n se dirige hacia un bloque de c\u00f3digo que procesa paquetes que realizan una operaci\u00f3n de copia ilimitada que permite desbordar el b\u00fafer. El protocolo personalizado creado por Dlink sigue el siguiente patr\u00f3n: Packetlen, Tipo de paquete; M=direcci\u00f3n MAC del dispositivo o transmisi\u00f3n; D=Tipo de dispositivo; C=cadena de comando codificada en base64; prueba=1111 Podemos visualizar que la funci\u00f3n de direcci\u00f3n que comienza en la direcci\u00f3n 0x0000DBF8 maneja todo el paquete UDP y realiza una copia no segura usando la funci\u00f3n strcpy en la direcci\u00f3n 0x0000DC88. Esto genera el desbordamiento del puntero de la pila despu\u00e9s de 1060 caracteres y, por lo tanto, permite controlar el registro PC y resulta en la ejecuci\u00f3n del c\u00f3digo. La misma forma de comunicaci\u00f3n puede iniciarse mediante cualquier proceso, incluido un proceso de atacante en el tel\u00e9fono m\u00f3vil o en el escritorio, y esto permite que una aplicaci\u00f3n de terceros en el dispositivo ejecute comandos en el dispositivo sin ninguna autenticaci\u00f3n mediante el env\u00edo de solo 1 paquete UDP con la codificaci\u00f3n base64 personalizada."}]}, "references": {"reference_data": [{"url": "http://packetstormsecurity.com/files/153226/Dlink-DCS-1130-Command-Injection-CSRF-Stack-Overflow.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf", "name": "", "refsource": "", "tags": ["Not Applicable", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/153226/Dlink-DCS-1130-Command-Injection-CSRF-Stack-Overflow.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf", "name": "", "refsource": "", "tags": ["Not Applicable", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2019/Jun/8", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-119"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:N/C:C/I:C/A:C", "baseScore": 8.3, "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE"}, "exploitabilityScore": 6.5, "impactScore": 10.0, "severity": "HIGH", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:dlink:dcs-1130_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "0DB53465-4FE2-43EF-B2C6-839DFEA80D62", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:dlink:dcs-1130:-:*:*:*:*:*:*:*", "matchCriteriaId": "33A388EC-275D-4180-83E2-AD73F7EEB54F", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:dlink:dcs-1100_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "554817F7-7E3D-4D69-90AC-46D86056143B", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:dlink:dcs-1100:-:*:*:*:*:*:*:*", "matchCriteriaId": "704F9608-72CE-49C0-B7D2-F2FE84DF0C74", "cpe_name": []}]}]}}