{"publishedDate": "2019-07-03T20:15Z", "lastModifiedDate": "2024-11-21T03:33Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-8230", "ASSIGNER": "cve@mitre.org"}, "description": {"description_data": [{"lang": "en", "value": "On Amcrest IPM-721S V2.420.AC00.16.R.20160909 devices, the users on the device are divided into 2 groups \"admin\" and \"user\". However, as a part of security analysis it was identified that a low privileged user who belongs to the \"user\" group and who has access to login in to the web administrative interface of the device can add a new administrative user to the interface using HTTP APIs provided by the device and perform all the actions as an administrative user by using that account. If the firmware version V2.420.AC00.16.R 9/9/2016 is dissected using binwalk tool, one obtains a _user-x.squashfs.img.extracted archive which contains the filesystem set up on the device that many of the binaries in the /usr folder. The binary \"sonia\" is the one that has the vulnerable functions that performs the various action described in HTTP APIs. If one opens this binary in IDA-pro one will notice that this follows a ARM little endian format. The function at address 0x00429084 in IDA pro is the one that processes the HTTP API request for \"addUser\" action. If one traces the calls to this function, it can be clearly seen that the function sub_ 41F38C at address 0x0041F588 parses the call received from the browser and passes it to the \"addUser\" function without any authorization check."}, {"lang": "es", "value": "En los dispositivos Amcrest IPM-721S V2.420.AC00.16.R.20160909, los usuarios del dispositivo se dividen en 2 grupos \"admin\" y \"usuario\". Sin embargo, como parte del an\u00e1lisis de seguridad, se identific\u00f3 que un usuario con pocos privilegios que pertenece al grupo de \"usuarios\" y que tiene acceso para iniciar sesi\u00f3n en la interfaz administrativa web del dispositivo puede agregar un nuevo usuario administrativo a la interfaz mediante HTTP Las API proporcionadas por el dispositivo y realizar todas las acciones como un usuario administrativo mediante el uso de esa cuenta. Si la versi\u00f3n del firmware V2.420.AC00.16.R 9/9/2016 se diseca con la herramienta binwalk, se obtiene un archivo _user-x.squashfs.img.extracted que contiene el sistema de archivos configurado en el dispositivo que muchos de los binarios en la carpeta / usr. El \"sonia\" binario es el que tiene las funciones vulnerables que realizan las diversas acciones descritas en las API de HTTP. Si uno abre este binario en IDA-pro, notar\u00e1 que sigue un formato ARM little endian. La funci\u00f3n en la direcci\u00f3n 0x00429084 en IDA pro es la que procesa la solicitud de API HTTP para la acci\u00f3n \"addUser\". Si se rastrean las llamadas a esta funci\u00f3n, se puede ver claramente que la funci\u00f3n sub_ 41F38C en la direcci\u00f3n 0x0041F588 analiza la llamada recibida desde el navegador y la pasa a la funci\u00f3n \"addUser\" sin ninguna verificaci\u00f3n de autorizaci\u00f3n."}]}, "references": {"reference_data": [{"url": "http://packetstormsecurity.com/files/153224/Amcrest-IPM-721S-Credential-Disclosure-Privilege-Escalation.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Amcrest_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/153224/Amcrest-IPM-721S-Credential-Disclosure-Privilege-Escalation.html", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Amcrest_sec_issues.pdf", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-264"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "baseScore": 4.0, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}, "exploitabilityScore": 8.0, "impactScore": 2.9, "severity": "MEDIUM", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 5.9, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:amcrest:ipm-721s_firmware:*:*:*:*:*:*:*:*", "matchCriteriaId": "2EC72AB3-67BC-4187-8918-8030B045F383", "cpe_name": [], "versionEndIncluding": "2.420.ac00.16.r.20160909"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:amcrest:ipm-721s:-:*:*:*:*:*:*:*", "matchCriteriaId": "A8A354BD-B8FC-45D1-B8B2-5A44334CF2F8", "cpe_name": []}]}]}}