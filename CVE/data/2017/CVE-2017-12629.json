{"publishedDate": "2017-10-14T23:29Z", "lastModifiedDate": "2025-04-20T01:37Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-12629", "ASSIGNER": "security@apache.org"}, "description": {"description_data": [{"lang": "en", "value": "Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr."}, {"lang": "es", "value": "Ocurre una ejecuci\u00f3n remota de c\u00f3digo en Apache Solr en versiones anteriores a la 7.1 con Apache Lucene en versiones anteriores a la 7.1 explotando XXE junto con el uso de un comando add-listener de la API de configuraci\u00f3n para alcanzar la clase RunExecutableListener. Elasticsearch, a pesar de que emplea Lucene, NO es vulnerable a esto. Es destacable que la vulnerabilidad de XML external entity expansion ocurre en el analizador sint\u00e1ctico de consulta de XML que est\u00e1 disponible, por defecto, para cualquier petici\u00f3n de consulta con par\u00e1metros deftype=xmlparser y puede ser explotado para subir datos maliciosos al manipulador de peticiones /upload o como XXE ciego empleando un contenedor ftp para leer archivos locales arbitrarios del servidor Solr. Tambi\u00e9n hay que tener en cuenta el hecho de que la segunda vulnerabilidad est\u00e1 relacionada con la ejecuci\u00f3n remota de c\u00f3digo empleando la clase RunExecutableListener disponible en todas las versiones afectadas de Solr."}]}, "references": {"reference_data": [{"url": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E", "name": "", "refsource": "", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "http://openwall.com/lists/oss-security/2017/10/13/1", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/101261", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3123", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3124", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3244", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3451", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3452", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0002", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0003", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0004", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0005", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f%40%3Coak-issues.jackrabbit.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://s.apache.org/FJDl", "name": "", "refsource": "", "tags": ["Exploit", "Mailing List", "Vendor Advisory"]}, {"url": "https://twitter.com/ApacheSolr/status/918731485611401216", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://twitter.com/joshbressers/status/919258716297420802", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://twitter.com/searchtools_avi/status/918904813613543424", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4259-1/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2018/dsa-4124", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/43009/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E", "name": "", "refsource": "", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "http://openwall.com/lists/oss-security/2017/10/13/1", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/101261", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3123", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3124", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3244", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3451", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2017:3452", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0002", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0003", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0004", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0005", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f%40%3Coak-issues.jackrabbit.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef%40%3Cusers.solr.apache.org%3E", "name": "", "refsource": "", "tags": []}, {"url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://s.apache.org/FJDl", "name": "", "refsource": "", "tags": ["Exploit", "Mailing List", "Vendor Advisory"]}, {"url": "https://twitter.com/ApacheSolr/status/918731485611401216", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://twitter.com/joshbressers/status/919258716297420802", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://twitter.com/searchtools_avi/status/918904813613543424", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4259-1/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2018/dsa-4124", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/43009/", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-611"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "baseScore": 7.5, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL"}, "exploitabilityScore": 10.0, "impactScore": 6.4, "severity": "HIGH", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "matchCriteriaId": "6D6F404C-2EE9-4A14-9293-AB2DEB3D3BF6", "cpe_name": [], "versionStartIncluding": "5.5.0", "versionEndIncluding": "5.5.4"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:5.5.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:5.5.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:5.5.2:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:5.5.3:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:5.5.4:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "matchCriteriaId": "B8614312-907C-4617-82BC-256A8CB85CA1", "cpe_name": [], "versionStartIncluding": "6.0.0", "versionEndIncluding": "6.6.1"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.0.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.0.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.1.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.2.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.2.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.3.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.4.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.4.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.4.2:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.5.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.5.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.6.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:6.6.1:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "matchCriteriaId": "729484B3-0906-4B46-8649-51405630D270", "cpe_name": [], "versionStartIncluding": "7.0.0", "versionEndIncluding": "7.0.1"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:7.0.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:solr:7.0.1:*:*:*:*:*:*:*", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "72A54BDA-311C-413B-8E4D-388AD65A170A", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "868C0845-F25C-487F-A697-72917BE9D78E", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:o:redhat:enterprise_linux_server:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "9BBCD86A-E6C7-4444-9D74-F861084090F0", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "51EF4996-72F4-4FA4-814F-F5991E7A8318", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "16F59A04-14CF-49E2-9973-645477EA09DA", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*", "matchCriteriaId": "F7016A2A-8365-4F1A-89A2-7A19F2BCAE5B", "cpe_name": []}]}]}}