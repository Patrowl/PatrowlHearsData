{"publishedDate": "2017-07-17T13:18Z", "lastModifiedDate": "2025-04-20T01:37Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2017-2343", "ASSIGNER": "sirt@juniper.net"}, "description": {"description_data": [{"lang": "en", "value": "The Integrated User Firewall (UserFW) feature was introduced in Junos OS version 12.1X47-D10 on the Juniper SRX Series devices to provide simple integration of user profiles on top of the existing firewall polices. As part of an internal security review of the UserFW services authentication API, hardcoded credentials were identified and removed which can impact both the SRX Series device, and potentially LDAP and Active Directory integrated points. An attacker may be able to completely compromise SRX Series devices, as well as Active Directory servers and services. When Active Directory is compromised, it may allow access to user credentials, workstations, servers performing other functions such as email, database, etc. Inter-Forest Active Directory deployments may also be at risk as the attacker may gain full administrative control over one or more Active Directories depending on the credentials supplied by the administrator of the AD domains and SRX devices performing integrated authentication of users, groups and devices. To identify if your device is potentially vulnerable to exploitation, check to see if the service is operating; from CLI review the following output: root@SRX-Firewall# run show services user-identification active-directory-access domain-controller status extensive A result of \"Status: Connected\" will indicate that the service is active on the device. To evaluate if user authentication is occurring through the device: root@SRX-Firewall# run show services user-identification active-directory-access active-directory-authentication-table all Next review the results to see if valid users and groups are returned. e.g. Domain: juniperlab.com Total entries: 3 Source IP Username groups state 172.16.26.1 administrator Valid 192.168.26.2 engg01 engineers Valid 192.168.26.3 guest01 guests Valid Domain: NULL Total entries: 8 Source IP Username groups state 192.168.26.4 Invalid 192.168.26.5 Invalid This will also indicate that Valid users and groups are authenticating through the device. Affected releases are Juniper Networks Junos OS 12.3X48 from 12.3X48-D30 and prior to 12.3X48-D35 on SRX series; 15.1X49 from 15.1X49-D40 and prior to 15.1X49-D50 on SRX series. Devices on any version of Junos OS 12.1X46, or 12.1X47 are unaffected by this issue."}, {"lang": "es", "value": "La funci\u00f3n Integrated User Firewall (UserFW) fue introducida en Junos OS versi\u00f3n 12.1X47-D10 en los dispositivos de la serie SRX de Juniper para proporcionar una integraci\u00f3n sencilla de los perfiles de usuario en la parte superior de las pol\u00edticas de firewall existentes. Como parte de una revisi\u00f3n de seguridad interna de la API de autenticaci\u00f3n de servicios UserFW, se identificaron y eliminaron las credenciales codificadas, lo que puede impactar tanto al dispositivo de la serie SRX como a los puntos integrados de LDAP y Active Directory. Un atacante puede poner en peligro completamente los dispositivos de la serie SRX, as\u00ed como los servidores y servicios de Active Directory. Cuando Active Directory se ve comprometido, puede permitir el acceso a credenciales de usuario, estaciones de trabajo, servidores que realizan otras funciones como correo electr\u00f3nico, base de datos, etc. Las implementaciones de Active Directory entre bosques tambi\u00e9n pueden estar en riesgo, ya que el atacante puede alcanzar el control administrativo total sobre uno o m\u00e1s directorios activos en funci\u00f3n de las credenciales proporcionadas por el administrador de los dominios de AD y los dispositivos SRX que realizan autenticaci\u00f3n integrada de usuarios, grupos y dispositivos. Para identificar si su dispositivo es potencialmente vulnerable a la explotaci\u00f3n, compruebe si el servicio est\u00e1 funcionando; de la revisi\u00f3n de la CLI de la siguiente salida: root@SRX-Firewall#, ejecutar show services user-identification active-directory-access domain-controller status extensive Un resultado de \"Status: Connected\u201d indicar\u00e1 que el servicio est\u00e1 activo en el dispositivo. Para evaluar si la autenticaci\u00f3n de usuario se est\u00e1 produciendo por medio del dispositivo: root@SRX-Firewall#, ejecutar show services user-id active-directory-access active-directory-authentication-table all Next revise los resultados para visualizar si los usuarios y grupos v\u00e1lidos son devueltos. e.g. Dominio: juniperlab.com Total de entradas: 3 Grupos de nombres de usuario IP de origen estado 172.16.26.1 administrador v\u00e1lido 192.168.26.2 ingenieros engg01 v\u00e1lidos 192.168.26.3 invitado Dominio v\u00e1lido: ENTRADAS totales NULL: 8 grupos de nombres de usuario IP de origen estado 192.168.26.4 192.168.26.5 No v\u00e1lido Esto tambi\u00e9n indicar\u00e1 que los usuarios y grupos v\u00e1lidos se autentican por medio del dispositivo. Las versiones afectadas son Juniper Networks Junos OS versi\u00f3n 12.3X48 de 12.3X48-D30 y anteriores a versi\u00f3n 12.3X48-D35 en la serie SRX; versi\u00f3n 15.1X49 de 15.1X49-D40 y anterior a 15.1X49-D50 en la serie SRX. Los dispositivos de cualquier versi\u00f3n de Junos OS versi\u00f3n 12.1X46 o 12.1X47 no est\u00e1n afectados por este problema."}]}, "references": {"reference_data": [{"url": "http://www.securitytracker.com/id/1038904", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://kb.juniper.net/JSA10791", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "http://www.securitytracker.com/id/1038904", "name": "", "refsource": "", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://kb.juniper.net/JSA10791", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-798"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "baseScore": 10.0, "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE"}, "exploitabilityScore": 10.0, "impactScore": 10.0, "severity": "HIGH", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.9, "cvssV3": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d10:*:*:*:*:*:*", "matchCriteriaId": "4B7066A4-CD05-4E1A-89E8-71B4CB92CFF3", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d15:*:*:*:*:*:*", "matchCriteriaId": "A4AC2E1E-74FB-4DA3-8292-B2079F83FF54", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d20:*:*:*:*:*:*", "matchCriteriaId": "5FF83BD0-3B28-481E-8C8F-09ECDA493DA4", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d25:*:*:*:*:*:*", "matchCriteriaId": "6E296274-AFC1-4F56-A4B3-827C2E0BC9D5", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d30:*:*:*:*:*:*", "matchCriteriaId": "3C82799B-BD25-4359-9E3D-4D7CA7367525", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:12.3x48:d35:*:*:*:*:*:*", "matchCriteriaId": "094485FF-960C-4533-A2AF-6C4D420D260D", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:15.1x49:d40:*:*:*:*:*:*", "matchCriteriaId": "235EE40B-AA15-4F39-8087-A051F4F70995", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:juniper:junos:15.1x49:d45:*:*:*:*:*:*", "matchCriteriaId": "17330544-3AFC-463E-A146-2840A8AE17D2", "cpe_name": []}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx100:-:*:*:*:*:*:*:*", "matchCriteriaId": "561C1113-3D59-4DD9-ADA7-3C9ECC4632EC", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx110:-:*:*:*:*:*:*:*", "matchCriteriaId": "78C6D8A0-92D3-4FD3-BCC1-CC7C87B76317", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx1400:-:*:*:*:*:*:*:*", "matchCriteriaId": "927EAB8B-EC3B-4B12-85B9-5517EBA49A30", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx210:-:*:*:*:*:*:*:*", "matchCriteriaId": "CD647C15-A686-4C8F-A766-BC29404C0FED", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx220:-:*:*:*:*:*:*:*", "matchCriteriaId": "45AB1622-1AED-4CD7-98F1-67779CDFC321", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx240:-:*:*:*:*:*:*:*", "matchCriteriaId": "89276D88-3B8D-4168-A2CD-0920297485F2", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx3400:-:*:*:*:*:*:*:*", "matchCriteriaId": "746C3882-2A5B-4215-B259-EB1FD60C513D", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx3600:-:*:*:*:*:*:*:*", "matchCriteriaId": "DDE64EC0-7E42-43AF-A8FA-1A233BD3E3BC", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx5400:-:*:*:*:*:*:*:*", "matchCriteriaId": "2FDDC897-747F-44DD-9599-7266F9B5B7B1", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx550:-:*:*:*:*:*:*:*", "matchCriteriaId": "62FC145A-D477-4C86-89E7-F70F52773801", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx5600:-:*:*:*:*:*:*:*", "matchCriteriaId": "68CA098D-CBE4-4E62-9EC0-43E1B6098710", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx5800:-:*:*:*:*:*:*:*", "matchCriteriaId": "66F474D4-79B6-4525-983C-9A9011BD958B", "cpe_name": []}, {"vulnerable": false, "cpe23Uri": "cpe:2.3:h:juniper:srx650:-:*:*:*:*:*:*:*", "matchCriteriaId": "8AA424D4-4DBF-4E8C-96B8-E37741B5403E", "cpe_name": []}]}]}}