{"publishedDate": "2024-07-29T15:15Z", "lastModifiedDate": "2024-11-21T09:32Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-41078", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: qgroup: fix quota root leak after quota disable failure\n\nIf during the quota disable we fail when cleaning the quota tree or when\ndeleting the root from the root tree, we jump to the 'out' label without\never dropping the reference on the quota root, resulting in a leak of the\nroot since fs_info->quota_root is no longer pointing to the root (we have\nset it to NULL just before those steps).\n\nFix this by always doing a btrfs_put_root() call under the 'out' label.\nThis is a problem that exists since qgroups were first added in 2012 by\ncommit bed92eae26cc (\"Btrfs: qgroup implementation and prototypes\"), but\nback then we missed a kfree on the quota root and free_extent_buffer()\ncalls on its root and commit root nodes, since back then roots were not\nyet reference counted."}, {"lang": "es", "value": "En el kernel de Linux se ha solucionado la siguiente vulnerabilidad: btrfs:qgroup: arregla fuga de cuota ra\u00edz tras fallo de desactivaci\u00f3n de cuota Si durante la desactivaci\u00f3n de cuota fallamos al limpiar el \u00e1rbol de cuotas o al borrar el root del \u00e1rbol ra\u00edz, saltamos al etiqueta 'out' sin eliminar la referencia en la ra\u00edz de la cuota, lo que resulta en una p\u00e9rdida de la ra\u00edz ya que fs_info-&gt;quota_root ya no apunta a la ra\u00edz (la hemos configurado en NULL justo antes de esos pasos). Solucione este problema realizando siempre una llamada btrfs_put_root() bajo la etiqueta 'out'. Este es un problema que existe desde que qgroups se agregaron por primera vez en 2012 mediante el compromiso bed92eae26cc (\"Btrfs: implementaci\u00f3n y prototipos de qgroup\"), pero en aquel entonces nos perdimos un kfree en la cuota ra\u00edz y llamadas free_extent_buffer() en su ra\u00edz y en los nodos ra\u00edz de confirmaci\u00f3n. , ya que en aquel entonces las ra\u00edces a\u00fan no se contaban como referencia."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/5ef3961682e5310f2221bae99bcf9f5d0f4b0d51", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7dd6a5b96157a21245566b21fd58276a214357ff", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/8a69529f22590b67bb018de9acbcf94abc8603cf", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/94818bdb00ef34a996a06aa63d11f591074cb757", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/a7e4c6a3031c74078dba7fa36239d0f4fe476c53", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f88aeff5a173e8ba3133314eb4b964236ef3589d", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/5ef3961682e5310f2221bae99bcf9f5d0f4b0d51", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7dd6a5b96157a21245566b21fd58276a214357ff", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/8a69529f22590b67bb018de9acbcf94abc8603cf", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/94818bdb00ef34a996a06aa63d11f591074cb757", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/a7e4c6a3031c74078dba7fa36239d0f4fe476c53", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/f88aeff5a173e8ba3133314eb4b964236ef3589d", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}