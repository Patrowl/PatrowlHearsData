{"publishedDate": "2024-12-29T12:15Z", "lastModifiedDate": "2025-10-01T20:17Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-56743", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnfs_common: must not hold RCU while calling nfsd_file_put_local\n\nMove holding the RCU from nfs_to_nfsd_file_put_local to\nnfs_to_nfsd_net_put.  It is the call to nfs_to->nfsd_serv_put that\nrequires the RCU anyway (the puts for nfsd_file and netns were\ncombined to avoid an extra indirect reference but that\nmicro-optimization isn't possible now).\n\nThis fixes xfstests generic/013 and it triggering:\n\n\"Voluntary context switch within RCU read-side critical section!\"\n\n[  143.545738] Call Trace:\n[  143.546206]  <TASK>\n[  143.546625]  ? show_regs+0x6d/0x80\n[  143.547267]  ? __warn+0x91/0x140\n[  143.547951]  ? rcu_note_context_switch+0x496/0x5d0\n[  143.548856]  ? report_bug+0x193/0x1a0\n[  143.549557]  ? handle_bug+0x63/0xa0\n[  143.550214]  ? exc_invalid_op+0x1d/0x80\n[  143.550938]  ? asm_exc_invalid_op+0x1f/0x30\n[  143.551736]  ? rcu_note_context_switch+0x496/0x5d0\n[  143.552634]  ? wakeup_preempt+0x62/0x70\n[  143.553358]  __schedule+0xaa/0x1380\n[  143.554025]  ? _raw_spin_unlock_irqrestore+0x12/0x40\n[  143.554958]  ? try_to_wake_up+0x1fe/0x6b0\n[  143.555715]  ? wake_up_process+0x19/0x20\n[  143.556452]  schedule+0x2e/0x120\n[  143.557066]  schedule_preempt_disabled+0x19/0x30\n[  143.557933]  rwsem_down_read_slowpath+0x24d/0x4a0\n[  143.558818]  ? xfs_efi_item_format+0x50/0xc0 [xfs]\n[  143.559894]  down_read+0x4e/0xb0\n[  143.560519]  xlog_cil_commit+0x1b2/0xbc0 [xfs]\n[  143.561460]  ? _raw_spin_unlock+0x12/0x30\n[  143.562212]  ? xfs_inode_item_precommit+0xc7/0x220 [xfs]\n[  143.563309]  ? xfs_trans_run_precommits+0x69/0xd0 [xfs]\n[  143.564394]  __xfs_trans_commit+0xb5/0x330 [xfs]\n[  143.565367]  xfs_trans_roll+0x48/0xc0 [xfs]\n[  143.566262]  xfs_defer_trans_roll+0x57/0x100 [xfs]\n[  143.567278]  xfs_defer_finish_noroll+0x27a/0x490 [xfs]\n[  143.568342]  xfs_defer_finish+0x1a/0x80 [xfs]\n[  143.569267]  xfs_bunmapi_range+0x4d/0xb0 [xfs]\n[  143.570208]  xfs_itruncate_extents_flags+0x13d/0x230 [xfs]\n[  143.571353]  xfs_free_eofblocks+0x12e/0x190 [xfs]\n[  143.572359]  xfs_file_release+0x12d/0x140 [xfs]\n[  143.573324]  __fput+0xe8/0x2d0\n[  143.573922]  __fput_sync+0x1d/0x30\n[  143.574574]  nfsd_filp_close+0x33/0x60 [nfsd]\n[  143.575430]  nfsd_file_free+0x96/0x150 [nfsd]\n[  143.576274]  nfsd_file_put+0xf7/0x1a0 [nfsd]\n[  143.577104]  nfsd_file_put_local+0x18/0x30 [nfsd]\n[  143.578070]  nfs_close_local_fh+0x101/0x110 [nfs_localio]\n[  143.579079]  __put_nfs_open_context+0xc9/0x180 [nfs]\n[  143.580031]  nfs_file_clear_open_context+0x4a/0x60 [nfs]\n[  143.581038]  nfs_file_release+0x3e/0x60 [nfs]\n[  143.581879]  __fput+0xe8/0x2d0\n[  143.582464]  __fput_sync+0x1d/0x30\n[  143.583108]  __x64_sys_close+0x41/0x80\n[  143.583823]  x64_sys_call+0x189a/0x20d0\n[  143.584552]  do_syscall_64+0x64/0x170\n[  143.585240]  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n[  143.586185] RIP: 0033:0x7f3c5153efd7"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: nfs_common: no debe mantener la RCU mientras se llama a nfsd_file_put_local Mueva la retenci\u00f3n de la RCU de nfs_to_nfsd_file_put_local a nfs_to_nfsd_net_put. Es la llamada a nfs_to-&gt;nfsd_serv_put la que requiere la RCU de todos modos (las puts para nfsd_file y netns se combinaron para evitar una referencia indirecta adicional, pero esa microoptimizaci\u00f3n ahora no es posible). Esto corrige xfstests generic/013 y su activaci\u00f3n: \"\u00a1Cambio de contexto voluntario dentro de la secci\u00f3n cr\u00edtica del lado de lectura de RCU!\" [ 143.545738] Seguimiento de llamadas: [ 143.546206]  [ 143.546625] ? asm_exc_invalid_op+0x1f/0x30 [ 143.551736] ? rcu_note_context_switch+0x496/0x5d0 [ 143.552634] ? wakeup_preempt+0x62/0x70 [ 143.553358] ? __schedule+0xaa/0x1380 [ 143.554025] ? _raw_spin_unlock_irqrestore+0x12/0x40 [ 143.554958] ? try_to_wake_up+0x1fe/0x6b0 [ 143.555715] ? xfs_efi_item_format+0x50/0xc0 [xfs] [ 143.559894] lectura_bajada+0x4e/0xb0 [ 143.560519] xlog_cil_commit+0x1b2/0xbc0 [xfs] [ 143.561460] ? xfs_inode_item_precommit+0xc7/0x220 [xfs] [ 143.563309] ? xfs_trans_run_precommits+0x69/0xd0 [xfs] [ 143.564394] __xfs_trans_commit+0xb5/0x330 [xfs] [ 143.565367] xfs_trans_roll+0x48/0xc0 [xfs] [ 143.566262] xfs_defer_trans_roll+0x57/0x100 [xfs] [ 143.567278] xfs_defer_finish_noroll+0x27a/0x490 [xfs] [ 143.568342] xfs_defer_finish+0x1a/0x80 [xfs] [ 143.569267] xfs_bunmapi_range+0x4d/0xb0 [xfs] [ 143.570208] xfs_itruncate_extents_flags+0x13d/0x230 [xfs] [ 143.571353] xfs_free_eofblocks+0x12e/0x190 [xfs] [ 143.572359] xfs_file_release+0x12d/0x140 [xfs] [ 143.573324] __fput+0xe8/0x2d0 [ 143.573922] __fput_sync+0x1d/0x30 [ 143.574574] nfsd_filp_close+0x33/0x60 [nfsd] [ 143.575430] nfsd_file_free+0x96/0x150 [nfsd] [ 143.576274] nfsd_file_put+0xf7/0x1a0 [nfsd] [ 143.577104] nfsd_file_put_local+0x18/0x30 [nfsd] [ 143.578070] nfs_close_local_fh+0x101/0x110 [nfs_localio] [ 143.579079] __put_nfs_open_context+0xc9/0x180 [nfs] [ 143.580031] nfs_file_clear_open_context+0x4a/0x60 [nfs] [ 143.581038] liberaci\u00f3n_archivo_nfs+0x3e/0x60 [nfs] [ 143.581879] __fput+0xe8/0x2d0 [ 143.582464] __fput_sync+0x1d/0x30 [ 143.583108] __x64_sys_close+0x41/0x80 [ 143.583823] llamada_sys_x64+0x189a/0x20d0 [ 143.584552] llamada_sys_64+0x64/0x170 [ 143.585240] entrada_SYSCALL_64_despu\u00e9s_hwframe+0x76/0x7e [ 143.586185] Descanse en paz: 0033:0x7f3c5153efd7"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/3e6e3e97d64f50d9b6b1d62274f08925b1adbfc2", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c840b8e1f039e90f97ca55525667eb961422f86c", "name": "", "refsource": "", "tags": ["Patch"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-667"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "baseScore": 5.5, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "D8882B1B-2ABC-4838-AC1D-DBDBB5764776", "cpe_name": [], "versionStartIncluding": "6.12", "versionEndExcluding": "6.12.2"}]}]}}