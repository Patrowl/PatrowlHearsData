{"publishedDate": "2024-09-27T16:15Z", "lastModifiedDate": "2025-08-21T19:28Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-47070", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue."}, {"lang": "es", "value": "authentik es un proveedor de identidad de c\u00f3digo abierto. Una vulnerabilidad que existe en versiones anteriores a 2024.8.3 y 2024.6.5 permite omitir el inicio de sesi\u00f3n con contrase\u00f1a agregando el encabezado X-Forwarded-For con una direcci\u00f3n IP que no se puede analizar, por ejemplo, `a`. Esto genera la posibilidad de iniciar sesi\u00f3n en cualquier cuenta con un nombre de usuario o una direcci\u00f3n de correo electr\u00f3nico conocidos. La vulnerabilidad requiere que la instancia de authentik conf\u00ede en el encabezado X-Forwarded-For proporcionado por el atacante, por lo que no es reproducible desde hosts externos en un entorno configurado correctamente. El problema ocurre debido a que la etapa de contrase\u00f1a tiene una pol\u00edtica vinculada a ella, que omite la etapa de contrase\u00f1a si la etapa de identificaci\u00f3n est\u00e1 configurada para contener tambi\u00e9n una etapa de contrase\u00f1a. Debido al encabezado X-Forwarded-For no v\u00e1lido, que no se valida como una direcci\u00f3n IP con la suficiente anticipaci\u00f3n, la excepci\u00f3n ocurre m\u00e1s tarde y la pol\u00edtica falla. El modelo predeterminado no establece correctamente `failure_result` en `True` en el enlace de pol\u00edtica, lo que significa que debido a esta excepci\u00f3n, la pol\u00edtica devuelve falso y se omite la etapa de contrase\u00f1a. Las versiones 2024.8.3 y 2024.6.5 solucionan este problema."}]}, "references": {"reference_data": [{"url": "https://github.com/goauthentik/authentik/commit/78f7b04d5a62b2a9d4316282a713c2c7857dbe29", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/goauthentik/authentik/commit/dd8f809161e738b25765797eb2a5c77a7d3fc2cf", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-7jxf-mmg9-9hg7", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-287"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.2, "impactScore": 6.0, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "baseScore": 9.0, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*", "matchCriteriaId": "64784B4C-46C6-4F7A-947B-167A29072B70", "cpe_name": [], "versionEndExcluding": "2024.6.5"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*", "matchCriteriaId": "424378D1-E5DB-446E-AC2A-05BF49F0EF44", "cpe_name": [], "versionStartIncluding": "2024.8.0", "versionEndExcluding": "2024.8.3"}]}]}}