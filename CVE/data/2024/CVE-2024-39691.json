{"publishedDate": "2024-07-05T19:15Z", "lastModifiedDate": "2024-11-21T09:28Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-39691", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "matrix-appservice-irc is a Node.js IRC bridge for the Matrix messaging protocol. The fix for GHSA-wm4w-7h2q-3pf7 / CVE-2024-32000 included in matrix-appservice-irc 2.0.0 relied on the Matrix homeserver-provided timestamp to determine whether a user has access to the event they're replying to when determining whether or not to include a truncated version of the original event in the IRC message. Since this value is controlled by external entities, a malicious Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance (before version 2.0.1) is present can fabricate the timestamp with the intent of tricking the bridge into leaking room messages the homeserver should not have access to. matrix-appservice-irc 2.0.1 drops the reliance on `origin_server_ts` when determining whether or not an event should be visible to a user, instead tracking the event timestamps internally. As a workaround, it's possible to limit the amount of information leaked by setting a reply template that doesn't contain the original message."}, {"lang": "es", "value": "Matrix-appservice-irc es un puente IRC de Node.js para el protocolo de mensajer\u00eda Matrix. La soluci\u00f3n para GHSA-wm4w-7h2q-3pf7/CVE-2024-32000 incluida en Matrix-appservice-irc 2.0.0 se basaba en la marca de tiempo proporcionada por el servidor dom\u00e9stico de Matrix para determinar si un usuario tiene acceso al evento al que est\u00e1 respondiendo cuando determina si se incluye o no una versi\u00f3n truncada del evento original en el mensaje IRC. Dado que este valor est\u00e1 controlado por entidades externas, un servidor dom\u00e9stico Matrix malicioso unido a una sala en la que est\u00e1 presente una instancia de puente Matrix-appservice-irc (anterior a la versi\u00f3n 2.0.1) puede fabricar la marca de tiempo con la intenci\u00f3n de enga\u00f1ar al puente para fugar mensajes de la sala, mensajes a los que el servidor dom\u00e9stico no deber\u00eda tener acceso. Matrix-appservice-irc 2.0.1 elimina la dependencia de `origin_server_ts` al determinar si un evento debe ser visible o no para un usuario, en lugar de realizar un seguimiento interno de las marcas de tiempo del evento. Como soluci\u00f3n alternativa, es posible limitar la cantidad de informaci\u00f3n filtrada configurando una plantilla de respuesta que no contenga el mensaje original."}]}, "references": {"reference_data": [{"url": "https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/pull/1804", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/pull/1804", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-280"}, {"lang": "en", "value": "CWE-755"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 1.4, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "baseScore": 4.3, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}