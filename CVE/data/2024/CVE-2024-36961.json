{"publishedDate": "2024-06-03T08:15Z", "lastModifiedDate": "2024-11-21T09:22Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-36961", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nthermal/debugfs: Fix two locking issues with thermal zone debug\n\nWith the current thermal zone locking arrangement in the debugfs code,\nuser space can open the \"mitigations\" file for a thermal zone before\nthe zone's debugfs pointer is set which will result in a NULL pointer\ndereference in tze_seq_start().\n\nMoreover, thermal_debug_tz_remove() is not called under the thermal\nzone lock, so it can run in parallel with the other functions accessing\nthe thermal zone's struct thermal_debugfs object.  Then, it may clear\ntz->debugfs after one of those functions has checked it and the\nstruct thermal_debugfs object may be freed prematurely.\n\nTo address the first problem, pass a pointer to the thermal zone's\nstruct thermal_debugfs object to debugfs_create_file() in\nthermal_debug_tz_add() and make tze_seq_start(), tze_seq_next(),\ntze_seq_stop(), and tze_seq_show() retrieve it from s->private\ninstead of a pointer to the thermal zone object.  This will ensure\nthat tz_debugfs will be valid across the \"mitigations\" file accesses\nuntil thermal_debugfs_remove_id() called by thermal_debug_tz_remove()\nremoves that file.\n\nTo address the second problem, use tz->lock in thermal_debug_tz_remove()\naround the tz->debugfs value check (in case the same thermal zone is\nremoved at the same time in two different threads) and its reset to NULL.\n\nCc :6.8+ <stable@vger.kernel.org> # 6.8+"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: Thermal/debugfs: soluciona dos problemas de bloqueo con la depuraci\u00f3n de la zona t\u00e9rmica. Con la disposici\u00f3n actual de bloqueo de la zona t\u00e9rmica en el c\u00f3digo debugfs, el espacio de usuario puede abrir el archivo de \"mitigaciones\" para una zona t\u00e9rmica antes. El puntero debugfs de la zona est\u00e1 configurado, lo que dar\u00e1 como resultado una desreferencia del puntero NULL en tze_seq_start(). Adem\u00e1s, Thermal_debug_tz_remove() no se llama bajo el bloqueo de la zona t\u00e9rmica, por lo que puede ejecutarse en paralelo con las otras funciones que acceden al objeto struct Thermal_debugfs de la zona t\u00e9rmica. Luego, puede borrar tz-&gt;debugfs despu\u00e9s de que una de esas funciones lo haya verificado y el objeto struct Thermal_debugfs puede liberarse prematuramente. Para solucionar el primer problema, pase un puntero al objeto struct Thermal_debugfs de la zona t\u00e9rmica para debugfs_create_file() en Thermal_debug_tz_add() y haga que tze_seq_start(), tze_seq_next(), tze_seq_stop() y tze_seq_show() lo recuperen de s-&gt;private. de un puntero al objeto de la zona t\u00e9rmica. Esto garantizar\u00e1 que tz_debugfs sea v\u00e1lido en todos los accesos a archivos de \"mitigaciones\" hasta que Thermal_debugfs_remove_id() llamado por Thermal_debug_tz_remove() elimine ese archivo. Para solucionar el segundo problema, use tz-&gt;lock en Thermal_debug_tz_remove() alrededor de la verificaci\u00f3n del valor de tz-&gt;debugfs (en caso de que la misma zona t\u00e9rmica se elimine al mismo tiempo en dos subprocesos diferentes) y se restablezca a NULL. CC :6.8+  # 6.8+"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/6c57bdd0505422d5ccd2df541d993aec978c842e", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/c7f7c37271787a7f77d7eedc132b0b419a76b4c8", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/6c57bdd0505422d5ccd2df541d993aec978c842e", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/c7f7c37271787a7f77d7eedc132b0b419a76b4c8", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}