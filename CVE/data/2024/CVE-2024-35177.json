{"publishedDate": "2025-02-03T22:15Z", "lastModifiedDate": "2025-02-03T22:15Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-35177", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Wazuh is a free and open source platform used for threat prevention, detection, and response. It is capable of protecting workloads across on-premises, virtualized, containerized, and cloud-based environments. The wazuh-agent for Windows is vulnerable to a Local Privilege Escalation vulnerability due to improper ACL of the non-default installation directory. A local malicious user could potentially exploit this vulnerability by placing one of the many DLL that are loaded and not present on the system in the installation folder of the agent OR by replacing the service executable binary itself with a malicious one. The root cause is an improper ACL applied on the installation folder when a non-default installation path is specified (e.g,: C:\\wazuh). Many DLLs are loaded from the installation folder and by creating a malicious DLLs that exports the functions of a legit one (and that is not found on the system where the agent is installed, such as rsync.dll) it is possible to escalate privileges from a low-privileged user and obtain code execution under the context of NT AUTHORITY\\SYSTEM. This issue has been addressed in version 4.9.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Wazuh es una plataforma gratuita y de c\u00f3digo abierto que se utiliza para la prevenci\u00f3n, detecci\u00f3n y respuesta ante amenazas. Es capaz de proteger cargas de trabajo en entornos locales, virtualizados, en contenedores y basados ??en la nube. El agente wazuh para Windows es vulnerable a una vulnerabilidad de escalada de privilegios locales debido a una ACL incorrecta del directorio de instalaci\u00f3n no predeterminado. Un usuario malintencionado local podr\u00eda explotar esta vulnerabilidad colocando una de las muchas DLL que est\u00e1n cargadas y no est\u00e1n presentes en sistema en la carpeta de instalaci\u00f3n del agente O reemplazando el binario ejecutable del servicio por uno malintencionado. La causa principal es una ACL incorrecta aplicada en la carpeta de instalaci\u00f3n cuando se especifica una ruta de instalaci\u00f3n no predeterminada (p. ej., C:\\wazuh). Muchas DLL se cargan desde la carpeta de instalaci\u00f3n y, al crear una DLL maliciosa que exporta las funciones de una leg\u00edtima (y que no se encuentra en el directorio sistema donde est\u00e1 instalado el agente, como rsync.dll), es posible escalar privilegios de un usuario con pocos privilegios y obtener la ejecuci\u00f3n de c\u00f3digo en el contexto de NT AUsistemaY\\SYSTEM. Este problema se ha solucionado en la versi\u00f3n 4.9.0 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}]}, "references": {"reference_data": [{"url": "https://github.com/wazuh/wazuh/security/advisories/GHSA-pmr2-2r83-h3cv", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-284"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 7.8, "baseSeverity": "HIGH", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}