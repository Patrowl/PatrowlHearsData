{"publishedDate": "2024-03-06T19:15Z", "lastModifiedDate": "2024-11-21T09:04Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-27287", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "ESPHome is a system to control your ESP8266/ESP32 for Home Automation systems. Starting in version 2023.12.9 and prior to version 2024.2.2, editing the configuration file API in dashboard component of ESPHome version 2023.12.9 (command line installation and Home Assistant add-on) serves unsanitized data with `Content-Type: text/html; charset=UTF-8`, allowing a remote authenticated user to inject arbitrary web script and exfiltrate session cookies via Cross-Site scripting. It is possible for a malicious authenticated user to inject arbitrary Javascript in configuration files using a POST request to the /edit endpoint, the configuration parameter allows to specify the file to write. To trigger the XSS vulnerability, the victim must visit the page` /edit?configuration=[xss file]`. Abusing this vulnerability a malicious actor could perform operations on the dashboard on the behalf of a logged user, access sensitive information, create, edit and delete configuration files and flash firmware on managed boards.\nIn addition to this, cookies are not correctly secured, allowing the exfiltration of session cookie values. Version 2024.2.2 contains a patch for this issue.\n"}, {"lang": "es", "value": "ESPHome es un sistema para controlar su ESP8266/ESP32 para sistemas de dom\u00f3tica. A partir de la versi\u00f3n 2023.12.9 y antes de la versi\u00f3n 2024.2.2, la edici\u00f3n del archivo de configuraci\u00f3n API en el componente del panel de ESPHome versi\u00f3n 2023.12.9 (instalaci\u00f3n de l\u00ednea de comando y complemento Home Assistant) proporciona datos no desinfectados con `Tipo de contenido: texto/ HTML; charset=UTF-8`, lo que permite a un usuario autenticado remoto inyectar secuencias de comandos web arbitrarias y extraer cookies de sesi\u00f3n mediante secuencias de comandos entre sitios. Es posible que un usuario autenticado malicioso inyecte Javascript arbitrario en archivos de configuraci\u00f3n mediante una solicitud POST al punto final /edit; el par\u00e1metro de configuraci\u00f3n permite especificar el archivo a escribir. Para activar la vulnerabilidad XSS, la v\u00edctima debe visitar la p\u00e1gina ` /edit?configuration=[archivo xss]`. Al abusar de esta vulnerabilidad, un actor malintencionado podr\u00eda realizar operaciones en el tablero en nombre de un usuario registrado, acceder a informaci\u00f3n confidencial, crear, editar y eliminar archivos de configuraci\u00f3n y actualizar firmware en tableros administrados. Adem\u00e1s de esto, las cookies no est\u00e1n protegidas correctamente, lo que permite la filtraci\u00f3n de los valores de las cookies de sesi\u00f3n. La versi\u00f3n 2024.2.2 contiene un parche para este problema."}]}, "references": {"reference_data": [{"url": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/esphome/esphome/security/advisories/GHSA-9p43-hj5j-96h5", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/esphome/esphome/security/advisories/GHSA-9p43-hj5j-96h5", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-79"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.2, "impactScore": 5.2, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N", "baseScore": 6.5, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}