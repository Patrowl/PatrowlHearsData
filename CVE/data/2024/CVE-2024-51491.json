{"publishedDate": "2025-01-13T22:15Z", "lastModifiedDate": "2025-09-05T15:42Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-51491", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "notion-go is a collection of libraries for supporting sign and verify OCI artifacts. Based on Notary Project specifications. The issue was identified during Quarkslab's security audit on the Certificate Revocation List (CRL) based revocation check feature.\nAfter retrieving the CRL, notation-go attempts to update the CRL cache using the os.Rename method. However, this operation may fail due to operating system-specific limitations, particularly when the source and destination paths are on different mount points. This failure could lead to an unexpected program termination. In method `crl.(*FileCache).Set`, a temporary file is created in the OS dedicated area (like /tmp for, usually, Linux/Unix). The file is written and then it is tried to move it to the dedicated `notation` cache directory thanks `os.Rename`. As specified in Go documentation, OS specific restriction may apply. When used with Linux OS, it is relying on rename syscall from the libc and as per the documentation, moving a file to a different mountpoint raises an EXDEV error, interpreted as Cross device link not permitted error. Some Linux distribution, like RedHat use a dedicated filesystem (tmpfs), mounted on a specific mountpoint (usually /tmp) for temporary files. When using such OS, revocation check based on CRL will repeatedly crash notation. As a result the signature verification process is aborted as process crashes. This issue has been addressed in version 1.3.0-rc.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "notion-go es una colecci\u00f3n de Librer\u00edas para respaldar la firma y verificaci\u00f3n de artefactos OCI. Basado en las especificaciones del Proyecto Notary. El problema se identific\u00f3 durante la auditor\u00eda de seguridad de Quarkslab sobre la funci\u00f3n de verificaci\u00f3n de revocaci\u00f3n basada en la Lista de revocaci\u00f3n de certificados (CRL). Despu\u00e9s de recuperar la CRL, notation-go intenta actualizar la cach\u00e9 de CRL utilizando el m\u00e9todo os.Rename. Sin embargo, esta operaci\u00f3n puede fallar debido a limitaciones espec\u00edficas de sistema operativo, en particular cuando las rutas de origen y destino est\u00e1n en diferentes puntos de montaje. Este fallo podr\u00eda provocar una finalizaci\u00f3n inesperada del programa. En el m\u00e9todo `crl.(*FileCache).Set`, se crea un archivo temporal en el \u00e1rea dedicada del SO (como /tmp para, por lo general, Linux/Unix). El archivo se escribe y luego se intenta moverlo al directorio de cach\u00e9 dedicado de `notation` gracias a `os.Rename`. Como se especifica en la documentaci\u00f3n de Go, pueden aplicarse restricciones espec\u00edficas del SO. Cuando se utiliza con el sistema operativo Linux, se basa en la llamada al sistema de cambio de nombre de la libc y, seg\u00fan la documentaci\u00f3n, mover un archivo a un punto de montaje diferente genera un error EXDEV, que se interpreta como un error de v\u00ednculo entre dispositivos no permitido. Algunas distribuciones de Linux, como RedHat, utilizan un sistema de archivos dedicado (tmpfs), montado en un punto de montaje espec\u00edfico (normalmente /tmp) para archivos temporales. Cuando se utiliza dicho sistema operativo, la comprobaci\u00f3n de revocaci\u00f3n basada en CRL bloquear\u00e1 repetidamente la notaci\u00f3n. Como resultado, el proceso de verificaci\u00f3n de firma se cancela a medida que el proceso se bloquea. Este problema se ha solucionado en la versi\u00f3n 1.3.0-rc.2 y se recomienda a todos los usuarios que actualicen. No se conocen Workarounds para esta vulnerabilidad."}]}, "references": {"reference_data": [{"url": "https://github.com/notaryproject/notation-go/commit/3c3302258ad510fbca2f8a73731569d91f07d196", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/notaryproject/notation-go/security/advisories/GHSA-qjh3-4j3h-vmwp", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://man7.org/linux/man-pages/man2/rename.2.html", "name": "", "refsource": "", "tags": ["Product"]}, {"url": "https://github.com/notaryproject/notation-go/security/advisories/GHSA-qjh3-4j3h-vmwp", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-703"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 1.4, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "baseScore": 3.3, "baseSeverity": "LOW", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:notaryproject:notation-go:*:*:*:*:*:*:*:*", "matchCriteriaId": "CDC85969-B9CC-4ADC-BBAD-26CE0ACD4205", "cpe_name": [], "versionEndExcluding": "1.3.0"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:notaryproject:notation-go:1.3.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "D33ED917-52DC-4DAD-A91A-94B496A0036D", "cpe_name": []}]}]}}