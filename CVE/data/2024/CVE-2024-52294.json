{"publishedDate": "2024-12-30T17:15Z", "lastModifiedDate": "2024-12-30T17:15Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-52294", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Khoj is a self-hostable artificial intelligence app. Prior to version 1.29.10, an Insecure Direct Object Reference (IDOR) vulnerability in the update_subscription endpoint allows any authenticated user to manipulate other users' Stripe subscriptions by simply modifying the email parameter in the request. The vulnerability exists in the subscription endpoint at `/api/subscription`. The endpoint uses an email parameter as a direct reference to user subscriptions without verifying object ownership. While authentication is required, there is no authorization check to verify if the authenticated user owns the referenced subscription. The issue was fixed in version 1.29.10. Support for arbitrarily presenting an email for update has been deprecated."}, {"lang": "es", "value": "Khoj es una aplicaci\u00f3n de inteligencia artificial autoalojada. Antes de la versi\u00f3n 1.29.10, una vulnerabilidad de referencia directa a objetos inseguros (IDOR) en el punto de conexi\u00f3n update_subscription permite que cualquier usuario autenticado manipule las suscripciones de Stripe de otros usuarios simplemente modificando el par\u00e1metro de correo electr\u00f3nico en la solicitud. La vulnerabilidad existe en el punto de conexi\u00f3n de suscripci\u00f3n en `/api/subscription`. El punto de conexi\u00f3n usa un par\u00e1metro de correo electr\u00f3nico como referencia directa a las suscripciones de los usuarios sin verificar la propiedad del objeto. Si bien se requiere autenticaci\u00f3n, no hay una verificaci\u00f3n de autorizaci\u00f3n para verificar si el usuario autenticado posee la suscripci\u00f3n a la que se hace referencia. El problema se solucion\u00f3 en la versi\u00f3n 1.29.10. La compatibilidad con la presentaci\u00f3n arbitraria de un correo electr\u00f3nico para la actualizaci\u00f3n ha quedado obsoleta."}]}, "references": {"reference_data": [{"url": "https://github.com/khoj-ai/khoj/commit/47d3c8c23597900af708bdc60aced3ae5d2064c1", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-639"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 1.4, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "baseScore": 4.3, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}