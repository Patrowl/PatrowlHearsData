{"publishedDate": "2025-01-11T13:15Z", "lastModifiedDate": "2025-01-11T13:15Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-55881", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: x86: Play nice with protected guests in complete_hypercall_exit()\n\nUse is_64_bit_hypercall() instead of is_64_bit_mode() to detect a 64-bit\nhypercall when completing said hypercall.  For guests with protected state,\ne.g. SEV-ES and SEV-SNP, KVM must assume the hypercall was made in 64-bit\nmode as the vCPU state needed to detect 64-bit mode is unavailable.\n\nHacking the sev_smoke_test selftest to generate a KVM_HC_MAP_GPA_RANGE\nhypercall via VMGEXIT trips the WARN:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 273 PID: 326626 at arch/x86/kvm/x86.h:180 complete_hypercall_exit+0x44/0xe0 [kvm]\n  Modules linked in: kvm_amd kvm ... [last unloaded: kvm]\n  CPU: 273 UID: 0 PID: 326626 Comm: sev_smoke_test Not tainted 6.12.0-smp--392e932fa0f3-feat #470\n  Hardware name: Google Astoria/astoria, BIOS 0.20240617.0-0 06/17/2024\n  RIP: 0010:complete_hypercall_exit+0x44/0xe0 [kvm]\n  Call Trace:\n   <TASK>\n   kvm_arch_vcpu_ioctl_run+0x2400/0x2720 [kvm]\n   kvm_vcpu_ioctl+0x54f/0x630 [kvm]\n   __se_sys_ioctl+0x6b/0xc0\n   do_syscall_64+0x83/0x160\n   entry_SYSCALL_64_after_hwframe+0x76/0x7e\n   </TASK>\n  ---[ end trace 0000000000000000 ]---"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: KVM: x86: Juega bien con invitados protegidos en complete_hypercall_exit() Usa is_64_bit_hypercall() en lugar de is_64_bit_mode() para detectar una hiperllamada de 64 bits al completar dicha hiperllamada. Para invitados con estado protegido, por ejemplo, SEV-ES y SEV-SNP, KVM debe asumir que la hiperllamada se realiz\u00f3 en modo de 64 bits, ya que el estado de vCPU necesario para detectar el modo de 64 bits no est\u00e1 disponible. Al piratear la autoprueba sev_smoke_test para generar una hiperllamada KVM_HC_MAP_GPA_RANGE a trav\u00e9s de VMGEXIT se activa el WARN: ------------[ cortar aqu\u00ed ]------------ ADVERTENCIA: CPU: 273 PID: 326626 en arch/x86/kvm/x86.h:180 complete_hypercall_exit+0x44/0xe0 [kvm] M\u00f3dulos vinculados en: kvm_amd kvm ... [\u00faltima descarga: kvm] CPU: 273 UID: 0 PID: 326626 Comm: sev_smoke_test No contaminado 6.12.0-smp--392e932fa0f3-feat #470 Nombre del hardware: Google Astoria/astoria, BIOS 0.20240617.0-0 17/06/2024 RIP: 0010:completar_hiperllamada_salida+0x44/0xe0 [kvm] Seguimiento de llamadas:  kvm_arch_vcpu_ioctl_run+0x2400/0x2720 [kvm] kvm_vcpu_ioctl+0x54f/0x630 [kvm] __se_sys_ioctl+0x6b/0xc0 do_syscall_64+0x83/0x160 entry_SYSCALL_64_after_hwframe+0x76/0x7e  ---[fin del seguimiento 0000000000000000 ]---"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/0840d360a8909c722fb62459f42836afe32ededb", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/22b5c2acd65dbe949032f619d4758a35a82fffc3", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/3d2634ec0d1dbe8f4b511cf5261f327c6a76f4b6", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7ed4db315094963de0678a8adfd43c46471b9349", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9b42d1e8e4fe9dc631162c04caa69b0d1860b0f0", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}