{"publishedDate": "2024-05-08T02:15Z", "lastModifiedDate": "2024-11-21T09:10Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-2746", "ASSIGNER": "secalert@redhat.com"}, "description": {"description_data": [{"lang": "en", "value": "Incomplete fix for CVE-2024-1929\n\nThe problem with CVE-2024-1929 was that the dnf5 D-Bus daemon accepted arbitrary configuration parameters from unprivileged users, which allowed a\nlocal root exploit by tricking the daemon into loading a user controlled \"plugin\". All of this happened before Polkit authentication was even started.\n\nThe dnf5 library code does not check whether non-root users control the directory in question.\u00a0\n\nOn one hand, this poses a Denial-of-Service attack vector by making the daemonoperate on a blocking file (e.g. named FIFO special file) or a very large file\nthat causes an out-of-memory situation (e.g. /dev/zero). On the other hand, this can be used to let the daemon process privileged files like /etc/shadow.\nThe file in question is parsed as an INI file. Error diagnostics resulting from parsing privileged files could cause information leaks, if these diagnostics\nare accessible to unprivileged users. In the case of libdnf5, no such user accessible diagnostics should exist, though.\n\nAlso, a local attacker can place a valid repository configuration file in this directory. This configuration file allows to specify\na plethora of additional configuration options. This makes various\u00a0additional code paths in libdnf5 accessible to the attacker."}, {"lang": "es", "value": "Soluci\u00f3n incompleta para CVE-2024-1929 El problema con CVE-2024-1929 era que el daemon dnf5 D-Bus aceptaba par\u00e1metros de configuraci\u00f3n arbitrarios de usuarios sin privilegios, lo que permit\u00eda un exploit de ra\u00edz local enga\u00f1ando al daemon para que cargara un \"complemento\" controlado por el usuario. Todo esto sucedi\u00f3 incluso antes de que se iniciara la autenticaci\u00f3n Polkit. El c\u00f3digo de la librer\u00eda dnf5 no comprueba si los usuarios no root controlan el directorio en cuesti\u00f3n. Por un lado, esto plantea un vector de ataque de denegaci\u00f3n de servicio al hacer que el daemon opere en un archivo de bloqueo (por ejemplo, un archivo especial llamado FIFO) o un archivo muy grande que causa una situaci\u00f3n de falta de memoria (por ejemplo, /dev/zero). Por otro lado, esto se puede utilizar para permitir que el daemon procese archivos privilegiados como /etc/shadow. El archivo en cuesti\u00f3n se analiza como un archivo INI. Los diagn\u00f3sticos de errores resultantes del an\u00e1lisis de archivos privilegiados podr\u00edan causar fugas de informaci\u00f3n, si estos diagn\u00f3sticos son accesibles para usuarios sin privilegios. Sin embargo, en el caso de libdnf5, no deber\u00eda existir ning\u00fan diagn\u00f3stico accesible para el usuario. Adem\u00e1s, un atacante local puede colocar un archivo de configuraci\u00f3n de repositorio v\u00e1lido en este directorio. Este archivo de configuraci\u00f3n permite especificar una gran cantidad de opciones de configuraci\u00f3n adicionales. Esto hace que el atacante pueda acceder a varias rutas de c\u00f3digo adicionales en libdnf5."}]}, "references": {"reference_data": [{"url": "https://www.openwall.com/lists/oss-security/2024/04/03/5", "name": "", "refsource": "", "tags": []}, {"url": "https://www.openwall.com/lists/oss-security/2024/04/03/5", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-20"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.0, "impactScore": 6.0, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "baseScore": 8.8, "baseSeverity": "HIGH", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}