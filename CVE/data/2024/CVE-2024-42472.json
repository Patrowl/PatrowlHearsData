{"publishedDate": "2024-08-15T19:15Z", "lastModifiedDate": "2025-08-19T15:21Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-42472", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.14.0 and 1.15.10, a malicious or compromised Flatpak app using persistent directories could access and write files outside of what it would otherwise have access to, which is an attack on integrity and confidentiality.\n\nWhen `persistent=subdir` is used in the application permissions (represented as `--persist=subdir` in the command-line interface), that means that an application which otherwise doesn't have access to the real user home directory will see an empty home directory with a writeable subdirectory `subdir`. Behind the scenes, this directory is actually a bind mount and the data is stored in the per-application directory as `~/.var/app/$APPID/subdir`. This allows existing apps that are not aware of the per-application directory to still work as intended without general home directory access.\n\nHowever, the application does have write access to the application directory `~/.var/app/$APPID` where this directory is stored. If the source directory for the `persistent`/`--persist` option is replaced by a symlink, then the next time the application is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox.\n\nPartial protection against this vulnerability can be provided by patching Flatpak using the patches in commits ceec2ffc and 98f79773. However, this leaves a race condition that could be exploited by two instances of a malicious app running in parallel. Closing the race condition requires updating or patching the version of bubblewrap that is used by Flatpak to add the new `--bind-fd` option using the patch and then patching Flatpak to use it. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=bwrap` (1.15.x) or `--with-system-bubblewrap=bwrap` (1.14.x or older), or a similar option, then the version of bubblewrap that needs to be patched is a system copy that is distributed separately, typically `/usr/bin/bwrap`. This configuration is the one that is typically used in Linux distributions. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=` (1.15.x) or with `--without-system-bubblewrap` (1.14.x or older), then it is the bundled version of bubblewrap that is included with Flatpak that must be patched. This is typically installed as `/usr/libexec/flatpak-bwrap`. This configuration is the default when building from source code.\n\nFor the 1.14.x stable branch, these changes are included in Flatpak 1.14.10. The bundled version of bubblewrap included in this release has been updated to 0.6.3. For the 1.15.x development branch, these changes are included in Flatpak 1.15.10. The bundled version of bubblewrap in this release is a Meson \"wrap\" subproject, which has been updated to 0.10.0. The 1.12.x and 1.10.x branches will not be updated for this vulnerability. Long-term support OS distributions should backport the individual changes into their versions of Flatpak and bubblewrap, or update to newer versions if their stability policy allows it. As a workaround, avoid using applications using the `persistent` (`--persist`) permission."}, {"lang": "es", "value": "Flatpak es un marco de distribuci\u00f3n y sandbox de aplicaciones Linux. Antes de las versiones 1.14.0 y 1.15.10, una aplicaci\u00f3n Flatpak maliciosa o comprometida que utilizaba directorios persistentes pod\u00eda acceder y escribir archivos fuera de lo que de otro modo tendr\u00eda acceso, lo cual es un ataque a la integridad y la confidencialidad. Cuando se usa `persistent=subdir` en los permisos de la aplicaci\u00f3n (representado como `--persist=subdir` en la interfaz de l\u00ednea de comandos), eso significa que una aplicaci\u00f3n que de otro modo no tendr\u00eda acceso al directorio de inicio del usuario real ver\u00e1 un directorio de inicio vac\u00edo con un subdirectorio grabable `subdir`. Detr\u00e1s de escena, este directorio es en realidad un montaje de enlace y los datos se almacenan en el directorio por aplicaci\u00f3n como `~/.var/app/$APPID/subdir`. Esto permite que las aplicaciones existentes que no conocen el directorio por aplicaci\u00f3n sigan funcionando seg\u00fan lo previsto sin acceso general al directorio de inicio. Sin embargo, la aplicaci\u00f3n tiene acceso de escritura al directorio de la aplicaci\u00f3n `~/.var/app/$APPID` donde est\u00e1 almacenado este directorio. Si el directorio de origen para la opci\u00f3n `persistent`/`--persist` se reemplaza por un enlace simb\u00f3lico, la pr\u00f3xima vez que se inicie la aplicaci\u00f3n, el montaje del enlace seguir\u00e1 el enlace simb\u00f3lico y montar\u00e1 lo que sea que apunte en el sandbox. Se puede proporcionar protecci\u00f3n parcial contra esta vulnerabilidad parcheando Flatpak usando los parches en las confirmaciones ceec2ffc y 98f79773. Sin embargo, esto deja una condici\u00f3n de ejecuci\u00f3n que podr\u00eda ser aprovechada por dos instancias de una aplicaci\u00f3n maliciosa que se ejecutan en paralelo. Cerrar la condici\u00f3n de ejecuci\u00f3n requiere actualizar o parchear la versi\u00f3n de bubblewrap que usa Flatpak para agregar la nueva opci\u00f3n `--bind-fd` usando el parche y luego parchear Flatpak para usarlo. Si Flatpak se configur\u00f3 en el momento de la compilaci\u00f3n con `-Dsystem_bubbl\u00e9wrap=bwrap` (1.15.x) o `--with-system-bubblewrap=bwrap` (1.14.x o anterior), o una opci\u00f3n similar, entonces la versi\u00f3n de El bubblewrap que necesita parchearse es una copia del sistema que se distribuye por separado, normalmente `/usr/bin/bwrap`. Esta configuraci\u00f3n es la que se utiliza normalmente en las distribuciones de Linux. Si Flatpak se configur\u00f3 en el momento de la compilaci\u00f3n con `-Dsystem_bubbewrap=` (1.15.x) o con `-- without-system-bubblewrap` (1.14.x o anterior), entonces se incluye la versi\u00f3n empaquetada de bubblewrap. con Flatpak que hay que parchear. Normalmente se instala como `/usr/libexec/flatpak-bwrap`. Esta configuraci\u00f3n es la predeterminada cuando se construye a partir del c\u00f3digo fuente. Para la rama estable 1.14.x, estos cambios se incluyen en Flatpak 1.14.10. La versi\u00f3n empaquetada de bubblewrap incluida en esta versi\u00f3n se actualiz\u00f3 a 0.6.3. Para la rama de desarrollo 1.15.x, estos cambios se incluyen en Flatpak 1.15.10. La versi\u00f3n incluida de bubblewrap en esta versi\u00f3n es un subproyecto \"wrap\" de Meson, que se actualiz\u00f3 a 0.10.0. Las ramas 1.12.x y 1.10.x no se actualizar\u00e1n para esta vulnerabilidad. Las distribuciones de SO con soporte a largo plazo deben respaldar los cambios individuales en sus versiones de Flatpak y bubblewrap, o actualizar a versiones m\u00e1s nuevas si su pol\u00edtica de estabilidad lo permite. Como workaround, evite el uso de aplicaciones que utilicen el permiso \"persistente\" (`--persist`)."}]}, "references": {"reference_data": [{"url": "https://github.com/containers/bubblewrap/commit/68e75c3091c87583c28a439b45c45627a94d622c", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/containers/bubblewrap/commit/a253257cd298892da43e15201d83f9a02c9b58b5", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/2cdd1e1e5ae90d7c3a4b60ce2e36e4d609e44e72", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/3caeb16c31a3ed62d744e2aaf01d684f7991051a", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/6bd603f6836e9b38b9b937d3b78f3fbf36e7ff75", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/7c63e53bb2af0aae9097fd2edfd6a9ba9d453e97", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/8a18137d7e80f0575e8defabf677d81e5cc3a788", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/commit/db3a785241fda63bf53f0ec12bb519aa5210de19", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://github.com/flatpak/flatpak/security/advisories/GHSA-7hgv-f2j8-xw87", "name": "", "refsource": "", "tags": ["Exploit", "Vendor Advisory", "Mitigation"]}, {"url": "http://www.openwall.com/lists/oss-security/2024/08/14/6", "name": "", "refsource": "", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2025/03/msg00025.html", "name": "", "refsource": "", "tags": ["Mailing List", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-74"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 5.8, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N", "baseScore": 10.0, "baseSeverity": "CRITICAL", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*", "matchCriteriaId": "EE4746DE-A130-4D25-9D88-99C0B0FC3BAD", "cpe_name": [], "versionStartIncluding": "1.14.0", "versionEndExcluding": "1.14.10"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*", "matchCriteriaId": "1FB53E50-2BC5-4A74-AE72-356FA8ECEE34", "cpe_name": [], "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.10"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*", "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED", "cpe_name": []}]}]}}