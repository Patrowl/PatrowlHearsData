{"publishedDate": "2024-10-16T08:15Z", "lastModifiedDate": "2025-07-01T20:28Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-45219", "ASSIGNER": "security@apache.org"}, "description": {"description_data": [{"lang": "en", "value": "Account users in Apache CloudStack by default are allowed to upload and register templates for deploying instances and volumes for attaching them as data disks to their existing instances. Due to missing validation checks for KVM-compatible templates or volumes in CloudStack 4.0.0 through 4.18.2.3 and 4.19.0.0 through 4.19.1.1, an attacker that can upload or register templates and volumes, can use them to deploy malicious instances or attach uploaded volumes to their existing instances on KVM-based environments and exploit this to gain access to the host filesystems that could result in the compromise of resource integrity and confidentiality, data loss, denial of service, and availability of KVM-based infrastructure managed by CloudStack.\n\n\nUsers are recommended to upgrade to Apache CloudStack 4.18.2.4 or 4.19.1.2, or later, which addresses this issue. \n\nAdditionally, all user-uploaded or registered KVM-compatible templates and volumes can be scanned and checked that they are flat files that should not be using any additional or unnecessary features. For example, operators can run this on their secondary storage(s) and inspect output. An empty output for the disk being validated means it has no references to the host filesystems; on the other hand, if the output for the disk being validated is not empty, it might indicate a compromised disk.\n\n\nfor file in $(find /path/to/storage/ -type f -regex [a-f0-9\\-]*.*); do echo \"Retrieving file [$file] info. If the output is not empty, that might indicate a compromised disk; check it carefully.\"; qemu-img info -U $file | grep file: ; printf \"\\n\\n\"; done\nThe command can also be run for the file-based primary storages; however, bear in mind that (i) volumes created from templates will have references for the templates at first and (ii) volumes can be consolidated while migrating, losing their references to the templates. Therefore, the command execution for the primary storages can show both false positives and false negatives.\n\nFor checking the whole template/volume features of each disk, operators can run the following command:\n\n\nfor file in $(find /path/to/storage/ -type f -regex [a-f0-9\\-]*.*); do echo \"Retrieving file [$file] info.\"; qemu-img info -U $file; printf \"\\n\\n\"; done"}, {"lang": "es", "value": "De manera predeterminada, los usuarios de cuentas en Apache CloudStack pueden cargar y registrar plantillas para implementar instancias y vol\u00famenes para adjuntarlos como discos de datos a sus instancias existentes. Debido a que faltan comprobaciones de validaci\u00f3n para plantillas o vol\u00famenes compatibles con KVM en CloudStack 4.0.0 a 4.18.2.3 y 4.19.0.0 a 4.19.1.1, un atacante que pueda cargar o registrar plantillas y vol\u00famenes puede usarlos para implementar instancias maliciosas o adjuntar vol\u00famenes cargados a sus instancias existentes en entornos basados en KVM y aprovechar esto para obtener acceso a los sistemas de archivos del host, lo que podr\u00eda provocar la vulneraci\u00f3n de la integridad y confidencialidad de los recursos, la p\u00e9rdida de datos, la denegaci\u00f3n de servicio y la disponibilidad de la infraestructura basada en KVM administrada por CloudStack. Se recomienda a los usuarios que actualicen a Apache CloudStack 4.18.2.4 o 4.19.1.2, o una versi\u00f3n posterior, que soluciona este problema. Adem\u00e1s, todas las plantillas y vol\u00famenes compatibles con KVM cargados o registrados por el usuario se pueden escanear y verificar que sean archivos planos que no deber\u00edan usar ninguna caracter\u00edstica adicional o innecesaria. Por ejemplo, los operadores pueden ejecutar esto en sus almacenamientos secundarios e inspeccionar la salida. Una salida vac\u00eda para el disco que se est\u00e1 validando significa que no tiene referencias a los sistemas de archivos del host; por otro lado, si la salida para el disco que se est\u00e1 validando no est\u00e1 vac\u00eda, podr\u00eda indicar un disco comprometido. for file in $(find /path/to/storage/ -type f -regex [a-f0-9\\-]*.*); do echo \"Recuperando informaci\u00f3n del archivo [$file]. Si la salida no est\u00e1 vac\u00eda, eso podr\u00eda indicar un disco comprometido; verif\u00edquelo cuidadosamente.\"; qemu-img info -U $file | grep file: ; printf \"\\n\\n\"; done El comando tambi\u00e9n se puede ejecutar para los almacenamientos primarios basados en archivos; Sin embargo, tenga en cuenta que (i) los vol\u00famenes creados a partir de plantillas tendr\u00e1n referencias a las plantillas al principio y (ii) los vol\u00famenes se pueden consolidar durante la migraci\u00f3n, perdiendo sus referencias a las plantillas. Por lo tanto, la ejecuci\u00f3n del comando para los almacenamientos primarios puede mostrar tanto falsos positivos como falsos negativos. Para verificar todas las caracter\u00edsticas de plantilla/volumen de cada disco, los operadores pueden ejecutar el siguiente comando: for file in $(find /path/to/storage/ -type f -regex [a-f0-9\\-]*.*); do echo \"Recuperando informaci\u00f3n del archivo [$file].\"; qemu-img info -U $file; printf \"\\n\\n\"; done"}]}, "references": {"reference_data": [{"url": "https://cloudstack.apache.org/blog/security-release-advisory-4.18.2.4-4.19.1.2", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://lists.apache.org/thread/ktsfjcnj22x4kg49ctock3d9tq7jnvlo", "name": "", "refsource": "", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-4-and-4-19-1-2/", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2024/10/15/2", "name": "", "refsource": "", "tags": ["Mailing List"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-116"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 6.0, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H", "baseScore": 8.5, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*", "matchCriteriaId": "B6DDA155-897D-4FCE-B1C1-C3F5F70DFB89", "cpe_name": [], "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.18.2.4"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*", "matchCriteriaId": "6B851F50-43E1-4DD1-989E-94676D12EC33", "cpe_name": [], "versionStartIncluding": "4.19.0.0", "versionEndExcluding": "4.19.1.2"}]}]}}