{"publishedDate": "2024-11-09T11:15Z", "lastModifiedDate": "2025-10-01T21:16Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-50231", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\niio: gts-helper: Fix memory leaks in iio_gts_build_avail_scale_table()\n\nmodprobe iio-test-gts and rmmod it, then the following memory leak\noccurs:\n\n\tunreferenced object 0xffffff80c810be00 (size 64):\n\t  comm \"kunit_try_catch\", pid 1654, jiffies 4294913981\n\t  hex dump (first 32 bytes):\n\t    02 00 00 00 08 00 00 00 20 00 00 00 40 00 00 00  ........ ...@...\n\t    80 00 00 00 00 02 00 00 00 04 00 00 00 08 00 00  ................\n\t  backtrace (crc a63d875e):\n\t    [<0000000028c1b3c2>] kmemleak_alloc+0x34/0x40\n\t    [<000000001d6ecc87>] __kmalloc_noprof+0x2bc/0x3c0\n\t    [<00000000393795c1>] devm_iio_init_iio_gts+0x4b4/0x16f4\n\t    [<0000000071bb4b09>] 0xffffffdf052a62e0\n\t    [<000000000315bc18>] 0xffffffdf052a6488\n\t    [<00000000f9dc55b5>] kunit_try_run_case+0x13c/0x3ac\n\t    [<00000000175a3fd4>] kunit_generic_run_threadfn_adapter+0x80/0xec\n\t    [<00000000f505065d>] kthread+0x2e8/0x374\n\t    [<00000000bbfb0e5d>] ret_from_fork+0x10/0x20\n\tunreferenced object 0xffffff80cbfe9e70 (size 16):\n\t  comm \"kunit_try_catch\", pid 1658, jiffies 4294914015\n\t  hex dump (first 16 bytes):\n\t    10 00 00 00 40 00 00 00 80 00 00 00 00 00 00 00  ....@...........\n\t  backtrace (crc 857f0cb4):\n\t    [<0000000028c1b3c2>] kmemleak_alloc+0x34/0x40\n\t    [<000000001d6ecc87>] __kmalloc_noprof+0x2bc/0x3c0\n\t    [<00000000393795c1>] devm_iio_init_iio_gts+0x4b4/0x16f4\n\t    [<0000000071bb4b09>] 0xffffffdf052a62e0\n\t    [<000000007d089d45>] 0xffffffdf052a6864\n\t    [<00000000f9dc55b5>] kunit_try_run_case+0x13c/0x3ac\n\t    [<00000000175a3fd4>] kunit_generic_run_threadfn_adapter+0x80/0xec\n\t    [<00000000f505065d>] kthread+0x2e8/0x374\n\t    [<00000000bbfb0e5d>] ret_from_fork+0x10/0x20\n\t......\n\nIt includes 5*5 times \"size 64\" memory leaks, which correspond to 5 times\ntest_init_iio_gain_scale() calls with gts_test_gains size 10 (10*size(int))\nand gts_test_itimes size 5. It also includes 5*1 times \"size 16\"\nmemory leak, which correspond to one time __test_init_iio_gain_scale()\ncall with gts_test_gains_gain_low size 3 (3*size(int)) and gts_test_itimes\nsize 5.\n\nThe reason is that the per_time_gains[i] is not freed which is allocated in\nthe \"gts->num_itime\" for loop in iio_gts_build_avail_scale_table()."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: iio: gts-helper: corrige fugas de memoria en iio_gts_build_avail_scale_table() modprobe iio-test-gts y rmmod, luego ocurre la siguiente fuga de memoria: objeto sin referencia 0xffffff80c810be00 (tama\u00f1o 64): comm \"kunit_try_catch\", pid 1654, jiffies 4294913981 volcado hexadecimal (primeros 32 bytes): 02 00 00 00 08 00 00 00 20 00 00 00 40 00 00 00 ........ ...@... 80 00 00 00 00 02 00 00 00 04 00 00 00 08 00 00 ................ backtrace (crc a63d875e): [&lt;0000000028c1b3c2&gt;] kmemleak_alloc+0x34/0x40 [&lt;000000001d6ecc87&gt;] __kmalloc_noprof+0x2bc/0x3c0 [&lt;00000000393795c1&gt;] devm_iio_init_iio_gts+0x4b4/0x16f4 [&lt;0000000071bb4b09&gt;] 0xffffffdf052a62e0 [&lt;000000000315bc18&gt;] 0xffffffdf052a6488 [&lt;00000000f9dc55b5&gt;] kunit_try_run_case+0x13c/0x3ac [&lt;00000000175a3fd4&gt;] kunit_generic_run_threadfn_adapter+0x80/0xec [&lt;00000000f505065d&gt;] kthread+0x2e8/0x374 [&lt;00000000bbfb0e5d&gt;] ret_from_fork+0x10/0x20 objeto sin referencia 0xffffff80cbfe9e70 (tama\u00f1o 16): comm \"kunit_try_catch\", pid 1658, jiffies 4294914015 volcado hexadecimal (primeros 16 bytes): 10 00 00 00 40 00 00 00 80 00 00 00 00 00 00 00 ....@........... backtrace (crc 857f0cb4): [&lt;0000000028c1b3c2&gt;] kmemleak_alloc+0x34/0x40 [&lt;000000001d6ecc87&gt;] __kmalloc_noprof+0x2bc/0x3c0 [&lt;00000000393795c1&gt;] devm_iio_init_iio_gts+0x4b4/0x16f4 [&lt;0000000071bb4b09&gt;] 0xffffffdf052a62e0 [&lt;000000007d089d45&gt;] 0xffffffdf052a6864 [&lt;00000000f9dc55b5&gt;] kunit_try_run_case+0x13c/0x3ac [&lt;00000000175a3fd4&gt;] kunit_generic_run_threadfn_adapter+0x80/0xec [&lt;00000000f505065d&gt;] kthread+0x2e8/0x374 [&lt;00000000bbfb0e5d&gt;] ret_from_fork+0x10/0x20 ...... Incluye 5*5 veces p\u00e9rdidas de memoria de \"tama\u00f1o 64\", que corresponden a 5 veces llamadas a test_init_iio_gain_scale() con gts_test_gains tama\u00f1o 10 (10*size(int)) y gts_test_itimes tama\u00f1o 5. Tambi\u00e9n incluye 5*1 veces p\u00e9rdidas de memoria de \"tama\u00f1o 16\", que corresponden a una vez llamada a __test_init_iio_gain_scale() con gts_test_gains_gain_low tama\u00f1o 3 (3*size(int)) y gts_test_itimes tama\u00f1o 5. La raz\u00f3n es que no se libera per_time_gains[i], que est\u00e1 asignado en el bucle for \"gts-&gt;num_itime\" en iio_gts_build_avail_scale_table()."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/16e41593825c3044efca0eb34b2d6ffba306e4ec", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/38d6e8be234d87b0eedca50309e25051888b39d1", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/691e79ffc42154a9c91dc3b7e96a307037b4be74", "name": "", "refsource": "", "tags": ["Patch"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-401"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "baseScore": 5.5, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "A878C8F6-C972-4F6F-88E6-0743B1F3EF1C", "cpe_name": [], "versionStartIncluding": "6.4", "versionEndExcluding": "6.6.60"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "E96F53A4-5E87-4A70-BD9A-BC327828D57F", "cpe_name": [], "versionStartIncluding": "6.7", "versionEndExcluding": "6.11.7"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*", "matchCriteriaId": "7F361E1D-580F-4A2D-A509-7615F73167A1", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*", "matchCriteriaId": "925478D0-3E3D-4E6F-ACD5-09F28D5DF82C", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*", "matchCriteriaId": "3C95E234-D335-4B6C-96BF-E2CEBD8654ED", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*", "matchCriteriaId": "E0F717D8-3014-4F84-8086-0124B2111379", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*", "matchCriteriaId": "24DBE6C7-2AAE-4818-AED2-E131F153D2FA", "cpe_name": []}]}]}}