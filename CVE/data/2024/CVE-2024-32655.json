{"publishedDate": "2024-05-14T15:36Z", "lastModifiedDate": "2024-12-12T21:15Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-32655", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Npgsql is the .NET data provider for PostgreSQL. The `WriteBind()` method in `src/Npgsql/Internal/NpgsqlConnector.FrontendMessages.cs` uses `int` variables to store the message length and the sum of parameter lengths. Both variables overflow when the sum of parameter lengths becomes too large. This causes Npgsql to write a message size that is too small when constructing a Postgres protocol message to send it over the network to the database. When parsing the message, the database will only read a small number of bytes and treat any following bytes as new messages while they belong to the old message. Attackers can abuse this to inject arbitrary Postgres protocol messages into the connection, leading to the execution of arbitrary SQL statements on the application's behalf. This vulnerability is fixed in 4.0.14, 4.1.13, 5.0.18, 6.0.11, 7.0.7, and 8.0.3."}, {"lang": "es", "value": "Npgsql es el proveedor de datos .NET para PostgreSQL. El m\u00e9todo `WriteBind()` en `src/Npgsql/Internal/NpgsqlConnector.FrontendMessages.cs` usa variables `int` para almacenar la longitud del mensaje y la suma de las longitudes de los par\u00e1metros. Ambas variables se desbordan cuando la suma de las longitudes de los par\u00e1metros se vuelve demasiado grande. Esto hace que Npgsql escriba un tama\u00f1o de mensaje demasiado peque\u00f1o al construir un mensaje de protocolo Postgres para enviarlo a trav\u00e9s de la red a la base de datos. Al analizar el mensaje, la base de datos solo leer\u00e1 una peque\u00f1a cantidad de bytes y tratar\u00e1 los bytes siguientes como mensajes nuevos mientras pertenezcan al mensaje anterior. Los atacantes pueden abusar de esto para inyectar mensajes arbitrarios del protocolo Postgres en la conexi\u00f3n, lo que lleva a la ejecuci\u00f3n de sentencias SQL arbitrarias en nombre de la aplicaci\u00f3n. Esta vulnerabilidad se solucion\u00f3 en 4.0.14, 4.1.13, 5.0.18, 6.0.11, 7.0.7 y 8.0.3."}]}, "references": {"reference_data": [{"url": "https://github.com/npgsql/npgsql/commit/091655eed0c84e502ab424950c930339d17c1928", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/3183efb2bdcca159c8c2e22af57e18ea8f853cf0", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/67acbe027e28477ac2199e15cfb554bb2ffaf169", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/703d9af8fa48dfe8c0180e36edb8278f34342d7b", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/a22a42d8141d7a3528f43c02c095a409507cf1af", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/e34e2ba8042e666d9af54a1b255fba4d5b11df56", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/f7e7ead0702d776a8f551f5786c4cac2d65c4bc6", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v4.0.14", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v4.1.13", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v5.0.18", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v6.0.11", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v7.0.7", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v8.0.3", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/security/advisories/GHSA-x9vc-6hfv-hg8c", "name": "", "refsource": "", "tags": []}, {"url": "https://www.youtube.com/watch?v=Tfg1B8u1yvE", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/091655eed0c84e502ab424950c930339d17c1928", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/3183efb2bdcca159c8c2e22af57e18ea8f853cf0", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/67acbe027e28477ac2199e15cfb554bb2ffaf169", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/703d9af8fa48dfe8c0180e36edb8278f34342d7b", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/a22a42d8141d7a3528f43c02c095a409507cf1af", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/e34e2ba8042e666d9af54a1b255fba4d5b11df56", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/commit/f7e7ead0702d776a8f551f5786c4cac2d65c4bc6", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v4.0.14", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v4.1.13", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v5.0.18", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v6.0.11", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v7.0.7", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/releases/tag/v8.0.3", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/npgsql/npgsql/security/advisories/GHSA-x9vc-6hfv-hg8c", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-89"}, {"lang": "en", "value": "CWE-190"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.2, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 8.1, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}