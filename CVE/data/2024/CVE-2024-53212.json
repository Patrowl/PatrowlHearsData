{"publishedDate": "2024-12-27T14:15Z", "lastModifiedDate": "2024-12-27T14:15Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-53212", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetlink: fix false positive warning in extack during dumps\n\nCommit under fixes extended extack reporting to dumps.\nIt works under normal conditions, because extack errors are\nusually reported during ->start() or the first ->dump(),\nit's quite rare that the dump starts okay but fails later.\nIf the dump does fail later, however, the input skb will\nalready have the initiating message pulled, so checking\nif bad attr falls within skb->data will fail.\n\nSwitch the check to using nlh, which is always valid.\n\nsyzbot found a way to hit that scenario by filling up\nthe receive queue. In this case we initiate a dump\nbut don't call ->dump() until there is read space for\nan skb.\n\nWARNING: CPU: 1 PID: 5845 at net/netlink/af_netlink.c:2210 netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209\nRIP: 0010:netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209\nCall Trace:\n <TASK>\n netlink_dump_done+0x513/0x970 net/netlink/af_netlink.c:2250\n netlink_dump+0x91f/0xe10 net/netlink/af_netlink.c:2351\n netlink_recvmsg+0x6bb/0x11d0 net/netlink/af_netlink.c:1983\n sock_recvmsg_nosec net/socket.c:1051 [inline]\n sock_recvmsg+0x22f/0x280 net/socket.c:1073\n __sys_recvfrom+0x246/0x3d0 net/socket.c:2267\n __do_sys_recvfrom net/socket.c:2285 [inline]\n __se_sys_recvfrom net/socket.c:2281 [inline]\n __x64_sys_recvfrom+0xde/0x100 net/socket.c:2281\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n RIP: 0033:0x7ff37dd17a79"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: netlink: corrige la advertencia de falso positivo en extack durante los volcados Commit bajo corrige el informe extendido de extack a los volcados. Funciona en condiciones normales, porque los errores de extack generalmente se informan durante -&gt;start() o el primer -&gt;dump(), es bastante raro que el volcado comience bien pero falle m\u00e1s tarde. Sin embargo, si el volcado falla m\u00e1s tarde, el skb de entrada ya tendr\u00e1 el mensaje de inicio extra\u00eddo, por lo que la verificaci\u00f3n de si el atributo incorrecto cae dentro de skb-&gt;data fallar\u00e1. Cambie la verificaci\u00f3n para usar nlh, que siempre es v\u00e1lido. syzbot encontr\u00f3 una forma de abordar ese escenario llenando la cola de recepci\u00f3n. En este caso, iniciamos un volcado pero no llamamos a -&gt;dump() hasta que haya espacio de lectura para un skb. ADVERTENCIA: CPU: 1 PID: 5845 en net/netlink/af_netlink.c:2210 netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209 RIP: 0010:netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209 Seguimiento de llamadas:  netlink_dump_done+0x513/0x970 net/netlink/af_netlink.c:2250 netlink_dump+0x91f/0xe10 net/netlink/af_netlink.c:2351 netlink_recvmsg+0x6bb/0x11d0 net/netlink/af_netlink.c:1983 sock_recvmsg_nosec net/socket.c:1051 [en l\u00ednea] sock_recvmsg+0x22f/0x280 net/socket.c:1073 __sys_recvfrom+0x246/0x3d0 net/socket.c:2267 __do_sys_recvfrom net/socket.c:2285 [en l\u00ednea] __se_sys_recvfrom net/socket.c:2281 [en l\u00ednea] __x64_sys_recvfrom+0xde/0x100 net/socket.c:2281 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83 entrada_SYSCALL_64_after_hwframe+0x77/0x7f RIP: 0033:0x7ff37dd17a79"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/28af028a71371df5fcbf807fd4444bba8d0c33cc", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/3bf39fa849ab8ed52abb6715922e6102d3df9f97", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/6406d0ce0414b807af5d2a4b781c3f3ee52b8a4d", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}