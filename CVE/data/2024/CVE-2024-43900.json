{"publishedDate": "2024-08-26T11:15Z", "lastModifiedDate": "2025-11-03T22:18Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2024-43900", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: xc2028: avoid use-after-free in load_firmware_cb()\n\nsyzkaller reported use-after-free in load_firmware_cb() [1].\nThe reason is because the module allocated a struct tuner in tuner_probe(),\nand then the module initialization failed, the struct tuner was released.\nA worker which created during module initialization accesses this struct\ntuner later, it caused use-after-free.\n\nThe process is as follows:\n\ntask-6504           worker_thread\ntuner_probe                             <= alloc dvb_frontend [2]\n...\nrequest_firmware_nowait                 <= create a worker\n...\ntuner_remove                            <= free dvb_frontend\n...\n                    request_firmware_work_func  <= the firmware is ready\n                    load_firmware_cb    <= but now the dvb_frontend has been freed\n\nTo fix the issue, check the dvd_frontend in load_firmware_cb(), if it is\nnull, report a warning and just return.\n\n[1]:\n    ==================================================================\n     BUG: KASAN: use-after-free in load_firmware_cb+0x1310/0x17a0\n     Read of size 8 at addr ffff8000d7ca2308 by task kworker/2:3/6504\n\n     Call trace:\n      load_firmware_cb+0x1310/0x17a0\n      request_firmware_work_func+0x128/0x220\n      process_one_work+0x770/0x1824\n      worker_thread+0x488/0xea0\n      kthread+0x300/0x430\n      ret_from_fork+0x10/0x20\n\n     Allocated by task 6504:\n      kzalloc\n      tuner_probe+0xb0/0x1430\n      i2c_device_probe+0x92c/0xaf0\n      really_probe+0x678/0xcd0\n      driver_probe_device+0x280/0x370\n      __device_attach_driver+0x220/0x330\n      bus_for_each_drv+0x134/0x1c0\n      __device_attach+0x1f4/0x410\n      device_initial_probe+0x20/0x30\n      bus_probe_device+0x184/0x200\n      device_add+0x924/0x12c0\n      device_register+0x24/0x30\n      i2c_new_device+0x4e0/0xc44\n      v4l2_i2c_new_subdev_board+0xbc/0x290\n      v4l2_i2c_new_subdev+0xc8/0x104\n      em28xx_v4l2_init+0x1dd0/0x3770\n\n     Freed by task 6504:\n      kfree+0x238/0x4e4\n      tuner_remove+0x144/0x1c0\n      i2c_device_remove+0xc8/0x290\n      __device_release_driver+0x314/0x5fc\n      device_release_driver+0x30/0x44\n      bus_remove_device+0x244/0x490\n      device_del+0x350/0x900\n      device_unregister+0x28/0xd0\n      i2c_unregister_device+0x174/0x1d0\n      v4l2_device_unregister+0x224/0x380\n      em28xx_v4l2_init+0x1d90/0x3770\n\n     The buggy address belongs to the object at ffff8000d7ca2000\n      which belongs to the cache kmalloc-2k of size 2048\n     The buggy address is located 776 bytes inside of\n      2048-byte region [ffff8000d7ca2000, ffff8000d7ca2800)\n     The buggy address belongs to the page:\n     page:ffff7fe00035f280 count:1 mapcount:0 mapping:ffff8000c001f000 index:0x0\n     flags: 0x7ff800000000100(slab)\n     raw: 07ff800000000100 ffff7fe00049d880 0000000300000003 ffff8000c001f000\n     raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000\n     page dumped because: kasan: bad access detected\n\n     Memory state around the buggy address:\n      ffff8000d7ca2200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n      ffff8000d7ca2280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n     >ffff8000d7ca2300: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n                           ^\n      ffff8000d7ca2380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n      ffff8000d7ca2400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n     ==================================================================\n\n[2]\n    Actually, it is allocated for struct tuner, and dvb_frontend is inside."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: medio: xc2028: evitar el use-after-free en load_firmware_cb() syzkaller inform\u00f3 el use-after-free en load_firmware_cb() [1]. La raz\u00f3n es que el m\u00f3dulo asign\u00f3 un sintonizador de estructuras en tuner_probe(), y luego la inicializaci\u00f3n del m\u00f3dulo fall\u00f3, se liber\u00f3 el sintonizador de estructuras. Un trabajador que cre\u00f3 durante la inicializaci\u00f3n del m\u00f3dulo accede a este sintonizador de estructuras m\u00e1s tarde, lo que provoc\u00f3 un use-after-free. El proceso es el siguiente: task-6504 trabajador_thread tuner_probe &lt;= alloc dvb_frontend [2]... request_firmware_nowait &lt;= crear un trabajador... tuner_remove &lt;= free dvb_frontend... request_firmware_work_func &lt;= el firmware est\u00e1 listo load_firmware_cb &lt;= pero ahora el dvb_frontend ha sido liberado. Para solucionar el problema, verifique el dvd_frontend en load_firmware_cb(), si es nulo, informe una advertencia y simplemente regrese. [1]: =============================================== ==================== ERROR: KASAN: use-after-free en load_firmware_cb+0x1310/0x17a0 Lectura de tama\u00f1o 8 en la direcci\u00f3n ffff8000d7ca2308 por tarea kworker/2:3/ 6504 Rastreo de llamadas: load_firmware_cb+0x1310/0x17a0 request_firmware_work_func+0x128/0x220 Process_one_work+0x770/0x1824 Workers_thread+0x488/0xea0 kthread+0x300/0x430 ret_from_fork+0x10/0x20 Asignado por tarea 650 4: kzalloc tuner_probe+0xb0/0x1430 i2c_device_probe+0x92c/0xaf0 very_probe+0x678/0xcd0 driver_probe_device+0x280/0x370 __device_attach_driver+0x220/0x330 bus_for_each_drv+0x134/0x1c0 __device_attach+0x1f4/0x410 dispositivo_initial_probe+0x20/0x30 bus_probe_device+0x 184/0x200 dispositivo_add+0x924/0x12c0 registro_dispositivo+0x24/0x30 i2c_new_device+0x4e0/0xc44 v4l2_i2c_new_subdev_board+0xbc/0x290 v4l2_i2c_new_subdev+0xc8/0x104 em28xx_v4l2_init+0x1dd0/0x3770 Liberado por la tarea 6504: kfree+0x238/0x4e4 tuner_remove+0x144/0x1c0 vice_remove+0xc8/0x290 __device_release_driver+0x314/0x5fc dispositivo_release_driver+0x30/0x44 bus_remove_device+0x244/0x490 device_del+0x350/0x900 device_unregister+0x28/0xd0 i2c_unregister_device+0x174/0x1d0 v4l2_device_unregister+0x224/0x380 em28xx_v4l2_init+0x1d90/0x3770 La direcci\u00f3n con errores pertenece al objeto en ffff8000d7ca200 0 que pertenece al cach\u00e9 kmalloc-2k de tama\u00f1o 2048 La direcci\u00f3n del error se encuentra 776 bytes dentro de la regi\u00f3n de 2048 bytes [ffff8000d7ca2000, ffff8000d7ca2800) La direcci\u00f3n con errores pertenece a la p\u00e1gina: p\u00e1gina:ffff7fe00035f280 recuento:1 mapcount:0 mapeo:ffff8000c001f000 \u00edndice:0x0 banderas: 0x7ff800000000100(slab) : 07ff800000000100 ffff7fe00049d880 0000000300000003 ffff8000c001f000 crudo: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000 p\u00e1gina volcada porque: kasan: mal acceso detectado Estado de la memoria alrededor de la direcci\u00f3n del error: ffff8000d7ca2200: fb fb fb fb fb fb fb fb fb fb fb fb f b fb fb fb ffff8000d7ca2280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb &gt;ffff8000d7ca2300: fb fb fb fb fb fb fb fb fb fb fb fb ^ ffff8000d7ca2380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb ffff8000d7ca2400: b fb fb fb fb fb fb fb fb fb fb fb fb fb fb ======================================== ============================ [2] En realidad, est\u00e1 asignado para el sintonizador de estructuras y dvb_frontend est\u00e1 dentro."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/208deb6d8c3cb8c3acb1f41eb31cf68ea08726d5", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/68594cec291ff9523b9feb3f43fd853dcddd1f60", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/850304152d367f104d21c77cfbcc05806504218b", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/ef517bdfc01818419f7bd426969a0c86b14f3e0e", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-416"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 5.9, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 7.8, "baseSeverity": "HIGH", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "ECB889E5-9368-4201-9049-7289757A0B8D", "cpe_name": [], "versionEndExcluding": "6.1.105"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "FA11941E-81FB-484C-B583-881EEB488340", "cpe_name": [], "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.46"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "D074AE50-4A5E-499C-A2FD-75FD60DEA560", "cpe_name": [], "versionStartIncluding": "6.7", "versionEndExcluding": "6.10.5"}]}]}}