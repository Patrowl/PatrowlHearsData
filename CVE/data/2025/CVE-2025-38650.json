{"publishedDate": "2025-08-22T16:15Z", "lastModifiedDate": "2026-01-07T17:36Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-38650", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: remove mutex_lock check in hfsplus_free_extents\n\nSyzbot reported an issue in hfsplus filesystem:\n\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 4400 at fs/hfsplus/extents.c:346\n\thfsplus_free_extents+0x700/0xad0\nCall Trace:\n<TASK>\nhfsplus_file_truncate+0x768/0xbb0 fs/hfsplus/extents.c:606\nhfsplus_write_begin+0xc2/0xd0 fs/hfsplus/inode.c:56\ncont_expand_zero fs/buffer.c:2383 [inline]\ncont_write_begin+0x2cf/0x860 fs/buffer.c:2446\nhfsplus_write_begin+0x86/0xd0 fs/hfsplus/inode.c:52\ngeneric_cont_expand_simple+0x151/0x250 fs/buffer.c:2347\nhfsplus_setattr+0x168/0x280 fs/hfsplus/inode.c:263\nnotify_change+0xe38/0x10f0 fs/attr.c:420\ndo_truncate+0x1fb/0x2e0 fs/open.c:65\ndo_sys_ftruncate+0x2eb/0x380 fs/open.c:193\ndo_syscall_x64 arch/x86/entry/common.c:50 [inline]\ndo_syscall_64+0x3d/0xb0 arch/x86/entry/common.c:80\nentry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nTo avoid deadlock, Commit 31651c607151 (\"hfsplus: avoid deadlock\non file truncation\") unlock extree before hfsplus_free_extents(),\nand add check wheather extree is locked in hfsplus_free_extents().\n\nHowever, when operations such as hfsplus_file_release,\nhfsplus_setattr, hfsplus_unlink, and hfsplus_get_block are executed\nconcurrently in different files, it is very likely to trigger the\nWARN_ON, which will lead syzbot and xfstest to consider it as an\nabnormality.\n\nThe comment above this warning also describes one of the easy\ntriggering situations, which can easily trigger and cause\nxfstest&syzbot to report errors.\n\n[task A]\t\t\t[task B]\n->hfsplus_file_release\n  ->hfsplus_file_truncate\n    ->hfs_find_init\n      ->mutex_lock\n    ->mutex_unlock\n\t\t\t\t->hfsplus_write_begin\n\t\t\t\t  ->hfsplus_get_block\n\t\t\t\t    ->hfsplus_file_extend\n\t\t\t\t      ->hfsplus_ext_read_extent\n\t\t\t\t        ->hfs_find_init\n\t\t\t\t\t  ->mutex_lock\n    ->hfsplus_free_extents\n      WARN_ON(mutex_is_locked) !!!\n\nSeveral threads could try to lock the shared extents tree.\nAnd warning can be triggered in one thread when another thread\nhas locked the tree. This is the wrong behavior of the code and\nwe need to remove the warning."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: hfsplus: eliminar comprobaci\u00f3n mutex_lock en hfsplus_free_extents Syzbot inform\u00f3 de un problema en el sistema de archivos hfsplus: ------------[ cortar aqu\u00ed ]------------ ADVERTENCIA: CPU: 0 PID: 4400 en fs/hfsplus/extents.c:346 hfsplus_free_extents+0x700/0xad0 Rastreo de llamadas:  hfsplus_file_truncate+0x768/0xbb0 fs/hfsplus/extents.c:606 hfsplus_write_begin+0xc2/0xd0 fs/hfsplus/inode.c:56 cont_expand_zero fs/buffer.c:2383 [en l\u00ednea] cont_write_begin+0x2cf/0x860 fs/buffer.c:2446 hfsplus_write_begin+0x86/0xd0 fs/hfsplus/inode.c:52 generic_cont_expand_simple+0x151/0x250 fs/buffer.c:2347 hfsplus_setattr+0x168/0x280 fs/hfsplus/inode.c:263 notify_change+0xe38/0x10f0 fs/attr.c:420 do_truncate+0x1fb/0x2e0 fs/open.c:65 do_sys_ftruncate+0x2eb/0x380 fs/open.c:193 do_syscall_x64 arch/x86/entry/common.c:50 [en l\u00ednea] do_syscall_64+0x3d/0xb0 arch/x86/entry/common.c:80 entry_SYSCALL_64_after_hwframe+0x63/0xcd Para evitar un bloqueo, el commit 31651c607151 (\"hfsplus: evitar bloqueo al truncamiento de archivos\") desbloquea el \u00e1rbol externo antes de hfsplus_free_extents() y a\u00f1ade una comprobaci\u00f3n de si el \u00e1rbol externo est\u00e1 bloqueado en hfsplus_free_extents(). Sin embargo, cuando operaciones como hfsplus_file_release, hfsplus_setattr, hfsplus_unlink y hfsplus_get_block se ejecutan simult\u00e1neamente en archivos diferentes, es muy probable que se active WARN_ON, lo que har\u00e1 que syzbot y xfstest lo consideren una anomal\u00eda. El comentario sobre esta advertencia tambi\u00e9n describe una de las situaciones de f\u00e1cil activaci\u00f3n, que puede f\u00e1cilmente provocar que xfstest y syzbot reporten errores. [Tarea A] [Tarea B] -&gt;hfsplus_file_release -&gt;hfsplus_file_truncate -&gt;hfs_find_init -&gt;mutex_lock -&gt;mutex_unlock -&gt;hfsplus_write_begin -&gt;hfsplus_get_block -&gt;hfsplus_file_extend -&gt;hfsplus_ext_read_extent -&gt;hfs_find_init -&gt;mutex_lock -&gt;hfsplus_free_extents WARN_ON(mutex_is_locked) !!! Varios subprocesos podr\u00edan intentar bloquear el \u00e1rbol de extensiones compartidas. Una advertencia puede activarse en un subproceso cuando otro subproceso ha bloqueado el \u00e1rbol. Este comportamiento del c\u00f3digo es incorrecto y debemos eliminar la advertencia."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/0807e4ac59a546f2346961c5e26a98901594b205", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/084933961ecda7561dedfb78c4676ccb90c91ada", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/14922f0cc92e010b160121679c0a6ca072f4e975", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/314310166ba1fdff7660dfd9d18ea42d7058f7ae", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/5055b7db94110f228961dea6b74eed0a93a50b01", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/9764b8bb9f5f94df105cd2ac43829dd0d2c82b9f", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a19ce9230b22a0866313932e7964cf05557a6008", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/fcb96956c921f1aae7e7b477f2435c56f77a31b4", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/fdd6aca652122d6e97787e88d7dd53ddc8b74e7e", "name": "", "refsource": "", "tags": ["Patch"]}, {"url": "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-667"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 1.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "baseScore": 5.5, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "DB980BDC-B34E-41B6-BF6D-8AF3F2450143", "cpe_name": [], "versionStartIncluding": "4.19", "versionEndExcluding": "5.4.297"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "D0D21C35-EB8A-488A-BBF9-403E4817E5DD", "cpe_name": [], "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.241"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "AD9E597F-3DDE-4D7E-976C-463D0611F13F", "cpe_name": [], "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.190"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "3E5B1B93-C244-4B54-B3AB-12C2635A443B", "cpe_name": [], "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.148"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "DD6EDB96-08AC-49D8-A1A9-4D2140C49BC7", "cpe_name": [], "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.102"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "EA7AA5E6-4376-4A85-A021-6ACC5FF801C3", "cpe_name": [], "versionStartIncluding": "6.7", "versionEndExcluding": "6.12.42"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "5890C690-B295-40C2-9121-FF5F987E5142", "cpe_name": [], "versionStartIncluding": "6.13", "versionEndExcluding": "6.15.10"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "58182352-D7DF-4CC9-841E-03C1D852C3FB", "cpe_name": [], "versionStartIncluding": "6.16", "versionEndExcluding": "6.16.1"}]}, {"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*", "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED", "cpe_name": []}]}]}}