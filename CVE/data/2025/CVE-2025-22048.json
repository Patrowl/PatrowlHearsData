{"publishedDate": "2025-04-16T15:15Z", "lastModifiedDate": "2025-04-17T20:22Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-22048", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nLoongArch: BPF: Don't override subprog's return value\n\nThe verifier test `calls: div by 0 in subprog` triggers a panic at the\nld.bu instruction. The ld.bu insn is trying to load byte from memory\naddress returned by the subprog. The subprog actually set the correct\naddress at the a5 register (dedicated register for BPF return values).\nBut at commit 73c359d1d356 (\"LoongArch: BPF: Sign-extend return values\")\nwe also sign extended a5 to the a0 register (return value in LoongArch).\nFor function call insn, we later propagate the a0 register back to a5\nregister. This is right for native calls but wrong for bpf2bpf calls\nwhich expect zero-extended return value in a5 register. So only move a0\nto a5 for native calls (i.e. non-BPF_PSEUDO_CALL)."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: LoongArch: BPF: No anule el valor de retorno del subprograma La prueba del verificador `calls: div by 0 in subprog` desencadena un p\u00e1nico en la instrucci\u00f3n ld.bu. La instrucci\u00f3n ld.bu insn intenta cargar un byte desde la direcci\u00f3n de memoria devuelta por el subprograma. El subprograma en realidad estableci\u00f3 la direcci\u00f3n correcta en el registro a5 (registro dedicado para valores de retorno de BPF). Pero en el commit 73c359d1d356 (\"LoongArch: BPF: Valores de retorno con signo extendido\") tambi\u00e9n firmamos a5 extendido en el registro a0 (valor de retorno en LoongArch). Para la instrucci\u00f3n de llamada a funci\u00f3n insn, luego propagamos el registro a0 de vuelta al registro a5. Esto es correcto para llamadas nativas, pero incorrecto para llamadas bpf2bpf que esperan un valor de retorno extendido cero en el registro a5. Por lo tanto, solo mueva a0 a a5 para llamadas nativas (es decir, no BPF_PSEUDO_CALL)."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/223d565d8892481684091cfbaf3466f2b0e289d3", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/60f3caff1492e5b8616b9578c4bedb5c0a88ed14", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/780628a780b622759d9e5adc76d15432144da1a3", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7df2696256a034405d3c5a71b3a4c54725de4404", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/996e90ab446641553e8e21707b38b9709605e0e0", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}