{"publishedDate": "2025-07-10T09:15Z", "lastModifiedDate": "2025-07-10T13:17Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-38331", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: ethernet: cortina: Use TOE/TSO on all TCP\n\nIt is desireable to push the hardware accelerator to also\nprocess non-segmented TCP frames: we pass the skb->len\nto the \"TOE/TSO\" offloader and it will handle them.\n\nWithout this quirk the driver becomes unstable and lock\nup and and crash.\n\nI do not know exactly why, but it is probably due to the\nTOE (TCP offload engine) feature that is coupled with the\nsegmentation feature - it is not possible to turn one\npart off and not the other, either both TOE and TSO are\nactive, or neither of them.\n\nNot having the TOE part active seems detrimental, as if\nthat hardware feature is not really supposed to be turned\noff.\n\nThe datasheet says:\n\n  \"Based on packet parsing and TCP connection/NAT table\n   lookup results, the NetEngine puts the packets\n   belonging to the same TCP connection to the same queue\n   for the software to process. The NetEngine puts\n   incoming packets to the buffer or series of buffers\n   for a jumbo packet. With this hardware acceleration,\n   IP/TCP header parsing, checksum validation and\n   connection lookup are offloaded from the software\n   processing.\"\n\nAfter numerous tests with the hardware locking up after\nsomething between minutes and hours depending on load\nusing iperf3 I have concluded this is necessary to stabilize\nthe hardware."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: ethernet: cortina: Usar TOE/TSO en todos los protocolos TCP. Es deseable que el acelerador de hardware tambi\u00e9n procese tramas TCP no segmentadas: pasamos el comando skb-&gt;len al descargador \"TOE/TSO\" y este las gestionar\u00e1. Sin esta peculiaridad, el controlador se vuelve inestable, se bloquea y se bloquea. No s\u00e9 exactamente por qu\u00e9, pero probablemente se deba a la funci\u00f3n TOE (motor de descarga TCP) que est\u00e1 acoplada a la funci\u00f3n de segmentaci\u00f3n: no es posible desactivar una parte y no la otra, ya sea que tanto TOE como TSO est\u00e9n activos, o ninguno de ellos. No tener activa la funci\u00f3n TOE parece perjudicial, como si esa funci\u00f3n de hardware no debiera estar desactivada. La hoja de datos indica: \"Con base en el an\u00e1lisis de paquetes y los resultados de la b\u00fasqueda de la conexi\u00f3n TCP/tabla NAT, NetEngine coloca los paquetes pertenecientes a la misma conexi\u00f3n TCP en la misma cola para que el software los procese. NetEngine coloca los paquetes entrantes en el b\u00fafer o en una serie de b\u00faferes para un paquete jumbo. Con esta aceleraci\u00f3n de hardware, el an\u00e1lisis de encabezados IP/TCP, la validaci\u00f3n de la suma de comprobaci\u00f3n y la b\u00fasqueda de conexi\u00f3n se descargan del procesamiento del software\". Tras numerosas pruebas con el hardware bloque\u00e1ndose despu\u00e9s de minutos u horas, dependiendo de la carga, utilizando iperf3, he concluido que esto es necesario para estabilizar el hardware."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/1b503b790109d19710ec83c589c3ee59e95347ec", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/2bd434bb0eeb680c2b3dd6c68ca319b30cb8d47f", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/6a07e3af4973402fa199a80036c10060b922c92c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/a37888a435b0737128d2d9c6f67b8d608f83df7a", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ebe12e232f1d58ebb4b53b6d9149962b707bed91", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}