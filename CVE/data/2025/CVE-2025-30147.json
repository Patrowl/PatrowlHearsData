{"publishedDate": "2025-05-07T19:16Z", "lastModifiedDate": "2025-05-08T14:39Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-30147", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Besu Native contains scripts and tooling that is used to build and package the native libraries used by the Ethereum client Hyperledger Besu. Besu 24.7.1 through 25.2.2, corresponding to besu-native versions 0.9.0 through 1.2.1, have a potential consensus bug for the precompiles ALTBN128_ADD (0x06), ALTBN128_MUL (0x07), and ALTBN128_PAIRING (0x08). These precompiles were reimplemented in besu-native using gnark-crypto's bn254 implementation, as the former implementation used a library which was no longer maintained and not sufficiently performant. The new gnark implementation was initially added in version 0.9.0 of besu-native but was not utilized by Besu until version 0.9.2 in Besu 24.7.1. The issue is that there are EC points which may be crafted which are in the correct subgroup but are not on the curve and the besu-native gnark implementation was relying on subgroup checks to perform point-on-curve checks as well. The version of gnark-crypto used at the time did not do this check when performing subgroup checks. The result is that it was possible for Besu to give an incorrect result and fall out of consensus when executing one of these precompiles against a specially crafted input point. Additionally, homogenous Besu-only networks can potentially enshrine invalid state which would be incorrect and difficult to process with patched versions of besu which handle these calls correctly. The underlying defect has been patched in besu-native release 1.3.0. The fixed version of Besu is version 25.3.0. As a workaround for versions of Besu with the problem, the native precompile for altbn128 may be disabled in favor of the pure-java implementation. The pure java implementation is significantly slower, but does not have this consensus issue."}, {"lang": "es", "value": "Besu Native contiene scripts y herramientas que se utilizan para compilar y empaquetar las librer\u00edas nativas que utiliza el cliente de Ethereum, Hyperledger Besu. Las versiones de Besu 24.7.1 a 25.2.2, correspondientes a las versiones de besu-native 0.9.0 a 1.2.1, presentan un posible error de consenso en las precompilaciones ALTBN128_ADD (0x06), ALTBN128_MUL (0x07) y ALTBN128_PAIRING (0x08). Estas precompilaciones se reimplementaron en besu-native con la implementaci\u00f3n bn254 de gnark-crypto, ya que la implementaci\u00f3n anterior utilizaba una librer\u00eda que ya no recib\u00eda mantenimiento y no ofrec\u00eda el rendimiento suficiente. La nueva implementaci\u00f3n de gnark se a\u00f1adi\u00f3 inicialmente en la versi\u00f3n 0.9.0 de besu-native, pero Besu no la utiliz\u00f3 hasta la versi\u00f3n 0.9.2 de Besu 24.7.1. El problema radica en que existen puntos EC que podr\u00edan estar manipulados y que se encuentran en el subgrupo correcto, pero no en la curva. La implementaci\u00f3n de besu-native de gnark depend\u00eda de comprobaciones de subgrupos para realizar tambi\u00e9n comprobaciones de punto en la curva. La versi\u00f3n de gnark-crypto utilizada en ese momento no realizaba esta comprobaci\u00f3n al realizar comprobaciones de subgrupos. Como resultado, Besu pod\u00eda generar un resultado incorrecto y perder el consenso al ejecutar una de estas precompilaciones contra un punto de entrada especialmente manipulado. Adem\u00e1s, las redes homog\u00e9neas solo de Besu pueden potencialmente incluir un estado no v\u00e1lido, lo cual ser\u00eda incorrecto y dif\u00edcil de procesar con versiones parcheadas de besu que gestionan estas llamadas correctamente. El defecto subyacente se ha corregido en la versi\u00f3n 1.3.0 de besu-native. La versi\u00f3n corregida de Besu es la 25.3.0. Como soluci\u00f3n temporal para las versiones de Besu con este problema, se puede deshabilitar la precompilaci\u00f3n nativa para altbn128 en favor de la implementaci\u00f3n puramente Java. La implementaci\u00f3n de Java puro es significativamente m\u00e1s lenta, pero no tiene este problema de consenso."}]}, "references": {"reference_data": [{"url": "https://github.com/hyperledger/besu-native/security/advisories/GHSA-jcp8-gh74-97hq", "name": "", "refsource": "", "tags": []}, {"url": "https://github.com/hyperledger/besu/blob/main/besu/src/main/java/org/hyperledger/besu/cli/options/NativeLibraryOptions.java#L31-L38", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-325"}]}]}}, "impact": {"baseMetricV4": {"cvssV4": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "baseScore": 8.7, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnConfidentialityImpact": "NONE", "vulnIntegrityImpact": "HIGH", "vulnAvailabilityImpact": "NONE", "subConfidentialityImpact": "NONE", "subIntegrityImpact": "NONE", "subAvailabilityImpact": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirement": "NOT_DEFINED", "integrityRequirement": "NOT_DEFINED", "availabilityRequirement": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnConfidentialityImpact": "NOT_DEFINED", "modifiedVulnIntegrityImpact": "NOT_DEFINED", "modifiedVulnAvailabilityImpact": "NOT_DEFINED", "modifiedSubConfidentialityImpact": "NOT_DEFINED", "modifiedSubIntegrityImpact": "NOT_DEFINED", "modifiedSubAvailabilityImpact": "NOT_DEFINED", "Safety": "NOT_DEFINED", "Automatable": "NOT_DEFINED", "Recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}