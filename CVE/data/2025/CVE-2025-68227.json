{"publishedDate": "2025-12-16T14:15Z", "lastModifiedDate": "2025-12-18T15:08Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-68227", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: Fix proto fallback detection with BPF\n\nThe sockmap feature allows bpf syscall from userspace, or based\non bpf sockops, replacing the sk_prot of sockets during protocol stack\nprocessing with sockmap's custom read/write interfaces.\n'''\ntcp_rcv_state_process()\n  syn_recv_sock()/subflow_syn_recv_sock()\n    tcp_init_transfer(BPF_SOCK_OPS_PASSIVE_ESTABLISHED_CB)\n      bpf_skops_established       <== sockops\n        bpf_sock_map_update(sk)   <== call bpf helper\n          tcp_bpf_update_proto()  <== update sk_prot\n'''\n\nWhen the server has MPTCP enabled but the client sends a TCP SYN\nwithout MPTCP, subflow_syn_recv_sock() performs a fallback on the\nsubflow, replacing the subflow sk's sk_prot with the native sk_prot.\n'''\nsubflow_syn_recv_sock()\n  subflow_ulp_fallback()\n    subflow_drop_ctx()\n      mptcp_subflow_ops_undo_override()\n'''\n\nThen, this subflow can be normally used by sockmap, which replaces the\nnative sk_prot with sockmap's custom sk_prot. The issue occurs when the\nuser executes accept::mptcp_stream_accept::mptcp_fallback_tcp_ops().\nHere, it uses sk->sk_prot to compare with the native sk_prot, but this\nis incorrect when sockmap is used, as we may incorrectly set\nsk->sk_socket->ops.\n\nThis fix uses the more generic sk_family for the comparison instead.\n\nAdditionally, this also prevents a WARNING from occurring:\n\nresult from ./scripts/decode_stacktrace.sh:\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 337 at net/mptcp/protocol.c:68 mptcp_stream_accept \\\n(net/mptcp/protocol.c:4005)\nModules linked in:\n...\n\nPKRU: 55555554\nCall Trace:\n<TASK>\ndo_accept (net/socket.c:1989)\n__sys_accept4 (net/socket.c:2028 net/socket.c:2057)\n__x64_sys_accept (net/socket.c:2067)\nx64_sys_call (arch/x86/entry/syscall_64.c:41)\ndo_syscall_64 (arch/x86/entry/syscall_64.c:63 arch/x86/entry/syscall_64.c:94)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\nRIP: 0033:0x7f87ac92b83d\n\n---[ end trace 0000000000000000 ]---"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/037cc50589643342d69185b663ecf9d26cce91e8", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/1a0d5c74af9b6ba9ffdf1172de5a1a6df5922a00", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/344974ea1a3ca30e4920687b0091bda4438cebdb", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7ee8f015eb47907745e2070184a8ab1e442ac3c4", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/92c4092fe012ecdfa5fb05d394f1c1d8f91ad81c", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9b1980b6f23fa30bf12add19f37c7458625099eb", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/c77b3b79a92e3345aa1ee296180d1af4e7031f8f", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}