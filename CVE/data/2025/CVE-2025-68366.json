{"publishedDate": "2025-12-24T11:16Z", "lastModifiedDate": "2026-01-19T13:16Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-68366", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnbd: defer config unlock in nbd_genl_connect\n\nThere is one use-after-free warning when running NBD_CMD_CONNECT and\nNBD_CLEAR_SOCK:\n\nnbd_genl_connect\n  nbd_alloc_and_init_config // config_refs=1\n  nbd_start_device // config_refs=2\n  set NBD_RT_HAS_CONFIG_REF\t\t\topen nbd // config_refs=3\n  recv_work done // config_refs=2\n\t\t\t\t\t\tNBD_CLEAR_SOCK // config_refs=1\n\t\t\t\t\t\tclose nbd // config_refs=0\n  refcount_inc -> uaf\n\n------------[ cut here ]------------\nrefcount_t: addition on 0; use-after-free.\nWARNING: CPU: 24 PID: 1014 at lib/refcount.c:25 refcount_warn_saturate+0x12e/0x290\n nbd_genl_connect+0x16d0/0x1ab0\n genl_family_rcv_msg_doit+0x1f3/0x310\n genl_rcv_msg+0x44a/0x790\n\nThe issue can be easily reproduced by adding a small delay before\nrefcount_inc(&nbd->config_refs) in nbd_genl_connect():\n\n        mutex_unlock(&nbd->config_lock);\n        if (!ret) {\n                set_bit(NBD_RT_HAS_CONFIG_REF, &config->runtime_flags);\n+               printk(\"before sleep\\n\");\n+               mdelay(5 * 1000);\n+               printk(\"after sleep\\n\");\n                refcount_inc(&nbd->config_refs);\n                nbd_connect_reply(info, nbd->index);\n        }"}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/1649714b930f9ea6233ce0810ba885999da3b5d4", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/2e5e0665a594f076ef2b9439447bae8be293d09d", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/330d688a5ca53857828081a3cf31b92ad1b0b3ed", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9a38306643874566d20f7aba7dff9e6f657b51a9", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ae3e7bc1f4b393ae20e5c85583eb2c6977374716", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/c9b99c948b4fb014812afe7b5ccf2db121d22e46", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/c9e805f6a35d1dd189a9345595a5c20e87611942", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/cd93db1b1b4460e6ee77564024ea461e5940f69c", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}