{"publishedDate": "2025-07-25T13:15Z", "lastModifiedDate": "2025-07-25T15:29Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-38388", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfirmware: arm_ffa: Replace mutex with rwlock to avoid sleep in atomic context\n\nThe current use of a mutex to protect the notifier hashtable accesses\ncan lead to issues in the atomic context. It results in the below\nkernel warnings:\n\n  |  BUG: sleeping function called from invalid context at kernel/locking/mutex.c:258\n  |  in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 9, name: kworker/0:0\n  |  preempt_count: 1, expected: 0\n  |  RCU nest depth: 0, expected: 0\n  |  CPU: 0 UID: 0 PID: 9 Comm: kworker/0:0 Not tainted 6.14.0 #4\n  |  Workqueue: ffa_pcpu_irq_notification notif_pcpu_irq_work_fn\n  |  Call trace:\n  |   show_stack+0x18/0x24 (C)\n  |   dump_stack_lvl+0x78/0x90\n  |   dump_stack+0x18/0x24\n  |   __might_resched+0x114/0x170\n  |   __might_sleep+0x48/0x98\n  |   mutex_lock+0x24/0x80\n  |   handle_notif_callbacks+0x54/0xe0\n  |   notif_get_and_handle+0x40/0x88\n  |   generic_exec_single+0x80/0xc0\n  |   smp_call_function_single+0xfc/0x1a0\n  |   notif_pcpu_irq_work_fn+0x2c/0x38\n  |   process_one_work+0x14c/0x2b4\n  |   worker_thread+0x2e4/0x3e0\n  |   kthread+0x13c/0x210\n  |   ret_from_fork+0x10/0x20\n\nTo address this, replace the mutex with an rwlock to protect the notifier\nhashtable accesses. This ensures that read-side locking does not sleep and\nmultiple readers can acquire the lock concurrently, avoiding unnecessary\ncontention and potential deadlocks. Writer access remains exclusive,\npreserving correctness.\n\nThis change resolves warnings from lockdep about potential sleep in\natomic context."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: firmware: arm_ffa: Reemplazar mutex por rwlock para evitar la suspensi\u00f3n en contexto at\u00f3mico El uso actual de un mutex para proteger los accesos a la tabla hash del notificador puede provocar problemas en el contexto at\u00f3mico. Esto da como resultado las siguientes advertencias del kernel: | BUG: funci\u00f3n de suspensi\u00f3n llamada desde un contexto no v\u00e1lido en kernel/locking/mutex.c:258 | in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 9, name: kworker/0:0 | preempt_count: 1, expected: 0 | RCU nest Depth: 0, expected: 0 | CPU: 0 UID: 0 PID: 9 Comm: kworker/0:0 No contaminado 6.14.0 #4 | Workqueue: ffa_pcpu_irq_notification notif_pcpu_irq_work_fn | Rastreo de llamadas: | show_stack+0x18/0x24 (C) | dump_stack_lvl+0x78/0x90 | dump_stack+0x18/0x24 | __might_resched+0x114/0x170 | __might_sleep+0x48/0x98 | mutex_lock+0x24/0x80 | handle_notif_callbacks+0x54/0xe0 | notif_get_and_handle+0x40/0x88 | generic_exec_single+0x80/0xc0 | smp_call_function_single+0xfc/0x1a0 | notif_pcpu_irq_work_fn+0x2c/0x38 | process_one_work+0x14c/0x2b4 | work_thread+0x2e4/0x3e0 | kthread+0x13c/0x210 | ret_from_fork+0x10/0x20 Para solucionar esto, reemplace el mutex con un rwlock para proteger los accesos a la tabla hash del notificador. Esto garantiza que el bloqueo del lado de lectura no se suspenda y que varios lectores puedan adquirir el bloqueo simult\u00e1neamente, evitando contenciones innecesarias y posibles interbloqueos. El acceso de escritura se mantiene exclusivo, preservando la correcci\u00f3n. Este cambio resuelve las advertencias de lockdep sobre la posible suspensi\u00f3n en un contexto at\u00f3mico."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/31405510a48dcf054abfa5b7b8d70ce1b27d1f13", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/8986f8f61b482c0e6efd28f0b2423d9640c20eb1", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/9ca7a421229bbdfbe2e1e628cff5cfa782720a10", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}