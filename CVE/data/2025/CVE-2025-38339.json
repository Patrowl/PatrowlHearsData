{"publishedDate": "2025-07-10T09:15Z", "lastModifiedDate": "2025-07-10T13:17Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-38339", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/bpf: fix JIT code size calculation of bpf trampoline\n\narch_bpf_trampoline_size() provides JIT size of the BPF trampoline\nbefore the buffer for JIT'ing it is allocated. The total number of\ninstructions emitted for BPF trampoline JIT code depends on where\nthe final image is located. So, the size arrived at with the dummy\npass in arch_bpf_trampoline_size() can vary from the actual size\nneeded in  arch_prepare_bpf_trampoline().  When the instructions\naccounted in  arch_bpf_trampoline_size() is less than the number of\ninstructions emitted during the actual JIT compile of the trampoline,\nthe below warning is produced:\n\n  WARNING: CPU: 8 PID: 204190 at arch/powerpc/net/bpf_jit_comp.c:981 __arch_prepare_bpf_trampoline.isra.0+0xd2c/0xdcc\n\nwhich is:\n\n  /* Make sure the trampoline generation logic doesn't overflow */\n  if (image && WARN_ON_ONCE(&image[ctx->idx] >\n  \t\t\t(u32 *)rw_image_end - BPF_INSN_SAFETY)) {\n\nSo, during the dummy pass, instead of providing some arbitrary image\nlocation, account for maximum possible instructions if and when there\nis a dependency with image location for JIT'ing."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: powerpc/bpf: correcci\u00f3n del c\u00e1lculo del tama\u00f1o del c\u00f3digo JIT del trampol\u00edn BPF. arch_bpf_trampoline_size() proporciona el tama\u00f1o JIT del trampol\u00edn BPF antes de asignar el b\u00fafer para su procesamiento JIT. El n\u00famero total de instrucciones emitidas para el c\u00f3digo JIT del trampol\u00edn BPF depende de la ubicaci\u00f3n de la imagen final. Por lo tanto, el tama\u00f1o obtenido con el paso ficticio en arch_bpf_trampoline_size() puede variar del tama\u00f1o real necesario en arch_prepare_bpf_trampoline(). Cuando las instrucciones contabilizadas en arch_bpf_trampoline_size() son menores que la cantidad de instrucciones emitidas durante la compilaci\u00f3n JIT real del trampol\u00edn, se produce la siguiente advertencia: ADVERTENCIA: CPU: 8 PID: 204190 en arch/powerpc/net/bpf_jit_comp.c:981 __arch_prepare_bpf_trampoline.isra.0+0xd2c/0xdcc que es: /* Aseg\u00farese de que la l\u00f3gica de generaci\u00f3n del trampol\u00edn no se desborde */ if (image &amp;&amp; WARN_ON_ONCE(&amp;image[ctx-&gt;idx] &gt; (u32 *)rw_image_end - BPF_INSN_SAFETY)) { Entonces, durante el pase ficticio, en lugar de proporcionar una ubicaci\u00f3n de imagen arbitraria, tenga en cuenta la m\u00e1xima cantidad de instrucciones posibles si y cuando exista una dependencia con la ubicaci\u00f3n de la imagen para JIT."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/59ba025948be2a92e8bc9ae1cbdaf197660bd508", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/7833deb95e05bec146414b3a2feb24f025ca27c0", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}