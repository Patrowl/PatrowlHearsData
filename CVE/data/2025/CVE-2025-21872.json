{"publishedDate": "2025-03-27T15:15Z", "lastModifiedDate": "2025-03-27T16:45Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-21872", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nefi: Don't map the entire mokvar table to determine its size\n\nCurrently, when validating the mokvar table, we (re)map the entire table\non each iteration of the loop, adding space as we discover new entries.\nIf the table grows over a certain size, this fails due to limitations of\nearly_memmap(), and we get a failure and traceback:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 0 PID: 0 at mm/early_ioremap.c:139 __early_ioremap+0xef/0x220\n  ...\n  Call Trace:\n   <TASK>\n   ? __early_ioremap+0xef/0x220\n   ? __warn.cold+0x93/0xfa\n   ? __early_ioremap+0xef/0x220\n   ? report_bug+0xff/0x140\n   ? early_fixup_exception+0x5d/0xb0\n   ? early_idt_handler_common+0x2f/0x3a\n   ? __early_ioremap+0xef/0x220\n   ? efi_mokvar_table_init+0xce/0x1d0\n   ? setup_arch+0x864/0xc10\n   ? start_kernel+0x6b/0xa10\n   ? x86_64_start_reservations+0x24/0x30\n   ? x86_64_start_kernel+0xed/0xf0\n   ? common_startup_64+0x13e/0x141\n   </TASK>\n  ---[ end trace 0000000000000000 ]---\n  mokvar: Failed to map EFI MOKvar config table pa=0x7c4c3000, size=265187.\n\nMapping the entire structure isn't actually necessary, as we don't ever\nneed more than one entry header mapped at once.\n\nChanges efi_mokvar_table_init() to only map each entry header, not the\nentire table, when determining the table size.  Since we're not mapping\nany data past the variable name, it also changes the code to enforce\nthat each variable name is NUL terminated, rather than attempting to\nverify it in place."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: efi: No asigne toda la tabla mokvar para determinar su tama\u00f1o Actualmente, al validar la tabla mokvar, (re)asignamos la tabla completa en cada iteraci\u00f3n del bucle, agregando espacio a medida que descubrimos nuevas entradas. Si la tabla crece por encima de cierto tama\u00f1o, esto falla debido a las limitaciones de early_memmap(), y obtenemos un error y seguimiento: ------------[ cortar aqu\u00ed ]------------ ADVERTENCIA: CPU: 0 PID: 0 en mm/early_ioremap.c:139 __early_ioremap+0xef/0x220 ... Seguimiento de llamada:  ? __early_ioremap+0xef/0x220 ? __warn.cold+0x93/0xfa ? __early_ioremap+0xef/0x220 ? report_bug+0xff/0x140 ? early_fixup_exception+0x5d/0xb0 ? early_idt_handler_common+0x2f/0x3a ? __early_ioremap+0xef/0x220 ? efi_mokvar_table_init+0xce/0x1d0 ? setup_arch+0x864/0xc10 ? start_kernel+0x6b/0xa10 ? x86_64_start_reservations+0x24/0x30 ? x86_64_start_kernel+0xed/0xf0 ? common_startup_64+0x13e/0x141  ---[ fin del seguimiento 0000000000000000 ]--- mokvar: Error al asignar la tabla de configuraci\u00f3n EFI MOKvar pa=0x7c4c3000, tama\u00f1o=265187. No es necesario asignar toda la estructura, ya que no necesitamos asignar m\u00e1s de un encabezado de entrada a la vez. Se modifica efi_mokvar_table_init() para que solo asigne cada encabezado de entrada, no toda la tabla, al determinar el tama\u00f1o de la tabla. Dado que no se asignan datos m\u00e1s all\u00e1 del nombre de la variable, tambi\u00e9n se modifica el c\u00f3digo para que cada nombre de variable termine en NUL, en lugar de intentar verificarlo en su lugar."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/2b90e7ace79774a3540ce569e000388f8d22c9e0", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/46c0454ffb78ce9d3355a3cccac86383ea8ddd55", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/65f4aebb8127708ba668dd938e83b8558abfc5cd", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/97bd560b6cc4c26386a53b4881bf03e96f9ba03a", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ea3f0b362dfe4ef885ef812bfaf4088176422c91", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}