{"publishedDate": "2025-04-16T15:16Z", "lastModifiedDate": "2025-04-17T20:22Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-23135", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nRISC-V: KVM: Teardown riscv specific bits after kvm_exit\n\nDuring a module removal, kvm_exit invokes arch specific disable\ncall which disables AIA. However, we invoke aia_exit before kvm_exit\nresulting in the following warning. KVM kernel module can't be inserted\nafterwards due to inconsistent state of IRQ.\n\n[25469.031389] percpu IRQ 31 still enabled on CPU0!\n[25469.031732] WARNING: CPU: 3 PID: 943 at kernel/irq/manage.c:2476 __free_percpu_irq+0xa2/0x150\n[25469.031804] Modules linked in: kvm(-)\n[25469.031848] CPU: 3 UID: 0 PID: 943 Comm: rmmod Not tainted 6.14.0-rc5-06947-g91c763118f47-dirty #2\n[25469.031905] Hardware name: riscv-virtio,qemu (DT)\n[25469.031928] epc : __free_percpu_irq+0xa2/0x150\n[25469.031976]  ra : __free_percpu_irq+0xa2/0x150\n[25469.032197] epc : ffffffff8007db1e ra : ffffffff8007db1e sp : ff2000000088bd50\n[25469.032241]  gp : ffffffff8131cef8 tp : ff60000080b96400 t0 : ff2000000088baf8\n[25469.032285]  t1 : fffffffffffffffc t2 : 5249207570637265 s0 : ff2000000088bd90\n[25469.032329]  s1 : ff60000098b21080 a0 : 037d527a15eb4f00 a1 : 037d527a15eb4f00\n[25469.032372]  a2 : 0000000000000023 a3 : 0000000000000001 a4 : ffffffff8122dbf8\n[25469.032410]  a5 : 0000000000000fff a6 : 0000000000000000 a7 : ffffffff8122dc10\n[25469.032448]  s2 : ff60000080c22eb0 s3 : 0000000200000022 s4 : 000000000000001f\n[25469.032488]  s5 : ff60000080c22e00 s6 : ffffffff80c351c0 s7 : 0000000000000000\n[25469.032582]  s8 : 0000000000000003 s9 : 000055556b7fb490 s10: 00007ffff0e12fa0\n[25469.032621]  s11: 00007ffff0e13e9a t3 : ffffffff81354ac7 t4 : ffffffff81354ac7\n[25469.032664]  t5 : ffffffff81354ac8 t6 : ffffffff81354ac7\n[25469.032698] status: 0000000200000100 badaddr: ffffffff8007db1e cause: 0000000000000003\n[25469.032738] [<ffffffff8007db1e>] __free_percpu_irq+0xa2/0x150\n[25469.032797] [<ffffffff8007dbfc>] free_percpu_irq+0x30/0x5e\n[25469.032856] [<ffffffff013a57dc>] kvm_riscv_aia_exit+0x40/0x42 [kvm]\n[25469.033947] [<ffffffff013b4e82>] cleanup_module+0x10/0x32 [kvm]\n[25469.035300] [<ffffffff8009b150>] __riscv_sys_delete_module+0x18e/0x1fc\n[25469.035374] [<ffffffff8000c1ca>] syscall_handler+0x3a/0x46\n[25469.035456] [<ffffffff809ec9a4>] do_trap_ecall_u+0x72/0x134\n[25469.035536] [<ffffffff809f5e18>] handle_exception+0x148/0x156\n\nInvoke aia_exit and other arch specific cleanup functions after kvm_exit\nso that disable gets a chance to be called first before exit."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: RISC-V: KVM: Desmontaje de bits espec\u00edficos de RISCV despu\u00e9s de kvm_exit. Durante la eliminaci\u00f3n de un m\u00f3dulo, kvm_exit invoca una llamada de desactivaci\u00f3n espec\u00edfica de la arquitectura, que deshabilita AIA. Sin embargo, al invocar aia_exit antes de kvm_exit, se genera la siguiente advertencia. El m\u00f3dulo del kernel KVM no se puede insertar posteriormente debido a un estado inconsistente de IRQ. [25469.031389] \u00a1IRQ 31 por CPU sigue habilitado en CPU0! [25469.031732] ADVERTENCIA: CPU: 3 PID: 943 en kernel/irq/manage.c:2476 __free_percpu_irq+0xa2/0x150 [25469.031804] M\u00f3dulos vinculados: kvm(-) [25469.031848] CPU: 3 UID: 0 PID: 943 Comm: rmmod No contaminado 6.14.0-rc5-06947-g91c763118f47-dirty #2 [25469.031905] Nombre del hardware: riscv-virtio,qemu (DT) [25469.031928] epc : __free_percpu_irq+0xa2/0x150 [25469.031976] ra : __free_percpu_irq+0xa2/0x150 [25469.032197] epc : ffffffff8007db1e ra : ffffffff8007db1e sp : ff2000000088bd50 [25469.032241] gp : ffffffff8131cef8 tp : ff60000080b96400 t0 : ff2000000088baf8 [25469.032285] t1 : fffffffffffffffc t2 : 5249207570637265 s0 : ff2000000088bd90 [25469.032329] s1: ff60000098b21080 a0: 037d527a15eb4f00 a1: 037d527a15eb4f00 [25469.032372] a2: 0000000000000023 a3: 0000000000000001 a4 : ffffffff8122dbf8 [25469.032410] a5 : 0000000000000fff a6 : 00000000000000000 a7 : ffffffff8122dc10 [25469.032448] s2 : ff60000080c22eb0 s3: 0000000200000022 s4: 000000000000001f [25469.032488] s5: ff60000080c22e00 s6: ffffffff80c351c0 s7: 0000000000000000 [25469.032582] s8: 0000000000000003 s9: 000055556b7fb490 s10: 00007ffff0e12fa0 [25469.032621] s11: 00007ffff0e13e9a t3: ffffffff81354ac7 t4: ffffffff81354ac7 [25469.032664] t5: ffffffff81354ac8 t6: ffffffff81354ac7 [25469.032698] estado: 0000000200000100 direcci\u00f3n incorrecta: ffffffff8007db1e causa: 0000000000000003 [25469.032738] [] __free_percpu_irq+0xa2/0x150 [25469.032797] [] free_percpu_irq+0x30/0x5e [25469.032856] [] kvm_riscv_aia_exit+0x40/0x42 [kvm] [25469.033947] [] m\u00f3dulo_limpieza+0x10/0x32 [kvm] [25469.035300] [] __riscv_sys_delete_module+0x18e/0x1fc [25469.035374] [] controlador_de_llamadas_al_sistema+0x3a/0x46 [25469.035456] [] do_trap_ecall_u+0x72/0x134 [25469.035536] [] handle_exception+0x148/0x156 Invoca aia_exit y otras funciones de limpieza espec\u00edficas de la arquitectura despu\u00e9s de kvm_exit para que deshabilitar tenga la oportunidad de ser llamado primero antes de salir."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/1521cc04f0b6e737ff30105aa57fa9dde8493231", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/1edb2de48616b11ee05e9a65d74c70abcb6d9939", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/2d117e67f318303f6ab699a5511d1fac3f170545", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}