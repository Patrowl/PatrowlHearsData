{"publishedDate": "2025-06-03T12:59Z", "lastModifiedDate": "2025-06-05T14:01Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "5.1", "CVE_data_meta": {"ID": "CVE-2025-4138", "ASSIGNER": "PSF"}, "description": {"description_data": [{"lang": "en", "supportingMedia": [{"base64": false, "type": "text/html", "value": "<p><span style=\"background-color: rgb(255, 255, 255);\">Allows the extraction filter to be ignored, allowing symlink targets to point outside the destination directory, and the modification of some file metadata.</span><br></p><p>You are affected by this vulnerability if using the <code>tarfile</code>&nbsp;module to extract untrusted tar archives using <code>TarFile.extractall()</code>&nbsp;or <code>TarFile.extract()</code>&nbsp;using the <code>filter=</code>&nbsp;parameter with a value of <code>\"data\"</code>&nbsp;or <code>\"tar\"</code>. See the tarfile <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.python.org/3/library/tarfile.html#tarfile-extraction-filter\">extraction filters documentation</a>&nbsp;for more information.</p><p><span style=\"background-color: var(--wht);\">Note that for Python 3.14 or later the default value of </span><code>filter=</code><span style=\"background-color: var(--wht);\">&nbsp;changed from \"no filtering\" to `\"data\", so if you are relying on this new default behavior then your usage is also affected.</span></p><p>Note that none of these vulnerabilities significantly affect the installation of source distributions which are tar archives as source distributions already allow arbitrary code execution during the build process. However when evaluating source distributions it's important to avoid installing source distributions with suspicious links.<br></p>"}], "value": "Allows the extraction filter to be ignored, allowing symlink targets to point outside the destination directory, and the modification of some file metadata.\n\n\nYou are affected by this vulnerability if using the tarfile\u00a0module to extract untrusted tar archives using TarFile.extractall()\u00a0or TarFile.extract()\u00a0using the filter=\u00a0parameter with a value of \"data\"\u00a0or \"tar\". See the tarfile  extraction filters documentation https://docs.python.org/3/library/tarfile.html#tarfile-extraction-filter \u00a0for more information.\n\nNote that for Python 3.14 or later the default value of filter=\u00a0changed from \"no filtering\" to `\"data\", so if you are relying on this new default behavior then your usage is also affected.\n\nNote that none of these vulnerabilities significantly affect the installation of source distributions which are tar archives as source distributions already allow arbitrary code execution during the build process. However when evaluating source distributions it's important to avoid installing source distributions with suspicious links."}]}, "references": {"reference_data": [{"tags": ["issue-tracking"], "url": "https://github.com/python/cpython/issues/135034"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/pull/135037"}, {"tags": ["vendor-advisory"], "url": "https://mail.python.org/archives/list/security-announce@python.org/thread/MAXIJJCUUMCL7ATZNDVEGGHUMQMUUKLG/"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/3612d8f51741b11f36f8fb0494d79086bac9390a"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/9e0ac76d96cf80b49055f6d6b9a6763fb9215c2a"}, {"tags": ["mitigation"], "url": "https://gist.github.com/sethmlarson/52398e33eff261329a0180ac1d54f42f"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/19de092debb3d7e832e5672cc2f7b788d35951da"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/aa9eb5f757ceff461e6e996f12c89e5d9b583b01"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/28463dba112af719df1e8b0391c46787ad756dd9"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/4633f3f497b1ff70e4a35b6fe2c907cbe2d4cb2e"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/9c1110ef6652687d7c55f590f909720eddde965a"}, {"tags": ["patch"], "url": "https://github.com/python/cpython/commit/dd8f187d0746da151e0025c51680979ac5b4cfb1"}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-22"}]}]}}, "impact": {"baseMetricV3": {"cvssV3": {"cvssV3_1": {"attackComplexity": "LOW", "attackVector": "NETWORK", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "privilegesRequired": "NONE", "scope": "UNCHANGED", "userInteraction": "NONE", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "version": "3.1"}, "format": "CVSS", "scenarios": [{"lang": "en", "value": "GENERAL"}]}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.12.11:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.13.4:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.14.0:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.9.23:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.11.13:*:*:*:*:*:*:*", "cpe_name": []}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:python software foundation:cpython:3.10.18:*:*:*:*:*:*:*", "cpe_name": []}]}]}}