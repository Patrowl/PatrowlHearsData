{"publishedDate": "2025-07-11T17:15Z", "lastModifiedDate": "2025-07-15T13:14Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-43856", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "immich is a high performance self-hosted photo and video management solution. Prior to 1.132.0, immich is vulnerable to account hijacking through oauth2, because the state parameter is not being checked. The oauth2 state parameter is similar to a csrf token, so when the user starts the login flow this unpredictable token is generated and somehow saved in the browser session and passed to the identity provider, which will return the state parameter when redirecting the user back to immich. Before the user is logged in that parameter needs to be verified to make sure the login was actively initiated by the user in this browser session. On it's own, this wouldn't be too bad, but when immich uses the /user-settings page as a redirect_uri, it will automatically link the accounts if the user was already logged in. This means that if someone has an immich instance with a public oauth provider (like google), an attacker can - for example - embed a hidden iframe in a webpage or even just send the victim a forged oauth login url with a code that logs the victim into the attackers oauth account and redirects back to immich and links the accounts. After this, the attacker can log into the victims account using their own oauth credentials. This vulnerability is fixed in 1.132.0."}, {"lang": "es", "value": "immich es una soluci\u00f3n de gesti\u00f3n de fotos y v\u00eddeos autoalojada de alto rendimiento. En versiones anteriores a la versi\u00f3n 1.132.0, immich era vulnerable al secuestro de cuentas mediante OAuth2, ya que no se verificaba el par\u00e1metro de estado. Este par\u00e1metro de estado de OAuth2 es similar a un token CSRF; por lo tanto, cuando el usuario inicia el flujo de inicio de sesi\u00f3n, se genera este token impredecible, que se guarda de alguna manera en la sesi\u00f3n del navegador y se transmite al proveedor de identidad, que devolver\u00e1 el par\u00e1metro de estado al redirigir al usuario de vuelta a immich. Antes de que el usuario inicie sesi\u00f3n, es necesario verificar dicho par\u00e1metro para garantizar que el usuario inici\u00f3 el inicio de sesi\u00f3n activamente en esta sesi\u00f3n del navegador. Por s\u00ed solo, esto no ser\u00eda tan grave, pero cuando immich usa la p\u00e1gina /user-settings como redirect_uri, vincular\u00e1 autom\u00e1ticamente las cuentas si el usuario ya ha iniciado sesi\u00f3n. Esto significa que si alguien tiene una instancia de immich con un proveedor p\u00fablico de OAuth (como Google), un atacante puede, por ejemplo, incrustar un iframe oculto en una p\u00e1gina web o incluso enviar a la v\u00edctima una URL de inicio de sesi\u00f3n de OAuth falsificada con un c\u00f3digo que inicia sesi\u00f3n en la cuenta de OAuth del atacante, redirige a immich y vincula las cuentas. Despu\u00e9s, el atacante puede iniciar sesi\u00f3n en la cuenta de la v\u00edctima con sus propias credenciales de OAuth. Esta vulnerabilidad est\u00e1 corregida en la versi\u00f3n 1.132.0."}]}, "references": {"reference_data": [{"url": "https://github.com/immich-app/immich/security/advisories/GHSA-3832-6r8h-9cfm", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-303"}]}]}}, "impact": {"baseMetricV4": {"cvssV4": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "baseScore": 7.3, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "PRESENT", "privilegesRequired": "LOW", "userInteraction": "ACTIVE", "vulnConfidentialityImpact": "HIGH", "vulnIntegrityImpact": "HIGH", "vulnAvailabilityImpact": "HIGH", "subConfidentialityImpact": "NONE", "subIntegrityImpact": "NONE", "subAvailabilityImpact": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirement": "NOT_DEFINED", "integrityRequirement": "NOT_DEFINED", "availabilityRequirement": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnConfidentialityImpact": "NOT_DEFINED", "modifiedVulnIntegrityImpact": "NOT_DEFINED", "modifiedVulnAvailabilityImpact": "NOT_DEFINED", "modifiedSubConfidentialityImpact": "NOT_DEFINED", "modifiedSubIntegrityImpact": "NOT_DEFINED", "modifiedSubAvailabilityImpact": "NOT_DEFINED", "Safety": "NOT_DEFINED", "Automatable": "NOT_DEFINED", "Recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}