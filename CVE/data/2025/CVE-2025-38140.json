{"publishedDate": "2025-07-03T09:15Z", "lastModifiedDate": "2025-07-03T15:13Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2025-38140", "ASSIGNER": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, "description": {"description_data": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm: limit swapping tables for devices with zone write plugs\n\ndm_revalidate_zones() only allowed new or previously unzoned devices to\ncall blk_revalidate_disk_zones(). If the device was already zoned,\ndisk->nr_zones would always equal md->nr_zones, so dm_revalidate_zones()\nreturned without doing any work. This would make the zoned settings for\nthe device not match the new table. If the device had zone write plug\nresources, it could run into errors like bdev_zone_is_seq() reading\ninvalid memory because disk->conv_zones_bitmap was the wrong size.\n\nIf the device doesn't have any zone write plug resources, calling\nblk_revalidate_disk_zones() will always correctly update device.  If\nblk_revalidate_disk_zones() fails, it can still overwrite or clear the\ncurrent disk->nr_zones value. In this case, DM must restore the previous\nvalue of disk->nr_zones, so that the zoned settings will continue to\nmatch the previous value that it fell back to.\n\nIf the device already has zone write plug resources,\nblk_revalidate_disk_zones() will not correctly update them, if it is\ncalled for arbitrary zoned device changes.  Since there is not much need\nfor this ability, the easiest solution is to disallow any table reloads\nthat change the zoned settings, for devices that already have zone plug\nresources.  Specifically, if a device already has zone plug resources\nallocated, it can only switch to another zoned table that also emulates\nzone append.  Also, it cannot change the device size or the zone size. A\ndevice can switch to an error target."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: dm: limitar el intercambio de tablas para dispositivos con conectores de escritura de zona. dm_revalidate_zones() solo permit\u00eda que los dispositivos nuevos o previamente no zonificados llamaran a blk_revalidate_disk_zones(). Si el dispositivo ya estaba zonificado, disk-&gt;nr_zones siempre ser\u00eda igual a md-&gt;nr_zones, por lo que dm_revalidate_zones() regresaba sin realizar ning\u00fan trabajo. Esto har\u00eda que la configuraci\u00f3n zonificada para el dispositivo no coincidiera con la nueva tabla. Si el dispositivo ten\u00eda recursos de conector de escritura de zona, podr\u00eda encontrarse con errores como bdev_zone_is_seq() leyendo memoria no v\u00e1lida porque disk-&gt;conv_zones_bitmap ten\u00eda un tama\u00f1o incorrecto. Si el dispositivo no tiene ning\u00fan recurso de conector de escritura de zona, llamar a blk_revalidate_disk_zones() siempre actualizar\u00e1 correctamente el dispositivo. Si blk_revalidate_disk_zones() falla, a\u00fan puede sobrescribir o borrar el valor actual de disk-&gt;nr_zones. En este caso, DM debe restaurar el valor anterior de disk-&gt;nr_zones para que la configuraci\u00f3n de zonas siga siendo la misma que la anterior. Si el dispositivo ya cuenta con recursos de complemento de escritura de zona, blk_revalidate_disk_zones() no los actualizar\u00e1 correctamente si se le solicita para realizar cambios arbitrarios en el dispositivo de zona. Dado que esta funci\u00f3n no es muy necesaria, la soluci\u00f3n m\u00e1s sencilla es impedir cualquier recarga de tabla que modifique la configuraci\u00f3n de zonas en los dispositivos que ya cuentan con recursos de complemento de zona. En concreto, si un dispositivo ya tiene asignados recursos de complemento de zona, solo puede cambiar a otra tabla de zonas que tambi\u00e9n emule la anexi\u00f3n de zona. Adem\u00e1s, no puede cambiar el tama\u00f1o del dispositivo ni el de la zona. Un dispositivo puede cambiar a un destino de error."}]}, "references": {"reference_data": [{"url": "https://git.kernel.org/stable/c/121218bef4c1df165181f5cd8fc3a2246bac817e", "name": "", "refsource": "", "tags": []}, {"url": "https://git.kernel.org/stable/c/ac8acb0bfd98a1c65f3ca9a3e217a766124eebd8", "name": "", "refsource": "", "tags": []}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}]}}, "impact": {}, "configurations": {"CVE_data_version": "4.0", "nodes": []}}