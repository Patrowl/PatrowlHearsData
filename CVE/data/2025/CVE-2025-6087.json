{"publishedDate": "2025-06-16T18:30Z", "lastModifiedDate": "2025-06-16T18:55Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "5.1", "CVE_data_meta": {"ID": "CVE-2025-6087", "ASSIGNER": "cloudflare"}, "description": {"description_data": [{"lang": "en", "supportingMedia": [{"base64": false, "type": "text/html", "value": "<p><span style=\"background-color: transparent;\">A Server-Side Request Forgery (SSRF) vulnerability was identified in the </span><span style=\"background-color: transparent;\">@opennextjs/cloudflare</span><span style=\"background-color: transparent;\"> package. The vulnerability stems from an unimplemented feature in the Cloudflare adapter for Open Next, which allowed unauthenticated users to proxy arbitrary remote content via the </span><span style=\"background-color: transparent;\">/_next/image</span><span style=\"background-color: transparent;\"> endpoint.</span></p><p><span style=\"background-color: transparent;\">This issue allowed attackers to load remote resources from arbitrary hosts under the victim site\u2019s domain for any site deployed using the Cloudflare adapter for Open Next.&nbsp;</span></p><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\">For example:</span></p><p><span style=\"background-color: transparent;\"><i><a target=\"_blank\" rel=\"nofollow\" href=\"https://victim-site.com/_next/image?url=https://attacker.com\">https://victim-site.com/_next/image?url=https://attacker.com</a></i></span></p><p><span style=\"background-color: transparent;\">In this example, attacker-controlled content from attacker.com is served through the victim site\u2019s domain (victim-site.com), violating the same-origin policy and potentially misleading users or other services.</span></p><b><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\">Impact:</span></p></b><ul><li><p><span style=\"background-color: transparent;\">SSRF via unrestricted remote URL loading</span></p></li></ul><ul><li><p><span style=\"background-color: transparent;\">Arbitrary remote content loading</span></p></li></ul><ul><li><p><span style=\"background-color: transparent;\">Potential internal service exposure or phishing risks through domain abuse</span></p></li></ul><b><p><br></p><p><span style=\"background-color: transparent;\">Mitigation:</span></p></b><p><span style=\"background-color: transparent;\">The following mitigations have been put in place:</span></p><ul><li><p><span style=\"background-color: transparent;\">Server side updates to Cloudflare\u2019s platform to restrict the content loaded via the&nbsp;</span><span style=\"background-color: transparent;\">/_next/image&nbsp;</span><span style=\"background-color: transparent;\">endpoint to images. The update automatically mitigates the issue for all existing and any future sites deployed to Cloudflare using the affected version of the Cloudflare adapter for Open Next</span></p></li></ul><ul><li><p><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/opennextjs/opennextjs-cloudflare/pull/727\"><span style=\"background-color: transparent;\">Root cause fix</span></a>&nbsp;<span style=\"background-color: transparent;\">to the Cloudflare adapter for Open Next. The patched version of the adapter is found here&nbsp;</span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.npmjs.com/package/@opennextjs/cloudflare/v/1.3.0\"><span style=\"background-color: transparent;\">@opennextjs/cloudflare@1.3.0</span></a></p></li><li><p><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/workers-sdk/pull/9608\"><span style=\"background-color: transparent;\">Package dependency update</span></a>&nbsp;<span style=\"background-color: transparent;\">to create-cloudflare (c3) to use the fixed version of the Cloudflare adapter for Open Next. The patched version of create-cloudflare is found here:&nbsp;</span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.npmjs.com/package/create-cloudflare/v/2.49.3\"><span style=\"background-color: transparent;\">create-cloudflare@2.49.3</span></a></p></li></ul><span style=\"background-color: transparent;\">In addition to the automatic mitigation deployed on Cloudflare\u2019s platform, we encourage affected  users to upgrade to @opennext/cloudflare v1.3.0 and use the </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://nextjs.org/docs/pages/api-reference/components/image#remotepatterns\"><span style=\"background-color: transparent;\">remotePatterns </span></a><a target=\"_blank\" rel=\"nofollow\" href=\"https://nextjs.org/docs/pages/api-reference/components/image#remotepatterns\"><span style=\"background-color: transparent;\">filter in Next config</span></a><span style=\"background-color: transparent;\"> if they need to allow-list external urls with images assets.</span><br>"}], "value": "A Server-Side Request Forgery (SSRF) vulnerability was identified in the @opennextjs/cloudflare package. The vulnerability stems from an unimplemented feature in the Cloudflare adapter for Open Next, which allowed unauthenticated users to proxy arbitrary remote content via the /_next/image endpoint.\n\nThis issue allowed attackers to load remote resources from arbitrary hosts under the victim site\u2019s domain for any site deployed using the Cloudflare adapter for Open Next.\u00a0\n\n\n\n\nFor example:\n\n https://victim-site.com/_next/image?url=https://attacker.com \n\nIn this example, attacker-controlled content from attacker.com is served through the victim site\u2019s domain (victim-site.com), violating the same-origin policy and potentially misleading users or other services.\n\n\n\n\nImpact:\n\n  *  SSRF via unrestricted remote URL loading\n\n\n\n\n  *  Arbitrary remote content loading\n\n\n\n\n  *  Potential internal service exposure or phishing risks through domain abuse\n\n\n\n\n\n\n\nMitigation:\n\nThe following mitigations have been put in place:\n\n  *  Server side updates to Cloudflare\u2019s platform to restrict the content loaded via the\u00a0/_next/image\u00a0endpoint to images. The update automatically mitigates the issue for all existing and any future sites deployed to Cloudflare using the affected version of the Cloudflare adapter for Open Next\n\n\n\n\n  *   Root cause fix https://github.com/opennextjs/opennextjs-cloudflare/pull/727 \u00a0to the Cloudflare adapter for Open Next. The patched version of the adapter is found here\u00a0 @opennextjs/cloudflare@1.3.0 https://www.npmjs.com/package/@opennextjs/cloudflare/v/1.3.0 \n\n\n  *   Package dependency update https://github.com/cloudflare/workers-sdk/pull/9608 \u00a0to create-cloudflare (c3) to use the fixed version of the Cloudflare adapter for Open Next. The patched version of create-cloudflare is found here:\u00a0 create-cloudflare@2.49.3 https://www.npmjs.com/package/create-cloudflare/v/2.49.3 \n\n\n\n\nIn addition to the automatic mitigation deployed on Cloudflare\u2019s platform, we encourage affected  users to upgrade to @opennext/cloudflare v1.3.0 and use the  remotePatterns  https://nextjs.org/docs/pages/api-reference/components/image#remotepatterns  filter in Next config https://nextjs.org/docs/pages/api-reference/components/image#remotepatterns  if they need to allow-list external urls with images assets."}]}, "references": {"reference_data": [{"url": "https://github.com/opennextjs/opennextjs-cloudflare"}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-918"}]}]}}, "impact": {"baseMetricV4": {"cvssV4": {"cvssV4_0": {"Automatable": "NOT_DEFINED", "Recovery": "NOT_DEFINED", "Safety": "NOT_DEFINED", "attackComplexity": "LOW", "attackRequirements": "NONE", "attackVector": "NETWORK", "baseScore": 7.8, "baseSeverity": "HIGH", "privilegesRequired": "NONE", "providerUrgency": "NOT_DEFINED", "subAvailabilityImpact": "NONE", "subConfidentialityImpact": "HIGH", "subIntegrityImpact": "LOW", "userInteraction": "NONE", "valueDensity": "NOT_DEFINED", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:H/SI:L/SA:N", "version": "4.0", "vulnAvailabilityImpact": "NONE", "vulnConfidentialityImpact": "LOW", "vulnIntegrityImpact": "LOW", "vulnerabilityResponseEffort": "NOT_DEFINED"}, "format": "CVSS", "scenarios": [{"lang": "en", "value": "GENERAL"}]}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "children": [], "cpe_match": []}]}}