{"publishedDate": "2022-11-17T22:15Z", "lastModifiedDate": "2024-11-21T07:18Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2022-39389", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Lightning Network Daemon (lnd) is an implementation of a lightning bitcoin overlay network node. All lnd nodes before version `v0.15.4` are vulnerable to a block parsing bug that can cause a node to enter a degraded state once encountered. In this degraded state, nodes can continue to make payments and forward HTLCs, and close out channels. Opening channels is prohibited, and also on chain transaction events will be undetected. This can cause loss of funds if a CSV expiry is researched during a breach attempt or a CLTV delta expires forgetting the funds in the HTLC. A patch is available in `lnd` version 0.15.4. Users are advised to upgrade. Users unable to upgrade may use the `lncli updatechanpolicy` RPC call to increase their CLTV value to a very high amount or increase their fee policies. This will prevent nodes from routing through your node, meaning that no pending HTLCs can be present."}, {"lang": "es", "value": "Lightning Network Daemon (lnd) es una implementaci\u00f3n de un nodo de red superpuesto de bitcoin rel\u00e1mpago. Todos los nodos lnd anteriores a la versi\u00f3n `v0.15.4` son vulnerables a un error de an\u00e1lisis de bloques que puede hacer que un nodo entre en un estado degradado una vez encontrado. En este estado degradado, los nodos pueden continuar realizando pagos y reenviando HTLC y cerrar canales. Est\u00e1 prohibido abrir canales y tampoco se detectar\u00e1n eventos de transacciones en cadena. Esto puede provocar la p\u00e9rdida de fondos si se investiga el vencimiento de un CSV durante un intento de infracci\u00f3n o si un delta de CLTV expira olvid\u00e1ndose de los fondos en el HTLC. Hay un parche disponible en la versi\u00f3n 0.15.4 de `lnd`. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar pueden usar la llamada RPC `lncli updatechanpolicy` para aumentar su valor CLTV a una cantidad muy alta o aumentar sus pol\u00edticas de tarifas. Esto evitar\u00e1 que los nodos se enruten a trav\u00e9s de su nodo, lo que significa que no puede haber ning\u00fan HTLC pendiente."}]}, "references": {"reference_data": [{"url": "https://github.com/lightningnetwork/lnd/issues/7096", "name": "", "refsource": "", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/pull/7098", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/issues/7096", "name": "", "refsource": "", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/pull/7098", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-20"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 2.5, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L", "baseScore": 6.5, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:btcd_project:btcd:*:*:*:*:*:*:*:*", "matchCriteriaId": "4C76213E-2BE3-4BF3-B5D1-2AA9B6BB0A95", "cpe_name": [], "versionEndExcluding": "0.23.3"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*", "matchCriteriaId": "E4F9DC3C-AC0A-472A-B74E-2966F1B7D3A9", "cpe_name": [], "versionEndExcluding": "0.15.4"}]}]}}