{"publishedDate": "2022-02-23T23:15Z", "lastModifiedDate": "2024-11-21T06:49Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2022-23653", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "B2 Command Line Tool is the official command line tool for the backblaze cloud storage service. Linux and Mac releases of the B2 command-line tool version 3.2.0 and below contain a key disclosure vulnerability that, in certain conditions, can be exploited by local attackers through a time-of-check-time-of-use (TOCTOU) race condition. The command line tool saves API keys (and bucket name-to-id mapping) in a local database file (`$XDG_CONFIG_HOME/b2/account_info`, `~/.b2_account_info` or a user-defined path) when `b2 authorize-account` is first run. This happens regardless of whether a valid key is provided or not. When first created, the file is world readable and is (typically a few milliseconds) later altered to be private to the user. If the directory is readable by a local attacker and the user did not yet run `b2 authorize-account` then during the brief period between file creation and permission modification, a local attacker can race to open the file and maintain a handle to it. This allows the local attacker to read the contents after the file after the sensitive information has been saved to it. Users that have not yet run `b2 authorize-account` should upgrade to B2 Command-Line Tool v3.2.1 before running it. Users that have run `b2 authorize-account` are safe if at the time of the file creation no other local users had read access to the local configuration file. Users that have run `b2 authorize-account` where the designated path could be opened by another local user should upgrade to B2 Command-Line Tool v3.2.1 and remove the database and regenerate all application keys. Note that `b2 clear-account` does not remove the database file and it should not be used to ensure that all open handles to the file are invalidated. If B2 Command-Line Tool cannot be upgraded to v3.2.1 due to a dependency conflict, a binary release can be used instead. Alternatively a new version could be installed within a virtualenv, or the permissions can be changed to prevent local users from opening the database file."}, {"lang": "es", "value": "B2 Command Line Tool es la herramienta oficial de l\u00ednea de comandos para el servicio de almacenamiento en la nube de Backblaze. Las versiones para Linux y Mac de la herramienta de l\u00ednea de comandos B2, versi\u00f3n 3.2.0 y anteriores, contienen una vulnerabilidad de divulgaci\u00f3n de claves que, en determinadas condiciones, puede ser explotada por atacantes locales mediante una condici\u00f3n de carrera de tiempo de comprobaci\u00f3n de uso (TOCTOU). La herramienta de l\u00ednea de comandos guarda las claves de la API (y el mapeo de nombres de cubos a identificadores) en un archivo de base de datos local (\"$XDG_CONFIG_HOME/b2/account_info\", \"~/.b2_account_info\" o una ruta definida por el usuario) cuando es ejecutado \"b2 authorize-account\" por primera vez. Esto ocurre independientemente de si es proporcionada una clave v\u00e1lida o no. Cuando es creado por primera vez, el archivo es legible para todo el mundo y m\u00e1s tarde (normalmente unos milisegundos) es alterada para que sea privado para el usuario. Si el directorio es legible por un atacante local y el usuario a\u00fan no ha ejecutado \"b2 authorize-account\", entonces durante el breve per\u00edodo entre la creaci\u00f3n del archivo y la modificaci\u00f3n del permiso, un atacante local puede correr para abrir el archivo y mantener un manejo del mismo. Esto permite al atacante local leer el contenido despu\u00e9s del archivo una vez que la informaci\u00f3n confidencial ha sido guardada en \u00e9l. Los usuarios que a\u00fan no hayan ejecutado \"b2 authorize-account\" deber\u00edan actualizar a B2 Command Line Tool versi\u00f3n v3.2.1 antes de ejecutarla. Los usuarios que han ejecutado \"b2 authorize-account\" est\u00e1n seguros si en el momento de la creaci\u00f3n del archivo ning\u00fan otro usuario local ten\u00eda acceso de lectura al archivo de configuraci\u00f3n local. Los usuarios que hayan ejecutado \"b2 authorize-account\" cuando la ruta designada pueda ser abierta por otro usuario local deben actualizar a B2 Command-Line Tool versi\u00f3n v3.2.1 y eliminar la base de datos y regenerar todas las claves de aplicaci\u00f3n. Tenga en cuenta que \"b2 clear-account\" no elimina el archivo de la base de datos y no debe usarse para asegurar que todos los manejadores abiertos al archivo sean invalidados. Si la herramienta de l\u00ednea de comandos B2 no puede actualizarse a versi\u00f3n 3.2.1 debido a un conflicto de dependencias, puede usarse una versi\u00f3n binaria en su lugar. Tambi\u00e9n puede instalarse una nueva versi\u00f3n dentro de un virtualenv, o pueden cambiarse los permisos para evitar que usuarios locales abran el archivo de la base de datos"}]}, "references": {"reference_data": [{"url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Backblaze/B2_Command_Line_Tool/security/advisories/GHSA-8wr4-2wm6-w3pr", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Backblaze/B2_Command_Line_Tool/security/advisories/GHSA-8wr4-2wm6-w3pr", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-367"}]}]}}, "impact": {"baseMetricV2": {"cvssV2": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "baseScore": 1.9, "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE"}, "exploitabilityScore": 3.4, "impactScore": 2.9, "severity": "LOW", "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "baseMetricV3": {"exploitabilityScore": 1.0, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "baseScore": 4.7, "baseSeverity": "MEDIUM", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:linux:*:*", "matchCriteriaId": "8C0E07A2-B0E4-4CB3-8A51-52A48CA903A7", "cpe_name": [], "versionEndIncluding": "3.2.0"}, {"vulnerable": true, "cpe23Uri": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:mac:*:*", "matchCriteriaId": "D48B24B7-6F45-48AD-BE6D-704C7FEDAE03", "cpe_name": [], "versionEndIncluding": "3.2.0"}]}]}}