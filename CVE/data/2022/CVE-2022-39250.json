{"publishedDate": "2022-09-29T13:15Z", "lastModifiedDate": "2024-11-21T07:17Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2022-39250", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "Matrix JavaScript SDK is the Matrix Client-Server software development kit (SDK) for JavaScript. Prior to version 19.7.0, an attacker cooperating with a malicious homeserver could interfere with the verification flow between two users, injecting its own cross-signing user identity in place of one of the users\u2019 identities. This would lead to the other device trusting/verifying the user identity under the control of the homeserver instead of the intended one. The vulnerability is a bug in the matrix-js-sdk, caused by checking and signing user identities and devices in two separate steps, and inadequately fixing the keys to be signed between those steps. Even though the attack is partly made possible due to the design decision of treating cross-signing user identities as Matrix devices on the server side (with their device ID set to the public part of the user identity key), no other examined implementations were vulnerable. Starting with version 19.7.0, the matrix-js-sdk has been modified to double check that the key signed is the one that was verified instead of just referencing the key by ID. An additional check has been made to report an error when one of the device ID matches a cross-signing key. As this attack requires coordination between a malicious homeserver and an attacker, those who trust their homeservers do not need a particular workaround."}, {"lang": "es", "value": "Matrix JavaScript SDK es el kit de desarrollo de software (SDK) cliente-servidor de Matrix para JavaScript. En versiones anteriores a 19.7.0, un atacante que cooperara con un servidor dom\u00e9stico malicioso podr\u00eda interferir con el flujo de verificaci\u00f3n entre dos usuarios, inyectando su propia identidad de usuario de firma cruzada en lugar de la identidad de uno de los usuarios. Esto conllevar\u00eda a que el otro dispositivo confiara/verificara la identidad del usuario bajo el control del servidor dom\u00e9stico en lugar de la prevista. La vulnerabilidad es un bug en el matrix-js-sdk, causado por la comprobaci\u00f3n y firma de las identidades de los usuarios y los dispositivos en dos pasos separados, y la fijaci\u00f3n inapropiada de las claves a firmar entre esos pasos. Aunque el ataque es posible en parte debido a la decisi\u00f3n de dise\u00f1o de tratar las identidades de usuario de firma cruzada como dispositivos de Matrix en el lado del servidor (con su ID de dispositivo establecido en la parte p\u00fablica de la clave de identidad del usuario), ninguna otra implementaci\u00f3n examinada era vulnerable. A partir de la versi\u00f3n 19.7.0, el matrix-js-sdk ha sido modificado para comprobar dos veces que la clave firmada es la que ha sido verificada en lugar de hacer referencia a la clave por su ID. Ha sido realizada una comprobaci\u00f3n adicional para informar de un error cuando uno de los ID del dispositivo coincide con una clave de firma cruzada. Como este ataque requiere la coordinaci\u00f3n entre un servidor dom\u00e9stico malicioso y un atacante, quienes conf\u00edan en sus servidores dom\u00e9sticos no necesitan una mitigaci\u00f3n particular"}]}, "references": {"reference_data": [{"url": "https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://security.gentoo.org/glsa/202210-35", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76", "name": "", "refsource": "", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0", "name": "", "refsource": "", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}, {"url": "https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients", "name": "", "refsource": "", "tags": ["Vendor Advisory"]}, {"url": "https://security.gentoo.org/glsa/202210-35", "name": "", "refsource": "", "tags": ["Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-287"}, {"lang": "en", "value": "CWE-322"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 3.9, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "baseScore": 7.5, "baseSeverity": "HIGH", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:node.js:*:*", "matchCriteriaId": "4755C737-8BCE-49AF-8D23-CD3D36F9EDA7", "cpe_name": [], "versionEndExcluding": "19.7.0"}]}]}}