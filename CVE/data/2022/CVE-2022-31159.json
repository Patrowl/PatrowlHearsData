{"publishedDate": "2022-07-15T18:15Z", "lastModifiedDate": "2024-11-21T07:04Z", "cve": {"data_type": "CVE", "data_format": "MITRE", "data_version": "1.0", "CVE_data_meta": {"ID": "CVE-2022-31159", "ASSIGNER": "security-advisories@github.com"}, "description": {"description_data": [{"lang": "en", "value": "The AWS SDK for Java enables Java developers to work with Amazon Web Services. A partial-path traversal issue exists within the `downloadDirectory` method in the AWS S3 TransferManager component of the AWS SDK for Java v1 prior to version 1.12.261. Applications using the SDK control the `destinationDirectory` argument, but S3 object keys are determined by the application that uploaded the objects. The `downloadDirectory` method allows the caller to pass a filesystem object in the object key but contained an issue in the validation logic for the key name. A knowledgeable actor could bypass the validation logic by including a UNIX double-dot in the bucket key. Under certain conditions, this could permit them to retrieve a directory from their S3 bucket that is one level up in the filesystem from their working directory. This issue\u2019s scope is limited to directories whose name prefix matches the destinationDirectory. E.g. for destination directory`/tmp/foo`, the actor can cause a download to `/tmp/foo-bar`, but not `/tmp/bar`. If `com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory` is used to download an untrusted buckets contents, the contents of that bucket can be written outside of the intended destination directory. Version 1.12.261 contains a patch for this issue. As a workaround, when calling `com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory`, pass a `KeyFilter` that forbids `S3ObjectSummary` objects that `getKey` method return a string containing the substring `..` ."}, {"lang": "es", "value": "El SDK de AWS para Java permite a desarrolladores de Java trabajar con Amazon Web Services. Se presenta un problema de salto de ruta parcial en el m\u00e9todo \"downloadDirectory\" del componente AWS S3 TransferManager del AWS SDK para Java v1 versiones anteriores a 1.12.261. Las aplicaciones que usan el SDK controlan el argumento \"destinationDirectory\", pero las claves de los objetos de S3 est\u00e1n determinadas por la aplicaci\u00f3n que carg\u00f3 los objetos. El m\u00e9todo \"downloadDirectory\" permite a quien lo llama pasar un objeto del sistema de archivos en la clave del objeto, pero conten\u00eda un problema en la l\u00f3gica de comprobaci\u00f3n del nombre de la clave. Un actor con conocimientos pod\u00eda omitir la l\u00f3gica de comprobaci\u00f3n incluyendo un doble punto UNIX en la clave del cubo. Bajo determinadas condiciones, esto podr\u00eda permitirles recuperar un directorio de su cubo de S3 que est\u00e1 un nivel m\u00e1s arriba en el sistema de archivos de su directorio de trabajo. El alcance de este problema es limitado a directorios cuyo prefijo de nombre coincide con el destinationDirectory. Por ejemplo, para el directorio de destino \"/tmp/foo\", el actor puede causar una descarga en \"/tmp/foo-bar\", pero no en \"/tmp/bar\". Si es usado \"com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory\" para descargar el contenido de un cubo no confiable, el contenido de ese cubo puede escribirse fuera del directorio de destino previsto. La versi\u00f3n 1.12.261 contiene un parche para este problema. Como mitigaci\u00f3n, cuando llame a \"com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory\", pase un \"KeyFilter\" que proh\u00edba los objetos \"S3ObjectSummary\" cuyo m\u00e9todo \"getKey\" devuelva una cadena que contenga la subcadena \"..\" "}]}, "references": {"reference_data": [{"url": "https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3", "name": "", "refsource": "", "tags": ["Exploit", "Third Party Advisory"]}]}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "CWE-22"}]}]}}, "impact": {"baseMetricV3": {"exploitabilityScore": 2.8, "impactScore": 3.6, "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "baseScore": 6.5, "baseSeverity": "MEDIUM", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE"}}}, "configurations": {"CVE_data_version": "4.0", "nodes": [{"operator": "OR", "negate": false, "children": [], "cpe_match": [{"vulnerable": true, "cpe23Uri": "cpe:2.3:a:amazon:aws-sdk-java:*:*:*:*:*:*:*:*", "matchCriteriaId": "0C9116AD-5423-45EA-9577-EE801EEFA4D7", "cpe_name": [], "versionEndIncluding": "1.12.260"}]}]}}