{"id": "EUVD-2022-55162", "enisaUuid": "0ed28b56-4182-3e5d-9096-dfd23798c52a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: always report error in run_one_delayed_ref()\n\nCurrently we have a btrfs_debug() for run_one_delayed_ref() failure, but\nif end users hit such problem, there will be no chance that\nbtrfs_debug() is enabled.  This can lead to very little useful info for\ndebugging.\n\nThis patch will:\n\n- Add extra info for error reporting\n  Including:\n  * logical bytenr\n  * num_bytes\n  * type\n  * action\n  * ref_mod\n\n- Replace the btrfs_debug() with btrfs_err()\n\n- Move the error reporting into run_one_delayed_ref()\n  This is to avoid use-after-free, the @node can be freed in the caller.\n\nThis error should only be triggered at most once.\n\nAs if run_one_delayed_ref() failed, we trigger the error message, then\ncausing the call chain to error out:\n\nbtrfs_run_delayed_refs()\n`- btrfs_run_delayed_refs()\n   `- btrfs_run_delayed_refs_for_head()\n      `- run_one_delayed_ref()\n\nAnd we will abort the current transaction in btrfs_run_delayed_refs().\nIf we have to run delayed refs for the abort transaction,\nrun_one_delayed_ref() will just cleanup the refs and do nothing, thus no\nnew error messages would be output.", "datePublished": "2025-03-27T16:43:07", "dateUpdated": "2025-12-23T13:25:34", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/18bd1c9c02e64a3567f90c83c2c8b855531c8098", "https://git.kernel.org/stable/c/fdb4a70bb768d2a87890409597529ad81cb3de8a", "https://git.kernel.org/stable/c/853ffa1511b058c79a4c9bb1407b3b20ce311792", "https://git.kernel.org/stable/c/39f501d68ec1ed5cd5c66ac6ec2a7131c517bb92", "https://nvd.nist.gov/vuln/detail/CVE-2022-49761"], "aliases": ["CVE-2022-49761"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "08d61bfa-1702-35f4-a504-6d748da41e6b", "product": {"name": "Linux"}, "product_version": "patch: 5.10.165"}, {"id": "0f557695-b72f-3b3b-8380-d42c0c99e53b", "product": {"name": "Linux"}, "product_version": "3.4"}, {"id": "1a06ceb7-af6b-32e7-88bf-58143556f916", "product": {"name": "Linux"}, "product_version": "patch: 6.1.8"}, {"id": "1c6d84a4-9c05-3a02-aba5-144b5213dff0", "product": {"name": "Linux"}, "product_version": "79787eaab46121d4713ed03c8fc63b9ec3eaec76 <39f501d68ec1ed5cd5c66ac6ec2a7131c517bb92"}, {"id": "319a2031-24f6-3619-8093-21e509188703", "product": {"name": "Linux"}, "product_version": "79787eaab46121d4713ed03c8fc63b9ec3eaec76 <853ffa1511b058c79a4c9bb1407b3b20ce311792"}, {"id": "6929784a-cc0c-37f4-b128-4e65e62d3e39", "product": {"name": "Linux"}, "product_version": "79787eaab46121d4713ed03c8fc63b9ec3eaec76 <18bd1c9c02e64a3567f90c83c2c8b855531c8098"}, {"id": "695d999e-69a0-3c20-acc8-4bd435e0dd4d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.90"}, {"id": "71bced9c-199a-326d-9f6e-6ed5e76161a8", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "9053d725-8c52-360c-b5dd-62177c3d918a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <853ffa1511b058c79a4c9bb1407b3b20ce311792"}, {"id": "95bece54-8bc5-3de8-8174-60fc27d7a808", "product": {"name": "Linux"}, "product_version": "79787eaab46121d4713ed03c8fc63b9ec3eaec76 <fdb4a70bb768d2a87890409597529ad81cb3de8a"}, {"id": "b0ac6337-4e36-3315-8a5b-8ca419893b29", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <18bd1c9c02e64a3567f90c83c2c8b855531c8098"}, {"id": "b7bbbc92-c45c-3d58-9dee-ea184692de31", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <39f501d68ec1ed5cd5c66ac6ec2a7131c517bb92"}, {"id": "d4d13012-86f8-3ee9-9d30-eddbeccced7a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fdb4a70bb768d2a87890409597529ad81cb3de8a"}, {"id": "f52625cd-55ad-3725-9c76-b4968d93dfb7", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "870ae5b3-0d03-3316-bf56-af8fe5c826c8", "vendor": {"name": "Linux"}}], "isExploited": false}