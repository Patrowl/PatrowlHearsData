{"id": "EUVD-2022-55541", "enisaUuid": "935d2eeb-f753-36ce-a766-dc99348d5b98", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnbd: Fix hung when signal interrupts nbd_start_device_ioctl()\n\nsyzbot reported hung task [1].  The following program is a simplified\nversion of the reproducer:\n\nint main(void)\n{\n\tint sv[2], fd;\n\n\tif (socketpair(AF_UNIX, SOCK_STREAM, 0, sv) < 0)\n\t\treturn 1;\n\tif ((fd = open(\"/dev/nbd0\", 0)) < 0)\n\t\treturn 1;\n\tif (ioctl(fd, NBD_SET_SIZE_BLOCKS, 0x81) < 0)\n\t\treturn 1;\n\tif (ioctl(fd, NBD_SET_SOCK, sv[0]) < 0)\n\t\treturn 1;\n\tif (ioctl(fd, NBD_DO_IT) < 0)\n\t\treturn 1;\n\treturn 0;\n}\n\nWhen signal interrupt nbd_start_device_ioctl() waiting the condition\natomic_read(&config->recv_threads) == 0, the task can hung because it\nwaits the completion of the inflight IOs.\n\nThis patch fixes the issue by clearing queue, not just shutdown, when\nsignal interrupt nbd_start_device_ioctl().", "datePublished": "2025-09-15T14:46:09", "dateUpdated": "2025-12-23T13:28:10", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3ba3846cb3e2fb3c6fbf79e998472821b298419e", "https://git.kernel.org/stable/c/c7b4641bd2395c2f3cd3b0a0cbf292ed9d489398", "https://git.kernel.org/stable/c/3575949513ea3b387b30dac1e69468a923c86caf", "https://git.kernel.org/stable/c/b2700f98b3f4dd19fb4315b70581e5caff89eb49", "https://git.kernel.org/stable/c/c0d73be0af8c1310713bc39a8d7a22e35084e14f", "https://git.kernel.org/stable/c/62006a72b05e0d38727eef5188700f2488be5e89", "https://git.kernel.org/stable/c/35fb7d4a53d9e36d1b91161ea9870d9c6d57dccf", "https://git.kernel.org/stable/c/1de7c3cf48fc41cd95adb12bd1ea9033a917798a", "https://nvd.nist.gov/vuln/detail/CVE-2022-50314"], "aliases": ["CVE-2022-50314"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "08c05f11-f3e8-3dab-a29a-cc60b14341b1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <62006a72b05e0d38727eef5188700f2488be5e89"}, {"id": "099d54ad-d990-3aaf-81dc-269113a645fd", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "137938c5-c233-3542-9819-5fb8f071e4aa", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <62006a72b05e0d38727eef5188700f2488be5e89"}, {"id": "1926f71d-7754-37c5-8719-f08354c5e462", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c0d73be0af8c1310713bc39a8d7a22e35084e14f"}, {"id": "31d40595-2288-3128-acf2-089e2ab895f2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3ba3846cb3e2fb3c6fbf79e998472821b298419e"}, {"id": "3c1f53e7-09b3-3108-a5a8-f48538294653", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "3d9c0a5a-5f9d-32e6-a7f9-2d22822b6068", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c7b4641bd2395c2f3cd3b0a0cbf292ed9d489398"}, {"id": "3e2dbdd2-ced3-3a3a-8d3c-139471ed8e36", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "43d03959-25d4-376a-807b-895a876e5b93", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <1de7c3cf48fc41cd95adb12bd1ea9033a917798a"}, {"id": "4656ab5e-1c69-326a-9b42-72d0093d2805", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "5fe0e0e0-4eab-3868-be61-79dace8cb9da", "product": {"name": "Linux"}, "product_version": "patch: 5.4.220"}, {"id": "6f8590a4-3a25-3c2c-9f05-f485972b65aa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b2700f98b3f4dd19fb4315b70581e5caff89eb49"}, {"id": "6febcb80-43d4-3573-ad7d-6bafa8c4e5e2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1de7c3cf48fc41cd95adb12bd1ea9033a917798a"}, {"id": "903f1bb1-2a52-3b40-ace2-4ead87acc844", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <c7b4641bd2395c2f3cd3b0a0cbf292ed9d489398"}, {"id": "a5691019-97e7-389f-ade5-2a83fac19256", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <3575949513ea3b387b30dac1e69468a923c86caf"}, {"id": "b6b87047-dafc-35e2-9ce4-f9b3a6cf21f1", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <b2700f98b3f4dd19fb4315b70581e5caff89eb49"}, {"id": "b9ceff8e-131c-30bf-9ce6-3ce1e492ddab", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <35fb7d4a53d9e36d1b91161ea9870d9c6d57dccf"}, {"id": "bb943e61-ae29-3eff-9116-188ec07ee030", "product": {"name": "Linux"}, "product_version": "patch: 4.14.296"}, {"id": "c1933f87-32a1-35d7-a4be-2d39c43d8814", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c9a6ca22-2ad2-36c7-b5e5-14413ea62176", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "d26a79ed-9c48-3edb-bb4b-4876ec6eb004", "product": {"name": "Linux"}, "product_version": "patch: 4.19.262"}, {"id": "db01f5d6-6ee3-3892-864d-18463aa678c0", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <c0d73be0af8c1310713bc39a8d7a22e35084e14f"}, {"id": "e08f7382-1a99-3a2d-a2ec-86be225815ca", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3575949513ea3b387b30dac1e69468a923c86caf"}, {"id": "e379fd58-20e1-37ab-98fa-92518e07a7e5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <35fb7d4a53d9e36d1b91161ea9870d9c6d57dccf"}, {"id": "e4ab335d-a8b5-3ce2-bb4c-77bd9367bc4e", "product": {"name": "Linux"}, "product_version": "4.12"}, {"id": "e9ac5292-524f-3616-a60e-961e2e41cebe", "product": {"name": "Linux"}, "product_version": "5ea8d10802ec4c153a6e21eebaf412e2abd29736 <3ba3846cb3e2fb3c6fbf79e998472821b298419e"}], "enisaIdVendor": [{"id": "9c22e888-abf4-333d-8556-a1907ff573f9", "vendor": {"name": "Linux"}}], "isExploited": false}