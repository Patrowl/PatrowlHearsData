{"id": "EUVD-2022-15908", "enisaUuid": "b8814843-d700-3d58-b1a1-489f51c929b4", "description": "This is a concurrency issue that can result in the wrong caller principal being returned from the session context of an EJB that is configured with a RunAs principal. In particular, the org.jboss.as.ejb3.component.EJBComponent class has an incomingRunAsIdentity field. This field is used by the org.jboss.as.ejb3.security.RunAsPrincipalInterceptor to keep track of the current identity prior to switching to a new identity created using the RunAs principal. The exploit consist that the EJBComponent#incomingRunAsIdentity field is currently just a SecurityIdentity. This means in a concurrent environment, where multiple users are repeatedly invoking an EJB that is configured with a RunAs principal, it's possible for the wrong the caller principal to be returned from EJBComponent#getCallerPrincipal. Similarly, it's also possible for EJBComponent#isCallerInRole to return the wrong value. Both of these methods rely on incomingRunAsIdentity. Affects all versions of JBoss EAP from 7.1.0 and all versions of WildFly 11+ when Elytron is enabled.", "datePublished": "2022-05-10T20:20:35", "dateUpdated": "2024-08-02T23:40:04", "baseScore": 5.3, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "references": ["https://access.redhat.com/errata/RHSA-2022:4918", "https://access.redhat.com/errata/RHSA-2022:4919", "https://access.redhat.com/errata/RHSA-2022:4922", "https://access.redhat.com/errata/RHSA-2022:6782", "https://access.redhat.com/errata/RHSA-2022:6783", "https://access.redhat.com/errata/RHSA-2022:6787", "https://access.redhat.com/errata/RHSA-2022:7409", "https://access.redhat.com/errata/RHSA-2022:7410", "https://access.redhat.com/errata/RHSA-2022:7411", "https://access.redhat.com/errata/RHSA-2022:7417", "https://bugzilla.redhat.com/show_bug.cgi?id=2060929#c0"], "aliases": ["CVE-2022-0866"], "assigner": "redhat", "epss": 0.27, "enisaIdProduct": [], "enisaIdVendor": [{"id": "c1a7d03f-f33e-3b20-ac9e-1662569d79ea", "vendor": {"name": "n/a"}}], "isExploited": false}