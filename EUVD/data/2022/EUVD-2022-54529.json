{"id": "EUVD-2022-54529", "enisaUuid": "4fdd4506-a169-3486-a7f0-9e7c5afe6b08", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nzonefs: fix zonefs_iomap_begin() for reads\n\nIf a readahead is issued to a sequential zone file with an offset\nexactly equal to the current file size, the iomap type is set to\nIOMAP_UNWRITTEN, which will prevent an IO, but the iomap length is\ncalculated as 0. This causes a WARN_ON() in iomap_iter():\n\n[17309.548939] WARNING: CPU: 3 PID: 2137 at fs/iomap/iter.c:34 iomap_iter+0x9cf/0xe80\n[...]\n[17309.650907] RIP: 0010:iomap_iter+0x9cf/0xe80\n[...]\n[17309.754560] Call Trace:\n[17309.757078]  <TASK>\n[17309.759240]  ? lock_is_held_type+0xd8/0x130\n[17309.763531]  iomap_readahead+0x1a8/0x870\n[17309.767550]  ? iomap_read_folio+0x4c0/0x4c0\n[17309.771817]  ? lockdep_hardirqs_on_prepare+0x400/0x400\n[17309.778848]  ? lock_release+0x370/0x750\n[17309.784462]  ? folio_add_lru+0x217/0x3f0\n[17309.790220]  ? reacquire_held_locks+0x4e0/0x4e0\n[17309.796543]  read_pages+0x17d/0xb60\n[17309.801854]  ? folio_add_lru+0x238/0x3f0\n[17309.807573]  ? readahead_expand+0x5f0/0x5f0\n[17309.813554]  ? policy_node+0xb5/0x140\n[17309.819018]  page_cache_ra_unbounded+0x27d/0x450\n[17309.825439]  filemap_get_pages+0x500/0x1450\n[17309.831444]  ? filemap_add_folio+0x140/0x140\n[17309.837519]  ? lock_is_held_type+0xd8/0x130\n[17309.843509]  filemap_read+0x28c/0x9f0\n[17309.848953]  ? zonefs_file_read_iter+0x1ea/0x4d0 [zonefs]\n[17309.856162]  ? trace_contention_end+0xd6/0x130\n[17309.862416]  ? __mutex_lock+0x221/0x1480\n[17309.868151]  ? zonefs_file_read_iter+0x166/0x4d0 [zonefs]\n[17309.875364]  ? filemap_get_pages+0x1450/0x1450\n[17309.881647]  ? __mutex_unlock_slowpath+0x15e/0x620\n[17309.888248]  ? wait_for_completion_io_timeout+0x20/0x20\n[17309.895231]  ? lock_is_held_type+0xd8/0x130\n[17309.901115]  ? lock_is_held_type+0xd8/0x130\n[17309.906934]  zonefs_file_read_iter+0x356/0x4d0 [zonefs]\n[17309.913750]  new_sync_read+0x2d8/0x520\n[17309.919035]  ? __x64_sys_lseek+0x1d0/0x1d0\n\nFurthermore, this causes iomap_readahead() to loop forever as\niomap_readahead_iter() always returns 0, making no progress.\n\nFix this by treating reads after the file size as access to holes,\nsetting the iomap type to IOMAP_HOLE, the iomap addr to IOMAP_NULL_ADDR\nand using the length argument as is for the iomap length. To simplify\nthe code with this change, zonefs_iomap_begin() is split into the read\nvariant, zonefs_read_iomap_begin() and zonefs_read_iomap_ops, and the\nwrite variant, zonefs_write_iomap_begin() and zonefs_write_iomap_ops.", "datePublished": "2025-10-24T18:30:57", "dateUpdated": "2025-10-24T18:30:57", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/355be6131164c5bacf2e810763835aecb6e01fcb", "https://git.kernel.org/stable/c/c2f71b9bb398e2e573bdc2574149f42b45efe410", "https://git.kernel.org/stable/c/3a7f05f104347b407e865c10be2675cd833a4e48", "https://git.kernel.org/stable/c/c1c1204c0d0c1dccc1310b9277fb2bd8b663d8fe", "https://nvd.nist.gov/vuln/detail/CVE-2022-49706"], "aliases": ["CVE-2022-49706"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "47e30370-76ee-3f53-9ad1-9c6b74f81c9b", "product": {"name": "Linux"}, "product_version": "8dcc1a9d90c10fa4143e5c17821082e5e60e46a1 <c2f71b9bb398e2e573bdc2574149f42b45efe410"}, {"id": "6ee2137f-e701-3e83-a464-24e313d21f1e", "product": {"name": "Linux"}, "product_version": "8dcc1a9d90c10fa4143e5c17821082e5e60e46a1 <355be6131164c5bacf2e810763835aecb6e01fcb"}, {"id": "7452035c-efca-3827-9ea2-5b5551358e7c", "product": {"name": "Linux"}, "product_version": "patch: 5.18.7"}, {"id": "7903f8f6-2fb3-3b81-905c-cc9629ff56ec", "product": {"name": "Linux"}, "product_version": "patch: 5.15.50"}, {"id": "8074a143-ab36-34d3-a840-2a844e1b0af1", "product": {"name": "Linux"}, "product_version": "patch: 5.10.125"}, {"id": "837a7318-4f12-35a8-9a68-9154794c5724", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "9c20ce8d-167d-3623-a9a5-7a5c07835274", "product": {"name": "Linux"}, "product_version": "8dcc1a9d90c10fa4143e5c17821082e5e60e46a1 <c1c1204c0d0c1dccc1310b9277fb2bd8b663d8fe"}, {"id": "ad606706-ba1d-3233-8ac9-1d6063ba4517", "product": {"name": "Linux"}, "product_version": "8dcc1a9d90c10fa4143e5c17821082e5e60e46a1 <3a7f05f104347b407e865c10be2675cd833a4e48"}, {"id": "e67002bc-7dfd-3648-92af-ab1ae2936576", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "fce2d6c2-fffd-3251-a213-b239e66fcab9", "product": {"name": "Linux"}, "product_version": "5.6"}], "enisaIdVendor": [{"id": "9535de99-fbad-307c-8f71-29602b4e63be", "vendor": {"name": "Linux"}}], "isExploited": false}