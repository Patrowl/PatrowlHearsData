{"id": "EUVD-2022-55511", "enisaUuid": "d6dba224-1ea6-3983-b52c-1f93a6d40c60", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nNFSD: fix use-after-free on source server when doing inter-server copy\n\nUse-after-free occurred when the laundromat tried to free expired\ncpntf_state entry on the s2s_cp_stateids list after inter-server\ncopy completed. The sc_cp_list that the expired copy state was\ninserted on was already freed.\n\nWhen COPY completes, the Linux client normally sends LOCKU(lock_state x),\nFREE_STATEID(lock_state x) and CLOSE(open_state y) to the source server.\nThe nfs4_put_stid call from nfsd4_free_stateid cleans up the copy state\nfrom the s2s_cp_stateids list before freeing the lock state's stid.\n\nHowever, sometimes the CLOSE was sent before the FREE_STATEID request.\nWhen this happens, the nfsd4_close_open_stateid call from nfsd4_close\nfrees all lock states on its st_locks list without cleaning up the copy\nstate on the sc_cp_list list. When the time the FREE_STATEID arrives the\nserver returns BAD_STATEID since the lock state was freed. This causes\nthe use-after-free error to occur when the laundromat tries to free\nthe expired cpntf_state.\n\nThis patch adds a call to nfs4_free_cpntf_statelist in\nnfsd4_close_open_stateid to clean up the copy state before calling\nfree_ol_stateid_reaplist to free the lock state's stid on the reaplist.", "datePublished": "2025-09-15T14:01:47", "dateUpdated": "2025-12-23T13:27:19", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/bbacfcde5fff25ac22597e8373a065c647da6738", "https://git.kernel.org/stable/c/83b94969751a691347606dbe6b1865efcfa5a643", "https://git.kernel.org/stable/c/6ea71246b7a02af675d733e72d14bd0d591d5f4a", "https://git.kernel.org/stable/c/35aa0fb8c3033a3d78603356e96fc18c5b9cceb2", "https://git.kernel.org/stable/c/019805fea91599b22dfa62ffb29c022f35abeb06", "https://nvd.nist.gov/vuln/detail/CVE-2022-50241"], "aliases": ["CVE-2022-50241"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "08401d25-4073-3562-b57e-baf7ba9a84ef", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <83b94969751a691347606dbe6b1865efcfa5a643"}, {"id": "0abeeec8-f4cf-39a3-aec3-836b401e5281", "product": {"name": "Linux"}, "product_version": "5.6"}, {"id": "1ca4304e-ffaa-38f2-8523-8ab974984c65", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "23ead8e7-16d1-3f99-8a57-da219179c59c", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "318899e0-bd55-33d2-8ffe-bea3af61ca22", "product": {"name": "Linux"}, "product_version": "624322f1adc58acd0b69f77a6ddc764207e97241 <bbacfcde5fff25ac22597e8373a065c647da6738"}, {"id": "3a67ab6e-3f37-38b6-8d02-fbf0137c4d91", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "42d6e90e-fdfe-31fb-8976-ed605ae129b9", "product": {"name": "Linux"}, "product_version": "624322f1adc58acd0b69f77a6ddc764207e97241 <83b94969751a691347606dbe6b1865efcfa5a643"}, {"id": "76fbab45-44af-34d4-a7ac-c3afdfa2f850", "product": {"name": "Linux"}, "product_version": "624322f1adc58acd0b69f77a6ddc764207e97241 <019805fea91599b22dfa62ffb29c022f35abeb06"}, {"id": "7bd9a881-7a32-39c0-a234-e3834a51c310", "product": {"name": "Linux"}, "product_version": "624322f1adc58acd0b69f77a6ddc764207e97241 <6ea71246b7a02af675d733e72d14bd0d591d5f4a"}, {"id": "8d3de7ca-d594-3cc1-9972-11313c6536f0", "product": {"name": "Linux"}, "product_version": "624322f1adc58acd0b69f77a6ddc764207e97241 <35aa0fb8c3033a3d78603356e96fc18c5b9cceb2"}, {"id": "90fbbff5-f1e9-3784-bd1f-7deb53a30a11", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "9310607d-fc52-3249-a73f-cc5870fb52a4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "955b34df-5758-3de6-adf6-30d55fca8d2e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <35aa0fb8c3033a3d78603356e96fc18c5b9cceb2"}, {"id": "e98d89df-302c-3a72-b663-260a0c0ae979", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "eba09b9e-b8a4-3e02-9cea-543a8b24b821", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6ea71246b7a02af675d733e72d14bd0d591d5f4a"}, {"id": "edb80b6d-1798-3624-a652-357cdd6df8e5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bbacfcde5fff25ac22597e8373a065c647da6738"}, {"id": "f8816389-8159-3eaf-ae5b-8080f28ace3d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <019805fea91599b22dfa62ffb29c022f35abeb06"}], "enisaIdVendor": [{"id": "2367f4b0-5e40-3d18-b658-d4855f8c2487", "vendor": {"name": "Linux"}}], "isExploited": false}