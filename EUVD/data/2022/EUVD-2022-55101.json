{"id": "EUVD-2022-55101", "enisaUuid": "48dd79e5-1efe-3422-a113-74b06a7c5b20", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: Fix use after free in hci_send_acl\n\nThis fixes the following trace caused by receiving\nHCI_EV_DISCONN_PHY_LINK_COMPLETE which does call hci_conn_del without\nfirst checking if conn->type is in fact AMP_LINK and in case it is\ndo properly cleanup upper layers with hci_disconn_cfm:\n\n ==================================================================\n    BUG: KASAN: use-after-free in hci_send_acl+0xaba/0xc50\n    Read of size 8 at addr ffff88800e404818 by task bluetoothd/142\n\n    CPU: 0 PID: 142 Comm: bluetoothd Not tainted\n    5.17.0-rc5-00006-gda4022eeac1a #7\n    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\n    rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n    Call Trace:\n     <TASK>\n     dump_stack_lvl+0x45/0x59\n     print_address_description.constprop.0+0x1f/0x150\n     kasan_report.cold+0x7f/0x11b\n     hci_send_acl+0xaba/0xc50\n     l2cap_do_send+0x23f/0x3d0\n     l2cap_chan_send+0xc06/0x2cc0\n     l2cap_sock_sendmsg+0x201/0x2b0\n     sock_sendmsg+0xdc/0x110\n     sock_write_iter+0x20f/0x370\n     do_iter_readv_writev+0x343/0x690\n     do_iter_write+0x132/0x640\n     vfs_writev+0x198/0x570\n     do_writev+0x202/0x280\n     do_syscall_64+0x38/0x90\n     entry_SYSCALL_64_after_hwframe+0x44/0xae\n    RSP: 002b:00007ffce8a099b8 EFLAGS: 00000246 ORIG_RAX: 0000000000000014\n    Code: 0f 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b8 0f 1f 00 f3\n    0f 1e fa 64 8b 04 25 18 00 00 00 85 c0 75 10 b8 14 00 00 00 0f 05\n    <48> 3d 00 f0 ff ff 77 51 c3 48 83 ec 28 89 54 24 1c 48 89 74 24 10\n    RDX: 0000000000000001 RSI: 00007ffce8a099e0 RDI: 0000000000000015\n    RAX: ffffffffffffffda RBX: 00007ffce8a099e0 RCX: 00007f788fc3cf77\n    R10: 00007ffce8af7080 R11: 0000000000000246 R12: 000055e4ccf75580\n    RBP: 0000000000000015 R08: 0000000000000002 R09: 0000000000000001\n    </TASK>\n    R13: 000055e4ccf754a0 R14: 000055e4ccf75cd0 R15: 000055e4ccf4a6b0\n\n    Allocated by task 45:\n        kasan_save_stack+0x1e/0x40\n        __kasan_kmalloc+0x81/0xa0\n        hci_chan_create+0x9a/0x2f0\n        l2cap_conn_add.part.0+0x1a/0xdc0\n        l2cap_connect_cfm+0x236/0x1000\n        le_conn_complete_evt+0x15a7/0x1db0\n        hci_le_conn_complete_evt+0x226/0x2c0\n        hci_le_meta_evt+0x247/0x450\n        hci_event_packet+0x61b/0xe90\n        hci_rx_work+0x4d5/0xc50\n        process_one_work+0x8fb/0x15a0\n        worker_thread+0x576/0x1240\n        kthread+0x29d/0x340\n        ret_from_fork+0x1f/0x30\n\n    Freed by task 45:\n        kasan_save_stack+0x1e/0x40\n        kasan_set_track+0x21/0x30\n        kasan_set_free_info+0x20/0x30\n        __kasan_slab_free+0xfb/0x130\n        kfree+0xac/0x350\n        hci_conn_cleanup+0x101/0x6a0\n        hci_conn_del+0x27e/0x6c0\n        hci_disconn_phylink_complete_evt+0xe0/0x120\n        hci_event_packet+0x812/0xe90\n        hci_rx_work+0x4d5/0xc50\n        process_one_work+0x8fb/0x15a0\n        worker_thread+0x576/0x1240\n        kthread+0x29d/0x340\n        ret_from_fork+0x1f/0x30\n\n    The buggy address belongs to the object at ffff88800c0f0500\n    The buggy address is located 24 bytes inside of\n    which belongs to the cache kmalloc-128 of size 128\n    The buggy address belongs to the page:\n    128-byte region [ffff88800c0f0500, ffff88800c0f0580)\n    flags: 0x100000000000200(slab|node=0|zone=1)\n    page:00000000fe45cd86 refcount:1 mapcount:0\n    mapping:0000000000000000 index:0x0 pfn:0xc0f0\n    raw: 0000000000000000 0000000080100010 00000001ffffffff\n    0000000000000000\n    raw: 0100000000000200 ffffea00003a2c80 dead000000000004\n    ffff8880078418c0\n    page dumped because: kasan: bad access detected\n    ffff88800c0f0400: 00 00 00 00 00 00 00 00 00 00 00 00 00 fc fc fc\n    Memory state around the buggy address:\n    >ffff88800c0f0500: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n    ffff88800c0f0480: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n    ffff88800c0f0580: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n                   \n---truncated---", "datePublished": "2025-02-26T01:54:56", "dateUpdated": "2025-12-23T13:21:59", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/c41de54b0a963e59e4dd04c029a4a6d73f45ef9c", "https://git.kernel.org/stable/c/643a6c26bd32e339d00ad97b8822b6db009e803c", "https://git.kernel.org/stable/c/684e505406abaeabe0058e9776f9210bf2747953", "https://git.kernel.org/stable/c/3803d896ddd97c7c16689a5381c0960040727647", "https://git.kernel.org/stable/c/2cc803804ec9a296b3156855d6c8c4ca1c6b84be", "https://git.kernel.org/stable/c/d404765dffdbd8dcd14758695d0c96c52fb2e624", "https://git.kernel.org/stable/c/4da302b90b96c309987eb9b37c8547f939f042d2", "https://git.kernel.org/stable/c/b3c2ea1fd444b3bb7b82bfd2c3a45418f85c2502", "https://git.kernel.org/stable/c/f63d24baff787e13b723d86fe036f84bdbc35045", "https://nvd.nist.gov/vuln/detail/CVE-2022-49111"], "aliases": ["CVE-2022-49111"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "0554659b-cdb3-31eb-9a50-7362838e29b8", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4da302b90b96c309987eb9b37c8547f939f042d2"}, {"id": "0d1c5779-ccd2-35c1-b197-80af4c6b45ca", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <3803d896ddd97c7c16689a5381c0960040727647"}, {"id": "1ea804a7-9820-3039-b270-faa9fa95a37d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c41de54b0a963e59e4dd04c029a4a6d73f45ef9c"}, {"id": "24dfaf9b-fe48-331d-9e91-b84e5f7718f9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d404765dffdbd8dcd14758695d0c96c52fb2e624"}, {"id": "3b4c953d-f4b9-3cc6-8990-f805c481ff08", "product": {"name": "Linux"}, "product_version": "patch: 4.9.311"}, {"id": "418d99d5-1b26-3ab5-8aaf-211b38b0fe0d", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <d404765dffdbd8dcd14758695d0c96c52fb2e624"}, {"id": "5016199a-b7ec-3bb2-994f-27a984b4f0ea", "product": {"name": "Linux"}, "product_version": "patch: 5.17.3"}, {"id": "50cb15d8-fd8b-3412-b9af-bb773986afbc", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <684e505406abaeabe0058e9776f9210bf2747953"}, {"id": "5491fc62-d6c3-3065-9325-47c9ee122dd2", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <643a6c26bd32e339d00ad97b8822b6db009e803c"}, {"id": "581de936-a8ae-346f-9d40-6ecd519936ad", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <684e505406abaeabe0058e9776f9210bf2747953"}, {"id": "5ca267ff-aa2e-3c62-916a-1e072b445d20", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b3c2ea1fd444b3bb7b82bfd2c3a45418f85c2502"}, {"id": "64883a8e-a9a9-320c-9252-968be93e85c8", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "66651c01-b940-3db8-bc5b-4ef222f91cec", "product": {"name": "Linux"}, "product_version": "patch: 4.19.238"}, {"id": "701aa9c0-e35b-36e8-a169-97724c59ae66", "product": {"name": "Linux"}, "product_version": "patch: 5.10.111"}, {"id": "7259d540-db85-3cda-8280-6af8f61ec5ed", "product": {"name": "Linux"}, "product_version": "patch: 4.14.276"}, {"id": "77532d8d-0684-336c-93e8-4a7a5ecae494", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <643a6c26bd32e339d00ad97b8822b6db009e803c"}, {"id": "7cffb11b-1ec9-364f-ab05-d16fc2eb2534", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <b3c2ea1fd444b3bb7b82bfd2c3a45418f85c2502"}, {"id": "996102c5-cdd2-39be-b52a-72ae763e62d5", "product": {"name": "Linux"}, "product_version": "patch: 5.16.20"}, {"id": "9a4385c6-5b7a-361a-8123-682b25b9e49d", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <c41de54b0a963e59e4dd04c029a4a6d73f45ef9c"}, {"id": "bd788000-4563-3cf0-9199-896dc305da7b", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "c32fe9dd-0b91-38ee-9eab-0415906b922c", "product": {"name": "Linux"}, "product_version": "patch: 5.4.189"}, {"id": "c62ed9aa-bf54-3257-82fc-ecaed306caa5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2cc803804ec9a296b3156855d6c8c4ca1c6b84be"}, {"id": "e0a72e8c-7753-3bf6-a752-945f46b5d22b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3803d896ddd97c7c16689a5381c0960040727647"}, {"id": "e2f06eb4-aecf-3c5a-9785-02e7e0555930", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <2cc803804ec9a296b3156855d6c8c4ca1c6b84be"}, {"id": "e827df10-bafb-31bb-b060-be4e0b5e3649", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <f63d24baff787e13b723d86fe036f84bdbc35045"}, {"id": "ec08abe5-18fa-3c90-a7dc-99231101a759", "product": {"name": "Linux"}, "product_version": "patch: 5.15.34"}, {"id": "f3416241-3423-3c8d-92d4-b12cd0661545", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f63d24baff787e13b723d86fe036f84bdbc35045"}, {"id": "f61a7e93-36e0-3a04-b222-76c7855a0a09", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "faf6c080-bf53-3934-9df8-4169a7d8594a", "product": {"name": "Linux"}, "product_version": "9eef6b3a9e38d5f8ad315b2a7db153392e6a77d6 <4da302b90b96c309987eb9b37c8547f939f042d2"}], "enisaIdVendor": [{"id": "16d0ca80-4e36-3e55-b852-a307658c8f06", "vendor": {"name": "Linux"}}], "isExploited": false}