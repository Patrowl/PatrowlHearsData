{"id": "EUVD-2022-54879", "enisaUuid": "a2b4c98c-5acf-34f3-bd9b-95aa4e38d7ee", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix use-after-free in ext4_rename_dir_prepare\n\nWe got issue as follows:\nEXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue\next4_get_first_dir_block: bh->b_data=0xffff88810bee6000 len=34478\next4_get_first_dir_block: *parent_de=0xffff88810beee6ae bh->b_data=0xffff88810bee6000\next4_rename_dir_prepare: [1] parent_de=0xffff88810beee6ae\n==================================================================\nBUG: KASAN: use-after-free in ext4_rename_dir_prepare+0x152/0x220\nRead of size 4 at addr ffff88810beee6ae by task rep/1895\n\nCPU: 13 PID: 1895 Comm: rep Not tainted 5.10.0+ #241\nCall Trace:\n dump_stack+0xbe/0xf9\n print_address_description.constprop.0+0x1e/0x220\n kasan_report.cold+0x37/0x7f\n ext4_rename_dir_prepare+0x152/0x220\n ext4_rename+0xf44/0x1ad0\n ext4_rename2+0x11c/0x170\n vfs_rename+0xa84/0x1440\n do_renameat2+0x683/0x8f0\n __x64_sys_renameat+0x53/0x60\n do_syscall_64+0x33/0x40\n entry_SYSCALL_64_after_hwframe+0x44/0xa9\nRIP: 0033:0x7f45a6fc41c9\nRSP: 002b:00007ffc5a470218 EFLAGS: 00000246 ORIG_RAX: 0000000000000108\nRAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f45a6fc41c9\nRDX: 0000000000000005 RSI: 0000000020000180 RDI: 0000000000000005\nRBP: 00007ffc5a470240 R08: 00007ffc5a470160 R09: 0000000020000080\nR10: 00000000200001c0 R11: 0000000000000246 R12: 0000000000400bb0\nR13: 00007ffc5a470320 R14: 0000000000000000 R15: 0000000000000000\n\nThe buggy address belongs to the page:\npage:00000000440015ce refcount:0 mapcount:0 mapping:0000000000000000 index:0x1 pfn:0x10beee\nflags: 0x200000000000000()\nraw: 0200000000000000 ffffea00043ff4c8 ffffea0004325608 0000000000000000\nraw: 0000000000000001 0000000000000000 00000000ffffffff 0000000000000000\npage dumped because: kasan: bad access detected\n\nMemory state around the buggy address:\n ffff88810beee580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\n ffff88810beee600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\n>ffff88810beee680: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\n                                  ^\n ffff88810beee700: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\n ffff88810beee780: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\n==================================================================\nDisabling lock debugging due to kernel taint\next4_rename_dir_prepare: [2] parent_de->inode=3537895424\next4_rename_dir_prepare: [3] dir=0xffff888124170140\next4_rename_dir_prepare: [4] ino=2\next4_rename_dir_prepare: ent->dir->i_ino=2 parent=-757071872\n\nReason is first directory entry which 'rec_len' is 34478, then will get illegal\nparent entry. Now, we do not check directory entry after read directory block\nin 'ext4_get_first_dir_block'.\nTo solve this issue, check directory entry in 'ext4_get_first_dir_block'.\n\n[ Trigger an ext4_error() instead of just warning if the directory is\n  missing a '.' or '..' entry.   Also make sure we return an error code\n  if the file system is corrupted.  -TYT ]", "datePublished": "2025-02-26T02:11:02", "dateUpdated": "2025-12-23T13:23:51", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/1a3a15bf6f9963d755270cbdb282863b84839195", "https://git.kernel.org/stable/c/97f802a652a749422dede32071d29a53cf4bd034", "https://git.kernel.org/stable/c/10801095224de0d0ab06ae60698680c1f883a3ae", "https://git.kernel.org/stable/c/eaecf7ebfd5dd09038a80b14be46b844f54cfc5c", "https://git.kernel.org/stable/c/dd887f83ea54aea5b780a84527e23ab95f777fed", "https://git.kernel.org/stable/c/364380c00912bed9b5d99eb485018360b0ecf64f", "https://git.kernel.org/stable/c/0ff38b99fa075ddd246487a28cb9af049f4ceef1", "https://git.kernel.org/stable/c/4a2bea60cf7ff957b3eda0b17750d483876a02fa", "https://git.kernel.org/stable/c/0be698ecbe4471fcad80e81ec6a05001421041b3", "https://nvd.nist.gov/vuln/detail/CVE-2022-49349"], "aliases": ["CVE-2022-49349"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "02256f8d-267b-30a6-8167-333047aa0b35", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <97f802a652a749422dede32071d29a53cf4bd034"}, {"id": "09bfdb8d-a4ed-3022-b217-41043446f5aa", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <0ff38b99fa075ddd246487a28cb9af049f4ceef1"}, {"id": "0e22e452-ecfc-3e63-b151-07988d44d39a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1a1f7f4b-53bc-31a9-a02e-9274d71317fb", "product": {"name": "Linux"}, "product_version": "patch: 5.10.121"}, {"id": "1ad7af0a-8c5d-344a-81ad-3403d1f3327f", "product": {"name": "Linux"}, "product_version": "patch: 4.19.247"}, {"id": "2c158385-5021-3c4b-94ec-0b4e67b5ccfe", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <10801095224de0d0ab06ae60698680c1f883a3ae"}, {"id": "2c62f625-3d22-3665-9739-bb4ea24cd8e7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <dd887f83ea54aea5b780a84527e23ab95f777fed"}, {"id": "315bd12b-3bc0-3f37-826c-2de968e8d256", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0ff38b99fa075ddd246487a28cb9af049f4ceef1"}, {"id": "577bebc9-b25d-3820-bcab-6a9e5a40a818", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4a2bea60cf7ff957b3eda0b17750d483876a02fa"}, {"id": "6e3ac7d3-eb45-3d03-84f5-7d0b98f09551", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <4a2bea60cf7ff957b3eda0b17750d483876a02fa"}, {"id": "787ff91a-dda4-37af-bdd1-85dff7eaac7a", "product": {"name": "Linux"}, "product_version": "patch: 5.18.3"}, {"id": "82c74586-084c-3456-9165-8836e9c95323", "product": {"name": "Linux"}, "product_version": "patch: 5.4.198"}, {"id": "85c5f677-a5f1-3e67-a1a1-cbc6efe44c64", "product": {"name": "Linux"}, "product_version": "patch: 4.14.283"}, {"id": "86816a05-ab00-34f2-9493-ff578fa91be7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <eaecf7ebfd5dd09038a80b14be46b844f54cfc5c"}, {"id": "a0497f8b-89f1-3baa-aa88-83559dc42617", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <364380c00912bed9b5d99eb485018360b0ecf64f"}, {"id": "aa0e60a7-039e-3b78-8959-1b4e2115049d", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <10801095224de0d0ab06ae60698680c1f883a3ae"}, {"id": "b808f972-5b46-39fb-807c-257adc50e193", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1a3a15bf6f9963d755270cbdb282863b84839195"}, {"id": "b9050487-e7ca-305d-801a-6fd6f2917f24", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0be698ecbe4471fcad80e81ec6a05001421041b3"}, {"id": "bc508c1f-b44c-3b85-b35b-9c8efa40d98b", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "c95b8945-b290-3a66-8e40-6e3aa69c8b4d", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <1a3a15bf6f9963d755270cbdb282863b84839195"}, {"id": "d021dee2-3f73-3cd0-9e2e-0d64ff88a313", "product": {"name": "Linux"}, "product_version": "patch: 5.15.46"}, {"id": "d5b50afd-7625-3c46-bb37-f902088f5324", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <97f802a652a749422dede32071d29a53cf4bd034"}, {"id": "e6290009-41a1-35a7-81e9-6d0b34303636", "product": {"name": "Linux"}, "product_version": "patch: 5.17.14"}, {"id": "eb086763-d679-311f-bac0-a32a990670a7", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <dd887f83ea54aea5b780a84527e23ab95f777fed"}, {"id": "f3f0c6e2-1fce-352b-8a51-09519d083492", "product": {"name": "Linux"}, "product_version": "patch: 4.9.318"}, {"id": "f4c8d092-970d-35e9-a7a7-26de23cc315d", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "f5d770ce-2d2f-3bc1-86f5-e144ae97b056", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <364380c00912bed9b5d99eb485018360b0ecf64f"}, {"id": "f67bfe70-f095-3bb4-99d4-13b5c0d65a1d", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <0be698ecbe4471fcad80e81ec6a05001421041b3"}, {"id": "fc2be380-9dac-31f1-a23f-e9b107317e06", "product": {"name": "Linux"}, "product_version": "32f7f22c0b52e8189fef83986b16dc7abe95f2c4 <eaecf7ebfd5dd09038a80b14be46b844f54cfc5c"}], "enisaIdVendor": [{"id": "bf07d8a5-301b-329d-8b8b-0a17940caf8c", "vendor": {"name": "Linux"}}], "isExploited": false}