{"id": "EUVD-2022-54678", "enisaUuid": "43f4968e-2151-3a45-badb-f8528fda304f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nzsmalloc: fix races between asynchronous zspage free and page migration\n\nThe asynchronous zspage free worker tries to lock a zspage's entire page\nlist without defending against page migration.  Since pages which haven't\nyet been locked can concurrently migrate off the zspage page list while\nlock_zspage() churns away, lock_zspage() can suffer from a few different\nlethal races.\n\nIt can lock a page which no longer belongs to the zspage and unsafely\ndereference page_private(), it can unsafely dereference a torn pointer to\nthe next page (since there's a data race), and it can observe a spurious\nNULL pointer to the next page and thus not lock all of the zspage's pages\n(since a single page migration will reconstruct the entire page list, and\ncreate_page_chain() unconditionally zeroes out each list pointer in the\nprocess).\n\nFix the races by using migrate_read_lock() in lock_zspage() to synchronize\nwith page migration.", "datePublished": "2025-10-22T18:30:32", "dateUpdated": "2025-10-22T18:30:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3674d8a8dadd03a447dd21069d4dacfc3399b63b", "https://git.kernel.org/stable/c/645996efc2ae391246d595832aaa6f9d3cc338c7", "https://git.kernel.org/stable/c/fc658c083904427abbf8f18280d517ee2668677c", "https://git.kernel.org/stable/c/fae05b2314b147a78fbed1dc4c645d9a66313758", "https://git.kernel.org/stable/c/3ec459c8810e658401be428d3168eacfc380bdd0", "https://git.kernel.org/stable/c/8ba7b7c1dad1f6503c541778f31b33f7f62eb966", "https://git.kernel.org/stable/c/c5402fb5f71f1a725f1e55d9c6799c0c7bec308f", "https://git.kernel.org/stable/c/2505a981114dcb715f8977b8433f7540854851d8", "https://nvd.nist.gov/vuln/detail/CVE-2022-49554"], "aliases": ["CVE-2022-49554"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "09f3c2fe-0927-3e6e-b180-d616c20646b7", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <3ec459c8810e658401be428d3168eacfc380bdd0"}, {"id": "0ee87ba1-cbbc-3703-9f70-62b873a44912", "product": {"name": "Linux"}, "product_version": "4.14"}, {"id": "1cdd37ac-75f3-3d6a-b8bc-79af77340ce1", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <fae05b2314b147a78fbed1dc4c645d9a66313758"}, {"id": "4b7e7d5f-0233-3798-88de-c1aa0c43744c", "product": {"name": "Linux"}, "product_version": "patch: 5.4.197"}, {"id": "687c94e8-9e25-36ed-baf8-c236573ac7cb", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <c5402fb5f71f1a725f1e55d9c6799c0c7bec308f"}, {"id": "6c5ed710-eb86-3bfd-b340-a9dae5e1bd28", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <fc658c083904427abbf8f18280d517ee2668677c"}, {"id": "7fdd7580-8959-3b5a-8f83-60c5f51e46f1", "product": {"name": "Linux"}, "product_version": "patch: 5.18.2"}, {"id": "8411abbc-8523-388f-8749-5b2e3ab7cd10", "product": {"name": "Linux"}, "product_version": "patch: 5.17.13"}, {"id": "85110d73-8e5c-37b9-b767-e8b17fa19d1d", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <645996efc2ae391246d595832aaa6f9d3cc338c7"}, {"id": "8dd2367d-0bf2-3699-8969-110dd9e41349", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <2505a981114dcb715f8977b8433f7540854851d8"}, {"id": "9357ef02-bd5d-3d1c-a3fd-80418d03bd5f", "product": {"name": "Linux"}, "product_version": "patch: 4.19.246"}, {"id": "9d28495a-4a6d-32ad-8270-d5643771ce3e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.45"}, {"id": "a221e1db-2195-3b74-ad03-52c953513cb9", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <8ba7b7c1dad1f6503c541778f31b33f7f62eb966"}, {"id": "a23dfa3c-52b2-36e2-85a9-201a6c3ce634", "product": {"name": "Linux"}, "product_version": "patch: 5.10.120"}, {"id": "c06b2f7c-40fe-36ca-9bbe-62c7a7e6193d", "product": {"name": "Linux"}, "product_version": "77ff465799c60294e248000cd22ae8171da3304c <3674d8a8dadd03a447dd21069d4dacfc3399b63b"}, {"id": "d7075feb-035d-32a5-9b2a-c929a4f7e2f6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e1af39bc-c8b5-3cda-85ae-87626a8720b4", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "f1e85e2b-b71d-35f0-b33b-bbe8032504c3", "product": {"name": "Linux"}, "product_version": "patch: 4.14.282"}], "enisaIdVendor": [{"id": "a4b60382-d057-3e7a-b8fa-9ce82f34d504", "vendor": {"name": "Linux"}}], "isExploited": false}