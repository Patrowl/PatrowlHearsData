{"id": "EUVD-2022-54944", "enisaUuid": "60f25593-de64-305e-a729-683a0c584852", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: quota: fix loop condition at f2fs_quota_sync()\n\ncnt should be passed to sb_has_quota_active() instead of type to check\nactive quota properly.\n\nMoreover, when the type is -1, the compiler with enough inline knowledge\ncan discard sb_has_quota_active() check altogether, causing a NULL pointer\ndereference at the following inode_lock(dqopt->files[cnt]):\n\n[    2.796010] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000a0\n[    2.796024] Mem abort info:\n[    2.796025]   ESR = 0x96000005\n[    2.796028]   EC = 0x25: DABT (current EL), IL = 32 bits\n[    2.796029]   SET = 0, FnV = 0\n[    2.796031]   EA = 0, S1PTW = 0\n[    2.796032] Data abort info:\n[    2.796034]   ISV = 0, ISS = 0x00000005\n[    2.796035]   CM = 0, WnR = 0\n[    2.796046] user pgtable: 4k pages, 39-bit VAs, pgdp=00000003370d1000\n[    2.796048] [00000000000000a0] pgd=0000000000000000, pud=0000000000000000\n[    2.796051] Internal error: Oops: 96000005 [#1] PREEMPT SMP\n[    2.796056] CPU: 7 PID: 640 Comm: f2fs_ckpt-259:7 Tainted: G S                5.4.179-arter97-r8-64666-g2f16e087f9d8 #1\n[    2.796057] Hardware name: Qualcomm Technologies, Inc. Lahaina MTP lemonadep (DT)\n[    2.796059] pstate: 80c00005 (Nzcv daif +PAN +UAO)\n[    2.796065] pc : down_write+0x28/0x70\n[    2.796070] lr : f2fs_quota_sync+0x100/0x294\n[    2.796071] sp : ffffffa3f48ffc30\n[    2.796073] x29: ffffffa3f48ffc30 x28: 0000000000000000\n[    2.796075] x27: ffffffa3f6d718b8 x26: ffffffa415fe9d80\n[    2.796077] x25: ffffffa3f7290048 x24: 0000000000000001\n[    2.796078] x23: 0000000000000000 x22: ffffffa3f7290000\n[    2.796080] x21: ffffffa3f72904a0 x20: ffffffa3f7290110\n[    2.796081] x19: ffffffa3f77a9800 x18: ffffffc020aae038\n[    2.796083] x17: ffffffa40e38e040 x16: ffffffa40e38e6d0\n[    2.796085] x15: ffffffa40e38e6cc x14: ffffffa40e38e6d0\n[    2.796086] x13: 00000000000004f6 x12: 00162c44ff493000\n[    2.796088] x11: 0000000000000400 x10: ffffffa40e38c948\n[    2.796090] x9 : 0000000000000000 x8 : 00000000000000a0\n[    2.796091] x7 : 0000000000000000 x6 : 0000d1060f00002a\n[    2.796093] x5 : ffffffa3f48ff718 x4 : 000000000000000d\n[    2.796094] x3 : 00000000060c0000 x2 : 0000000000000001\n[    2.796096] x1 : 0000000000000000 x0 : 00000000000000a0\n[    2.796098] Call trace:\n[    2.796100]  down_write+0x28/0x70\n[    2.796102]  f2fs_quota_sync+0x100/0x294\n[    2.796104]  block_operations+0x120/0x204\n[    2.796106]  f2fs_write_checkpoint+0x11c/0x520\n[    2.796107]  __checkpoint_and_complete_reqs+0x7c/0xd34\n[    2.796109]  issue_checkpoint_thread+0x6c/0xb8\n[    2.796112]  kthread+0x138/0x414\n[    2.796114]  ret_from_fork+0x10/0x18\n[    2.796117] Code: aa0803e0 aa1f03e1 52800022 aa0103e9 (c8e97d02)\n[    2.796120] ---[ end trace 96e942e8eb6a0b53 ]---\n[    2.800116] Kernel panic - not syncing: Fatal exception\n[    2.800120] SMP: stopping secondary CPUs", "datePublished": "2025-02-26T01:56:23", "dateUpdated": "2025-10-01T19:47:00", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/f1d5946d47c0827bae39e1537959ce8d6f0224c5", "https://git.kernel.org/stable/c/e58ee6bd939b773675240f5d0f5b88a367c037c4", "https://git.kernel.org/stable/c/f9156db0987f1b426015d56505e2c58dee70c90d", "https://git.kernel.org/stable/c/e9ebf1e8fc50b6a9336f9aea1082d7845e568d0e", "https://git.kernel.org/stable/c/724469814d805820cd37ea789769dba94123ff1a", "https://git.kernel.org/stable/c/680af5b824a52faa819167628665804a14f0e0df"], "aliases": ["CVE-2022-49282"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "00b0bea8-4555-3a35-8e50-f06cfb151a31", "product": {"name": "Linux"}, "product_version": "patch: 5.10.110"}, {"id": "22a6731c-2f54-3a42-b0bc-a49bc1e20337", "product": {"name": "Linux"}, "product_version": "2d586a3f5b7ec2f5a939db4abc9aa053c237545c <e58ee6bd939b773675240f5d0f5b88a367c037c4"}, {"id": "25e20e06-d1b9-34ba-b5d0-9ed514676e85", "product": {"name": "Linux"}, "product_version": "9de71ede81e6d1a111fdd868b2d78d459fa77f80 <724469814d805820cd37ea789769dba94123ff1a"}, {"id": "472b57b6-caca-30bb-840c-97027bb102e3", "product": {"name": "Linux"}, "product_version": "9dd5052a8a8be252990c1bb451b51f32529411ef"}, {"id": "48fedc05-6358-35a1-8989-0322d166302d", "product": {"name": "Linux"}, "product_version": "699a077aa087c17cf29c7170db71a34141e2effe"}, {"id": "4c9a9b47-7441-3071-83b9-780534ba6b1b", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "57e1182a-7c40-3127-baed-22069a16312b", "product": {"name": "Linux"}, "product_version": "9de71ede81e6d1a111fdd868b2d78d459fa77f80 <f9156db0987f1b426015d56505e2c58dee70c90d"}, {"id": "5837b8e4-6ebc-3e95-b4cc-7d9eccd1ccb0", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "7bf434b8-e920-3c2e-9ae7-6f888284661b", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "84308999-78b4-320a-b4c3-7d54b3465eeb", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}, {"id": "9e70b92d-419c-37bc-9f15-c80cdb603582", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "b5871079-7bb1-3672-8a2c-b36f0bb51f17", "product": {"name": "Linux"}, "product_version": "patch: 5.4.189"}, {"id": "b77938f3-6b2c-33bb-ba04-9a5ef7722581", "product": {"name": "Linux"}, "product_version": "9de71ede81e6d1a111fdd868b2d78d459fa77f80 <680af5b824a52faa819167628665804a14f0e0df"}, {"id": "d25dee2d-14ca-3b32-8fc0-6cab3f8f4ed6", "product": {"name": "Linux"}, "product_version": "9de71ede81e6d1a111fdd868b2d78d459fa77f80 <e9ebf1e8fc50b6a9336f9aea1082d7845e568d0e"}, {"id": "d5d12bcd-f9cd-386c-9567-ca0a09315fe2", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "dfa386e8-f6f5-321d-89fa-297171813261", "product": {"name": "Linux"}, "product_version": "a02982545e61020c23f411b073ba5171381138e4 <f1d5946d47c0827bae39e1537959ce8d6f0224c5"}], "enisaIdVendor": [{"id": "6a339ad7-e116-3572-8cae-f80bfc18d35b", "vendor": {"name": "Linux"}}], "isExploited": false}