{"id": "EUVD-2022-54888", "enisaUuid": "b7856136-be06-3f32-bd13-7c5ba31b70e6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nip_gre: test csum_start instead of transport header\n\nGRE with TUNNEL_CSUM will apply local checksum offload on\nCHECKSUM_PARTIAL packets.\n\nipgre_xmit must validate csum_start after an optional skb_pull,\nelse lco_csum may trigger an overflow. The original check was\n\n\tif (csum && skb_checksum_start(skb) < skb->data)\n\t\treturn -EINVAL;\n\nThis had false positives when skb_checksum_start is undefined:\nwhen ip_summed is not CHECKSUM_PARTIAL. A discussed refinement\nwas straightforward\n\n\tif (csum && skb->ip_summed == CHECKSUM_PARTIAL &&\n\t    skb_checksum_start(skb) < skb->data)\n\t\treturn -EINVAL;\n\nBut was eventually revised more thoroughly:\n- restrict the check to the only branch where needed, in an\n  uncommon GRE path that uses header_ops and calls skb_pull.\n- test skb_transport_header, which is set along with csum_start\n  in skb_partial_csum_set in the normal header_ops datapath.\n\nTurns out skbs can arrive in this branch without the transport\nheader set, e.g., through BPF redirection.\n\nRevise the check back to check csum_start directly, and only if\nCHECKSUM_PARTIAL. Do leave the check in the updated location.\nCheck field regardless of whether TUNNEL_CSUM is configured.", "datePublished": "2025-10-21T12:31:25", "dateUpdated": "2025-10-21T12:31:25", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/7596bd7920985f7fc8579a92e48bc53ce4475b21", "https://git.kernel.org/stable/c/3d08bc3a5d9b2106f5c8bcf1adb73147824aa006", "https://git.kernel.org/stable/c/fbeb8dfa8b87ef259eef0c89e39b53962a3cf604", "https://git.kernel.org/stable/c/e6b6f98fc7605c06c0a3baa70f62c534d7b4ce58", "https://git.kernel.org/stable/c/0c92d813c7c9ca2212ecd879232e7d87362fce98", "https://git.kernel.org/stable/c/0ffa268724656633af5f37a38c212326d98ebe8c", "https://git.kernel.org/stable/c/8d21e9963bec1aad2280cdd034c8993033ef2948", "https://nvd.nist.gov/vuln/detail/CVE-2022-49340"], "aliases": ["CVE-2022-49340"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "004211e8-ee27-3215-a60b-f4511099a7c5", "product": {"name": "Linux"}, "product_version": "8a0ed250f911da31a2aef52101bc707846a800ff <e6b6f98fc7605c06c0a3baa70f62c534d7b4ce58"}, {"id": "13a72987-1b89-3aa0-bea6-4dbf81550ec3", "product": {"name": "Linux"}, "product_version": "3d32ce5472bb2ca720bef84089b85f76a705fd1a <3d08bc3a5d9b2106f5c8bcf1adb73147824aa006"}, {"id": "211377c0-d629-3fd4-92d6-5504a519b764", "product": {"name": "Linux"}, "product_version": "774430026bd9a472d08c5d3c33351a782315771a <7596bd7920985f7fc8579a92e48bc53ce4475b21"}, {"id": "246871e5-6511-3ad0-bbb2-d97923034f20", "product": {"name": "Linux"}, "product_version": "patch: 5.15.47"}, {"id": "24eb98e4-84cf-3bda-9ca1-a1843b4c9190", "product": {"name": "Linux"}, "product_version": "87b34cd6485192777f632f92d592f2a71d8801a6 <fbeb8dfa8b87ef259eef0c89e39b53962a3cf604"}, {"id": "2ba5744d-83df-33a2-b589-b89c99f4eaa8", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "4aeedd29-db2b-3446-a3d5-1fc93af99fa6", "product": {"name": "Linux"}, "product_version": "patch: 5.10.122"}, {"id": "5c3288c3-ce62-3dc1-9e15-095f92827148", "product": {"name": "Linux"}, "product_version": "patch: 4.19.247"}, {"id": "5cbc9d2f-0145-3aa7-a655-472512acc3c2", "product": {"name": "Linux"}, "product_version": "patch: 5.18.4"}, {"id": "8884afee-659a-3dd1-8a0b-9081b6de7d59", "product": {"name": "Linux"}, "product_version": "8a0ed250f911da31a2aef52101bc707846a800ff <8d21e9963bec1aad2280cdd034c8993033ef2948"}, {"id": "acc67857-306d-3bd1-b2f1-49950e2335f3", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c5058709-2224-3ddb-bab1-9f7fabb475c9", "product": {"name": "Linux"}, "product_version": "8a0ed250f911da31a2aef52101bc707846a800ff <0ffa268724656633af5f37a38c212326d98ebe8c"}, {"id": "c9614dd6-1eb0-33a9-a204-9055d1b316a3", "product": {"name": "Linux"}, "product_version": "patch: 5.4.198"}, {"id": "d608a892-ca5d-3cba-a7f1-4d744ae1239b", "product": {"name": "Linux"}, "product_version": "patch: 5.17.15"}, {"id": "e0b742fb-3b41-3496-b285-c6b114b1f6e3", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "fa45c938-0b9e-3ed2-970c-13be74287bfb", "product": {"name": "Linux"}, "product_version": "8a0ed250f911da31a2aef52101bc707846a800ff <0c92d813c7c9ca2212ecd879232e7d87362fce98"}], "enisaIdVendor": [{"id": "e550834c-ff0b-3d8e-b4cf-5e76c120cc0d", "vendor": {"name": "Linux"}}], "isExploited": false}