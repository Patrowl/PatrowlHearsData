{"id": "EUVD-2022-55353", "enisaUuid": "871b8c18-6ff9-3d93-a5fd-f4d77ee668c1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock: don't allow the same type rq_qos add more than once\n\nIn our test of iocost, we encountered some list add/del corruptions of\ninner_walk list in ioc_timer_fn.\n\nThe reason can be described as follows:\n\ncpu 0\t\t\t\t\tcpu 1\nioc_qos_write\t\t\t\tioc_qos_write\n\nioc = q_to_ioc(queue);\nif (!ioc) {\n        ioc = kzalloc();\n\t\t\t\t\tioc = q_to_ioc(queue);\n\t\t\t\t\tif (!ioc) {\n\t\t\t\t\t\tioc = kzalloc();\n\t\t\t\t\t\t...\n\t\t\t\t\t\trq_qos_add(q, rqos);\n\t\t\t\t\t}\n        ...\n        rq_qos_add(q, rqos);\n        ...\n}\n\nWhen the io.cost.qos file is written by two cpus concurrently, rq_qos may\nbe added to one disk twice. In that case, there will be two iocs enabled\nand running on one disk. They own different iocgs on their active list. In\nthe ioc_timer_fn function, because of the iocgs from two iocs have the\nsame root iocg, the root iocg's walk_list may be overwritten by each other\nand this leads to list add/del corruptions in building or destroying the\ninner_walk list.\n\nAnd so far, the blk-rq-qos framework works in case that one instance for\none type rq_qos per queue by default. This patch make this explicit and\nalso fix the crash above.", "datePublished": "2025-06-18T11:02:27", "dateUpdated": "2025-12-23T13:26:49", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/0b7f5d7a4d2a72ad9de04ab8ccba2a31904aa638", "https://git.kernel.org/stable/c/08ef66e800a85afc6b54cb95841f6502627eee2e", "https://git.kernel.org/stable/c/0c9bb1acd1d103a3070b2126870eb52761d606ce", "https://git.kernel.org/stable/c/14a6e2eb7df5c7897c15b109cba29ab0c4a791b6", "https://nvd.nist.gov/vuln/detail/CVE-2022-50086"], "aliases": ["CVE-2022-50086"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "057e005f-24af-3539-8146-2b6481e89907", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <14a6e2eb7df5c7897c15b109cba29ab0c4a791b6"}, {"id": "18f67099-1f00-308a-9673-a8bf92d81244", "product": {"name": "Linux"}, "product_version": "a79050434b45959f397042080fd1d70ffa9bd9df <08ef66e800a85afc6b54cb95841f6502627eee2e"}, {"id": "1e138a25-d5c5-3571-83b8-ff2eff6fa82d", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "35916c8b-ab59-3a4d-93da-5bffb1a0e293", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "416d7bef-99e7-3687-85ac-27a10d5db5fb", "product": {"name": "Linux"}, "product_version": "a79050434b45959f397042080fd1d70ffa9bd9df <0b7f5d7a4d2a72ad9de04ab8ccba2a31904aa638"}, {"id": "43f1d081-2f6f-3f28-b2a7-5beeb195acf4", "product": {"name": "Linux"}, "product_version": "a79050434b45959f397042080fd1d70ffa9bd9df <14a6e2eb7df5c7897c15b109cba29ab0c4a791b6"}, {"id": "8192bac7-68f5-392b-a3a9-0861edc846cb", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "8e596978-7a32-3145-9c13-78920c931d43", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "c1c77b69-efc8-3474-9aad-48d798866d4f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0b7f5d7a4d2a72ad9de04ab8ccba2a31904aa638"}, {"id": "c399aba8-1560-324c-8b58-58566f122c13", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0c9bb1acd1d103a3070b2126870eb52761d606ce"}, {"id": "eecd3f19-2308-37c7-a73d-532f4ff6b246", "product": {"name": "Linux"}, "product_version": "a79050434b45959f397042080fd1d70ffa9bd9df <0c9bb1acd1d103a3070b2126870eb52761d606ce"}, {"id": "f46c746c-e3d4-3431-8c47-469c2a7f2479", "product": {"name": "Linux"}, "product_version": "4.19"}, {"id": "f8a501ef-89da-3a7b-b884-6ebaee057b79", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "fd2f0cc0-2852-3461-95e5-91e59d00da03", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <08ef66e800a85afc6b54cb95841f6502627eee2e"}], "enisaIdVendor": [{"id": "df25e45d-0efa-34e3-a0d1-b51ce112cd0c", "vendor": {"name": "Linux"}}], "isExploited": false}