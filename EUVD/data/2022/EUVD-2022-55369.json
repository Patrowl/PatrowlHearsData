{"id": "EUVD-2022-55369", "enisaUuid": "eca94a02-aba6-3b61-8026-54ff7f4f89e3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsched, cpuset: Fix dl_cpu_busy() panic due to empty cs->cpus_allowed\n\nWith cgroup v2, the cpuset's cpus_allowed mask can be empty indicating\nthat the cpuset will just use the effective CPUs of its parent. So\ncpuset_can_attach() can call task_can_attach() with an empty mask.\nThis can lead to cpumask_any_and() returns nr_cpu_ids causing the call\nto dl_bw_of() to crash due to percpu value access of an out of bound\nCPU value. For example:\n\n\t[80468.182258] BUG: unable to handle page fault for address: ffffffff8b6648b0\n\t  :\n\t[80468.191019] RIP: 0010:dl_cpu_busy+0x30/0x2b0\n\t  :\n\t[80468.207946] Call Trace:\n\t[80468.208947]  cpuset_can_attach+0xa0/0x140\n\t[80468.209953]  cgroup_migrate_execute+0x8c/0x490\n\t[80468.210931]  cgroup_update_dfl_csses+0x254/0x270\n\t[80468.211898]  cgroup_subtree_control_write+0x322/0x400\n\t[80468.212854]  kernfs_fop_write_iter+0x11c/0x1b0\n\t[80468.213777]  new_sync_write+0x11f/0x1b0\n\t[80468.214689]  vfs_write+0x1eb/0x280\n\t[80468.215592]  ksys_write+0x5f/0xe0\n\t[80468.216463]  do_syscall_64+0x5c/0x80\n\t[80468.224287]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nFix that by using effective_cpus instead. For cgroup v1, effective_cpus\nis the same as cpus_allowed. For v2, effective_cpus is the real cpumask\nto be used by tasks within the cpuset anyway.\n\nAlso update task_can_attach()'s 2nd argument name to cs_effective_cpus to\nreflect the change. In addition, a check is added to task_can_attach()\nto guard against the possibility that cpumask_any_and() may return a\nvalue >= nr_cpu_ids.", "datePublished": "2025-06-18T12:30:48", "dateUpdated": "2025-11-19T15:31:28", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/336626564b58071b8980a4e6a31a8f5d92705d9b", "https://git.kernel.org/stable/c/147f66d22f58712dce7ccdd6a1f6cb3ee8042df4", "https://git.kernel.org/stable/c/357f3f0e522a6ce1ce4a571cb780d9861d53bec7", "https://git.kernel.org/stable/c/f56607b44c9896e51678a7e8cdd3a5479f4b4548", "https://git.kernel.org/stable/c/b6e8d40d43ae4dec00c8fea2593eeea3114b8f44", "https://nvd.nist.gov/vuln/detail/CVE-2022-50103"], "aliases": ["CVE-2022-50103"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "084af13c-5f81-3779-ba31-4b7085de4164", "product": {"name": "Linux"}, "product_version": "7f51412a415d87ea8598d14722fb31e4f5701257 <f56607b44c9896e51678a7e8cdd3a5479f4b4548"}, {"id": "0907dfb2-9cfe-3845-8f7a-98eed1672c99", "product": {"name": "Linux"}, "product_version": "patch: 5.10.137"}, {"id": "18055655-6c31-3bc3-a71f-e2c42b98651b", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "1cb6e0bd-32fa-3190-9779-ce0786acad54", "product": {"name": "Linux"}, "product_version": "3.19"}, {"id": "200dc7bd-b69c-31ce-895c-8b18c29c203a", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "2bba6ff6-2179-32d1-ae1e-d8472486ab95", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "8fe9db7b-87e5-3747-86d6-23d6edbc1b35", "product": {"name": "Linux"}, "product_version": "7f51412a415d87ea8598d14722fb31e4f5701257 <357f3f0e522a6ce1ce4a571cb780d9861d53bec7"}, {"id": "918af3b2-a856-3377-bcf8-7a7080c80d37", "product": {"name": "Linux"}, "product_version": "7f51412a415d87ea8598d14722fb31e4f5701257 <147f66d22f58712dce7ccdd6a1f6cb3ee8042df4"}, {"id": "a0f0f1d7-9dfe-3a50-bc48-4d5b37cad8c7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "b243d4a5-b9ac-38ec-96bc-846937a4680f", "product": {"name": "Linux"}, "product_version": "7f51412a415d87ea8598d14722fb31e4f5701257 <b6e8d40d43ae4dec00c8fea2593eeea3114b8f44"}, {"id": "c4389b8f-bfaf-3917-b4eb-95c2bf33dad8", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f7eeff8e-66eb-3bf1-83e2-20281a25fd30", "product": {"name": "Linux"}, "product_version": "7f51412a415d87ea8598d14722fb31e4f5701257 <336626564b58071b8980a4e6a31a8f5d92705d9b"}], "enisaIdVendor": [{"id": "9137ecdd-fccc-3b5a-8374-e2e66593582b", "vendor": {"name": "Linux"}}], "isExploited": false}