{"id": "EUVD-2022-27321", "enisaUuid": "1b40cf6b-0d7e-3495-b878-c2cd645733f9", "description": "A vulnerability in the processing of inbound IPv6 packets in Juniper Networks Junos OS on QFX5000 Series and EX4600 switches may cause the memory to not be freed, leading to a packet DMA memory leak, and eventual Denial of Service (DoS) condition. Once the condition occurs, further packet processing will be impacted, creating a sustained Denial of Service (DoS) condition. The following error logs may be observed using the \"show heap\" command and the device may eventually run out of memory if such packets are received continuously. Jan 12 12:00:00 device-name fpc0 (buf alloc) failed allocating packet buffer Jan 12 12:00:01 device-name fpc0 (buf alloc) failed allocating packet buffer user@device-name> request pfe execute target fpc0 timeout 30 command \"show heap\" ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 246fc1a8 536870488 353653752 183216736 34 Kernel 1 91800000 16777216 12069680 4707536 28 DMA 2 92800000 75497472 69997640 5499832 7 PKT DMA DESC 3 106fc000 335544320 221425960 114118360 34 Bcm_sdk 4 97000000 176160768 200 176160568 99 Packet DMA <<<<<<<<<<<<<< 5 903fffe0 20971504 20971504 0 0 Blob This issue affects Juniper Networks Junos OS on QFX5000 Series, EX4600: 18.3R3 versions prior to 18.3R3-S6; 18.4 versions prior to 18.4R2-S9, 18.4R3-S9; 19.1 versions prior to 19.1R2-S3, 19.1R3-S7; 19.2 versions prior to 19.2R1-S8, 19.2R3-S3; 19.3 versions prior to 19.3R2-S7, 19.3R3-S4; 19.4 versions prior to 19.4R2-S5, 19.4R3-S6; 20.1 versions prior to 20.1R3-S1; 20.2 versions prior to 20.2R3-S2; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2-S1, 21.1R3; 21.2 versions prior to 21.2R1-S1, 21.2R2. This issue does not affect Juniper Networks Junos OS: Any versions prior to 17.4R3; 18.1 versions prior to 18.1R3-S6; 18.2 versions prior to 18.2R3; 18.3 versions prior to 18.3R3; 18.4 versions prior to 18.4R2; 19.1 versions prior to 19.1R2.", "datePublished": "2022-01-19T00:21:22", "dateUpdated": "2024-09-16T20:32:58", "baseScore": 7.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA11280"], "aliases": ["CVE-2022-22174"], "assigner": "juniper", "epss": 0.39, "enisaIdProduct": [{"id": "05ee7da9-ff82-3b37-8cea-594a4b081f7c", "product": {"name": "Junos OS"}, "product_version": "21.1 <21.1R2-S1, 21.1R3"}, {"id": "0f4b67a0-9f60-3e0f-ad9c-28c7e702ace9", "product": {"name": "Junos OS"}, "product_version": "18.4 <18.4R2-S9, 18.4R3-S9"}, {"id": "343600fb-2507-3c3c-b542-842d8fd2d165", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R2-S7, 19.3R3-S4"}, {"id": "39d1e91f-a41e-30a5-954e-e8a24b8664f8", "product": {"name": "Junos OS"}, "product_version": "19.1 <19.1R2-S3, 19.1R3-S7"}, {"id": "4858909a-de3b-3f83-b328-6a8bb5bb618b", "product": {"name": "Junos OS"}, "product_version": "21.2 <21.2R1-S1, 21.2R2"}, {"id": "6b9dfbde-3826-3c15-a795-e14631288ed0", "product": {"name": "Junos OS"}, "product_version": "19.4 <19.4R2-S5, 19.4R3-S6"}, {"id": "834fa12c-990e-3718-8874-3faf259e2172", "product": {"name": "Junos OS"}, "product_version": "19.2 <19.2R1-S8, 19.2R3-S3"}, {"id": "999f59ac-cfd8-3523-9762-43d061977374", "product": {"name": "Junos OS"}, "product_version": "18.3 <18.3R3-S6"}, {"id": "9e771c6d-925c-3e5d-a9b6-9d2757d76cd4", "product": {"name": "Junos OS"}, "product_version": "20.2 <20.2R3-S2"}, {"id": "a2db0f2e-0634-33c2-bb7c-82c9a39ed0d7", "product": {"name": "Junos OS"}, "product_version": "20.4 <20.4R3"}, {"id": "a979c747-70db-34df-8297-229c0e620f52", "product": {"name": "Junos OS"}, "product_version": "20.3 <20.3R3-S1"}, {"id": "d6240544-6e95-3787-8c65-aac4ec21f0ac", "product": {"name": "Junos OS"}, "product_version": "20.1 <20.1R3-S1"}], "enisaIdVendor": [{"id": "00204706-c4c2-3a5e-8243-7e70dafc62fc", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}