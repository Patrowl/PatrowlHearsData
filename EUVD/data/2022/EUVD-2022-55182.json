{"id": "EUVD-2022-55182", "enisaUuid": "6f955d1a-1014-315b-a6e4-5b7c73915582", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfbdev: smscufx: fix error handling code in ufx_usb_probe\n\nThe current error handling code in ufx_usb_probe have many unmatching\nissues, e.g., missing ufx_free_usb_list, destroy_modedb label should\nonly include framebuffer_release, fb_dealloc_cmap only matches\nfb_alloc_cmap.\n\nMy local syzkaller reports a memory leak bug:\n\nmemory leak in ufx_usb_probe\n\nBUG: memory leak\nunreferenced object 0xffff88802f879580 (size 128):\n  comm \"kworker/0:7\", pid 17416, jiffies 4295067474 (age 46.710s)\n  hex dump (first 32 bytes):\n    80 21 7c 2e 80 88 ff ff 18 d0 d0 0c 80 88 ff ff  .!|.............\n    00 d0 d0 0c 80 88 ff ff e0 ff ff ff 0f 00 00 00  ................\n  backtrace:\n    [<ffffffff814c99a0>] kmalloc_trace+0x20/0x90 mm/slab_common.c:1045\n    [<ffffffff824d219c>] kmalloc include/linux/slab.h:553 [inline]\n    [<ffffffff824d219c>] kzalloc include/linux/slab.h:689 [inline]\n    [<ffffffff824d219c>] ufx_alloc_urb_list drivers/video/fbdev/smscufx.c:1873 [inline]\n    [<ffffffff824d219c>] ufx_usb_probe+0x11c/0x15a0 drivers/video/fbdev/smscufx.c:1655\n    [<ffffffff82d17927>] usb_probe_interface+0x177/0x370 drivers/usb/core/driver.c:396\n    [<ffffffff82712f0d>] call_driver_probe drivers/base/dd.c:560 [inline]\n    [<ffffffff82712f0d>] really_probe+0x12d/0x390 drivers/base/dd.c:639\n    [<ffffffff8271322f>] __driver_probe_device+0xbf/0x140 drivers/base/dd.c:778\n    [<ffffffff827132da>] driver_probe_device+0x2a/0x120 drivers/base/dd.c:808\n    [<ffffffff82713c27>] __device_attach_driver+0xf7/0x150 drivers/base/dd.c:936\n    [<ffffffff82710137>] bus_for_each_drv+0xb7/0x100 drivers/base/bus.c:427\n    [<ffffffff827136b5>] __device_attach+0x105/0x2d0 drivers/base/dd.c:1008\n    [<ffffffff82711d36>] bus_probe_device+0xc6/0xe0 drivers/base/bus.c:487\n    [<ffffffff8270e242>] device_add+0x642/0xdc0 drivers/base/core.c:3517\n    [<ffffffff82d14d5f>] usb_set_configuration+0x8ef/0xb80 drivers/usb/core/message.c:2170\n    [<ffffffff82d2576c>] usb_generic_driver_probe+0x8c/0xc0 drivers/usb/core/generic.c:238\n    [<ffffffff82d16ffc>] usb_probe_device+0x5c/0x140 drivers/usb/core/driver.c:293\n    [<ffffffff82712f0d>] call_driver_probe drivers/base/dd.c:560 [inline]\n    [<ffffffff82712f0d>] really_probe+0x12d/0x390 drivers/base/dd.c:639\n    [<ffffffff8271322f>] __driver_probe_device+0xbf/0x140 drivers/base/dd.c:778\n\nFix this bug by rewriting the error handling code in ufx_usb_probe.", "datePublished": "2025-03-27T16:42:52", "dateUpdated": "2025-12-23T13:25:28", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/3b3d3127f5b4291ae4caaf50f7b66089ad600480", "https://git.kernel.org/stable/c/3931014367ef31d26af65386a4ca496f50f0cfdf", "https://git.kernel.org/stable/c/64fa364ad3245508d393e16ed4886f92d7eb423c", "https://git.kernel.org/stable/c/1b4c08844628dfc8d72d3f51b657f2a5e63b7b4b", "https://git.kernel.org/stable/c/b76449ee75e21acfe9fa4c653d8598f191ed7d68"], "aliases": ["CVE-2022-49741"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "126a23a2-0180-31b1-90fa-5fb0494cd3be", "product": {"name": "Linux"}, "product_version": "patch: 6.1.11"}, {"id": "2b5f5265-526b-33d2-94a8-c303ec459b3f", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "2cbef172-b264-3b59-867d-4d608c871cd9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3931014367ef31d26af65386a4ca496f50f0cfdf"}, {"id": "3392c04a-e9ec-3e1d-ae49-2b5c18860754", "product": {"name": "Linux"}, "product_version": "70faf9d9b6cc74418716bbf76fe75bd2da10ad4a"}, {"id": "3a7d0908-d203-30fd-8781-e4c1bd322fe6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1b4c08844628dfc8d72d3f51b657f2a5e63b7b4b"}, {"id": "4c5574d7-70fd-35d0-80f7-2b1903414549", "product": {"name": "Linux"}, "product_version": "3f40852d671072836fb7ae331a1f28a24223c4e8"}, {"id": "4e8fc60f-02e2-3f0b-aa0e-5dcc35d79dbd", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5981eec0-0c68-3877-a556-9052f7dab672", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b76449ee75e21acfe9fa4c653d8598f191ed7d68"}, {"id": "5e09bb67-bffb-3d3e-b0b3-056cca54eed1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.93"}, {"id": "6eb2f32a-78ec-38a2-9041-c1321092f68c", "product": {"name": "Linux"}, "product_version": "8d924b262f3178a9b17c17d4306a9f426c508bd9"}, {"id": "798e62a7-4077-3073-9ab7-5731fd8174f9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <64fa364ad3245508d393e16ed4886f92d7eb423c"}, {"id": "8c4d9987-3dbf-3e9f-951c-f3cd53605372", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3b3d3127f5b4291ae4caaf50f7b66089ad600480"}, {"id": "90de0ccd-d8a3-3866-b587-77ce95e9ae0d", "product": {"name": "Linux"}, "product_version": "cc67482c9e5f2c80d62f623bcc347c29f9f648e1 <b76449ee75e21acfe9fa4c653d8598f191ed7d68"}, {"id": "a127878f-bcb0-307c-ac2d-30995a513f86", "product": {"name": "Linux"}, "product_version": "cc6a7249842fceda7574ceb63275a2d5e99d2862 <64fa364ad3245508d393e16ed4886f92d7eb423c"}, {"id": "b58b3479-3bd4-32ad-9b7f-d2b16c6688eb", "product": {"name": "Linux"}, "product_version": "cc67482c9e5f2c80d62f623bcc347c29f9f648e1 <1b4c08844628dfc8d72d3f51b657f2a5e63b7b4b"}, {"id": "bb47367a-a369-3f07-8bcf-21fbafe1d559", "product": {"name": "Linux"}, "product_version": "patch: 5.10.168"}, {"id": "bcc7cf61-c902-3117-8a44-bc414f59bfd3", "product": {"name": "Linux"}, "product_version": "5385af2f89bc352fb70753ab41b2bb036190141f <3b3d3127f5b4291ae4caaf50f7b66089ad600480"}, {"id": "c9b83482-89bd-341a-aca5-1c3bca2a2c80", "product": {"name": "Linux"}, "product_version": "d9ddfeb01fb95ffbbc7031d46a5ee2a5e45cbb86 <3931014367ef31d26af65386a4ca496f50f0cfdf"}, {"id": "d2f3b306-a0b1-345c-b97d-dc8a41b2403a", "product": {"name": "Linux"}, "product_version": "6f2075ea883e5d7730d0c9ebb1bb8e7a1a7e953f"}, {"id": "e0cba400-04fe-336d-8720-94e15dc4b9cf", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "e4816e94-9c1c-3bd2-ad84-108f3cb527fc", "product": {"name": "Linux"}, "product_version": "patch: 5.4.232"}], "enisaIdVendor": [{"id": "b5644e32-38ed-368e-b127-b28752ade01f", "vendor": {"name": "Linux"}}], "isExploited": false}