{"id": "EUVD-2022-55351", "enisaUuid": "cc386f54-60a2-384a-91c2-09bd858ab957", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix warning in ext4_iomap_begin as race between bmap and write\n\nWe got issue as follows:\n------------[ cut here ]------------\nWARNING: CPU: 3 PID: 9310 at fs/ext4/inode.c:3441 ext4_iomap_begin+0x182/0x5d0\nRIP: 0010:ext4_iomap_begin+0x182/0x5d0\nRSP: 0018:ffff88812460fa08 EFLAGS: 00010293\nRAX: ffff88811f168000 RBX: 0000000000000000 RCX: ffffffff97793c12\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003\nRBP: ffff88812c669160 R08: ffff88811f168000 R09: ffffed10258cd20f\nR10: ffff88812c669077 R11: ffffed10258cd20e R12: 0000000000000001\nR13: 00000000000000a4 R14: 000000000000000c R15: ffff88812c6691ee\nFS:  00007fd0d6ff3740(0000) GS:ffff8883af180000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007fd0d6dda290 CR3: 0000000104a62000 CR4: 00000000000006e0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n iomap_apply+0x119/0x570\n iomap_bmap+0x124/0x150\n ext4_bmap+0x14f/0x250\n bmap+0x55/0x80\n do_vfs_ioctl+0x952/0xbd0\n __x64_sys_ioctl+0xc6/0x170\n do_syscall_64+0x33/0x40\n entry_SYSCALL_64_after_hwframe+0x44/0xa9\n\nAbove issue may happen as follows:\n          bmap                    write\nbmap\n  ext4_bmap\n    iomap_bmap\n      ext4_iomap_begin\n                            ext4_file_write_iter\n\t\t\t      ext4_buffered_write_iter\n\t\t\t        generic_perform_write\n\t\t\t\t  ext4_da_write_begin\n\t\t\t\t    ext4_da_write_inline_data_begin\n\t\t\t\t      ext4_prepare_inline_data\n\t\t\t\t        ext4_create_inline_data\n\t\t\t\t\t  ext4_set_inode_flag(inode,\n\t\t\t\t\t\tEXT4_INODE_INLINE_DATA);\n      if (WARN_ON_ONCE(ext4_has_inline_data(inode))) ->trigger bug_on\n\nTo solved above issue hold inode lock in ext4_bamp.", "datePublished": "2025-06-18T11:02:24", "dateUpdated": "2025-12-23T13:26:46", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e1682c7171a6c0ff576fe8116b8cba5b8f538b94", "https://git.kernel.org/stable/c/30dfb75e1f8645404a536c74d468d498adcd4e74", "https://git.kernel.org/stable/c/a9fe6d1e3d343d7309f501b1f48020ce7127221f", "https://git.kernel.org/stable/c/fa6482f374fda29a71ad44d76d35b4842d43cda4", "https://git.kernel.org/stable/c/51ae846cff568c8c29921b1b28eb2dfbcd4ac12d", "https://nvd.nist.gov/vuln/detail/CVE-2022-50082"], "aliases": ["CVE-2022-50082"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1fd44771-c31c-31ae-8886-d16a1f9860d2", "product": {"name": "Linux"}, "product_version": "ac58e4fb03f9d111d733a4ad379d06eef3a24705 <e1682c7171a6c0ff576fe8116b8cba5b8f538b94"}, {"id": "309ce6d4-b859-3519-929d-6deea32e226e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "45ce9c7a-4ef8-30a6-85b5-b655c5f2756d", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "46fbc6d1-58c8-3c76-a493-2a480be3a4bb", "product": {"name": "Linux"}, "product_version": "ac58e4fb03f9d111d733a4ad379d06eef3a24705 <fa6482f374fda29a71ad44d76d35b4842d43cda4"}, {"id": "4a14ebc8-c8d3-39e4-a7f1-3a17f80329b2", "product": {"name": "Linux"}, "product_version": "ac58e4fb03f9d111d733a4ad379d06eef3a24705 <a9fe6d1e3d343d7309f501b1f48020ce7127221f"}, {"id": "758eaa1c-eace-3e04-b88f-3ef367fd0492", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "7bd3028a-dc85-31f2-8916-ff935e0feab5", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "7e17eb0b-7a0b-39c4-a75b-bb4043f1e8ff", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e1682c7171a6c0ff576fe8116b8cba5b8f538b94"}, {"id": "7ef1e3fa-fac5-3c1c-90b8-1468929d9bd3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fa6482f374fda29a71ad44d76d35b4842d43cda4"}, {"id": "856016d8-7e5b-3593-871d-05a645a80e2e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8566cad0-2602-3f45-b664-99c9e7ea2c18", "product": {"name": "Linux"}, "product_version": "ac58e4fb03f9d111d733a4ad379d06eef3a24705 <30dfb75e1f8645404a536c74d468d498adcd4e74"}, {"id": "88a17125-1160-3e72-9ce6-0a8e0eea9827", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <51ae846cff568c8c29921b1b28eb2dfbcd4ac12d"}, {"id": "b41b2c46-8e3d-3fce-ac3d-da76d215cfbf", "product": {"name": "Linux"}, "product_version": "ac58e4fb03f9d111d733a4ad379d06eef3a24705 <51ae846cff568c8c29921b1b28eb2dfbcd4ac12d"}, {"id": "bc415e6b-c8bf-32e5-86fc-1a6c46492804", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <30dfb75e1f8645404a536c74d468d498adcd4e74"}, {"id": "d2dc74be-b729-386a-83e2-f60af8e011ec", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a9fe6d1e3d343d7309f501b1f48020ce7127221f"}, {"id": "d7202c88-40f6-3bb2-81a0-c447ce5a7196", "product": {"name": "Linux"}, "product_version": "patch: 5.10.137"}, {"id": "fc6f2def-94bd-351a-a5a3-809236d56c5f", "product": {"name": "Linux"}, "product_version": "5.7"}], "enisaIdVendor": [{"id": "8f1b0380-5a7f-3e69-ade6-94f13dc75316", "vendor": {"name": "Linux"}}], "isExploited": false}