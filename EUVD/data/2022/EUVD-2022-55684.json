{"id": "EUVD-2022-55684", "enisaUuid": "a6f43b0e-97b0-35af-9884-3f88332a0969", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/gud: Fix UBSAN warning\n\nUBSAN complains about invalid value for bool:\n\n[  101.165172] [drm] Initialized gud 1.0.0 20200422 for 2-3.2:1.0 on minor 1\n[  101.213360] gud 2-3.2:1.0: [drm] fb1: guddrmfb frame buffer device\n[  101.213426] usbcore: registered new interface driver gud\n[  101.989431] ================================================================================\n[  101.989441] UBSAN: invalid-load in linux/include/linux/iosys-map.h:253:9\n[  101.989447] load of value 121 is not a valid value for type '_Bool'\n[  101.989451] CPU: 1 PID: 455 Comm: kworker/1:6 Not tainted 5.18.0-rc5-gud-5.18-rc5 #3\n[  101.989456] Hardware name: Hewlett-Packard HP EliteBook 820 G1/1991, BIOS L71 Ver. 01.44 04/12/2018\n[  101.989459] Workqueue: events_long gud_flush_work [gud]\n[  101.989471] Call Trace:\n[  101.989474]  <TASK>\n[  101.989479]  dump_stack_lvl+0x49/0x5f\n[  101.989488]  dump_stack+0x10/0x12\n[  101.989493]  ubsan_epilogue+0x9/0x3b\n[  101.989498]  __ubsan_handle_load_invalid_value.cold+0x44/0x49\n[  101.989504]  dma_buf_vmap.cold+0x38/0x3d\n[  101.989511]  ? find_busiest_group+0x48/0x300\n[  101.989520]  drm_gem_shmem_vmap+0x76/0x1b0 [drm_shmem_helper]\n[  101.989528]  drm_gem_shmem_object_vmap+0x9/0xb [drm_shmem_helper]\n[  101.989535]  drm_gem_vmap+0x26/0x60 [drm]\n[  101.989594]  drm_gem_fb_vmap+0x47/0x150 [drm_kms_helper]\n[  101.989630]  gud_prep_flush+0xc1/0x710 [gud]\n[  101.989639]  ? _raw_spin_lock+0x17/0x40\n[  101.989648]  gud_flush_work+0x1e0/0x430 [gud]\n[  101.989653]  ? __switch_to+0x11d/0x470\n[  101.989664]  process_one_work+0x21f/0x3f0\n[  101.989673]  worker_thread+0x200/0x3e0\n[  101.989679]  ? rescuer_thread+0x390/0x390\n[  101.989684]  kthread+0xfd/0x130\n[  101.989690]  ? kthread_complete_and_exit+0x20/0x20\n[  101.989696]  ret_from_fork+0x22/0x30\n[  101.989706]  </TASK>\n[  101.989708] ================================================================================\n\nThe source of this warning is in iosys_map_clear() called from\ndma_buf_vmap(). It conditionally sets values based on map->is_iomem. The\niosys_map variables are allocated uninitialized on the stack leading to\n->is_iomem having all kinds of values and not only 0/1.\n\nFix this by zeroing the iosys_map variables.", "datePublished": "2025-12-08T03:31:03", "dateUpdated": "2025-12-08T03:31:03", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/832f861a46039d50536dcfda0a9fb334b48d0f8b", "https://git.kernel.org/stable/c/e1078b270d218f8d58efb4d78ea25a4d16ba3490", "https://git.kernel.org/stable/c/951df98024f7272f85df5044eca7374f5b5b24ef", "https://nvd.nist.gov/vuln/detail/CVE-2022-50628"], "aliases": ["CVE-2022-50628"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "26f9d804-8f92-353c-97a5-ed2279e66342", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "53f4c6a3-04a8-331b-98bf-edee2e299de4", "product": {"name": "Linux"}, "product_version": "40e1a70b4aedf2859a1829991b48ef0ebe650bf2 <832f861a46039d50536dcfda0a9fb334b48d0f8b"}, {"id": "5f08522a-e9f1-36e1-a123-cca8c23e420c", "product": {"name": "Linux"}, "product_version": "5.13"}, {"id": "7f9ddb19-400b-3ec4-94a2-964087141e83", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}, {"id": "93d1adc1-7b48-3f5d-9f05-91b4324d13f9", "product": {"name": "Linux"}, "product_version": "40e1a70b4aedf2859a1829991b48ef0ebe650bf2 <e1078b270d218f8d58efb4d78ea25a4d16ba3490"}, {"id": "e9032fea-595c-3ebc-a0cc-644d165e7c3d", "product": {"name": "Linux"}, "product_version": "40e1a70b4aedf2859a1829991b48ef0ebe650bf2 <951df98024f7272f85df5044eca7374f5b5b24ef"}, {"id": "ef89e97b-fd96-3d7d-8f4a-72dd0a4381b1", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "f4dccfa6-9cb0-360c-a701-d1870a6f2efd", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "4718f6a8-5c3d-3505-9174-43dc2a204f3b", "vendor": {"name": "Linux"}}], "isExploited": false}