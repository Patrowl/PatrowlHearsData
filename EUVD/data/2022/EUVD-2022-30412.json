{"id": "EUVD-2022-30412", "enisaUuid": "bc92a73d-5745-37c9-931b-a1c20479846c", "description": "In Apache APISIX before 2.13.0, when decoding JSON with duplicate keys, lua-cjson will choose the last occurred value as the result. By passing a JSON with a duplicate key, the attacker can bypass the body_schema validation in the request-validation plugin. For example, `{\"string_payload\":\"bad\",\"string_payload\":\"good\"}` can be used to hide the \"bad\" input. Systems satisfy three conditions below are affected by this attack: 1. use body_schema validation in the request-validation plugin 2. upstream application uses a special JSON library that chooses the first occurred value, like jsoniter or gojay 3. upstream application does not validate the input anymore. The fix in APISIX is to re-encode the validated JSON input back into the request body at the side of APISIX. Improper Input Validation vulnerability in __COMPONENT__ of Apache APISIX allows an attacker to __IMPACT__. This issue affects Apache APISIX Apache APISIX version 2.12.1 and prior versions.", "datePublished": "2022-03-28T07:00:16", "dateUpdated": "2024-08-03T04:49:43", "baseScore": 9.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "references": ["https://lists.apache.org/thread/03vd2j81krxmpz6xo8p1dl642flpo6fv", "http://www.openwall.com/lists/oss-security/2022/03/28/2"], "aliases": ["CVE-2022-25757"], "assigner": "apache", "epss": 0.49, "enisaIdProduct": [{"id": "5b595798-f4f2-3886-86a4-e132cc7f91a6", "product": {"name": "Apache APISIX"}, "product_version": "Apache APISIX \u22642.12.1"}], "enisaIdVendor": [{"id": "12ee26f3-0e27-3fd9-8a9d-e4ef70d85e77", "vendor": {"name": "Apache Software Foundation"}}], "isExploited": false}