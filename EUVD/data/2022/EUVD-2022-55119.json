{"id": "EUVD-2022-55119", "enisaUuid": "04b5c7ad-ba17-3799-b9aa-da62b07d062f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrbd: Fix five use after free bugs in get_initial_state\n\nIn get_initial_state, it calls notify_initial_state_done(skb,..) if\ncb->args[5]==1. If genlmsg_put() failed in notify_initial_state_done(),\nthe skb will be freed by nlmsg_free(skb).\nThen get_initial_state will goto out and the freed skb will be used by\nreturn value skb->len, which is a uaf bug.\n\nWhat's worse, the same problem goes even further: skb can also be\nfreed in the notify_*_state_change -> notify_*_state calls below.\nThus 4 additional uaf bugs happened.\n\nMy patch lets the problem callee functions: notify_initial_state_done\nand notify_*_state_change return an error code if errors happen.\nSo that the error codes could be propagated and the uaf bugs can be avoid.\n\nv2 reports a compilation warning. This v3 fixed this warning and built\nsuccessfully in my local environment with no additional warnings.\nv2: https://lore.kernel.org/patchwork/patch/1435218/", "datePublished": "2025-02-26T01:54:43", "dateUpdated": "2025-02-26T01:54:43", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/0489700bfeb1e53eb2039c2291c67e71b0b40103", "https://git.kernel.org/stable/c/dcf6be17b5c53b741898d2223b23e66d682de300", "https://git.kernel.org/stable/c/188fe6b26765edbad4055611c0f788b6870f4024", "https://git.kernel.org/stable/c/b6a4055036eed1f5e239ce3d8b0db1ce38bba447", "https://git.kernel.org/stable/c/594205b4936771a250f9d141e7e0fff21c3dd2d9", "https://git.kernel.org/stable/c/a972c768723359ec995579902473028fe3cd64b1", "https://git.kernel.org/stable/c/de63e74da2333b4068bb79983e632db730fea97e", "https://git.kernel.org/stable/c/226e993c39405292781bfcf4b039a8db56aab362", "https://git.kernel.org/stable/c/aadb22ba2f656581b2f733deb3a467c48cc618f6"], "aliases": ["CVE-2022-49085"], "assigner": "Linux", "epss": 0.07, "enisaIdProduct": [{"id": "1da69339-cfce-38ee-b235-287cc21debad", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <188fe6b26765edbad4055611c0f788b6870f4024"}, {"id": "21dcf243-9dbe-3b44-b3a9-8745bd6dd2be", "product": {"name": "Linux"}, "product_version": "patch: 5.15.34"}, {"id": "2939136f-17a1-377c-9271-69382beb0cb0", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <594205b4936771a250f9d141e7e0fff21c3dd2d9"}, {"id": "2b379ce5-0998-30c4-8918-7e6a1d6b8e38", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <aadb22ba2f656581b2f733deb3a467c48cc618f6"}, {"id": "364e92a0-c65c-3a3c-87ad-0a2d6c4e419c", "product": {"name": "Linux"}, "product_version": "patch: 4.9.311"}, {"id": "49f48295-da48-396a-bafc-09a98d8c7b8c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "83446bdd-ea2d-3ab5-a37a-f75bfaafaebf", "product": {"name": "Linux"}, "product_version": "patch: 4.14.276"}, {"id": "8b238083-e1d4-3285-8a28-998270222bec", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <de63e74da2333b4068bb79983e632db730fea97e"}, {"id": "9780dbd7-4f17-3061-9c04-cd707e2a5bb6", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "9af514bb-19c1-3cd2-97e0-57e65cf3f731", "product": {"name": "Linux"}, "product_version": "patch: 5.16.20"}, {"id": "9b95a066-cc1d-38db-bb2d-593b563e7472", "product": {"name": "Linux"}, "product_version": "4.5"}, {"id": "9cc1abf0-83a3-3f54-bd4f-a9b274ed2be7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.189"}, {"id": "b3d71867-35fb-3489-83db-81d0004d994b", "product": {"name": "Linux"}, "product_version": "patch: 5.17.3"}, {"id": "ba26e9fa-a101-37e9-9fe1-a9824e519d64", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <a972c768723359ec995579902473028fe3cd64b1"}, {"id": "bdc43aa8-1fe6-3518-bf1d-e58ddc31e440", "product": {"name": "Linux"}, "product_version": "patch: 4.19.238"}, {"id": "ca1a36cf-1f99-3267-94df-517f02d622d1", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <226e993c39405292781bfcf4b039a8db56aab362"}, {"id": "d5c5303e-2471-336d-8850-872528adcec4", "product": {"name": "Linux"}, "product_version": "patch: 5.10.111"}, {"id": "e0566735-e476-3e2a-b9b8-3fbce25d6b3f", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <b6a4055036eed1f5e239ce3d8b0db1ce38bba447"}, {"id": "e631d9a1-f4b3-34f2-bae3-18d79a39bfe2", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <0489700bfeb1e53eb2039c2291c67e71b0b40103"}, {"id": "e975e13d-a0cd-3ce6-b7b3-1198d0da0c7a", "product": {"name": "Linux"}, "product_version": "a29728463b254ce81ecefdf20c1a02e01d9361da <dcf6be17b5c53b741898d2223b23e66d682de300"}], "enisaIdVendor": [{"id": "029e5420-e38e-34dc-b506-7d8ff99394e9", "vendor": {"name": "Linux"}}], "isExploited": false}