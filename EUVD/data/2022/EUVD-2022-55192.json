{"id": "EUVD-2022-55192", "enisaUuid": "8e81448a-9736-3507-8690-f53fb9f3e9cb", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: core: Prevent nested device-reset calls\n\nAutomatic kernel fuzzing revealed a recursive locking violation in\nusb-storage:\n\n============================================\nWARNING: possible recursive locking detected\n5.18.0 #3 Not tainted\n--------------------------------------------\nkworker/1:3/1205 is trying to acquire lock:\nffff888018638db8 (&us_interface_key[i]){+.+.}-{3:3}, at:\nusb_stor_pre_reset+0x35/0x40 drivers/usb/storage/usb.c:230\n\nbut task is already holding lock:\nffff888018638db8 (&us_interface_key[i]){+.+.}-{3:3}, at:\nusb_stor_pre_reset+0x35/0x40 drivers/usb/storage/usb.c:230\n\n...\n\nstack backtrace:\nCPU: 1 PID: 1205 Comm: kworker/1:3 Not tainted 5.18.0 #3\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\n1.13.0-1ubuntu1.1 04/01/2014\nWorkqueue: usb_hub_wq hub_event\nCall Trace:\n<TASK>\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\nprint_deadlock_bug kernel/locking/lockdep.c:2988 [inline]\ncheck_deadlock kernel/locking/lockdep.c:3031 [inline]\nvalidate_chain kernel/locking/lockdep.c:3816 [inline]\n__lock_acquire.cold+0x152/0x3ca kernel/locking/lockdep.c:5053\nlock_acquire kernel/locking/lockdep.c:5665 [inline]\nlock_acquire+0x1ab/0x520 kernel/locking/lockdep.c:5630\n__mutex_lock_common kernel/locking/mutex.c:603 [inline]\n__mutex_lock+0x14f/0x1610 kernel/locking/mutex.c:747\nusb_stor_pre_reset+0x35/0x40 drivers/usb/storage/usb.c:230\nusb_reset_device+0x37d/0x9a0 drivers/usb/core/hub.c:6109\nr871xu_dev_remove+0x21a/0x270 drivers/staging/rtl8712/usb_intf.c:622\nusb_unbind_interface+0x1bd/0x890 drivers/usb/core/driver.c:458\ndevice_remove drivers/base/dd.c:545 [inline]\ndevice_remove+0x11f/0x170 drivers/base/dd.c:537\n__device_release_driver drivers/base/dd.c:1222 [inline]\ndevice_release_driver_internal+0x1a7/0x2f0 drivers/base/dd.c:1248\nusb_driver_release_interface+0x102/0x180 drivers/usb/core/driver.c:627\nusb_forced_unbind_intf+0x4d/0xa0 drivers/usb/core/driver.c:1118\nusb_reset_device+0x39b/0x9a0 drivers/usb/core/hub.c:6114\n\nThis turned out not to be an error in usb-storage but rather a nested\ndevice reset attempt.  That is, as the rtl8712 driver was being\nunbound from a composite device in preparation for an unrelated USB\nreset (that driver does not have pre_reset or post_reset callbacks),\nits ->remove routine called usb_reset_device() -- thus nesting one\nreset call within another.\n\nPerforming a reset as part of disconnect processing is a questionable\npractice at best.  However, the bug report points out that the USB\ncore does not have any protection against nested resets.  Adding a\nreset_in_progress flag and testing it will prevent such errors in the\nfuture.", "datePublished": "2025-06-18T10:54:37", "dateUpdated": "2025-12-23T13:26:07", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d90419b8b8322b6924f6da9da952647f2dadc21b", "https://git.kernel.org/stable/c/1b29498669914c7f9afb619722421418a753d372", "https://git.kernel.org/stable/c/cc9a12e12808af178c600cc485338bac2e37d2a8", "https://git.kernel.org/stable/c/df1875084898b15cbc42f712e93d7f113ae6271b", "https://git.kernel.org/stable/c/abe3cfb7a7c8e907b312c7dbd7bf4d142b745aa8", "https://git.kernel.org/stable/c/c548b99e1c37db6f7df86ecfe9a1f895d6c5966e", "https://git.kernel.org/stable/c/d5eb850b3e8836197a38475840725260b9783e94", "https://git.kernel.org/stable/c/9c6d778800b921bde3bff3cff5003d1650f942d1", "https://nvd.nist.gov/vuln/detail/CVE-2022-49936"], "aliases": ["CVE-2022-49936"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "1b198d83-67a9-39d4-8e37-5ae79c893217", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <d90419b8b8322b6924f6da9da952647f2dadc21b"}, {"id": "1ee58008-f780-3861-904a-f1d19733c88d", "product": {"name": "Linux"}, "product_version": "patch: 4.14.293"}, {"id": "258baad3-d483-3048-94c5-aabe0ad01c99", "product": {"name": "Linux"}, "product_version": "patch: 4.19.258"}, {"id": "2836a40f-88d2-3506-9498-9501708bbab7", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <d5eb850b3e8836197a38475840725260b9783e94"}, {"id": "2b321b95-c175-3019-9fe6-7392c069a1f4", "product": {"name": "Linux"}, "product_version": "patch: 5.4.213"}, {"id": "33cce5fc-5bd9-3d6b-bf1c-b083b399e7b5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cc9a12e12808af178c600cc485338bac2e37d2a8"}, {"id": "40db9e72-0eb9-32a3-9d24-e346bea2e09e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <abe3cfb7a7c8e907b312c7dbd7bf4d142b745aa8"}, {"id": "51c4694d-56c0-3f11-9dd4-29b2abfc8274", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1b29498669914c7f9afb619722421418a753d372"}, {"id": "63837012-50e3-3845-a907-0ee1e0817889", "product": {"name": "Linux"}, "product_version": "patch: 4.9.328"}, {"id": "69dccd6b-7c28-3d92-9bf3-dec706d98f1d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.142"}, {"id": "98ae65a7-ca7d-38e9-8986-c7fdc4512364", "product": {"name": "Linux"}, "product_version": "patch: 5.15.66"}, {"id": "9ae2c9e8-20db-37c9-a384-9ae26a407c80", "product": {"name": "Linux"}, "product_version": "2.6.27"}, {"id": "a19d44cc-9864-3301-9d3e-2e72bcfe9cca", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <1b29498669914c7f9afb619722421418a753d372"}, {"id": "a3551381-9de5-3431-87ba-8410ec634617", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "a601248e-498e-3984-b3e2-034a74565641", "product": {"name": "Linux"}, "product_version": "patch: 5.19.8"}, {"id": "ae6341dd-6057-3f74-aee6-a90a786d8173", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <abe3cfb7a7c8e907b312c7dbd7bf4d142b745aa8"}, {"id": "b20a575b-540a-32fa-be52-8c6cb029250e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9c6d778800b921bde3bff3cff5003d1650f942d1"}, {"id": "c0d9e702-a8dd-35e4-acbd-b3eb1f90d449", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <c548b99e1c37db6f7df86ecfe9a1f895d6c5966e"}, {"id": "c85150f1-a9d1-36d0-a478-7fa8a08636a4", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <df1875084898b15cbc42f712e93d7f113ae6271b"}, {"id": "cd6cc235-fad6-395c-9c5d-e2101bf3722a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <df1875084898b15cbc42f712e93d7f113ae6271b"}, {"id": "d25df1ff-95fd-3d12-ab89-510552174f8a", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <9c6d778800b921bde3bff3cff5003d1650f942d1"}, {"id": "e18f9a22-fd5e-3950-8248-e124b04311f7", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e1b9a761-1a6f-33df-a1a0-c51af6faa237", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c548b99e1c37db6f7df86ecfe9a1f895d6c5966e"}, {"id": "e8681862-ab3a-3fb9-a83e-94d53b89770d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d90419b8b8322b6924f6da9da952647f2dadc21b"}, {"id": "ef6fb742-24b9-30ae-b36c-6164f6e98b62", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d5eb850b3e8836197a38475840725260b9783e94"}, {"id": "f764785a-0f62-3903-ba0c-06920aef9fbf", "product": {"name": "Linux"}, "product_version": "78d9a487ee961c356e1a934d9a92eca38ffb3a70 <cc9a12e12808af178c600cc485338bac2e37d2a8"}], "enisaIdVendor": [{"id": "54b3810a-5bd2-3a50-9567-8b888ba4edd0", "vendor": {"name": "Linux"}}], "isExploited": false}