{"id": "EUVD-2022-55718", "enisaUuid": "1d0b0dc6-0216-359a-9ec9-75a8ab170822", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix bug_on in __es_tree_search caused by bad boot loader inode\n\nWe got a issue as fllows:\n==================================================================\n kernel BUG at fs/ext4/extents_status.c:203!\n invalid opcode: 0000 [#1] PREEMPT SMP\n CPU: 1 PID: 945 Comm: cat Not tainted 6.0.0-next-20221007-dirty #349\n RIP: 0010:ext4_es_end.isra.0+0x34/0x42\n RSP: 0018:ffffc9000143b768 EFLAGS: 00010203\n RAX: 0000000000000000 RBX: ffff8881769cd0b8 RCX: 0000000000000000\n RDX: 0000000000000000 RSI: ffffffff8fc27cf7 RDI: 00000000ffffffff\n RBP: ffff8881769cd0bc R08: 0000000000000000 R09: ffffc9000143b5f8\n R10: 0000000000000001 R11: 0000000000000001 R12: ffff8881769cd0a0\n R13: ffff8881768e5668 R14: 00000000768e52f0 R15: 0000000000000000\n FS: 00007f359f7f05c0(0000)GS:ffff88842fd00000(0000)knlGS:0000000000000000\n CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n CR2: 00007f359f5a2000 CR3: 000000017130c000 CR4: 00000000000006e0\n DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n Call Trace:\n  <TASK>\n  __es_tree_search.isra.0+0x6d/0xf5\n  ext4_es_cache_extent+0xfa/0x230\n  ext4_cache_extents+0xd2/0x110\n  ext4_find_extent+0x5d5/0x8c0\n  ext4_ext_map_blocks+0x9c/0x1d30\n  ext4_map_blocks+0x431/0xa50\n  ext4_mpage_readpages+0x48e/0xe40\n  ext4_readahead+0x47/0x50\n  read_pages+0x82/0x530\n  page_cache_ra_unbounded+0x199/0x2a0\n  do_page_cache_ra+0x47/0x70\n  page_cache_ra_order+0x242/0x400\n  ondemand_readahead+0x1e8/0x4b0\n  page_cache_sync_ra+0xf4/0x110\n  filemap_get_pages+0x131/0xb20\n  filemap_read+0xda/0x4b0\n  generic_file_read_iter+0x13a/0x250\n  ext4_file_read_iter+0x59/0x1d0\n  vfs_read+0x28f/0x460\n  ksys_read+0x73/0x160\n  __x64_sys_read+0x1e/0x30\n  do_syscall_64+0x35/0x80\n  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n  </TASK>\n==================================================================\n\nIn the above issue, ioctl invokes the swap_inode_boot_loader function to\nswap inode<5> and inode<12>. However, inode<5> contain incorrect imode and\ndisordered extents, and i_nlink is set to 1. The extents check for inode in\nthe ext4_iget function can be bypassed bacause 5 is EXT4_BOOT_LOADER_INO.\nWhile links_count is set to 1, the extents are not initialized in\nswap_inode_boot_loader. After the ioctl command is executed successfully,\nthe extents are swapped to inode<12>, in this case, run the `cat` command\nto view inode<12>. And Bug_ON is triggered due to the incorrect extents.\n\nWhen the boot loader inode is not initialized, its imode can be one of the\nfollowing:\n1) the imode is a bad type, which is marked as bad_inode in ext4_iget and\n   set to S_IFREG.\n2) the imode is good type but not S_IFREG.\n3) the imode is S_IFREG.\n\nThe BUG_ON may be triggered by bypassing the check in cases 1 and 2.\nTherefore, when the boot loader inode is bad_inode or its imode is not\nS_IFREG, initialize the inode to avoid triggering the BUG.", "datePublished": "2025-12-09T00:00:11", "dateUpdated": "2025-12-23T13:30:24", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e76ede9d2c9e0af4573342b56d7cdbf757c18084", "https://git.kernel.org/stable/c/a95ba369255ddcdc5e43d38bc5203537bdf3a518", "https://git.kernel.org/stable/c/5f8d36abd2059bf1bd016b17d1fe78d8613deddd", "https://git.kernel.org/stable/c/78e335fb573e6a85718c4c24d5a052718a99a9ed", "https://git.kernel.org/stable/c/71e99ec1315fe98d322b17b9a28f204aaf15ffee", "https://git.kernel.org/stable/c/d480a49c15c465cb9a16db1379f4996e9b5bb9cc", "https://git.kernel.org/stable/c/feec0ea94c5ef4aa118750284c8a921698733ef2", "https://git.kernel.org/stable/c/a125c8806b7d3c3815b6f9f59d395b9d7527b0ef", "https://git.kernel.org/stable/c/991ed014de0840c5dc405b679168924afb2952ac", "https://nvd.nist.gov/vuln/detail/CVE-2022-50638"], "aliases": ["CVE-2022-50638"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "20254d48-d68e-3e03-a549-353affcd0069", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5f8d36abd2059bf1bd016b17d1fe78d8613deddd"}, {"id": "281276e5-9e4a-32b6-ac30-f7c70ad59d51", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <a95ba369255ddcdc5e43d38bc5203537bdf3a518"}, {"id": "2a9ba086-8ca7-38f3-9261-70dc492a7349", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <991ed014de0840c5dc405b679168924afb2952ac"}, {"id": "48e7a98d-3f91-3e83-a4dd-b4bfe96be888", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <feec0ea94c5ef4aa118750284c8a921698733ef2"}, {"id": "510b3cc3-128b-344c-bbd9-7525ae69473e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.87"}, {"id": "56f659ca-c2e2-3756-903b-14de77793bc3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a95ba369255ddcdc5e43d38bc5203537bdf3a518"}, {"id": "58bce7cc-1b3b-359f-9212-c98a20ed071e", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <a125c8806b7d3c3815b6f9f59d395b9d7527b0ef"}, {"id": "61bd4888-5475-34fc-bcdb-e0eaef50db2b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <78e335fb573e6a85718c4c24d5a052718a99a9ed"}, {"id": "6411e2f7-0b05-3f8d-98c6-e7821db43a38", "product": {"name": "Linux"}, "product_version": "3.10"}, {"id": "7088eeeb-7238-3108-9d84-722e744a598c", "product": {"name": "Linux"}, "product_version": "patch: 4.9.337"}, {"id": "712a8d02-75c4-38d2-bb46-321a8409cb95", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <78e335fb573e6a85718c4c24d5a052718a99a9ed"}, {"id": "7ebb7a14-abb2-3055-bfd0-715caf7872c3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d480a49c15c465cb9a16db1379f4996e9b5bb9cc"}, {"id": "813c4b62-f0da-3514-bd9c-06dcb6e3f335", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <d480a49c15c465cb9a16db1379f4996e9b5bb9cc"}, {"id": "840c79e0-e788-34cc-b3aa-a3222846c88c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <feec0ea94c5ef4aa118750284c8a921698733ef2"}, {"id": "85d16515-e315-3859-9edd-f90eeee6f2ef", "product": {"name": "Linux"}, "product_version": "patch: 4.19.270"}, {"id": "912fc5be-7a8a-33d2-a47b-f31bbd5021e5", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "9c9cc4e8-ecc9-3e8c-848c-506c4e647fbd", "product": {"name": "Linux"}, "product_version": "patch: 4.14.303"}, {"id": "aa5d21b0-1a41-3ca4-8f09-a220e30d9dcd", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ab205e04-52a1-3313-8e77-e31c6128cf38", "product": {"name": "Linux"}, "product_version": "patch: 6.1.4"}, {"id": "b540e35c-02a3-30b9-9055-78dae44c3934", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e76ede9d2c9e0af4573342b56d7cdbf757c18084"}, {"id": "bb821a65-be06-339e-a90b-7a4ba5f4d56d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.163"}, {"id": "cc327489-e127-3ec9-a756-fefa095baac1", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <5f8d36abd2059bf1bd016b17d1fe78d8613deddd"}, {"id": "d2e8a582-a109-383e-bd94-699db8078645", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <e76ede9d2c9e0af4573342b56d7cdbf757c18084"}, {"id": "d2f9a509-5387-3954-8d79-53c79e422b17", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <71e99ec1315fe98d322b17b9a28f204aaf15ffee"}, {"id": "de1a004a-351b-3252-b35d-c554b54ffb65", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <71e99ec1315fe98d322b17b9a28f204aaf15ffee"}, {"id": "e309b686-f91d-30fd-8755-ab8ee97a2f5b", "product": {"name": "Linux"}, "product_version": "393d1d1d76933886d5e1ce603214c9987589c6d5 <991ed014de0840c5dc405b679168924afb2952ac"}, {"id": "ef4b9503-bc9b-3816-ade9-433d392525f7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.229"}, {"id": "f306bd19-27b0-3b95-ac6d-32d305fd71f3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a125c8806b7d3c3815b6f9f59d395b9d7527b0ef"}, {"id": "f82521dc-1b22-327b-8226-23a5432c155e", "product": {"name": "Linux"}, "product_version": "patch: 6.0.18"}], "enisaIdVendor": [{"id": "1ec51502-d413-3e93-8110-dcae895bd0ef", "vendor": {"name": "Linux"}}], "isExploited": false}