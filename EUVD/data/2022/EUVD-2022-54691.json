{"id": "EUVD-2022-54691", "enisaUuid": "7ef0801f-c902-3362-85fa-07dfe9de2767", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrcu-tasks: Fix race in schedule and flush work\n\nWhile booting secondary CPUs, cpus_read_[lock/unlock] is not keeping\nonline cpumask stable. The transient online mask results in below\ncalltrace.\n\n[    0.324121] CPU1: Booted secondary processor 0x0000000001 [0x410fd083]\n[    0.346652] Detected PIPT I-cache on CPU2\n[    0.347212] CPU2: Booted secondary processor 0x0000000002 [0x410fd083]\n[    0.377255] Detected PIPT I-cache on CPU3\n[    0.377823] CPU3: Booted secondary processor 0x0000000003 [0x410fd083]\n[    0.379040] ------------[ cut here ]------------\n[    0.383662] WARNING: CPU: 0 PID: 10 at kernel/workqueue.c:3084 __flush_work+0x12c/0x138\n[    0.384850] Modules linked in:\n[    0.385403] CPU: 0 PID: 10 Comm: rcu_tasks_rude_ Not tainted 5.17.0-rc3-v8+ #13\n[    0.386473] Hardware name: Raspberry Pi 4 Model B Rev 1.4 (DT)\n[    0.387289] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[    0.388308] pc : __flush_work+0x12c/0x138\n[    0.388970] lr : __flush_work+0x80/0x138\n[    0.389620] sp : ffffffc00aaf3c60\n[    0.390139] x29: ffffffc00aaf3d20 x28: ffffffc009c16af0 x27: ffffff80f761df48\n[    0.391316] x26: 0000000000000004 x25: 0000000000000003 x24: 0000000000000100\n[    0.392493] x23: ffffffffffffffff x22: ffffffc009c16b10 x21: ffffffc009c16b28\n[    0.393668] x20: ffffffc009e53861 x19: ffffff80f77fbf40 x18: 00000000d744fcc9\n[    0.394842] x17: 000000000000000b x16: 00000000000001c2 x15: ffffffc009e57550\n[    0.396016] x14: 0000000000000000 x13: ffffffffffffffff x12: 0000000100000000\n[    0.397190] x11: 0000000000000462 x10: ffffff8040258008 x9 : 0000000100000000\n[    0.398364] x8 : 0000000000000000 x7 : ffffffc0093c8bf4 x6 : 0000000000000000\n[    0.399538] x5 : 0000000000000000 x4 : ffffffc00a976e40 x3 : ffffffc00810444c\n[    0.400711] x2 : 0000000000000004 x1 : 0000000000000000 x0 : 0000000000000000\n[    0.401886] Call trace:\n[    0.402309]  __flush_work+0x12c/0x138\n[    0.402941]  schedule_on_each_cpu+0x228/0x278\n[    0.403693]  rcu_tasks_rude_wait_gp+0x130/0x144\n[    0.404502]  rcu_tasks_kthread+0x220/0x254\n[    0.405264]  kthread+0x174/0x1ac\n[    0.405837]  ret_from_fork+0x10/0x20\n[    0.406456] irq event stamp: 102\n[    0.406966] hardirqs last  enabled at (101): [<ffffffc0093c8468>] _raw_spin_unlock_irq+0x78/0xb4\n[    0.408304] hardirqs last disabled at (102): [<ffffffc0093b8270>] el1_dbg+0x24/0x5c\n[    0.409410] softirqs last  enabled at (54): [<ffffffc0081b80c8>] local_bh_enable+0xc/0x2c\n[    0.410645] softirqs last disabled at (50): [<ffffffc0081b809c>] local_bh_disable+0xc/0x2c\n[    0.411890] ---[ end trace 0000000000000000 ]---\n[    0.413000] smp: Brought up 1 node, 4 CPUs\n[    0.413762] SMP: Total of 4 processors activated.\n[    0.414566] CPU features: detected: 32-bit EL0 Support\n[    0.415414] CPU features: detected: 32-bit EL1 Support\n[    0.416278] CPU features: detected: CRC32 instructions\n[    0.447021] Callback from call_rcu_tasks_rude() invoked.\n[    0.506693] Callback from call_rcu_tasks() invoked.\n\nThis commit therefore fixes this issue by applying a single-CPU\noptimization to the RCU Tasks Rude grace-period process.  The key point\nhere is that the purpose of this RCU flavor is to force a schedule on\neach online CPU since some past event.  But the rcu_tasks_rude_wait_gp()\nfunction runs in the context of the RCU Tasks Rude's grace-period kthread,\nso there must already have been a context switch on the current CPU since\nthe call to either synchronize_rcu_tasks_rude() or call_rcu_tasks_rude().\nSo if there is only a single CPU online, RCU Tasks Rude's grace-period\nkthread does not need to anything at all.\n\nIt turns out that the rcu_tasks_rude_wait_gp() function's call to\nschedule_on_each_cpu() causes problems during early boot.  During that\ntime, there is only one online CPU, namely the boot CPU.  Therefore,\napplying this single-CPU optimization fixes early-boot instances of\nthis problem.", "datePublished": "2025-02-26T02:13:56", "dateUpdated": "2025-12-23T13:24:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1c6c3f2336642fb3074593911f5176565f47ec41", "https://git.kernel.org/stable/c/ba722d061bc4b54802d701fc63fc2fd988934603", "https://git.kernel.org/stable/c/230bf5878af6038dfb63d9184272a58475236580", "https://git.kernel.org/stable/c/8f49a8758b5cd541bd7aa9a0d0d11c7426141c0e", "https://git.kernel.org/stable/c/f75fd4b9221d93177c50dcfde671b2e907f53e86", "https://nvd.nist.gov/vuln/detail/CVE-2022-49540"], "aliases": ["CVE-2022-49540"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "2a2eb8a9-044d-3bc0-b0cf-03cc4a95d08f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.46"}, {"id": "2e9895ed-f3f1-3de3-abea-82fb5424d0a1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ba722d061bc4b54802d701fc63fc2fd988934603"}, {"id": "775a4290-6249-3e5f-ab8e-5f7e4a100079", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "82102729-5f79-33bd-8553-94a32c7cf527", "product": {"name": "Linux"}, "product_version": "c84aad765406c4c7573ce449e8a9977ebb8f4cb9 <1c6c3f2336642fb3074593911f5176565f47ec41"}, {"id": "92227de0-e2f1-38bb-b58a-9c9c0829809e", "product": {"name": "Linux"}, "product_version": "c84aad765406c4c7573ce449e8a9977ebb8f4cb9 <8f49a8758b5cd541bd7aa9a0d0d11c7426141c0e"}, {"id": "9aa01d74-38bb-3114-95a7-a1bfcfaebcc6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <230bf5878af6038dfb63d9184272a58475236580"}, {"id": "bb881985-6685-342a-b0c7-e9016e47c650", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8f49a8758b5cd541bd7aa9a0d0d11c7426141c0e"}, {"id": "c74b7495-336c-3fca-a462-16d4f7706343", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "cb587053-e4d1-353e-92d3-8a5b7de4fc68", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f75fd4b9221d93177c50dcfde671b2e907f53e86"}, {"id": "d516f6b8-05ca-3ae3-85df-e3d7a5bcdca6", "product": {"name": "Linux"}, "product_version": "c84aad765406c4c7573ce449e8a9977ebb8f4cb9 <f75fd4b9221d93177c50dcfde671b2e907f53e86"}, {"id": "de3d48e3-63a9-3143-8ada-d8412248d78b", "product": {"name": "Linux"}, "product_version": "patch: 5.18.3"}, {"id": "e07de9d4-3385-322b-b410-6db76f695460", "product": {"name": "Linux"}, "product_version": "patch: 5.17.14"}, {"id": "e0bc3d7b-90dc-3da8-a339-387309d28718", "product": {"name": "Linux"}, "product_version": "c84aad765406c4c7573ce449e8a9977ebb8f4cb9 <230bf5878af6038dfb63d9184272a58475236580"}, {"id": "e57731a4-2e4f-326b-996d-76b23e755436", "product": {"name": "Linux"}, "product_version": "c84aad765406c4c7573ce449e8a9977ebb8f4cb9 <ba722d061bc4b54802d701fc63fc2fd988934603"}, {"id": "ed98e25e-32fa-3c06-bf32-f9542e38436a", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "f8911181-8b5d-381a-a4b0-ec2cda5e27d2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1c6c3f2336642fb3074593911f5176565f47ec41"}, {"id": "f9431859-afc9-3f4b-84a4-0c8ee2ad4dae", "product": {"name": "Linux"}, "product_version": "patch: 5.10.121"}], "enisaIdVendor": [{"id": "9ad19adc-fbd9-39e7-8cb7-904c055709bc", "vendor": {"name": "Linux"}}], "isExploited": false}