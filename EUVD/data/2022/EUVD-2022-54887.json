{"id": "EUVD-2022-54887", "enisaUuid": "a8abd4e7-7520-3f18-b7f9-cd01fdbb2944", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, arm64: Clear prog->jited_len along prog->jited\n\nsyzbot reported an illegal copy_to_user() attempt\nfrom bpf_prog_get_info_by_fd() [1]\n\nThere was no repro yet on this bug, but I think\nthat commit 0aef499f3172 (\"mm/usercopy: Detect vmalloc overruns\")\nis exposing a prior bug in bpf arm64.\n\nbpf_prog_get_info_by_fd() looks at prog->jited_len\nto determine if the JIT image can be copied out to user space.\n\nMy theory is that syzbot managed to get a prog where prog->jited_len\nhas been set to 43, while prog->bpf_func has ben cleared.\n\nIt is not clear why copy_to_user(uinsns, NULL, ulen) is triggering\nthis particular warning.\n\nI thought find_vma_area(NULL) would not find a vm_struct.\nAs we do not hold vmap_area_lock spinlock, it might be possible\nthat the found vm_struct was garbage.\n\n[1]\nusercopy: Kernel memory exposure attempt detected from vmalloc (offset 792633534417210172, size 43)!\nkernel BUG at mm/usercopy.c:101!\nInternal error: Oops - BUG: 0 [#1] PREEMPT SMP\nModules linked in:\nCPU: 0 PID: 25002 Comm: syz-executor.1 Not tainted 5.18.0-syzkaller-10139-g8291eaafed36 #0\nHardware name: linux,dummy-virt (DT)\npstate: 60400009 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : usercopy_abort+0x90/0x94 mm/usercopy.c:101\nlr : usercopy_abort+0x90/0x94 mm/usercopy.c:89\nsp : ffff80000b773a20\nx29: ffff80000b773a30 x28: faff80000b745000 x27: ffff80000b773b48\nx26: 0000000000000000 x25: 000000000000002b x24: 0000000000000000\nx23: 00000000000000e0 x22: ffff80000b75db67 x21: 0000000000000001\nx20: 000000000000002b x19: ffff80000b75db3c x18: 00000000fffffffd\nx17: 2820636f6c6c616d x16: 76206d6f72662064 x15: 6574636574656420\nx14: 74706d6574746120 x13: 2129333420657a69 x12: 73202c3237313031\nx11: 3237313434333533 x10: 3336323937207465 x9 : 657275736f707865\nx8 : ffff80000a30c550 x7 : ffff80000b773830 x6 : ffff80000b773830\nx5 : 0000000000000000 x4 : ffff00007fbbaa10 x3 : 0000000000000000\nx2 : 0000000000000000 x1 : f7ff000028fc0000 x0 : 0000000000000064\nCall trace:\n usercopy_abort+0x90/0x94 mm/usercopy.c:89\n check_heap_object mm/usercopy.c:186 [inline]\n __check_object_size mm/usercopy.c:252 [inline]\n __check_object_size+0x198/0x36c mm/usercopy.c:214\n check_object_size include/linux/thread_info.h:199 [inline]\n check_copy_size include/linux/thread_info.h:235 [inline]\n copy_to_user include/linux/uaccess.h:159 [inline]\n bpf_prog_get_info_by_fd.isra.0+0xf14/0xfdc kernel/bpf/syscall.c:3993\n bpf_obj_get_info_by_fd+0x12c/0x510 kernel/bpf/syscall.c:4253\n __sys_bpf+0x900/0x2150 kernel/bpf/syscall.c:4956\n __do_sys_bpf kernel/bpf/syscall.c:5021 [inline]\n __se_sys_bpf kernel/bpf/syscall.c:5019 [inline]\n __arm64_sys_bpf+0x28/0x40 kernel/bpf/syscall.c:5019\n __invoke_syscall arch/arm64/kernel/syscall.c:38 [inline]\n invoke_syscall+0x48/0x114 arch/arm64/kernel/syscall.c:52\n el0_svc_common.constprop.0+0x44/0xec arch/arm64/kernel/syscall.c:142\n do_el0_svc+0xa0/0xc0 arch/arm64/kernel/syscall.c:206\n el0_svc+0x44/0xb0 arch/arm64/kernel/entry-common.c:624\n el0t_64_sync_handler+0x1ac/0x1b0 arch/arm64/kernel/entry-common.c:642\n el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S:581\nCode: aa0003e3 d00038c0 91248000 97fff65f (d4210000)", "datePublished": "2025-10-21T12:31:25", "dateUpdated": "2025-10-21T12:31:25", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/aaf61a312af63e1cfe2264c4c5b8cd4ea3626025", "https://git.kernel.org/stable/c/e412b3d178ea4bf746f6b8ee086761613704c6be", "https://git.kernel.org/stable/c/0cf7aaff290cdc4d7cee683d4a18138b0dacac48", "https://git.kernel.org/stable/c/3f4d5e727aeaa610688d46c9f101f78b7f712583", "https://git.kernel.org/stable/c/5c25a3040bc0486c41a7b63a1fb0de7cdb846ad7", "https://git.kernel.org/stable/c/41f7c4f85d402043687e863627a1a84fa867c62d", "https://git.kernel.org/stable/c/10f3b29c65bb2fe0d47c2945cd0b4087be1c5218", "https://nvd.nist.gov/vuln/detail/CVE-2022-49341"], "aliases": ["CVE-2022-49341"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "0351fd57-0bf6-352c-ba1b-0dbc493cc937", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <41f7c4f85d402043687e863627a1a84fa867c62d"}, {"id": "064faab2-3ff2-32c3-b333-4b4f7c02dc67", "product": {"name": "Linux"}, "product_version": "patch: 5.15.47"}, {"id": "35e0e9de-94bf-3f62-b6ed-0b8138d3e25c", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <10f3b29c65bb2fe0d47c2945cd0b4087be1c5218"}, {"id": "3c2d4b3a-afc5-3430-a0f8-6973ab891b8a", "product": {"name": "Linux"}, "product_version": "patch: 5.17.15"}, {"id": "4e07bcbf-0ff7-3af0-b89d-47b0910e3cc5", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "5d48039b-41fc-3412-a5f3-19315b17a9a7", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5f2f7a7d-db1b-36bc-903d-42a2802d8e89", "product": {"name": "Linux"}, "product_version": "patch: 4.19.247"}, {"id": "6ff5641f-fd9a-3c7a-aab3-9c1366bfd485", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <aaf61a312af63e1cfe2264c4c5b8cd4ea3626025"}, {"id": "91a3e616-efde-324d-a350-15bbb0a2dd8f", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <5c25a3040bc0486c41a7b63a1fb0de7cdb846ad7"}, {"id": "ab95c19a-33e8-3ff5-90a8-8f36e564cf3d", "product": {"name": "Linux"}, "product_version": "4.16"}, {"id": "bdbe0ec7-d348-3e43-9dc8-ddcd41fb5782", "product": {"name": "Linux"}, "product_version": "patch: 5.10.122"}, {"id": "c3cc7307-6ce3-33cf-b59e-0074988e533e", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <0cf7aaff290cdc4d7cee683d4a18138b0dacac48"}, {"id": "cdacb739-0872-32fb-a7b8-39b7227b05dd", "product": {"name": "Linux"}, "product_version": "patch: 5.18.4"}, {"id": "e852ebcf-c384-3027-b4f0-747db13fb388", "product": {"name": "Linux"}, "product_version": "patch: 5.4.198"}, {"id": "e99e75b5-2eca-3b6a-b657-d15b96fb4de6", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <3f4d5e727aeaa610688d46c9f101f78b7f712583"}, {"id": "ee1baebb-13a8-37de-a5a1-ddf00470b319", "product": {"name": "Linux"}, "product_version": "db496944fdaaf2a67d2f60529f5dc23abf809506 <e412b3d178ea4bf746f6b8ee086761613704c6be"}], "enisaIdVendor": [{"id": "02e9415a-c03c-3ba7-82ee-e837c5257731", "vendor": {"name": "Linux"}}], "isExploited": false}