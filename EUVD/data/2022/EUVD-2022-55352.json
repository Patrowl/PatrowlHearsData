{"id": "EUVD-2022-55352", "enisaUuid": "3f3d2910-c023-3b36-b5db-32fb673627eb", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm raid: fix address sanitizer warning in raid_status\n\nThere is this warning when using a kernel with the address sanitizer\nand running this testsuite:\nhttps://gitlab.com/cki-project/kernel-tests/-/tree/main/storage/swraid/scsi_raid\n\n==================================================================\nBUG: KASAN: slab-out-of-bounds in raid_status+0x1747/0x2820 [dm_raid]\nRead of size 4 at addr ffff888079d2c7e8 by task lvcreate/13319\nCPU: 0 PID: 13319 Comm: lvcreate Not tainted 5.18.0-0.rc3.<snip> #1\nHardware name: Red Hat KVM, BIOS 0.5.1 01/01/2011\nCall Trace:\n <TASK>\n dump_stack_lvl+0x6a/0x9c\n print_address_description.constprop.0+0x1f/0x1e0\n print_report.cold+0x55/0x244\n kasan_report+0xc9/0x100\n raid_status+0x1747/0x2820 [dm_raid]\n dm_ima_measure_on_table_load+0x4b8/0xca0 [dm_mod]\n table_load+0x35c/0x630 [dm_mod]\n ctl_ioctl+0x411/0x630 [dm_mod]\n dm_ctl_ioctl+0xa/0x10 [dm_mod]\n __x64_sys_ioctl+0x12a/0x1a0\n do_syscall_64+0x5b/0x80\n\nThe warning is caused by reading conf->max_nr_stripes in raid_status. The\ncode in raid_status reads mddev->private, casts it to struct r5conf and\nreads the entry max_nr_stripes.\n\nHowever, if we have different raid type than 4/5/6, mddev->private\ndoesn't point to struct r5conf; it may point to struct r0conf, struct\nr1conf, struct r10conf or struct mpconf. If we cast a pointer to one\nof these structs to struct r5conf, we will be reading invalid memory\nand KASAN warns about it.\n\nFix this bug by reading struct r5conf only if raid type is 4, 5 or 6.", "datePublished": "2025-06-18T11:02:25", "dateUpdated": "2025-12-23T13:26:47", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1ae0ebfb576b72c2ef400917a5484ebe7892d80b", "https://git.kernel.org/stable/c/90b006da40dd42285b24dd3c940d2c32aca9a70b", "https://git.kernel.org/stable/c/b856ce5f4b55f752144baf17e9d5c415072652c5", "https://git.kernel.org/stable/c/cb583ca6125ac64c98e9d65128e95ebb5be7d322", "https://git.kernel.org/stable/c/49dba30638e091120256a9e89125340795f034dc", "https://git.kernel.org/stable/c/4c233811a49578634d10a5e70a9dfa569d451e94", "https://git.kernel.org/stable/c/d8971b595d7adac3421c21f59918241f1574061e", "https://git.kernel.org/stable/c/b4c6c07c92b6cba2bf3cb2dfa722debeaf8a8abe", "https://git.kernel.org/stable/c/1fbeea217d8f297fe0e0956a1516d14ba97d0396", "https://nvd.nist.gov/vuln/detail/CVE-2022-50084"], "aliases": ["CVE-2022-50084"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "09b13718-1388-3862-8d77-7ccecee3f01c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0a48b000-56e5-3282-815e-d42ab3122e84", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "1b6ea25f-9489-3ae9-bf22-0b2d1088dc7e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <90b006da40dd42285b24dd3c940d2c32aca9a70b"}, {"id": "1f46877e-0a8d-355c-9dca-57630f46f498", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <1fbeea217d8f297fe0e0956a1516d14ba97d0396"}, {"id": "261e9c98-8eec-322a-8e12-6ebde283ae96", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "2c8f9604-a25d-3ddb-9b28-57c79aea66a8", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "37083a1f-9776-306f-90e1-6d360df92ca9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d8971b595d7adac3421c21f59918241f1574061e"}, {"id": "4e6ad372-34e9-343c-bfb5-f5ad93499e67", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <90b006da40dd42285b24dd3c940d2c32aca9a70b"}, {"id": "50aefe34-530f-3fc3-a408-8745902df652", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1ae0ebfb576b72c2ef400917a5484ebe7892d80b"}, {"id": "5567e350-7160-3c41-9909-bb99c963c94a", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "596f8a6f-145a-33ab-92fa-7c05149a9eaa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1fbeea217d8f297fe0e0956a1516d14ba97d0396"}, {"id": "5f7293df-0af3-3150-bc7f-063451b8d649", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b856ce5f4b55f752144baf17e9d5c415072652c5"}, {"id": "69435fee-3148-3fb4-ab3a-aea2267f3d13", "product": {"name": "Linux"}, "product_version": "patch: 5.4.211"}, {"id": "6de99c3c-6e7b-307e-be10-b88c87f94cc4", "product": {"name": "Linux"}, "product_version": "patch: 4.19.256"}, {"id": "791659a8-430f-3494-b31c-0fdea2ef1a81", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cb583ca6125ac64c98e9d65128e95ebb5be7d322"}, {"id": "7d182b11-51c3-322e-9fd4-74ffc5373d8d", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <cb583ca6125ac64c98e9d65128e95ebb5be7d322"}, {"id": "851bd4f2-eff8-3dc4-bedc-5562d8d6ed22", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <49dba30638e091120256a9e89125340795f034dc"}, {"id": "857e082e-8346-3a1c-a332-6e0f7453c3fb", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <b856ce5f4b55f752144baf17e9d5c415072652c5"}, {"id": "8646f7ed-dcf6-366b-a7fa-16c4dba8ee12", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <d8971b595d7adac3421c21f59918241f1574061e"}, {"id": "8e72054e-1b52-35ef-8178-a3799780eaba", "product": {"name": "Linux"}, "product_version": "patch: 5.10.137"}, {"id": "a5a0ecd8-24ac-34e8-904e-d552b265c357", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4c233811a49578634d10a5e70a9dfa569d451e94"}, {"id": "b9db3aa5-fe42-342e-b184-508197223ef7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <49dba30638e091120256a9e89125340795f034dc"}, {"id": "c1f86124-a5a2-3798-8e62-ac5aa757f176", "product": {"name": "Linux"}, "product_version": "patch: 4.9.326"}, {"id": "ce71d3ba-8234-3308-b12b-c70d6b1908be", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b4c6c07c92b6cba2bf3cb2dfa722debeaf8a8abe"}, {"id": "d2cf05ed-ac96-395d-8ab7-bf708b1fcaf1", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <4c233811a49578634d10a5e70a9dfa569d451e94"}, {"id": "d634e8b2-fa29-3b21-b573-07f5ab19c938", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <1ae0ebfb576b72c2ef400917a5484ebe7892d80b"}, {"id": "e5fac502-ca1c-34bb-9ff5-a6588dabad16", "product": {"name": "Linux"}, "product_version": "3a1c1ef2fd62087c3d6521de217ddb9360776658 <b4c6c07c92b6cba2bf3cb2dfa722debeaf8a8abe"}, {"id": "eae5d936-46ac-3822-b07c-12e97a1523bc", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "edaf7b8f-462e-3372-821a-64ce8a027829", "product": {"name": "Linux"}, "product_version": "patch: 4.14.291"}], "enisaIdVendor": [{"id": "9caf5215-a206-3c62-bd20-6f710920260d", "vendor": {"name": "Linux"}}], "isExploited": false}