{"id": "EUVD-2022-55649", "enisaUuid": "f37d40a5-b482-3914-9e1a-a31040ed1d1b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64: ftrace: fix module PLTs with mcount\n\nLi Huafei reports that mcount-based ftrace with module PLTs was broken\nby commit:\n\n  a6253579977e4c6f (\"arm64: ftrace: consistently handle PLTs.\")\n\nWhen a module PLTs are used and a module is loaded sufficiently far away\nfrom the kernel, we'll create PLTs for any branches which are\nout-of-range. These are separate from the special ftrace trampoline\nPLTs, which the module PLT code doesn't directly manipulate.\n\nWhen mcount is in use this is a problem, as each mcount callsite in a\nmodule will be initialized to point to a module PLT, but since commit\na6253579977e4c6f ftrace_make_nop() will assume that the callsite has\nbeen initialized to point to the special ftrace trampoline PLT, and\nftrace_find_callable_addr() rejects other cases.\n\nThis means that when ftrace tries to initialize a callsite via\nftrace_make_nop(), the call to ftrace_find_callable_addr() will find\nthat the `_mcount` stub is out-of-range and is not handled by the ftrace\nPLT, resulting in a splat:\n\n| ftrace_test: loading out-of-tree module taints kernel.\n| ftrace: no module PLT for _mcount\n| ------------[ ftrace bug ]------------\n| ftrace failed to modify\n| [<ffff800029180014>] 0xffff800029180014\n|  actual:   44:00:00:94\n| Initializing ftrace call sites\n| ftrace record flags: 2000000\n|  (0)\n|  expected tramp: ffff80000802eb3c\n| ------------[ cut here ]------------\n| WARNING: CPU: 3 PID: 157 at kernel/trace/ftrace.c:2120 ftrace_bug+0x94/0x270\n| Modules linked in:\n| CPU: 3 PID: 157 Comm: insmod Tainted: G           O       6.0.0-rc6-00151-gcd722513a189-dirty #22\n| Hardware name: linux,dummy-virt (DT)\n| pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n| pc : ftrace_bug+0x94/0x270\n| lr : ftrace_bug+0x21c/0x270\n| sp : ffff80000b2bbaf0\n| x29: ffff80000b2bbaf0 x28: 0000000000000000 x27: ffff0000c4d38000\n| x26: 0000000000000001 x25: ffff800009d7e000 x24: ffff0000c4d86e00\n| x23: 0000000002000000 x22: ffff80000a62b000 x21: ffff8000098ebea8\n| x20: ffff0000c4d38000 x19: ffff80000aa24158 x18: ffffffffffffffff\n| x17: 0000000000000000 x16: 0a0d2d2d2d2d2d2d x15: ffff800009aa9118\n| x14: 0000000000000000 x13: 6333626532303830 x12: 3030303866666666\n| x11: 203a706d61727420 x10: 6465746365707865 x9 : 3362653230383030\n| x8 : c0000000ffffefff x7 : 0000000000017fe8 x6 : 000000000000bff4\n| x5 : 0000000000057fa8 x4 : 0000000000000000 x3 : 0000000000000001\n| x2 : ad2cb14bb5438900 x1 : 0000000000000000 x0 : 0000000000000022\n| Call trace:\n|  ftrace_bug+0x94/0x270\n|  ftrace_process_locs+0x308/0x430\n|  ftrace_module_init+0x44/0x60\n|  load_module+0x15b4/0x1ce8\n|  __do_sys_init_module+0x1ec/0x238\n|  __arm64_sys_init_module+0x24/0x30\n|  invoke_syscall+0x54/0x118\n|  el0_svc_common.constprop.4+0x84/0x100\n|  do_el0_svc+0x3c/0xd0\n|  el0_svc+0x1c/0x50\n|  el0t_64_sync_handler+0x90/0xb8\n|  el0t_64_sync+0x15c/0x160\n| ---[ end trace 0000000000000000 ]---\n| ---------test_init-----------\n\nFix this by reverting to the old behaviour of ignoring the old\ninstruction when initialising an mcount callsite in a module, which was\nthe behaviour prior to commit a6253579977e4c6f.", "datePublished": "2025-10-22T15:31:10", "dateUpdated": "2025-10-22T15:31:10", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/657de36c72f57fa172a66b06f826b3f5bc56f42e", "https://git.kernel.org/stable/c/6c93b683cedaef745884cb9d554d02ed6266b897", "https://git.kernel.org/stable/c/0f77b6b2ba70d7c9d69ef39694e283ded9f8b5f2", "https://git.kernel.org/stable/c/985432303cf7d4804fb2c2fdfbf0466a796d68c3", "https://git.kernel.org/stable/c/8cfb08575c6d4585f1ce0deeb189e5c824776b04", "https://nvd.nist.gov/vuln/detail/CVE-2022-50579"], "aliases": ["CVE-2022-50579"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0c347621-00c6-3bb2-8d52-2118c00a71db", "product": {"name": "Linux"}, "product_version": "dcecc96ed16f73417de5550f384e348c9d56f279"}, {"id": "23102402-062d-34a6-a888-58eb623c0586", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "2b920cd1-3cfd-310f-b702-3c247a848f64", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "683cbadb-0d0e-3cc3-be53-2ab1acc02c83", "product": {"name": "Linux"}, "product_version": "bc28fde90937a920f7714ec4408269cac744f796 <657de36c72f57fa172a66b06f826b3f5bc56f42e"}, {"id": "8474f7cf-8eca-331c-b5f4-ae6b4676b2e6", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "9467fea0-5520-3acd-abba-e90647303a3a", "product": {"name": "Linux"}, "product_version": "a6253579977e4c6f7818eeb05bf2bc65678a7187 <0f77b6b2ba70d7c9d69ef39694e283ded9f8b5f2"}, {"id": "9e8ea32f-6680-3f5e-b36c-40dc58099448", "product": {"name": "Linux"}, "product_version": "a6253579977e4c6f7818eeb05bf2bc65678a7187 <8cfb08575c6d4585f1ce0deeb189e5c824776b04"}, {"id": "a46627f4-265a-3f91-98cd-01063da265c4", "product": {"name": "Linux"}, "product_version": "a6253579977e4c6f7818eeb05bf2bc65678a7187 <985432303cf7d4804fb2c2fdfbf0466a796d68c3"}, {"id": "d2488771-be25-3de5-9c0a-b5a2d375a541", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "d3e3a121-ca9d-3dd1-93ac-b9714512402d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "e00463dd-d6fe-3851-a6d7-c91e6ac22f79", "product": {"name": "Linux"}, "product_version": "db73aa9466338ec821ed2a0b01721fe4d06876b1 <6c93b683cedaef745884cb9d554d02ed6266b897"}, {"id": "eb04fe00-bd87-33ca-9085-db2951919611", "product": {"name": "Linux"}, "product_version": "5.19"}, {"id": "f01c2fa0-041c-340f-90c8-9667208b7a8b", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}], "enisaIdVendor": [{"id": "723cd08d-2d5a-332a-a9f3-685315095300", "vendor": {"name": "Linux"}}], "isExploited": false}