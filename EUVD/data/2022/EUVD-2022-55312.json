{"id": "EUVD-2022-55312", "enisaUuid": "bd993e2b-057c-3460-a811-8199801180b1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nice: Fix call trace with null VSI during VF reset\n\nDuring stress test with attaching and detaching VF from KVM and\nsimultaneously changing VFs spoofcheck and trust there was a\ncall trace in ice_reset_vf that VF's VSI is null.\n\n[145237.352797] WARNING: CPU: 46 PID: 840629 at drivers/net/ethernet/intel/ice/ice_vf_lib.c:508 ice_reset_vf+0x3d6/0x410 [ice]\n[145237.352851] Modules linked in: ice(E) vfio_pci vfio_pci_core vfio_virqfd vfio_iommu_type1 vfio iavf dm_mod xt_CHECKSUM xt_MASQUERADE\nxt_conntrack ipt_REJECT nf_reject_ipv4 nft_compat nft_chain_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 nf_tables nfnetlink tun\n bridge stp llc sunrpc intel_rapl_msr intel_rapl_common sb_edac x86_pkg_temp_thermal intel_powerclamp coretemp kvm_intel kvm iTCO_wdt iTC\nO_vendor_support irqbypass crct10dif_pclmul crc32_pclmul ghash_clmulni_intel rapl ipmi_si intel_cstate ipmi_devintf joydev intel_uncore m\nei_me ipmi_msghandler i2c_i801 pcspkr mei lpc_ich ioatdma i2c_smbus acpi_pad acpi_power_meter ip_tables xfs libcrc32c i2c_algo_bit drm_sh\nmem_helper drm_kms_helper sd_mod t10_pi crc64_rocksoft syscopyarea crc64 sysfillrect sg sysimgblt fb_sys_fops drm i40e ixgbe ahci libahci\n libata crc32c_intel mdio dca wmi fuse [last unloaded: ice]\n[145237.352917] CPU: 46 PID: 840629 Comm: kworker/46:2 Tainted: G S      W I E     5.19.0-rc6+ #24\n[145237.352921] Hardware name: Intel Corporation S2600WTT/S2600WTT, BIOS SE5C610.86B.01.01.0008.021120151325 02/11/2015\n[145237.352923] Workqueue: ice ice_service_task [ice]\n[145237.352948] RIP: 0010:ice_reset_vf+0x3d6/0x410 [ice]\n[145237.352984] Code: 30 ec f3 cc e9 28 fd ff ff 0f b7 4b 50 48 c7 c2 48 19 9c c0 4c 89 ee 48 c7 c7 30 fe 9e c0 e8 d1 21 9d cc 31 c0 e9 a\n9 fe ff ff <0f> 0b b8 ea ff ff ff e9 c1 fc ff ff 0f 0b b8 fb ff ff ff e9 91 fe\n[145237.352987] RSP: 0018:ffffb453e257fdb8 EFLAGS: 00010246\n[145237.352990] RAX: ffff8bd0040181c0 RBX: ffff8be68db8f800 RCX: 0000000000000000\n[145237.352991] RDX: 000000000000ffff RSI: 0000000000000000 RDI: ffff8be68db8f800\n[145237.352993] RBP: ffff8bd0040181c0 R08: 0000000000001000 R09: ffff8bcfd520e000\n[145237.352995] R10: 0000000000000000 R11: 00008417b5ab0bc0 R12: 0000000000000005\n[145237.352996] R13: ffff8bcee061c0d0 R14: ffff8bd004019640 R15: 0000000000000000\n[145237.352998] FS:  0000000000000000(0000) GS:ffff8be5dfb00000(0000) knlGS:0000000000000000\n[145237.353000] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[145237.353002] CR2: 00007fd81f651d68 CR3: 0000001a0fe10001 CR4: 00000000001726e0\n[145237.353003] Call Trace:\n[145237.353008]  <TASK>\n[145237.353011]  ice_process_vflr_event+0x8d/0xb0 [ice]\n[145237.353049]  ice_service_task+0x79f/0xef0 [ice]\n[145237.353074]  process_one_work+0x1c8/0x390\n[145237.353081]  ? process_one_work+0x390/0x390\n[145237.353084]  worker_thread+0x30/0x360\n[145237.353087]  ? process_one_work+0x390/0x390\n[145237.353090]  kthread+0xe8/0x110\n[145237.353094]  ? kthread_complete_and_exit+0x20/0x20\n[145237.353097]  ret_from_fork+0x22/0x30\n[145237.353103]  </TASK>\n\nRemove WARN_ON() from check if VSI is null in ice_reset_vf.\nAdd \"VF is already removed\\n\" in dev_dbg().\n\nThis WARN_ON() is unnecessary and causes call trace, despite that\ncall trace, driver still works. There is no need for this warn\nbecause this piece of code is responsible for disabling VF's Tx/Rx\nqueues when VF is disabled, but when VF is already removed there\nis no need to do reset or disable queues.", "datePublished": "2025-06-18T12:30:44", "dateUpdated": "2025-11-13T21:31:18", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/af1b0d1547dd1686ae842cac7f3678649a5cbd89", "https://git.kernel.org/stable/c/cf90b74341eecc32ceef0c136954a1668e43b1e7", "https://nvd.nist.gov/vuln/detail/CVE-2022-50041"], "aliases": ["CVE-2022-50041"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "35638cbd-5689-3de3-b9ee-d953740d1943", "product": {"name": "Linux"}, "product_version": "efe41860008e57fb6b69855b4b93fdf34bc42798 <af1b0d1547dd1686ae842cac7f3678649a5cbd89"}, {"id": "5bd2f1df-ceda-3e5b-9eb4-01bf7c21cb69", "product": {"name": "Linux"}, "product_version": "patch: 5.19.4"}, {"id": "5fa8e771-be94-32a9-a3ad-c580a4d5fe43", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "6012c1a5-7990-3eaa-961c-b572f62bae26", "product": {"name": "Linux"}, "product_version": "1bb8253b1dd44cf004e12c333acc6f25ee286cf3"}, {"id": "b7dea392-5eb0-3d7a-a0d3-9faafa069483", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c4cc52aa-b852-30c5-bd54-a4de88bdb8e3", "product": {"name": "Linux"}, "product_version": "efe41860008e57fb6b69855b4b93fdf34bc42798 <cf90b74341eecc32ceef0c136954a1668e43b1e7"}, {"id": "e85765c4-6634-3bfc-8a23-b5476473ed34", "product": {"name": "Linux"}, "product_version": "5.19"}], "enisaIdVendor": [{"id": "f7b887d9-3e54-33c2-9246-5f151bb4b32f", "vendor": {"name": "Linux"}}], "isExploited": false}