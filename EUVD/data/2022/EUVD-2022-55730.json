{"id": "EUVD-2022-55730", "enisaUuid": "a60f9a97-f3f8-3bcf-bf78-fe1250e78250", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64: mte: Avoid setting PG_mte_tagged if no tags cleared or restored\n\nPrior to commit 69e3b846d8a7 (\"arm64: mte: Sync tags for pages where PTE\nis untagged\"), mte_sync_tags() was only called for pte_tagged() entries\n(those mapped with PROT_MTE). Therefore mte_sync_tags() could safely use\ntest_and_set_bit(PG_mte_tagged, &page->flags) without inadvertently\nsetting PG_mte_tagged on an untagged page.\n\nThe above commit was required as guests may enable MTE without any\ncontrol at the stage 2 mapping, nor a PROT_MTE mapping in the VMM.\nHowever, the side-effect was that any page with a PTE that looked like\nswap (or migration) was getting PG_mte_tagged set automatically. A\nsubsequent page copy (e.g. migration) copied the tags to the destination\npage even if the tags were owned by KASAN.\n\nThis issue was masked by the page_kasan_tag_reset() call introduced in\ncommit e5b8d9218951 (\"arm64: mte: reset the page tag in page->flags\").\nWhen this commit was reverted (20794545c146), KASAN started reporting\naccess faults because the overriding tags in a page did not match the\noriginal page->flags (with CONFIG_KASAN_HW_TAGS=y):\n\n  BUG: KASAN: invalid-access in copy_page+0x10/0xd0 arch/arm64/lib/copy_page.S:26\n  Read at addr f5ff000017f2e000 by task syz-executor.1/2218\n  Pointer tag: [f5], memory tag: [f2]\n\nMove the PG_mte_tagged bit setting from mte_sync_tags() to the actual\nplace where tags are cleared (mte_sync_page_tags()) or restored\n(mte_restore_tags()).", "datePublished": "2025-12-09T18:30:32", "dateUpdated": "2025-12-09T18:30:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/918002bdbe4328c8c0164a22e8ebf2384b80dc23", "https://git.kernel.org/stable/c/749e9fc18b1e1a3f93a9512e91bd7f93002d2821", "https://git.kernel.org/stable/c/a8e5e5146ad08d794c58252bab00b261045ef16d", "https://nvd.nist.gov/vuln/detail/CVE-2022-50675"], "aliases": ["CVE-2022-50675"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "15ef73c9-7110-34f0-ae6f-156192a56570", "product": {"name": "Linux"}, "product_version": "69e3b846d8a753f9f279f29531ca56b0f7563ad0 <a8e5e5146ad08d794c58252bab00b261045ef16d"}, {"id": "29f4163c-52d7-33d3-bf95-f06e0b6671cd", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2bfdeb31-68c0-3fa0-b113-83c8c186e798", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "36a82439-9961-3369-abbc-1abee62bc6a4", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "991e836d-e9e2-3b36-85ea-40628d500df5", "product": {"name": "Linux"}, "product_version": "69e3b846d8a753f9f279f29531ca56b0f7563ad0 <918002bdbe4328c8c0164a22e8ebf2384b80dc23"}, {"id": "9fc5cdec-c376-32c3-ab63-2a9aae4a2a6a", "product": {"name": "Linux"}, "product_version": "5.14"}, {"id": "cf31c54e-b7c3-342c-8d11-81ce5bf4a3e0", "product": {"name": "Linux"}, "product_version": "69e3b846d8a753f9f279f29531ca56b0f7563ad0 <749e9fc18b1e1a3f93a9512e91bd7f93002d2821"}, {"id": "f41fa275-7fcc-3a68-8844-5b8c46c9e462", "product": {"name": "Linux"}, "product_version": "patch: 5.15.82"}], "enisaIdVendor": [{"id": "2d18d105-d2ac-3875-adfc-223c958f8a00", "vendor": {"name": "Linux"}}], "isExploited": false}