{"id": "EUVD-2022-55612", "enisaUuid": "af1955d0-3ac3-3e0b-96fc-2b78c1999bdc", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: target: iscsi: Fix a race condition between login_work and the login thread\n\nIn case a malicious initiator sends some random data immediately after a\nlogin PDU; the iscsi_target_sk_data_ready() callback will schedule the\nlogin_work and, at the same time, the negotiation may end without clearing\nthe LOGIN_FLAGS_INITIAL_PDU flag (because no additional PDU exchanges are\nrequired to complete the login).\n\nThe login has been completed but the login_work function will find the\nLOGIN_FLAGS_INITIAL_PDU flag set and will never stop from rescheduling\nitself; at this point, if the initiator drops the connection, the\niscsit_conn structure will be freed, login_work will dereference a released\nsocket structure and the kernel crashes.\n\nBUG: kernel NULL pointer dereference, address: 0000000000000230\nPF: supervisor write access in kernel mode\nPF: error_code(0x0002) - not-present page\nWorkqueue: events iscsi_target_do_login_rx [iscsi_target_mod]\nRIP: 0010:_raw_read_lock_bh+0x15/0x30\nCall trace:\n iscsi_target_do_login_rx+0x75/0x3f0 [iscsi_target_mod]\n process_one_work+0x1e8/0x3c0\n\nFix this bug by forcing login_work to stop after the login has been\ncompleted and the socket callbacks have been restored.\n\nAdd a comment to clearify the return values of iscsi_target_do_login()", "datePublished": "2025-09-16T18:31:26", "dateUpdated": "2025-12-02T00:31:10", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1533b8b3058db618409f41554ebe768c2e3acfae", "https://git.kernel.org/stable/c/3ecdca49ca49d4770639d81503c873b6d25887c4", "https://git.kernel.org/stable/c/fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f", "https://nvd.nist.gov/vuln/detail/CVE-2022-50350"], "aliases": ["CVE-2022-50350"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "00ee9584-4ac8-3db4-8998-842dcf31739f", "product": {"name": "Linux"}, "product_version": "d381a8010a052813a88e20e089be4a58aad8b40a <fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f"}, {"id": "261f6a54-bad6-382d-ad1f-cdc7f50e10e4", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "57dfd2ce-1fcc-3606-8b2c-1a642057061e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fec1b2fa62c162d03f5dcd7b03e3c89d3116d49f"}, {"id": "62e7726b-d064-36b4-a3fd-9bf7ff7a629a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3ecdca49ca49d4770639d81503c873b6d25887c4"}, {"id": "6ecf4481-dbbe-306c-a63e-ef3314014ea6", "product": {"name": "Linux"}, "product_version": "3.12"}, {"id": "762e5d07-2cf9-3c65-8e45-b79219d0efe9", "product": {"name": "Linux"}, "product_version": "patch: 6.1.2"}, {"id": "92e515f1-86ea-3205-b8f9-1173ecfd5bdc", "product": {"name": "Linux"}, "product_version": "patch: 6.0.16"}, {"id": "caba472c-4c8e-34ae-a243-404067913c33", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1533b8b3058db618409f41554ebe768c2e3acfae"}, {"id": "db456c83-b41b-317b-a73e-3ee65fa3f068", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e19fc953-d300-343a-aac4-0bc12f42617e", "product": {"name": "Linux"}, "product_version": "d381a8010a052813a88e20e089be4a58aad8b40a <3ecdca49ca49d4770639d81503c873b6d25887c4"}, {"id": "e967c4b9-8aba-355b-9a5e-03490c92bbbb", "product": {"name": "Linux"}, "product_version": "d381a8010a052813a88e20e089be4a58aad8b40a <1533b8b3058db618409f41554ebe768c2e3acfae"}], "enisaIdVendor": [{"id": "44a4fc03-4f1f-39cb-9be3-2b6909e2b950", "vendor": {"name": "Linux"}}], "isExploited": false}