{"id": "EUVD-2022-55033", "enisaUuid": "d10b776a-b260-31c7-a695-b3aea73fbd44", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nice: fix 'scheduling while atomic' on aux critical err interrupt\n\nThere's a kernel BUG splat on processing aux critical error\ninterrupts in ice_misc_intr():\n\n[ 2100.917085] BUG: scheduling while atomic: swapper/15/0/0x00010000\n...\n[ 2101.060770] Call Trace:\n[ 2101.063229]  <IRQ>\n[ 2101.065252]  dump_stack+0x41/0x60\n[ 2101.068587]  __schedule_bug.cold.100+0x4c/0x58\n[ 2101.073060]  __schedule+0x6a4/0x830\n[ 2101.076570]  schedule+0x35/0xa0\n[ 2101.079727]  schedule_preempt_disabled+0xa/0x10\n[ 2101.084284]  __mutex_lock.isra.7+0x310/0x420\n[ 2101.088580]  ? ice_misc_intr+0x201/0x2e0 [ice]\n[ 2101.093078]  ice_send_event_to_aux+0x25/0x70 [ice]\n[ 2101.097921]  ice_misc_intr+0x220/0x2e0 [ice]\n[ 2101.102232]  __handle_irq_event_percpu+0x40/0x180\n[ 2101.106965]  handle_irq_event_percpu+0x30/0x80\n[ 2101.111434]  handle_irq_event+0x36/0x53\n[ 2101.115292]  handle_edge_irq+0x82/0x190\n[ 2101.119148]  handle_irq+0x1c/0x30\n[ 2101.122480]  do_IRQ+0x49/0xd0\n[ 2101.125465]  common_interrupt+0xf/0xf\n[ 2101.129146]  </IRQ>\n...\n\nAs Andrew correctly mentioned previously[0], the following call\nladder happens:\n\nice_misc_intr() <- hardirq\n  ice_send_event_to_aux()\n    device_lock()\n      mutex_lock()\n        might_sleep()\n          might_resched() <- oops\n\nAdd a new PF state bit which indicates that an aux critical error\noccurred and serve it in ice_service_task() in process context.\nThe new ice_pf::oicr_err_reg is read-write in both hardirq and\nprocess contexts, but only 3 bits of non-critical data probably\naren't worth explicit synchronizing (and they're even in the same\nbyte [31:24]).\n\n[0] https://lore.kernel.org/all/YeSRUVmrdmlUXHDn@lunn.ch", "datePublished": "2025-10-21T12:31:23", "dateUpdated": "2025-10-21T12:31:23", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/9b77c8cf69a41d1e3851370aeaa04a9ea83b865c", "https://git.kernel.org/stable/c/24d7ac8426306ae7ccea7f7dd612a7368fe7201d", "https://git.kernel.org/stable/c/59e88a50afad7469c55804e46bf2924b9130281f", "https://git.kernel.org/stable/c/32d53c0aa3a7b727243473949bad2a830b908edc", "https://nvd.nist.gov/vuln/detail/CVE-2022-49193"], "aliases": ["CVE-2022-49193"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "576ab79b-416f-3ea0-8481-3151a380b50e", "product": {"name": "Linux"}, "product_version": "348048e724a0e8f08b63948d728d27596f6d3769 <32d53c0aa3a7b727243473949bad2a830b908edc"}, {"id": "638c2697-0dda-3056-8a26-80fb2553ec14", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7242c697-5e4d-3e40-8296-314ad6dc0818", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "85cab064-14f5-391e-b0ed-cd7f498551f7", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "9fdf0406-7b27-3972-b396-087ba81a6bff", "product": {"name": "Linux"}, "product_version": "5.14"}, {"id": "a082ff26-bd50-374d-8568-b614c5db64b0", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}, {"id": "a745f587-f627-3007-b1da-82b764e68711", "product": {"name": "Linux"}, "product_version": "348048e724a0e8f08b63948d728d27596f6d3769 <9b77c8cf69a41d1e3851370aeaa04a9ea83b865c"}, {"id": "c3d3dd27-17bb-35a9-a52c-c6affa14031b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "ce61e449-c821-3fae-8c46-5214739c0dac", "product": {"name": "Linux"}, "product_version": "348048e724a0e8f08b63948d728d27596f6d3769 <59e88a50afad7469c55804e46bf2924b9130281f"}, {"id": "dc3dabdf-160d-35ca-b7a3-64e19ff0e1a7", "product": {"name": "Linux"}, "product_version": "348048e724a0e8f08b63948d728d27596f6d3769 <24d7ac8426306ae7ccea7f7dd612a7368fe7201d"}], "enisaIdVendor": [{"id": "6c716215-5db7-3cc0-83a6-9e6fb1744232", "vendor": {"name": "Linux"}}], "isExploited": false}