{"id": "EUVD-2022-55880", "enisaUuid": "e013813a-ec46-3c60-a983-88cfaa56fba3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: pm8001: Fix running_req for internal abort commands\n\nDisabling the remote phy for a SATA disk causes a hang:\n\nroot@(none)$ more /sys/class/sas_phy/phy-0:0:8/target_port_protocols\nsata\nroot@(none)$ echo 0 > sys/class/sas_phy/phy-0:0:8/enable\nroot@(none)$ [   67.855950] sas: ex 500e004aaaaaaa1f phy08 change count has changed\n[   67.920585] sd 0:0:2:0: [sdc] Synchronizing SCSI cache\n[   67.925780] sd 0:0:2:0: [sdc] Synchronize Cache(10) failed: Result: hostbyte=0x04 driverbyte=DRIVER_OK\n[   67.935094] sd 0:0:2:0: [sdc] Stopping disk\n[   67.939305] sd 0:0:2:0: [sdc] Start/Stop Unit failed: Result: hostbyte=0x04 driverbyte=DRIVER_OK\n...\n[  123.998998] INFO: task kworker/u192:1:642 blocked for more than 30 seconds.\n[  124.005960]   Not tainted 6.0.0-rc1-205202-gf26f8f761e83 #218\n[  124.012049] \"echo 0 > /proc/sys/kernel/hung_task_timeout_secs\" disables this message.\n[  124.019872] task:kworker/u192:1  state:D stack:0 pid:  642 ppid: 2 flags:0x00000008\n[  124.028223] Workqueue: 0000:04:00.0_event_q sas_port_event_worker\n[  124.034319] Call trace:\n[  124.036758]  __switch_to+0x128/0x278\n[  124.040333]  __schedule+0x434/0xa58\n[  124.043820]  schedule+0x94/0x138\n[  124.047045]  schedule_timeout+0x2fc/0x368\n[  124.051052]  wait_for_completion+0xdc/0x200\n[  124.055234]  __flush_workqueue+0x1a8/0x708\n[  124.059328]  sas_porte_broadcast_rcvd+0xa8/0xc0\n[  124.063858]  sas_port_event_worker+0x60/0x98\n[  124.068126]  process_one_work+0x3f8/0x660\n[  124.072134]  worker_thread+0x70/0x700\n[  124.075793]  kthread+0x1a4/0x1b8\n[  124.079014]  ret_from_fork+0x10/0x20\n\nThe issue is that the per-device running_req read in\npm8001_dev_gone_notify() never goes to zero and we never make progress.\nThis is caused by missing accounting for running_req for when an internal\nabort command completes.\n\nIn commit 2cbbf489778e (\"scsi: pm8001: Use libsas internal abort support\")\nwe started to send internal abort commands as a proper sas_task. In this\nwhen we deliver a sas_task to HW the per-device running_req is incremented\nin pm8001_queue_command(). However it is never decremented for internal\nabort commnds, so decrement in pm8001_mpi_task_abort_resp().", "datePublished": "2025-12-30T15:30:26", "dateUpdated": "2025-12-30T15:30:26", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/4e750e0d8e486569fcb7f4ba6f6471673ce7d8a2", "https://git.kernel.org/stable/c/a62b9fc9775fbc8e666bb328f6e53c168054d6fe", "https://git.kernel.org/stable/c/d8c22c4697c11ed28062afe3c2b377025be11a23", "https://nvd.nist.gov/vuln/detail/CVE-2022-50818"], "aliases": ["CVE-2022-50818"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0665c8c6-77d3-35a3-919c-d6a5698a31b8", "product": {"name": "Linux"}, "product_version": "2cbbf489778eb9dde51392ec5f74ae2868e4b857 <d8c22c4697c11ed28062afe3c2b377025be11a23"}, {"id": "1fa5c962-d708-3183-9e54-72eb705dc863", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "371112f3-76e5-3e43-9132-6c57ae954d8b", "product": {"name": "Linux"}, "product_version": "2cbbf489778eb9dde51392ec5f74ae2868e4b857 <4e750e0d8e486569fcb7f4ba6f6471673ce7d8a2"}, {"id": "3a50cdd4-60ef-3bcd-b140-8471351ecc26", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "3b38e507-2a9b-3232-b50d-eaa776feed94", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "5e194325-c322-3d52-b2e7-970bbed8f242", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "b601cb95-ddde-3a87-b504-3e6fc49de50e", "product": {"name": "Linux"}, "product_version": "2cbbf489778eb9dde51392ec5f74ae2868e4b857 <a62b9fc9775fbc8e666bb328f6e53c168054d6fe"}, {"id": "f77b771f-c783-3605-99c5-1f53aec3ad9e", "product": {"name": "Linux"}, "product_version": "5.18"}], "enisaIdVendor": [{"id": "39ab0e5b-c024-37d9-9976-71d59a2d4d69", "vendor": {"name": "Linux"}}], "isExploited": false}