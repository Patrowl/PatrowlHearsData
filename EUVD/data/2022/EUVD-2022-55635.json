{"id": "EUVD-2022-55635", "enisaUuid": "3ac1e8b0-c08a-3ec1-9395-dc893ca80bb0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nskmsg: pass gfp argument to alloc_sk_msg()\n\nsyzbot found that alloc_sk_msg() could be called from a\nnon sleepable context. sk_psock_verdict_recv() uses\nrcu_read_lock() protection.\n\nWe need the callers to pass a gfp_t argument to avoid issues.\n\nsyzbot report was:\n\nBUG: sleeping function called from invalid context at include/linux/sched/mm.h:274\nin_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 3613, name: syz-executor414\npreempt_count: 0, expected: 0\nRCU nest depth: 1, expected: 0\nINFO: lockdep is turned off.\nCPU: 0 PID: 3613 Comm: syz-executor414 Not tainted 6.0.0-syzkaller-09589-g55be6084c8e0 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022\nCall Trace:\n<TASK>\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0x1e3/0x2cb lib/dump_stack.c:106\n__might_resched+0x538/0x6a0 kernel/sched/core.c:9877\nmight_alloc include/linux/sched/mm.h:274 [inline]\nslab_pre_alloc_hook mm/slab.h:700 [inline]\nslab_alloc_node mm/slub.c:3162 [inline]\nslab_alloc mm/slub.c:3256 [inline]\nkmem_cache_alloc_trace+0x59/0x310 mm/slub.c:3287\nkmalloc include/linux/slab.h:600 [inline]\nkzalloc include/linux/slab.h:733 [inline]\nalloc_sk_msg net/core/skmsg.c:507 [inline]\nsk_psock_skb_ingress_self+0x5c/0x330 net/core/skmsg.c:600\nsk_psock_verdict_apply+0x395/0x440 net/core/skmsg.c:1014\nsk_psock_verdict_recv+0x34d/0x560 net/core/skmsg.c:1201\ntcp_read_skb+0x4a1/0x790 net/ipv4/tcp.c:1770\ntcp_rcv_established+0x129d/0x1a10 net/ipv4/tcp_input.c:5971\ntcp_v4_do_rcv+0x479/0xac0 net/ipv4/tcp_ipv4.c:1681\nsk_backlog_rcv include/net/sock.h:1109 [inline]\n__release_sock+0x1d8/0x4c0 net/core/sock.c:2906\nrelease_sock+0x5d/0x1c0 net/core/sock.c:3462\ntcp_sendmsg+0x36/0x40 net/ipv4/tcp.c:1483\nsock_sendmsg_nosec net/socket.c:714 [inline]\nsock_sendmsg net/socket.c:734 [inline]\n__sys_sendto+0x46d/0x5f0 net/socket.c:2117\n__do_sys_sendto net/socket.c:2129 [inline]\n__se_sys_sendto net/socket.c:2125 [inline]\n__x64_sys_sendto+0xda/0xf0 net/socket.c:2125\ndo_syscall_x64 arch/x86/entry/common.c:50 [inline]\ndo_syscall_64+0x2b/0x70 arch/x86/entry/common.c:80\nentry_SYSCALL_64_after_hwframe+0x63/0xcd", "datePublished": "2025-09-17T15:30:37", "dateUpdated": "2025-12-10T21:31:29", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/693ddd6ffc05b228ea1638f9d757c5d3541f9446", "https://git.kernel.org/stable/c/2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08", "https://nvd.nist.gov/vuln/detail/CVE-2022-50363"], "aliases": ["CVE-2022-50363"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "31f8731a-9ae9-3d8d-ac1f-44e568c84c65", "product": {"name": "Linux"}, "product_version": "43312915b5ba20741617dd2119e835205fa8580c <693ddd6ffc05b228ea1638f9d757c5d3541f9446"}, {"id": "55c4ba55-e652-3de2-abee-bf14a99d8532", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "6f1fdd0a-5797-312e-8080-537edc5fe8eb", "product": {"name": "Linux"}, "product_version": "patch: 6.0.6"}, {"id": "71e8ca49-007f-3e4f-b80b-ad6358f6cb69", "product": {"name": "Linux"}, "product_version": "6.0"}, {"id": "8c244ccb-5fc8-3c28-954e-78600aead659", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "ca7a211d-ffa1-3232-911a-7d92cbd63f0d", "product": {"name": "Linux"}, "product_version": "43312915b5ba20741617dd2119e835205fa8580c <2d1f274b95c6e4ba6a813b3b8e7a1a38d54a0a08"}], "enisaIdVendor": [{"id": "6061f73a-822d-3e08-9fc1-63270837bbe2", "vendor": {"name": "Linux"}}], "isExploited": false}