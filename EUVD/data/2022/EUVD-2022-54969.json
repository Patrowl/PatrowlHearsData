{"id": "EUVD-2022-54969", "enisaUuid": "24751dae-43fb-3733-850e-9d99a51a1924", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwatch_queue: Fix NULL dereference in error cleanup\n\nIn watch_queue_set_size(), the error cleanup code doesn't take account of\nthe fact that __free_page() can't handle a NULL pointer when trying to free\nup buffer pages that did get allocated.\n\nFix this by only calling __free_page() on the pages actually allocated.\n\nWithout the fix, this can lead to something like the following:\n\nBUG: KASAN: null-ptr-deref in __free_pages+0x1f/0x1b0 mm/page_alloc.c:5473\nRead of size 4 at addr 0000000000000034 by task syz-executor168/3599\n...\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\n __kasan_report mm/kasan/report.c:446 [inline]\n kasan_report.cold+0x66/0xdf mm/kasan/report.c:459\n check_region_inline mm/kasan/generic.c:183 [inline]\n kasan_check_range+0x13d/0x180 mm/kasan/generic.c:189\n instrument_atomic_read include/linux/instrumented.h:71 [inline]\n atomic_read include/linux/atomic/atomic-instrumented.h:27 [inline]\n page_ref_count include/linux/page_ref.h:67 [inline]\n put_page_testzero include/linux/mm.h:717 [inline]\n __free_pages+0x1f/0x1b0 mm/page_alloc.c:5473\n watch_queue_set_size+0x499/0x630 kernel/watch_queue.c:275\n pipe_ioctl+0xac/0x2b0 fs/pipe.c:632\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:874 [inline]\n __se_sys_ioctl fs/ioctl.c:860 [inline]\n __x64_sys_ioctl+0x193/0x200 fs/ioctl.c:860\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x44/0xae", "datePublished": "2025-09-22T21:30:16", "dateUpdated": "2025-09-22T21:30:16", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/5ae75b4ed30322b42abaa75ef1b784addfdb7dc9", "https://git.kernel.org/stable/c/695c47cea02b9101e2fc2e7d36d552128592b347", "https://git.kernel.org/stable/c/112a2f9b0a8457794095a0450598f150724ec456", "https://git.kernel.org/stable/c/b6f5ad3e45d19f9c4ee3e8a2aff829f28d68591d", "https://git.kernel.org/stable/c/a635415a064e77bcfbf43da413fd9dfe0bbed9cb", "https://nvd.nist.gov/vuln/detail/CVE-2022-49257"], "aliases": ["CVE-2022-49257"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "06eb3f07-abd8-34b1-b2c1-77be3a6db545", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "1114ee57-66ca-36e0-8115-5182593ca83d", "product": {"name": "Linux"}, "product_version": "c73be61cede5882f9605a852414db559c0ebedfd <695c47cea02b9101e2fc2e7d36d552128592b347"}, {"id": "21acc40f-8340-37ee-a9cd-762899453ed9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2c403c2f-5a28-355d-94ab-98d27ba32b7c", "product": {"name": "Linux"}, "product_version": "c73be61cede5882f9605a852414db559c0ebedfd <112a2f9b0a8457794095a0450598f150724ec456"}, {"id": "3bd878e9-ec77-3fa5-8487-f11d3c246e9e", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "85adf84f-de30-30a9-8fa4-c27c5c828f65", "product": {"name": "Linux"}, "product_version": "c73be61cede5882f9605a852414db559c0ebedfd <5ae75b4ed30322b42abaa75ef1b784addfdb7dc9"}, {"id": "9896d361-67cb-3371-8087-0dd558db4e71", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "98994f54-d104-38e0-8647-0037b1227713", "product": {"name": "Linux"}, "product_version": "c73be61cede5882f9605a852414db559c0ebedfd <b6f5ad3e45d19f9c4ee3e8a2aff829f28d68591d"}, {"id": "ad015c1d-92cd-35c4-b380-f7d45540e575", "product": {"name": "Linux"}, "product_version": "patch: 5.10.110"}, {"id": "b5dfee50-e278-3e0e-bbff-a7bde59263a1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "d0babb0d-86b6-396c-8c5e-4c53e3db3423", "product": {"name": "Linux"}, "product_version": "c73be61cede5882f9605a852414db559c0ebedfd <a635415a064e77bcfbf43da413fd9dfe0bbed9cb"}, {"id": "d33fda60-55a2-3aef-97d5-c440e28c44d7", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}], "enisaIdVendor": [{"id": "2653279a-bafe-3bfe-8eb5-28dfecba6925", "vendor": {"name": "Linux"}}], "isExploited": false}