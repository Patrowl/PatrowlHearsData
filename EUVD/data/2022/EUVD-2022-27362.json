{"id": "EUVD-2022-27362", "enisaUuid": "bf6b661b-a235-31e6-93cf-287e39dcef30", "description": "A Missing Release of File Descriptor or Handle after Effective Lifetime vulnerability in plugable authentication module (PAM) of Juniper Networks Junos OS and Junos OS Evolved allows a locally authenticated attacker with low privileges to cause a Denial of Service (DoS). It is possible that after the termination of a gRPC connection the respective/var/run/<pid>.env file is not getting deleted which if occurring repeatedly can cause inode exhaustion. Inode exhaustion can present itself in two different ways: 1. The following log message can be observed: host kernel: pid <pid> (<process>), uid <uid> inumber <number> on /.mount/var: out of inodes which by itself is a clear indication. 2. The following log message can be observed: host <process>[<pid>]: ... : No space left on device which is not deterministic and just a representation of a write error which could have several reasons. So the following check needs to be done: user@host> show system storage no-forwarding Filesystem Size Used Avail Capacity Mounted on /dev/ada1p1 475M 300M 137M 69% /.mount/var which indicates that the write error is not actually due to a lack of disk space. If either 1. or 2. has been confirmed, then the output of: user@host> file list /var/run/*.env | count need to be checked and if it indicates a high (>10000) number of files the system has been affected by this issue. This issue affects: Juniper Networks Junos OS All versions prior to 19.1R3-S8; 19.2 versions prior to 19.2R3-S6; 19.3 versions prior to 19.3R3-S5; 19.4 versions prior to 19.4R2-S6, 19.4R3-S7; 20.1 version 20.1R1 and later versions; 20.2 versions prior to 20.2R3-S5; 20.3 versions prior to 20.3R3-S4; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R2. Juniper Networks Junos OS Evolved All versions prior to 20.4R3-EVO; 21.1 versions prior to 21.1R3-S1-EVO; 21.2 versions prior to 21.2R1-S1-EVO, 21.2R2-EVO.", "datePublished": "2022-07-20T14:15:37", "dateUpdated": "2024-09-17T01:11:06", "baseScore": 6.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA69719"], "aliases": ["CVE-2022-22215"], "assigner": "juniper", "epss": 0.29, "enisaIdProduct": [{"id": "04015fda-811d-3633-b9e6-0340535a882d", "product": {"name": "Junos OS"}, "product_version": "unspecified <19.1R3-S8"}, {"id": "1c1f3553-20b4-3252-a434-5b13f25734f5", "product": {"name": "Junos OS"}, "product_version": "20.3 <20.3R3-S4"}, {"id": "21ab996b-6d2c-3ed8-9241-5da81f32c89d", "product": {"name": "Junos OS"}, "product_version": "20.4 <20.4R3"}, {"id": "4339b3dd-fe07-3d02-a8c1-b125f59b0b49", "product": {"name": "Junos OS"}, "product_version": "20.2 <20.2R3-S5"}, {"id": "44b882eb-adbd-38d8-a01b-4ad41de0c9df", "product": {"name": "Junos OS"}, "product_version": "21.1 <21.1R3"}, {"id": "5ae9815c-120b-35d9-bce7-20c589f33f19", "product": {"name": "Junos OS Evolved"}, "product_version": "21.2 <21.2R1-S1-EVO, 21.2R2-EVO"}, {"id": "7978edf8-d938-35ad-9d87-b50392fa3ba6", "product": {"name": "Junos OS"}, "product_version": "19.2 <19.2R3-S6"}, {"id": "a73770a4-1d50-399d-81b7-92b6d3659c4a", "product": {"name": "Junos OS Evolved"}, "product_version": "unspecified <20.4R3-EVO"}, {"id": "b4b8dddb-5afb-39d5-a67b-77fcadb28e84", "product": {"name": "Junos OS Evolved"}, "product_version": "21.1 <21.1R3-S1-EVO"}, {"id": "b6191017-b553-3acd-a34b-d94e33e2eab5", "product": {"name": "Junos OS"}, "product_version": "20.1R1 <20.1*"}, {"id": "db82bb8a-8676-399c-ab64-d797a287ea55", "product": {"name": "Junos OS"}, "product_version": "21.2 <21.2R2"}, {"id": "e7848062-0baa-31a7-945c-9054896d7981", "product": {"name": "Junos OS"}, "product_version": "19.4 <19.4R2-S6, 19.4R3-S7"}, {"id": "f5b229cd-8662-37db-bcf0-4abb9f01efbf", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R3-S5"}], "enisaIdVendor": [{"id": "a1644a91-b77e-3e60-a0d5-cbc3df6b48af", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}