{"id": "EUVD-2022-55773", "enisaUuid": "1439dcf3-1202-35f6-88b8-8c98f7971879", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ar5523: Fix use-after-free on ar5523_cmd() timed out\n\nsyzkaller reported use-after-free with the stack trace like below [1]:\n\n[   38.960489][    C3] ==================================================================\n[   38.963216][    C3] BUG: KASAN: use-after-free in ar5523_cmd_tx_cb+0x220/0x240\n[   38.964950][    C3] Read of size 8 at addr ffff888048e03450 by task swapper/3/0\n[   38.966363][    C3]\n[   38.967053][    C3] CPU: 3 PID: 0 Comm: swapper/3 Not tainted 6.0.0-09039-ga6afa4199d3d-dirty #18\n[   38.968464][    C3] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.0-1.fc36 04/01/2014\n[   38.969959][    C3] Call Trace:\n[   38.970841][    C3]  <IRQ>\n[   38.971663][    C3]  dump_stack_lvl+0xfc/0x174\n[   38.972620][    C3]  print_report.cold+0x2c3/0x752\n[   38.973626][    C3]  ? ar5523_cmd_tx_cb+0x220/0x240\n[   38.974644][    C3]  kasan_report+0xb1/0x1d0\n[   38.975720][    C3]  ? ar5523_cmd_tx_cb+0x220/0x240\n[   38.976831][    C3]  ar5523_cmd_tx_cb+0x220/0x240\n[   38.978412][    C3]  __usb_hcd_giveback_urb+0x353/0x5b0\n[   38.979755][    C3]  usb_hcd_giveback_urb+0x385/0x430\n[   38.981266][    C3]  dummy_timer+0x140c/0x34e0\n[   38.982925][    C3]  ? notifier_call_chain+0xb5/0x1e0\n[   38.984761][    C3]  ? rcu_read_lock_sched_held+0xb/0x60\n[   38.986242][    C3]  ? lock_release+0x51c/0x790\n[   38.987323][    C3]  ? _raw_read_unlock_irqrestore+0x37/0x70\n[   38.988483][    C3]  ? __wake_up_common_lock+0xde/0x130\n[   38.989621][    C3]  ? reacquire_held_locks+0x4a0/0x4a0\n[   38.990777][    C3]  ? lock_acquire+0x472/0x550\n[   38.991919][    C3]  ? rcu_read_lock_sched_held+0xb/0x60\n[   38.993138][    C3]  ? lock_acquire+0x472/0x550\n[   38.994890][    C3]  ? dummy_urb_enqueue+0x860/0x860\n[   38.996266][    C3]  ? do_raw_spin_unlock+0x16f/0x230\n[   38.997670][    C3]  ? dummy_urb_enqueue+0x860/0x860\n[   38.999116][    C3]  call_timer_fn+0x1a0/0x6a0\n[   39.000668][    C3]  ? add_timer_on+0x4a0/0x4a0\n[   39.002137][    C3]  ? reacquire_held_locks+0x4a0/0x4a0\n[   39.003809][    C3]  ? __next_timer_interrupt+0x226/0x2a0\n[   39.005509][    C3]  __run_timers.part.0+0x69a/0xac0\n[   39.007025][    C3]  ? dummy_urb_enqueue+0x860/0x860\n[   39.008716][    C3]  ? call_timer_fn+0x6a0/0x6a0\n[   39.010254][    C3]  ? cpuacct_percpu_seq_show+0x10/0x10\n[   39.011795][    C3]  ? kvm_sched_clock_read+0x14/0x40\n[   39.013277][    C3]  ? sched_clock_cpu+0x69/0x2b0\n[   39.014724][    C3]  run_timer_softirq+0xb6/0x1d0\n[   39.016196][    C3]  __do_softirq+0x1d2/0x9be\n[   39.017616][    C3]  __irq_exit_rcu+0xeb/0x190\n[   39.019004][    C3]  irq_exit_rcu+0x5/0x20\n[   39.020361][    C3]  sysvec_apic_timer_interrupt+0x8f/0xb0\n[   39.021965][    C3]  </IRQ>\n[   39.023237][    C3]  <TASK>\n\nIn ar5523_probe(), ar5523_host_available() calls ar5523_cmd() as below\n(there are other functions which finally call ar5523_cmd()):\n\nar5523_probe()\n-> ar5523_host_available()\n   -> ar5523_cmd_read()\n      -> ar5523_cmd()\n\nIf ar5523_cmd() timed out, then ar5523_host_available() failed and\nar5523_probe() freed the device structure.  So, ar5523_cmd_tx_cb()\nmight touch the freed structure.\n\nThis patch fixes this issue by canceling in-flight tx cmd if submitted\nurb timed out.", "datePublished": "2025-12-24T12:22:40", "dateUpdated": "2026-01-02T15:04:02", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c9ba3fbf6a488da6cad1d304c5234bd8d729eba3", "https://git.kernel.org/stable/c/340524ae7b53a72cf5d9e7bd7790433422b3b12f", "https://git.kernel.org/stable/c/6447beefd21326a3f4719ec2ea511df797f6c820", "https://git.kernel.org/stable/c/7360b323e0343ea099091d4ae09576dbe1f09516", "https://git.kernel.org/stable/c/8af52492717e3538eba3f81d012b1476af8a89a6", "https://git.kernel.org/stable/c/3eca9697c2f3905dea3ad2fc536ebaa1fbd735bd", "https://git.kernel.org/stable/c/601ae89375033ac4870c086e24ba03f235d38e55", "https://git.kernel.org/stable/c/9aef34e1ae35a87e5f6a22278c17823b7ce64c88", "https://git.kernel.org/stable/c/b6702a942a069c2a975478d719e98d83cdae1797", "https://nvd.nist.gov/vuln/detail/CVE-2022-50716"], "aliases": ["CVE-2022-50716"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "0249274c-9011-3911-a043-d5df98a329f5", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <c9ba3fbf6a488da6cad1d304c5234bd8d729eba3"}, {"id": "0b15c0cf-de7e-3d21-b597-82f11b183682", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0ec8c79b-bbc3-32f8-ab18-cc6c37620109", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <3eca9697c2f3905dea3ad2fc536ebaa1fbd735bd"}, {"id": "139f28bf-af6d-32bb-9511-78039cd16ac9", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "2e6f8b9b-11c0-3501-943a-b668ed3f16a6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c9ba3fbf6a488da6cad1d304c5234bd8d729eba3"}, {"id": "4468273f-d2e2-34c1-ad37-e9c1dafd7262", "product": {"name": "Linux"}, "product_version": "patch: 6.0.16"}, {"id": "453e7485-ae0d-31d1-9f48-fec0f7f1bedb", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b6702a942a069c2a975478d719e98d83cdae1797"}, {"id": "4b6ea234-a1f2-31aa-b276-d77eab86185f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3eca9697c2f3905dea3ad2fc536ebaa1fbd735bd"}, {"id": "5a9977ec-0d7e-3888-9e1e-9a2488c0138b", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <8af52492717e3538eba3f81d012b1476af8a89a6"}, {"id": "5d33421f-1824-3710-8f36-73a3eaf841dc", "product": {"name": "Linux"}, "product_version": "patch: 4.14.303"}, {"id": "5e80372b-f3e1-3942-818e-0db81badbca7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.86"}, {"id": "67c982d9-06fb-376c-b987-b1adfe81153d", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <601ae89375033ac4870c086e24ba03f235d38e55"}, {"id": "69981b65-8698-305a-9080-9c8b00a6ee97", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <b6702a942a069c2a975478d719e98d83cdae1797"}, {"id": "7aeb1aa2-126a-3d04-8be3-a6fea3a6bffa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6447beefd21326a3f4719ec2ea511df797f6c820"}, {"id": "7fc7810a-bb47-3693-beea-66ec5b5c6ead", "product": {"name": "Linux"}, "product_version": "patch: 6.1.2"}, {"id": "8449bb93-1845-3354-8b6f-1549388bc92b", "product": {"name": "Linux"}, "product_version": "patch: 5.4.229"}, {"id": "865a7fda-6ecb-3451-948c-f80f5fa8e263", "product": {"name": "Linux"}, "product_version": "patch: 5.10.163"}, {"id": "92fae678-3556-36f7-bbe2-4b913b288eab", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9aef34e1ae35a87e5f6a22278c17823b7ce64c88"}, {"id": "9c65dbf3-22ff-32b1-844d-44ea26a91115", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "9e2482ba-e492-3a46-9c4b-d304cd5590c5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7360b323e0343ea099091d4ae09576dbe1f09516"}, {"id": "9f22cb0d-53c5-3e1e-aa71-fc47ee7b5088", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <340524ae7b53a72cf5d9e7bd7790433422b3b12f"}, {"id": "a338a22e-ca99-3b20-b4db-ff63e2403fc9", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <7360b323e0343ea099091d4ae09576dbe1f09516"}, {"id": "b1474e4b-e9b3-395c-b3b7-ddf944c0a4e9", "product": {"name": "Linux"}, "product_version": "patch: 4.9.337"}, {"id": "b8fa25ce-005b-3bf2-a067-db9bb4dddccb", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <601ae89375033ac4870c086e24ba03f235d38e55"}, {"id": "be07117c-ed6a-374f-816d-28c7bcb30c10", "product": {"name": "Linux"}, "product_version": "patch: 4.19.270"}, {"id": "ded8e1b9-3645-302e-9ef7-5cc4a9351925", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <6447beefd21326a3f4719ec2ea511df797f6c820"}, {"id": "f54648da-c583-3c85-a419-4f0ed6ea34ed", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <340524ae7b53a72cf5d9e7bd7790433422b3b12f"}, {"id": "f580b4a0-93d2-32b4-b52a-a5e1ccec9df2", "product": {"name": "Linux"}, "product_version": "b7d572e1871df06a96a1c9591c71c5494ff6b624 <9aef34e1ae35a87e5f6a22278c17823b7ce64c88"}, {"id": "fcd4ea5e-6632-371b-baa7-ae248fb99365", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8af52492717e3538eba3f81d012b1476af8a89a6"}], "enisaIdVendor": [{"id": "be0ad82c-c7b7-3e28-b13f-b07061d74c81", "vendor": {"name": "Linux"}}], "isExploited": false}