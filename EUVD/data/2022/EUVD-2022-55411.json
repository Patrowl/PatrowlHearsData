{"id": "EUVD-2022-55411", "enisaUuid": "db4bec7c-31ff-3383-8882-d9136219a0a7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: sf-pdma: Add multithread support for a DMA channel\n\nWhen we get a DMA channel and try to use it in multiple threads it\nwill cause oops and hanging the system.\n\n% echo 64 > /sys/module/dmatest/parameters/threads_per_chan\n% echo 10000 > /sys/module/dmatest/parameters/iterations\n% echo 1 > /sys/module/dmatest/parameters/run\n[   89.480664] Unable to handle kernel NULL pointer dereference at virtual\n               address 00000000000000a0\n[   89.488725] Oops [#1]\n[   89.494708] CPU: 2 PID: 1008 Comm: dma0chan0-copy0 Not tainted\n               5.17.0-rc5\n[   89.509385] epc : vchan_find_desc+0x32/0x46\n[   89.513553]  ra : sf_pdma_tx_status+0xca/0xd6\n\nThis happens because of data race. Each thread rewrite channels's\ndescriptor as soon as device_prep_dma_memcpy() is called. It leads to the\nsituation when the driver thinks that it uses right descriptor that\nactually is freed or substituted for other one.\n\nWith current fixes a descriptor changes its value only when it has\nbeen used. A new descriptor is acquired from vc->desc_issued queue that\nis already filled with descriptors that are ready to be sent. Threads\nhave no direct access to DMA channel descriptor. Now it is just possible\nto queue a descriptor for further processing.", "datePublished": "2025-06-18T12:30:51", "dateUpdated": "2025-11-21T00:30:18", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b9b4992f897be9b0b9e3a3b956cab6b75ccc3f11", "https://git.kernel.org/stable/c/5ab2782c944e324008ef5d658f2494a9f0e3c5ac", "https://git.kernel.org/stable/c/4c7350b1dd8a192af844de32fc99b9e34c876fda", "https://git.kernel.org/stable/c/a93b3f1e11971a91b6441b6d47488f4492cc113f", "https://git.kernel.org/stable/c/b2cc5c465c2cb8ab697c3fd6583c614e3f6cfbcc", "https://nvd.nist.gov/vuln/detail/CVE-2022-50145"], "aliases": ["CVE-2022-50145"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0bea12cb-e67d-3b24-81a2-8d1a36537750", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "3901b865-d084-3773-ac13-b98d35b17ae0", "product": {"name": "Linux"}, "product_version": "6973886ad58e6b4988813331abb76ae0b364a9c2 <b2cc5c465c2cb8ab697c3fd6583c614e3f6cfbcc"}, {"id": "4ee72be9-25ef-3624-96da-df9121bba080", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "94c33632-ef8c-3bff-8ea0-82983e9c6b53", "product": {"name": "Linux"}, "product_version": "5.5"}, {"id": "9d095f01-47e8-349e-84fb-066546b5b596", "product": {"name": "Linux"}, "product_version": "6973886ad58e6b4988813331abb76ae0b364a9c2 <a93b3f1e11971a91b6441b6d47488f4492cc113f"}, {"id": "aee99874-4739-3f43-a530-562966e033be", "product": {"name": "Linux"}, "product_version": "patch: 5.10.137"}, {"id": "b9f14ef6-473e-3150-8625-e3c74c814597", "product": {"name": "Linux"}, "product_version": "6973886ad58e6b4988813331abb76ae0b364a9c2 <5ab2782c944e324008ef5d658f2494a9f0e3c5ac"}, {"id": "befbd0d3-ce14-3b05-984c-9c9de96e346b", "product": {"name": "Linux"}, "product_version": "6973886ad58e6b4988813331abb76ae0b364a9c2 <4c7350b1dd8a192af844de32fc99b9e34c876fda"}, {"id": "f24dc4ba-2125-3874-8bd1-695bb03234fe", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "f5dbd072-cc1b-3d9c-94ee-a05633bc71e0", "product": {"name": "Linux"}, "product_version": "6973886ad58e6b4988813331abb76ae0b364a9c2 <b9b4992f897be9b0b9e3a3b956cab6b75ccc3f11"}, {"id": "f9b045f1-c9e5-303f-a32d-01df510d2e50", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "fad8be84-8830-3ab8-98d7-ad7fec63034d", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}], "enisaIdVendor": [{"id": "47b7c92a-fc16-39dc-aa41-dbbf4ea8ee23", "vendor": {"name": "Linux"}}], "isExploited": false}