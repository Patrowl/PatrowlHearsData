{"id": "EUVD-2022-55618", "enisaUuid": "2b606d26-831b-31b2-b2c3-5b8be88369e4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix null-ptr-deref in ext4_write_info\n\nI caught a null-ptr-deref bug as follows:\n==================================================================\nKASAN: null-ptr-deref in range [0x0000000000000068-0x000000000000006f]\nCPU: 1 PID: 1589 Comm: umount Not tainted 5.10.0-02219-dirty #339\nRIP: 0010:ext4_write_info+0x53/0x1b0\n[...]\nCall Trace:\n dquot_writeback_dquots+0x341/0x9a0\n ext4_sync_fs+0x19e/0x800\n __sync_filesystem+0x83/0x100\n sync_filesystem+0x89/0xf0\n generic_shutdown_super+0x79/0x3e0\n kill_block_super+0xa1/0x110\n deactivate_locked_super+0xac/0x130\n deactivate_super+0xb6/0xd0\n cleanup_mnt+0x289/0x400\n __cleanup_mnt+0x16/0x20\n task_work_run+0x11c/0x1c0\n exit_to_user_mode_prepare+0x203/0x210\n syscall_exit_to_user_mode+0x5b/0x3a0\n do_syscall_64+0x59/0x70\n entry_SYSCALL_64_after_hwframe+0x44/0xa9\n ==================================================================\n\nAbove issue may happen as follows:\n-------------------------------------\nexit_to_user_mode_prepare\n task_work_run\n  __cleanup_mnt\n   cleanup_mnt\n    deactivate_super\n     deactivate_locked_super\n      kill_block_super\n       generic_shutdown_super\n        shrink_dcache_for_umount\n         dentry = sb->s_root\n         sb->s_root = NULL              <--- Here set NULL\n        sync_filesystem\n         __sync_filesystem\n          sb->s_op->sync_fs > ext4_sync_fs\n           dquot_writeback_dquots\n            sb->dq_op->write_info > ext4_write_info\n             ext4_journal_start(d_inode(sb->s_root), EXT4_HT_QUOTA, 2)\n              d_inode(sb->s_root)\n               s_root->d_inode          <--- Null pointer dereference\n\nTo solve this problem, we use ext4_journal_start_sb directly\nto avoid s_root being used.", "datePublished": "2025-09-16T16:11:23", "dateUpdated": "2025-12-23T13:28:53", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/dc451578446afd03c0c21913993c08898a691435", "https://git.kernel.org/stable/c/f4b5ff0b794aa94afac7269c494550ca2f66511b", "https://git.kernel.org/stable/c/947264e00c46de19a016fd81218118c708fed2f3", "https://git.kernel.org/stable/c/3638aa1c7d87c0ca0aef23cf58cae2c48e7daca4", "https://git.kernel.org/stable/c/f34ab95162763cd7352f46df169296eec28b688d", "https://git.kernel.org/stable/c/533c60a0b97cee5daab376933f486207e6680fb7", "https://git.kernel.org/stable/c/4a657319cfabd6199fd0b7b65bbebf6ded7a11c1", "https://git.kernel.org/stable/c/bb420e8afc854d2a1caaa23a0c129839acfb7888", "https://git.kernel.org/stable/c/f9c1f248607d5546075d3f731e7607d5571f2b60", "https://nvd.nist.gov/vuln/detail/CVE-2022-50344"], "aliases": ["CVE-2022-50344"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "042fa0b7-391c-3abb-944a-6c9f5c0610f1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f4b5ff0b794aa94afac7269c494550ca2f66511b"}, {"id": "0748aa43-5482-332f-9e2b-4479cb42be44", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bb420e8afc854d2a1caaa23a0c129839acfb7888"}, {"id": "1b923f8a-7129-30fe-8fa4-210f55965698", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <947264e00c46de19a016fd81218118c708fed2f3"}, {"id": "3ba6661d-4877-30eb-831a-d16e2daaf046", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <533c60a0b97cee5daab376933f486207e6680fb7"}, {"id": "42453e00-62e9-3b27-b48a-dbc8662ad798", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "553b42d8-4f16-34f6-a776-e556f058d1f7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4a657319cfabd6199fd0b7b65bbebf6ded7a11c1"}, {"id": "59198672-09e8-3d08-abbf-9f1e790a1156", "product": {"name": "Linux"}, "product_version": "patch: 5.4.220"}, {"id": "5956f914-b493-3bfc-8d34-fa5e03a52d3f", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <bb420e8afc854d2a1caaa23a0c129839acfb7888"}, {"id": "5a36c044-94aa-3bd7-8d95-622748e37fa8", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "5c815b71-49e6-3f59-8a58-fe095bfdfbc0", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "5dc3f865-0832-3117-bcc8-e87565f2ece4", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f9c1f248607d5546075d3f731e7607d5571f2b60"}, {"id": "6eb5a4d8-f9cf-3c52-bcde-c096a5f1add7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3638aa1c7d87c0ca0aef23cf58cae2c48e7daca4"}, {"id": "75464ed6-9fad-34ae-9a9b-c3e9555533ec", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <dc451578446afd03c0c21913993c08898a691435"}, {"id": "76b08389-76c0-3f74-b30a-d8cc5db713be", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <3638aa1c7d87c0ca0aef23cf58cae2c48e7daca4"}, {"id": "7756a24b-b302-3425-9df4-a6d155dc1c1a", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <f4b5ff0b794aa94afac7269c494550ca2f66511b"}, {"id": "8376c30d-ba00-3d9c-8cea-475d8bf69298", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <4a657319cfabd6199fd0b7b65bbebf6ded7a11c1"}, {"id": "84c5100b-8831-33f6-a5bd-7851caf0fdac", "product": {"name": "Linux"}, "product_version": "3.6"}, {"id": "86990633-c378-3753-b7c7-fbc7031f96f0", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <dc451578446afd03c0c21913993c08898a691435"}, {"id": "8abf776f-f9f2-3fc2-9c5b-a9aca9d8cc81", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <533c60a0b97cee5daab376933f486207e6680fb7"}, {"id": "91050c81-2de3-3c7e-b2e6-feef0281cd1b", "product": {"name": "Linux"}, "product_version": "patch: 4.14.296"}, {"id": "a07b26db-c5f5-375e-890d-380ab77ebd40", "product": {"name": "Linux"}, "product_version": "patch: 4.19.262"}, {"id": "afddbd11-e8ac-3ef8-a74f-43f5d8e12d2d", "product": {"name": "Linux"}, "product_version": "patch: 4.9.331"}, {"id": "b8dd318b-b038-3536-a341-cf61645235b5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <947264e00c46de19a016fd81218118c708fed2f3"}, {"id": "cfb9629d-aba2-3449-941c-cb55a06e372c", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <f9c1f248607d5546075d3f731e7607d5571f2b60"}, {"id": "d5004218-cc38-32b6-badc-8733fa1ad1cc", "product": {"name": "Linux"}, "product_version": "a1177825719ccef3f76ef39bbfd5ebb6087d53c7 <f34ab95162763cd7352f46df169296eec28b688d"}, {"id": "e60d7256-f419-3492-8313-69b803dbad76", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "e6e892bb-6633-39f7-987f-da47e8e152e2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f34ab95162763cd7352f46df169296eec28b688d"}, {"id": "e97055c6-0056-30dc-a841-eba29724ece7", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ebe2fcf2-8bd8-32ab-aeef-975e8e0a248b", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}], "enisaIdVendor": [{"id": "c90c6561-d0d3-361b-b12a-9191f23e4904", "vendor": {"name": "Linux"}}], "isExploited": false}