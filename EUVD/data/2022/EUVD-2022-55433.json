{"id": "EUVD-2022-55433", "enisaUuid": "4a0b5c49-e90b-32ed-94e5-cf2c4df0f8c0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, x86: fix freeing of not-finalized bpf_prog_pack\n\nsyzbot reported a few issues with bpf_prog_pack [1], [2]. This only happens\nwith multiple subprogs. In jit_subprogs(), we first call bpf_int_jit_compile()\non each sub program. And then, we call it on each sub program again. jit_data\nis not freed in the first call of bpf_int_jit_compile(). Similarly we don't\ncall bpf_jit_binary_pack_finalize() in the first call of bpf_int_jit_compile().\n\nIf bpf_int_jit_compile() failed for one sub program, we will call\nbpf_jit_binary_pack_finalize() for this sub program. However, we don't have a\nchance to call it for other sub programs. Then we will hit \"goto out_free\" in\njit_subprogs(), and call bpf_jit_free on some subprograms that haven't got\nbpf_jit_binary_pack_finalize() yet.\n\nAt this point, bpf_jit_binary_pack_free() is called and the whole 2MB page is\nfreed erroneously.\n\nFix this with a custom bpf_jit_free() for x86_64, which calls\nbpf_jit_binary_pack_finalize() if necessary. Also, with custom\nbpf_jit_free(), bpf_prog_aux->use_bpf_prog_pack is not needed any more,\nremove it.\n\n[1] https://syzkaller.appspot.com/bug?extid=2f649ec6d2eea1495a8f\n[2] https://syzkaller.appspot.com/bug?extid=87f65c75f4a72db05445", "datePublished": "2025-06-18T12:30:52", "dateUpdated": "2025-12-03T21:30:58", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/f91ce608a79c0db3e72bd63c23e011a9ebc31505", "https://git.kernel.org/stable/c/60e66074812dde9cde3d99cdd3caa9e40f1a4516", "https://git.kernel.org/stable/c/1d5f82d9dd477d5c66e0214a68c3e4f308eadd6d", "https://nvd.nist.gov/vuln/detail/CVE-2022-50168"], "aliases": ["CVE-2022-50168"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "5008c0ea-f225-39f8-9210-55eeba38e8e0", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "55bbb0dc-74b9-3b0b-a420-f94c7fc9986d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "8e4d44b8-85b1-3fa0-b115-ba285bb99277", "product": {"name": "Linux"}, "product_version": "1022a5498f6f745c3b5fd3f050a5e11e7ca354f0 <1d5f82d9dd477d5c66e0214a68c3e4f308eadd6d"}, {"id": "aa4233aa-5045-353e-a82d-3701d26cb4db", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ae18241e-41f1-3ac5-b641-1dd86e1dc607", "product": {"name": "Linux"}, "product_version": "1022a5498f6f745c3b5fd3f050a5e11e7ca354f0 <60e66074812dde9cde3d99cdd3caa9e40f1a4516"}, {"id": "dbfe0009-51aa-36c4-b0ae-0bb6e18a53b2", "product": {"name": "Linux"}, "product_version": "5.18"}, {"id": "de161c04-b735-3c5b-bd1a-68c5da117bd4", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "e6fd7d91-c526-3a1a-b0d5-f2b5f7d57798", "product": {"name": "Linux"}, "product_version": "1022a5498f6f745c3b5fd3f050a5e11e7ca354f0 <f91ce608a79c0db3e72bd63c23e011a9ebc31505"}], "enisaIdVendor": [{"id": "b24ca0c6-abe9-3467-8097-ec7549a35259", "vendor": {"name": "Linux"}}], "isExploited": false}