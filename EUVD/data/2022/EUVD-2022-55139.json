{"id": "EUVD-2022-55139", "enisaUuid": "71595a5d-4bbf-3029-a9d2-21be6abfb37a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nSUNRPC: Fix the svc_deferred_event trace class\n\nFix a NULL deref crash that occurs when an svc_rqst is deferred\nwhile the sunrpc tracing subsystem is enabled. svc_revisit() sets\ndr->xprt to NULL, so it can't be relied upon in the tracepoint to\nprovide the remote's address.\n\nUnfortunately we can't revert the \"svc_deferred_class\" hunk in\ncommit ece200ddd54b (\"sunrpc: Save remote presentation address in\nsvc_xprt for trace events\") because there is now a specific check\nof event format specifiers for unsafe dereferences. The warning\nthat check emits is:\n\n  event svc_defer_recv has unsafe dereference of argument 1\n\nA \"%pISpc\" format specifier with a \"struct sockaddr *\" is indeed\nflagged by this check.\n\nInstead, take the brute-force approach used by the svcrdma_qp_error\ntracepoint. Convert the dr::addr field into a presentation address\nin the TP_fast_assign() arm of the trace event, and store that as\na string. This fix can be backported to -stable kernels.\n\nIn the meantime, commit c6ced22997ad (\"tracing: Update print fmt\ncheck to handle new __get_sockaddr() macro\") is now in v5.18, so\nthis wonky fix can be replaced with __sockaddr() and friends\nproperly during the v5.19 merge window.", "datePublished": "2025-02-26T01:54:33", "dateUpdated": "2025-10-01T19:57:06", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/85ee17ca21cf92989e8c923e3ea4514c291e9d38", "https://git.kernel.org/stable/c/726ae7300fcc25fefa46d188cc07eb16dc908f9e", "https://git.kernel.org/stable/c/c2456f470eea3bd06574d988bf6089e7c3f4c5cc", "https://git.kernel.org/stable/c/4d5004451ab2218eab94a30e1841462c9316ba19", "https://nvd.nist.gov/vuln/detail/CVE-2022-49065"], "aliases": ["CVE-2022-49065"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "2e8424d2-0d70-3c84-ba0d-e28ffbcb233e", "product": {"name": "Linux"}, "product_version": "ece200ddd54b9ce840cfee554fb812560c545c7d <c2456f470eea3bd06574d988bf6089e7c3f4c5cc"}, {"id": "468bb383-d010-306e-8754-c415c0256613", "product": {"name": "Linux"}, "product_version": "ece200ddd54b9ce840cfee554fb812560c545c7d <726ae7300fcc25fefa46d188cc07eb16dc908f9e"}, {"id": "4943869d-a572-39b4-8927-6f33c5e1b43b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "59f65aef-d106-36bf-8156-cb4ded545f19", "product": {"name": "Linux"}, "product_version": "4.17"}, {"id": "6c61277b-5203-3615-a964-e5f800548585", "product": {"name": "Linux"}, "product_version": "patch: 5.10.112"}, {"id": "6d5be744-c88c-3b40-838c-523f3f39d8da", "product": {"name": "Linux"}, "product_version": "ece200ddd54b9ce840cfee554fb812560c545c7d <4d5004451ab2218eab94a30e1841462c9316ba19"}, {"id": "7fb1b2ea-78db-34cf-8389-f75d55393f0d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.35"}, {"id": "88beee30-64db-389a-8c0c-97af48c7497b", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "c494704d-cc71-3c88-a428-e7e76e2a3316", "product": {"name": "Linux"}, "product_version": "patch: 5.17.4"}, {"id": "ea0a0f08-36af-314c-9165-6d9bf98274ab", "product": {"name": "Linux"}, "product_version": "ece200ddd54b9ce840cfee554fb812560c545c7d <85ee17ca21cf92989e8c923e3ea4514c291e9d38"}], "enisaIdVendor": [{"id": "059e9a4b-240a-358f-9855-bdf1988fa4d1", "vendor": {"name": "Linux"}}], "isExploited": false}