{"id": "EUVD-2022-55810", "enisaUuid": "43f26656-9510-3c79-8105-c4184c6d86be", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nconfigfs: fix possible memory leak in configfs_create_dir()\n\nkmemleak reported memory leaks in configfs_create_dir():\n\nunreferenced object 0xffff888009f6af00 (size 192):\n  comm \"modprobe\", pid 3777, jiffies 4295537735 (age 233.784s)\n  backtrace:\n    kmem_cache_alloc (mm/slub.c:3250 mm/slub.c:3256 mm/slub.c:3263 mm/slub.c:3273)\n    new_fragment (./include/linux/slab.h:600 fs/configfs/dir.c:163)\n    configfs_register_subsystem (fs/configfs/dir.c:1857)\n    basic_write (drivers/hwtracing/stm/p_basic.c:14) stm_p_basic\n    do_one_initcall (init/main.c:1296)\n    do_init_module (kernel/module/main.c:2455)\n    ...\n\nunreferenced object 0xffff888003ba7180 (size 96):\n  comm \"modprobe\", pid 3777, jiffies 4295537735 (age 233.784s)\n  backtrace:\n    kmem_cache_alloc (mm/slub.c:3250 mm/slub.c:3256 mm/slub.c:3263 mm/slub.c:3273)\n    configfs_new_dirent (./include/linux/slab.h:723 fs/configfs/dir.c:194)\n    configfs_make_dirent (fs/configfs/dir.c:248)\n    configfs_create_dir (fs/configfs/dir.c:296)\n    configfs_attach_group.isra.28 (fs/configfs/dir.c:816 fs/configfs/dir.c:852)\n    configfs_register_subsystem (fs/configfs/dir.c:1881)\n    basic_write (drivers/hwtracing/stm/p_basic.c:14) stm_p_basic\n    do_one_initcall (init/main.c:1296)\n    do_init_module (kernel/module/main.c:2455)\n    ...\n\nThis is because the refcount is not correct in configfs_make_dirent().\nFor normal stage, the refcount is changing as:\n\nconfigfs_register_subsystem()\n  configfs_create_dir()\n    configfs_make_dirent()\n      configfs_new_dirent() # set s_count = 1\n      dentry->d_fsdata = configfs_get(sd); # s_count = 2\n...\nconfigfs_unregister_subsystem()\n  configfs_remove_dir()\n    remove_dir()\n      configfs_remove_dirent() # s_count = 1\n    dput() ...\n      *dentry_unlink_inode()*\n        configfs_d_iput() # s_count = 0, release\n\nHowever, if we failed in configfs_create():\n\nconfigfs_register_subsystem()\n  configfs_create_dir()\n    configfs_make_dirent() # s_count = 2\n    ...\n    configfs_create() # fail\n    ->out_remove:\n    configfs_remove_dirent(dentry)\n      configfs_put(sd) # s_count = 1\n      return PTR_ERR(inode);\n\nThere is no inode in the error path, so the configfs_d_iput() is lost\nand makes sd and fragment memory leaked.\n\nTo fix this, when we failed in configfs_create(), manually call\nconfigfs_put(sd) to keep the refcount correct.", "datePublished": "2025-12-24T15:30:34", "dateUpdated": "2025-12-24T15:30:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/90c38f57a821499391526b15cc944c265bd24e48", "https://git.kernel.org/stable/c/74ac7c9ee2d486c501e7864c903f5098fc477acd", "https://git.kernel.org/stable/c/07f82dca112262b169bec0001378126439cab776", "https://git.kernel.org/stable/c/8bc77754224a2c8581727ffe2e958119b4e27c8f", "https://git.kernel.org/stable/c/c72eb6e6e49a71f7598740786568fafdd013a227", "https://git.kernel.org/stable/c/c65234b283a65cfbfc94619655e820a5e55199eb", "https://nvd.nist.gov/vuln/detail/CVE-2022-50751"], "aliases": ["CVE-2022-50751"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "05499494-6ddb-32dc-a6b5-fc1321a133fd", "product": {"name": "Linux"}, "product_version": "patch: 6.1.2"}, {"id": "0a617df9-4194-3ba9-a771-5b9c63e2f22b", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "20319b43-cb22-3a5b-ac78-d0cfb852352f", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <c65234b283a65cfbfc94619655e820a5e55199eb"}, {"id": "3109ed8d-750f-3336-bd71-6af7c0c268ce", "product": {"name": "Linux"}, "product_version": "2.6.16"}, {"id": "7af3d148-106a-39f2-a637-d822a453cb3f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.86"}, {"id": "86d697ce-8072-39ea-a358-c9af6ea36ccd", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <8bc77754224a2c8581727ffe2e958119b4e27c8f"}, {"id": "8c4c0b53-e55b-3c49-9870-55ae2852c605", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "9c5fb2c8-f65c-3aec-be88-963174a5956f", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <07f82dca112262b169bec0001378126439cab776"}, {"id": "9e9aeea6-585d-3554-995f-24a4eb81b07c", "product": {"name": "Linux"}, "product_version": "patch: 5.10.163"}, {"id": "a8e3440e-4563-3b86-8ca2-43640d527e56", "product": {"name": "Linux"}, "product_version": "patch: 5.4.229"}, {"id": "abc6635b-5c93-3530-b601-31dbc973932b", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <90c38f57a821499391526b15cc944c265bd24e48"}, {"id": "d2522a8d-68eb-310d-9ce5-66ffb816473f", "product": {"name": "Linux"}, "product_version": "patch: 6.0.16"}, {"id": "d52fbe97-7805-3b20-a644-df6222b2bc19", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <c72eb6e6e49a71f7598740786568fafdd013a227"}, {"id": "f5129a1c-c8b0-3dd7-b2ae-f1a97ffceda1", "product": {"name": "Linux"}, "product_version": "7063fbf2261194f72ee75afca67b3b38b554b5fa <74ac7c9ee2d486c501e7864c903f5098fc477acd"}], "enisaIdVendor": [{"id": "eb7ec272-8e1c-3381-9259-2a3b70024e26", "vendor": {"name": "Linux"}}], "isExploited": false}