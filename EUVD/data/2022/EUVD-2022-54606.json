{"id": "EUVD-2022-54606", "enisaUuid": "02109f70-4cdc-37a3-858d-614c88e7de6f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsfc: fix use after free when disabling sriov\n\nUse after free is detected by kfence when disabling sriov. What was read\nafter being freed was vf->pci_dev: it was freed from pci_disable_sriov\nand later read in efx_ef10_sriov_free_vf_vports, called from\nefx_ef10_sriov_free_vf_vswitching.\n\nSet the pointer to NULL at release time to not trying to read it later.\n\nReproducer and dmesg log (note that kfence doesn't detect it every time):\n$ echo 1 > /sys/class/net/enp65s0f0np0/device/sriov_numvfs\n$ echo 0 > /sys/class/net/enp65s0f0np0/device/sriov_numvfs\n\n BUG: KFENCE: use-after-free read in efx_ef10_sriov_free_vf_vswitching+0x82/0x170 [sfc]\n\n Use-after-free read at 0x00000000ff3c1ba5 (in kfence-#224):\n  efx_ef10_sriov_free_vf_vswitching+0x82/0x170 [sfc]\n  efx_ef10_pci_sriov_disable+0x38/0x70 [sfc]\n  efx_pci_sriov_configure+0x24/0x40 [sfc]\n  sriov_numvfs_store+0xfe/0x140\n  kernfs_fop_write_iter+0x11c/0x1b0\n  new_sync_write+0x11f/0x1b0\n  vfs_write+0x1eb/0x280\n  ksys_write+0x5f/0xe0\n  do_syscall_64+0x5c/0x80\n  entry_SYSCALL_64_after_hwframe+0x44/0xae\n\n kfence-#224: 0x00000000edb8ef95-0x00000000671f5ce1, size=2792, cache=kmalloc-4k\n\n allocated by task 6771 on cpu 10 at 3137.860196s:\n  pci_alloc_dev+0x21/0x60\n  pci_iov_add_virtfn+0x2a2/0x320\n  sriov_enable+0x212/0x3e0\n  efx_ef10_sriov_configure+0x67/0x80 [sfc]\n  efx_pci_sriov_configure+0x24/0x40 [sfc]\n  sriov_numvfs_store+0xba/0x140\n  kernfs_fop_write_iter+0x11c/0x1b0\n  new_sync_write+0x11f/0x1b0\n  vfs_write+0x1eb/0x280\n  ksys_write+0x5f/0xe0\n  do_syscall_64+0x5c/0x80\n  entry_SYSCALL_64_after_hwframe+0x44/0xae\n\n freed by task 6771 on cpu 12 at 3170.991309s:\n  device_release+0x34/0x90\n  kobject_cleanup+0x3a/0x130\n  pci_iov_remove_virtfn+0xd9/0x120\n  sriov_disable+0x30/0xe0\n  efx_ef10_pci_sriov_disable+0x57/0x70 [sfc]\n  efx_pci_sriov_configure+0x24/0x40 [sfc]\n  sriov_numvfs_store+0xfe/0x140\n  kernfs_fop_write_iter+0x11c/0x1b0\n  new_sync_write+0x11f/0x1b0\n  vfs_write+0x1eb/0x280\n  ksys_write+0x5f/0xe0\n  do_syscall_64+0x5c/0x80\n  entry_SYSCALL_64_after_hwframe+0x44/0xae", "datePublished": "2025-02-27T21:32:14", "dateUpdated": "2025-02-27T21:32:15", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3199e34912d84cdfb8a93a984c5ae5c73fb13e84", "https://git.kernel.org/stable/c/c9e75bb22a26e391f189f5a5133dd63dcb57fdaa", "https://git.kernel.org/stable/c/9c854ae512b89229aeee93849e9bd4c115b37909", "https://git.kernel.org/stable/c/bcad880865bfb421885364b1f0c7351280fe2b97", "https://git.kernel.org/stable/c/c2240500817b3b4b996cdf2a461a3a5679f49b94", "https://git.kernel.org/stable/c/58d93e9d160c0de6d867c7eb4c2206671a351eb1", "https://git.kernel.org/stable/c/e435c4aeeaa073091f7f3b7735af2ef5c97d63f2", "https://git.kernel.org/stable/c/ebe41da5d47ac0fff877e57bd14c54dccf168827", "https://nvd.nist.gov/vuln/detail/CVE-2022-49626"], "aliases": ["CVE-2022-49626"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "132b3450-57f1-3a70-896a-630fa96edd60", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "180cd7f0-d632-3c51-864d-71f4bba65bb8", "product": {"name": "Linux"}, "product_version": "patch: 5.4.207"}, {"id": "205166db-95bd-3fda-b3a1-abacf5790b57", "product": {"name": "Linux"}, "product_version": "patch: 4.9.324"}, {"id": "2e5616e6-727b-31b5-8efd-afa1048e7d77", "product": {"name": "Linux"}, "product_version": "patch: 5.18.13"}, {"id": "4bd84a91-d475-3b3c-be5a-02a2ea62c676", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "4cb78ed6-aa84-3256-ae3b-35bd5e7dc550", "product": {"name": "Linux"}, "product_version": "patch: 5.15.56"}, {"id": "4e2a2957-62f5-312c-9023-13bce6c825a3", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <58d93e9d160c0de6d867c7eb4c2206671a351eb1"}, {"id": "5bd2a1fa-5a54-323c-a278-96eae7066d49", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <c2240500817b3b4b996cdf2a461a3a5679f49b94"}, {"id": "66eeeb0b-cf18-3374-b9db-da10edb83042", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <bcad880865bfb421885364b1f0c7351280fe2b97"}, {"id": "6a5f636b-b5c3-3fb0-aa67-6cfe31f7502a", "product": {"name": "Linux"}, "product_version": "patch: 4.19.253"}, {"id": "9b01f846-8d36-386e-8550-610a6da04258", "product": {"name": "Linux"}, "product_version": "patch: 5.10.132"}, {"id": "ad30d952-7b83-318c-9db5-e87781884fc1", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <e435c4aeeaa073091f7f3b7735af2ef5c97d63f2"}, {"id": "b5dbb70a-0e9a-357f-96da-3a570a3b1b07", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <c9e75bb22a26e391f189f5a5133dd63dcb57fdaa"}, {"id": "bc0bf456-369c-3712-9555-a7d3e3d81511", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <ebe41da5d47ac0fff877e57bd14c54dccf168827"}, {"id": "bd8e1bf0-3501-3697-8560-c7cc281c02d5", "product": {"name": "Linux"}, "product_version": "4.2"}, {"id": "cd1b1c3f-ab42-3c90-81b3-9cc9fe0cc4a1", "product": {"name": "Linux"}, "product_version": "patch: 4.14.289"}, {"id": "d96acb40-b43e-30e0-b75a-a47e0e45b6bd", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <9c854ae512b89229aeee93849e9bd4c115b37909"}, {"id": "dd6c1cd5-b2c9-31fb-92d4-fc5a929e504b", "product": {"name": "Linux"}, "product_version": "3c5eb87605e85146a78de589b5070a37862425db <3199e34912d84cdfb8a93a984c5ae5c73fb13e84"}], "enisaIdVendor": [{"id": "a4f9444e-682e-364d-9788-6a01aca4ee3d", "vendor": {"name": "Linux"}}], "isExploited": false}