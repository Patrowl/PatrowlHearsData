{"id": "EUVD-2022-54609", "enisaUuid": "47d80867-0bee-3651-b83b-8e1b86a74948", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/xive/spapr: correct bitmap allocation size\n\nkasan detects access beyond the end of the xibm->bitmap allocation:\n\nBUG: KASAN: slab-out-of-bounds in _find_first_zero_bit+0x40/0x140\nRead of size 8 at addr c00000001d1d0118 by task swapper/0/1\n\nCPU: 0 PID: 1 Comm: swapper/0 Not tainted 5.19.0-rc2-00001-g90df023b36dd #28\nCall Trace:\n[c00000001d98f770] [c0000000012baab8] dump_stack_lvl+0xac/0x108 (unreliable)\n[c00000001d98f7b0] [c00000000068faac] print_report+0x37c/0x710\n[c00000001d98f880] [c0000000006902c0] kasan_report+0x110/0x354\n[c00000001d98f950] [c000000000692324] __asan_load8+0xa4/0xe0\n[c00000001d98f970] [c0000000011c6ed0] _find_first_zero_bit+0x40/0x140\n[c00000001d98f9b0] [c0000000000dbfbc] xive_spapr_get_ipi+0xcc/0x260\n[c00000001d98fa70] [c0000000000d6d28] xive_setup_cpu_ipi+0x1e8/0x450\n[c00000001d98fb30] [c000000004032a20] pSeries_smp_probe+0x5c/0x118\n[c00000001d98fb60] [c000000004018b44] smp_prepare_cpus+0x944/0x9ac\n[c00000001d98fc90] [c000000004009f9c] kernel_init_freeable+0x2d4/0x640\n[c00000001d98fd90] [c0000000000131e8] kernel_init+0x28/0x1d0\n[c00000001d98fe10] [c00000000000cd54] ret_from_kernel_thread+0x5c/0x64\n\nAllocated by task 0:\n kasan_save_stack+0x34/0x70\n __kasan_kmalloc+0xb4/0xf0\n __kmalloc+0x268/0x540\n xive_spapr_init+0x4d0/0x77c\n pseries_init_irq+0x40/0x27c\n init_IRQ+0x44/0x84\n start_kernel+0x2a4/0x538\n start_here_common+0x1c/0x20\n\nThe buggy address belongs to the object at c00000001d1d0118\n which belongs to the cache kmalloc-8 of size 8\nThe buggy address is located 0 bytes inside of\n 8-byte region [c00000001d1d0118, c00000001d1d0120)\n\nThe buggy address belongs to the physical page:\npage:c00c000000074740 refcount:1 mapcount:0 mapping:0000000000000000 index:0xc00000001d1d0558 pfn:0x1d1d\nflags: 0x7ffff000000200(slab|node=0|zone=0|lastcpupid=0x7ffff)\nraw: 007ffff000000200 c00000001d0003c8 c00000001d0003c8 c00000001d010480\nraw: c00000001d1d0558 0000000001e1000a 00000001ffffffff 0000000000000000\npage dumped because: kasan: bad access detected\n\nMemory state around the buggy address:\n c00000001d1d0000: fc 00 fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n c00000001d1d0080: fc fc 00 fc fc fc fc fc fc fc fc fc fc fc fc fc\n>c00000001d1d0100: fc fc fc 02 fc fc fc fc fc fc fc fc fc fc fc fc\n                            ^\n c00000001d1d0180: fc fc fc fc 04 fc fc fc fc fc fc fc fc fc fc fc\n c00000001d1d0200: fc fc fc fc fc 04 fc fc fc fc fc fc fc fc fc fc\n\nThis happens because the allocation uses the wrong unit (bits) when it\nshould pass (BITS_TO_LONGS(count) * sizeof(long)) or equivalent. With small\nnumbers of bits, the allocated object can be smaller than sizeof(long),\nwhich results in invalid accesses.\n\nUse bitmap_zalloc() to allocate and initialize the irq bitmap, paired with\nbitmap_free() for consistency.", "datePublished": "2025-02-26T02:23:39", "dateUpdated": "2025-12-23T13:24:51", "baseScore": 7.1, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H", "references": ["https://git.kernel.org/stable/c/10f2cd373e65bcd3be8f3cdc71c330c25763dfd8", "https://git.kernel.org/stable/c/99d1c36bddd93919072b5a51a89297bbb5ad6a6f", "https://git.kernel.org/stable/c/19fc5bb93c6bbdce8292b4d7eed04e2fa118d2fe"], "aliases": ["CVE-2022-49623"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "12b61a48-edc5-36f3-90a3-d6bcc2b9940b", "product": {"name": "Linux"}, "product_version": "eac1e731b59ee3b5f5e641a7765c7ed41ed26226 <10f2cd373e65bcd3be8f3cdc71c330c25763dfd8"}, {"id": "195886fc-3347-3128-a926-f3841f1df599", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "4d132d7a-79dc-3329-8187-b1741c654551", "product": {"name": "Linux"}, "product_version": "4.14"}, {"id": "522be5ad-a0a0-3530-b28f-2ce0f019dc06", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <99d1c36bddd93919072b5a51a89297bbb5ad6a6f"}, {"id": "77a7c5e1-41db-39e4-9a17-aa458697f8d8", "product": {"name": "Linux"}, "product_version": "patch: 5.15.56"}, {"id": "9a11a0f2-dfcf-3608-a3c5-c9611a74dc7c", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "c32a642c-5859-3c8b-8562-14c23c1efc07", "product": {"name": "Linux"}, "product_version": "eac1e731b59ee3b5f5e641a7765c7ed41ed26226 <19fc5bb93c6bbdce8292b4d7eed04e2fa118d2fe"}, {"id": "d339a134-5d9d-3b6a-8c6d-9c8c31ee62e2", "product": {"name": "Linux"}, "product_version": "patch: 5.18.13"}, {"id": "e27b9dac-d5c9-3fdc-bcdd-f7835f5a6e4d", "product": {"name": "Linux"}, "product_version": "eac1e731b59ee3b5f5e641a7765c7ed41ed26226 <99d1c36bddd93919072b5a51a89297bbb5ad6a6f"}, {"id": "e69d9e99-3756-38c0-b065-b0a2e1288a36", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <10f2cd373e65bcd3be8f3cdc71c330c25763dfd8"}, {"id": "fe7464d9-a73f-3dd1-ae88-22fc2d6aab15", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <19fc5bb93c6bbdce8292b4d7eed04e2fa118d2fe"}], "enisaIdVendor": [{"id": "43d37833-12cd-3e16-bccc-80276f407a09", "vendor": {"name": "Linux"}}], "isExploited": false}