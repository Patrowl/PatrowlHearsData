{"id": "EUVD-2022-55916", "enisaUuid": "8708b485-5817-3738-9937-ce1b237ab90c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ath10k: add peer map clean up for peer delete in ath10k_sta_state()\n\nWhen peer delete failed in a disconnect operation, use-after-free\ndetected by KFENCE in below log. It is because for each vdev_id and\naddress, it has only one struct ath10k_peer, it is allocated in\nath10k_peer_map_event(). When connected to an AP, it has more than\none HTT_T2H_MSG_TYPE_PEER_MAP reported from firmware, then the\narray peer_map of struct ath10k will be set muti-elements to the\nsame ath10k_peer in ath10k_peer_map_event(). When peer delete failed\nin ath10k_sta_state(), the ath10k_peer will be free for the 1st peer\nid in array peer_map of struct ath10k, and then use-after-free happened\nfor the 2nd peer id because they map to the same ath10k_peer.\n\nAnd clean up all peers in array peer_map for the ath10k_peer, then\nuser-after-free disappeared\n\npeer map event log:\n[  306.911021] wlan0: authenticate with b0:2a:43:e6:75:0e\n[  306.957187] ath10k_pci 0000:01:00.0: mac vdev 0 peer create b0:2a:43:e6:75:0e (new sta) sta 1 / 32 peer 1 / 33\n[  306.957395] ath10k_pci 0000:01:00.0: htt peer map vdev 0 peer b0:2a:43:e6:75:0e id 246\n[  306.957404] ath10k_pci 0000:01:00.0: htt peer map vdev 0 peer b0:2a:43:e6:75:0e id 198\n[  306.986924] ath10k_pci 0000:01:00.0: htt peer map vdev 0 peer b0:2a:43:e6:75:0e id 166\n\npeer unmap event log:\n[  435.715691] wlan0: deauthenticating from b0:2a:43:e6:75:0e by local choice (Reason: 3=DEAUTH_LEAVING)\n[  435.716802] ath10k_pci 0000:01:00.0: mac vdev 0 peer delete b0:2a:43:e6:75:0e sta ffff990e0e9c2b50 (sta gone)\n[  435.717177] ath10k_pci 0000:01:00.0: htt peer unmap vdev 0 peer b0:2a:43:e6:75:0e id 246\n[  435.717186] ath10k_pci 0000:01:00.0: htt peer unmap vdev 0 peer b0:2a:43:e6:75:0e id 198\n[  435.717193] ath10k_pci 0000:01:00.0: htt peer unmap vdev 0 peer b0:2a:43:e6:75:0e id 166\n\nuse-after-free log:\n[21705.888627] wlan0: deauthenticating from d0:76:8f:82:be:75 by local choice (Reason: 3=DEAUTH_LEAVING)\n[21713.799910] ath10k_pci 0000:01:00.0: failed to delete peer d0:76:8f:82:be:75 for vdev 0: -110\n[21713.799925] ath10k_pci 0000:01:00.0: found sta peer d0:76:8f:82:be:75 (ptr 0000000000000000 id 102) entry on vdev 0 after it was supposedly removed\n[21713.799968] ==================================================================\n[21713.799991] BUG: KFENCE: use-after-free read in ath10k_sta_state+0x265/0xb8a [ath10k_core]\n[21713.799991]\n[21713.799997] Use-after-free read at 0x00000000abe1c75e (in kfence-#69):\n[21713.800010]  ath10k_sta_state+0x265/0xb8a [ath10k_core]\n[21713.800041]  drv_sta_state+0x115/0x677 [mac80211]\n[21713.800059]  __sta_info_destroy_part2+0xb1/0x133 [mac80211]\n[21713.800076]  __sta_info_flush+0x11d/0x162 [mac80211]\n[21713.800093]  ieee80211_set_disassoc+0x12d/0x2f4 [mac80211]\n[21713.800110]  ieee80211_mgd_deauth+0x26c/0x29b [mac80211]\n[21713.800137]  cfg80211_mlme_deauth+0x13f/0x1bb [cfg80211]\n[21713.800153]  nl80211_deauthenticate+0xf8/0x121 [cfg80211]\n[21713.800161]  genl_rcv_msg+0x38e/0x3be\n[21713.800166]  netlink_rcv_skb+0x89/0xf7\n[21713.800171]  genl_rcv+0x28/0x36\n[21713.800176]  netlink_unicast+0x179/0x24b\n[21713.800181]  netlink_sendmsg+0x3a0/0x40e\n[21713.800187]  sock_sendmsg+0x72/0x76\n[21713.800192]  ____sys_sendmsg+0x16d/0x1e3\n[21713.800196]  ___sys_sendmsg+0x95/0xd1\n[21713.800200]  __sys_sendmsg+0x85/0xbf\n[21713.800205]  do_syscall_64+0x43/0x55\n[21713.800210]  entry_SYSCALL_64_after_hwframe+0x44/0xa9\n[21713.800213]\n[21713.800219] kfence-#69: 0x000000009149b0d5-0x000000004c0697fb, size=1064, cache=kmalloc-2k\n[21713.800219]\n[21713.800224] allocated by task 13 on cpu 0 at 21705.501373s:\n[21713.800241]  ath10k_peer_map_event+0x7e/0x154 [ath10k_core]\n[21713.800254]  ath10k_htt_t2h_msg_handler+0x586/0x1039 [ath10k_core]\n[21713.800265]  ath10k_htt_htc_t2h_msg_handler+0x12/0x28 [ath10k_core]\n[21713.800277]  ath10k_htc_rx_completion_handler+0x14c/0x1b5 [ath10k_core]\n[21713.800283]  ath10k_pci_process_rx_cb+0x195/0x1d\n---truncated---", "datePublished": "2025-12-30T15:30:29", "dateUpdated": "2025-12-30T15:30:29", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/15604ab67179ae27ea3c7fb24b6df32b143257c4", "https://git.kernel.org/stable/c/2d6259715c9597a6cfa25db8911683eb0073b1c6", "https://git.kernel.org/stable/c/f12fc305c127bd07bb50373e29c6037696f916a8", "https://git.kernel.org/stable/c/4494ec1c0bb850eaa80fed98e5b041d961011d3e", "https://git.kernel.org/stable/c/08faf07717be0c88b02b5aa45aad2225dfcdd2dc", "https://git.kernel.org/stable/c/54a3201f3c1ff813523937da78b5fa7649dbab71", "https://git.kernel.org/stable/c/2bf916418d2141b810c40812433ab4ecfd3c2934", "https://git.kernel.org/stable/c/38245f2d62cd4d1f38a763a7b4045ab4565b30a0", "https://git.kernel.org/stable/c/f020d9570a04df0762a2ac5c50cf1d8c511c9164", "https://nvd.nist.gov/vuln/detail/CVE-2022-50880"], "aliases": ["CVE-2022-50880"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "007f5a33-cef9-3888-96b2-9166436e8c2b", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <15604ab67179ae27ea3c7fb24b6df32b143257c4"}, {"id": "0990afde-c62a-3a19-9c7e-f913c173fcd9", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <2d6259715c9597a6cfa25db8911683eb0073b1c6"}, {"id": "0cdb4a58-3350-35cd-ae97-5cb6e55ee95e", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <f12fc305c127bd07bb50373e29c6037696f916a8"}, {"id": "0e04c8a9-f039-3320-b814-c1cb30221345", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1243e42b-26f6-3425-92b3-a908b84faf02", "product": {"name": "Linux"}, "product_version": "patch: 4.9.331"}, {"id": "17950bbf-3765-35ee-bcb8-0f0662bb991a", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "1cdee403-e332-34f4-a50f-c98504b1193c", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <2bf916418d2141b810c40812433ab4ecfd3c2934"}, {"id": "1f8318c6-119f-3d0b-b537-d06c1216f7ba", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "4b6a0b95-807a-3833-9dfc-895cf4091755", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <38245f2d62cd4d1f38a763a7b4045ab4565b30a0"}, {"id": "5e4069ba-05f3-3740-8bd9-857498ceaf73", "product": {"name": "Linux"}, "product_version": "patch: 4.19.262"}, {"id": "67082904-65db-3eff-8c28-5c69ed43e84c", "product": {"name": "Linux"}, "product_version": "patch: 4.14.296"}, {"id": "7164a84c-212c-300a-b9da-8708e3a8ba03", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <08faf07717be0c88b02b5aa45aad2225dfcdd2dc"}, {"id": "7e028399-d6fa-3f8e-be6c-9cea44460767", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "80f40e3b-cf9b-32c8-8236-709db60588a3", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "836d53e4-88c5-35e4-a451-6f9469c5b4d2", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "9df159f8-c7ac-351b-b560-b31ccc2a698d", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <54a3201f3c1ff813523937da78b5fa7649dbab71"}, {"id": "9f6ed516-8fe7-34f7-97c5-f93f8ad217fe", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "ab06c857-39fa-3552-8ec0-c583155148ce", "product": {"name": "Linux"}, "product_version": "patch: 5.4.220"}, {"id": "afd99cc7-4994-3c8f-8354-c29f6c249496", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <4494ec1c0bb850eaa80fed98e5b041d961011d3e"}, {"id": "c7ba5561-6f75-30b4-a9ea-beab67dd6c9a", "product": {"name": "Linux"}, "product_version": "d0eeafad118940fe445ca00f45be5624fea2ec34 <f020d9570a04df0762a2ac5c50cf1d8c511c9164"}], "enisaIdVendor": [{"id": "81cd83d6-fcc3-3500-849e-0b31c86d200b", "vendor": {"name": "Linux"}}], "isExploited": false}