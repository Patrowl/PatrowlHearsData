{"id": "EUVD-2022-55329", "enisaUuid": "7cf088f2-a40d-32f3-aef7-e1ec4ec6328c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvdpa_sim_blk: set number of address spaces and virtqueue groups\n\nCommit bda324fd037a (\"vdpasim: control virtqueue support\") added two\nnew fields (nas, ngroups) to vdpasim_dev_attr, but we forgot to\ninitialize them for vdpa_sim_blk.\n\nWhen creating a new vdpa_sim_blk device this causes the kernel\nto panic in this way:\n \u00a0 \u00a0$ vdpa dev add mgmtdev vdpasim_blk name blk0\n \u00a0 \u00a0BUG: kernel NULL pointer dereference, address: 0000000000000030\n \u00a0 \u00a0...\n \u00a0 \u00a0RIP: 0010:vhost_iotlb_add_range_ctx+0x41/0x220 [vhost_iotlb]\n \u00a0 \u00a0...\n \u00a0 \u00a0Call Trace:\n \u00a0 \u00a0 <TASK>\n \u00a0 \u00a0 vhost_iotlb_add_range+0x11/0x800 [vhost_iotlb]\n \u00a0 \u00a0 vdpasim_map_range+0x91/0xd0 [vdpa_sim]\n \u00a0 \u00a0 vdpasim_alloc_coherent+0x56/0x90 [vdpa_sim]\n \u00a0 \u00a0 ...\n\nThis happens because vdpasim->iommu[0] is not initialized when\ndev_attr.nas is 0.\n\nLet's fix this issue by initializing both (nas, ngroups) to 1 for\nvdpa_sim_blk.", "datePublished": "2025-06-18T12:30:45", "dateUpdated": "2025-11-13T18:31:00", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/a291c7d289fac2cb13fb2614a9a251afbbd86ce9", "https://git.kernel.org/stable/c/19cd4a5471b8eaa4bd161b0fdb4567f2fc88d809", "https://nvd.nist.gov/vuln/detail/CVE-2022-50058"], "aliases": ["CVE-2022-50058"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "037166a2-3d49-3d7c-a189-45b693e1283b", "product": {"name": "Linux"}, "product_version": "5.19"}, {"id": "496819e8-d53a-395a-a11c-65f780926cde", "product": {"name": "Linux"}, "product_version": "bda324fd037a6b0d44da5699574ce741ca161bc4 <19cd4a5471b8eaa4bd161b0fdb4567f2fc88d809"}, {"id": "4b26adfe-b07d-3812-b1d5-6d92b9ad259d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.4"}, {"id": "8790c8ad-facd-34d9-9d67-c8577888f092", "product": {"name": "Linux"}, "product_version": "bda324fd037a6b0d44da5699574ce741ca161bc4 <a291c7d289fac2cb13fb2614a9a251afbbd86ce9"}, {"id": "c6d99f85-0bd4-3e93-b03a-4eba165e2444", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "deb19b26-400c-34a8-8e00-7706a9e84095", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "ed693e6d-f7bd-39e6-835a-15fe63490f5d", "vendor": {"name": "Linux"}}], "isExploited": false}