{"id": "EUVD-2022-55436", "enisaUuid": "6b7bafbe-180d-39db-b9a9-b549acf539d0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: hisilicon/sec - don't sleep when in softirq\n\nWhen kunpeng920 encryption driver is used to deencrypt and decrypt\npackets during the softirq, it is not allowed to use mutex lock. The\nkernel will report the following error:\n\nBUG: scheduling while atomic: swapper/57/0/0x00000300\nCall trace:\ndump_backtrace+0x0/0x1e4\nshow_stack+0x20/0x2c\ndump_stack+0xd8/0x140\n__schedule_bug+0x68/0x80\n__schedule+0x728/0x840\nschedule+0x50/0xe0\nschedule_preempt_disabled+0x18/0x24\n__mutex_lock.constprop.0+0x594/0x5dc\n__mutex_lock_slowpath+0x1c/0x30\nmutex_lock+0x50/0x60\nsec_request_init+0x8c/0x1a0 [hisi_sec2]\nsec_process+0x28/0x1ac [hisi_sec2]\nsec_skcipher_crypto+0xf4/0x1d4 [hisi_sec2]\nsec_skcipher_encrypt+0x1c/0x30 [hisi_sec2]\ncrypto_skcipher_encrypt+0x2c/0x40\ncrypto_authenc_encrypt+0xc8/0xfc [authenc]\ncrypto_aead_encrypt+0x2c/0x40\nechainiv_encrypt+0x144/0x1a0 [echainiv]\ncrypto_aead_encrypt+0x2c/0x40\nesp_output_tail+0x348/0x5c0 [esp4]\nesp_output+0x120/0x19c [esp4]\nxfrm_output_one+0x25c/0x4d4\nxfrm_output_resume+0x6c/0x1fc\nxfrm_output+0xac/0x3c0\nxfrm4_output+0x64/0x130\nip_build_and_send_pkt+0x158/0x20c\ntcp_v4_send_synack+0xdc/0x1f0\ntcp_conn_request+0x7d0/0x994\ntcp_v4_conn_request+0x58/0x6c\ntcp_v6_conn_request+0xf0/0x100\ntcp_rcv_state_process+0x1cc/0xd60\ntcp_v4_do_rcv+0x10c/0x250\ntcp_v4_rcv+0xfc4/0x10a4\nip_protocol_deliver_rcu+0xf4/0x200\nip_local_deliver_finish+0x58/0x70\nip_local_deliver+0x68/0x120\nip_sublist_rcv_finish+0x70/0x94\nip_list_rcv_finish.constprop.0+0x17c/0x1d0\nip_sublist_rcv+0x40/0xb0\nip_list_rcv+0x140/0x1dc\n__netif_receive_skb_list_core+0x154/0x28c\n__netif_receive_skb_list+0x120/0x1a0\nnetif_receive_skb_list_internal+0xe4/0x1f0\nnapi_complete_done+0x70/0x1f0\ngro_cell_poll+0x9c/0xb0\nnapi_poll+0xcc/0x264\nnet_rx_action+0xd4/0x21c\n__do_softirq+0x130/0x358\nirq_exit+0x11c/0x13c\n__handle_domain_irq+0x88/0xf0\ngic_handle_irq+0x78/0x2c0\nel1_irq+0xb8/0x140\narch_cpu_idle+0x18/0x40\ndefault_idle_call+0x5c/0x1c0\ncpuidle_idle_call+0x174/0x1b0\ndo_idle+0xc8/0x160\ncpu_startup_entry+0x30/0x11c\nsecondary_start_kernel+0x158/0x1e4\nsoftirq: huh, entered softirq 3 NET_RX 0000000093774ee4 with\npreempt_count 00000100, exited with fffffe00?", "datePublished": "2025-06-18T12:30:52", "dateUpdated": "2025-11-28T15:30:27", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/16e18a8ac7c9748cf35a8d2f0ba2c6e8850e7568", "https://git.kernel.org/stable/c/aa495dfe71229b9034b59d8072ff0b2325ddd5ee", "https://git.kernel.org/stable/c/4a461ba5b9753352f438824fdd915cba675b1733", "https://git.kernel.org/stable/c/c9be45e4c69fde36522274f04d1aa0d097ae3958", "https://git.kernel.org/stable/c/02884a4f12de11f54d4ca67a07dd1f111d96fdbd", "https://nvd.nist.gov/vuln/detail/CVE-2022-50171"], "aliases": ["CVE-2022-50171"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "024921c1-ef39-3900-819e-11b96eb5945e", "product": {"name": "Linux"}, "product_version": "416d82204df44ef727de6eafafeaa4d12fdc78dc <02884a4f12de11f54d4ca67a07dd1f111d96fdbd"}, {"id": "4c4df400-2972-3263-aac7-5987841cf0be", "product": {"name": "Linux"}, "product_version": "patch: 5.18.18"}, {"id": "4ef53e1c-b29f-3546-b60a-3aa6da06b152", "product": {"name": "Linux"}, "product_version": "5.5"}, {"id": "714b103b-4f27-3270-a625-608b0621b4fc", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "80056d8a-9f49-3774-a7ae-fa4bf6262109", "product": {"name": "Linux"}, "product_version": "416d82204df44ef727de6eafafeaa4d12fdc78dc <aa495dfe71229b9034b59d8072ff0b2325ddd5ee"}, {"id": "a117326f-6c3c-30b2-9da0-6b8efb6b62d6", "product": {"name": "Linux"}, "product_version": "416d82204df44ef727de6eafafeaa4d12fdc78dc <4a461ba5b9753352f438824fdd915cba675b1733"}, {"id": "aa98718b-d400-3423-9759-39d90315f992", "product": {"name": "Linux"}, "product_version": "patch: 6.0"}, {"id": "ad00c8aa-5f7c-3b59-8e96-639417b6abf8", "product": {"name": "Linux"}, "product_version": "416d82204df44ef727de6eafafeaa4d12fdc78dc <c9be45e4c69fde36522274f04d1aa0d097ae3958"}, {"id": "d61895f5-1f6d-3f56-a13d-c12173ab43fd", "product": {"name": "Linux"}, "product_version": "patch: 5.15.61"}, {"id": "e70d5658-301d-35d1-a93d-b8ee9722e2b3", "product": {"name": "Linux"}, "product_version": "patch: 5.10.137"}, {"id": "f5236ce0-3269-3bed-afdd-c59576d8046d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.2"}, {"id": "f61bf805-2874-3163-bc52-e5e8e4f9ca8b", "product": {"name": "Linux"}, "product_version": "416d82204df44ef727de6eafafeaa4d12fdc78dc <16e18a8ac7c9748cf35a8d2f0ba2c6e8850e7568"}], "enisaIdVendor": [{"id": "7ff31d32-4610-3153-b413-c250f9be7c59", "vendor": {"name": "Linux"}}], "isExploited": false}