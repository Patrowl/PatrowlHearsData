{"id": "EUVD-2022-54822", "enisaUuid": "d52357c9-8ba0-3dc8-8097-3d85e8edef45", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndlm: fix plock invalid read\n\nThis patch fixes an invalid read showed by KASAN. A unlock will allocate a\n\"struct plock_op\" and a followed send_op() will append it to a global\nsend_list data structure. In some cases a followed dev_read() moves it\nto recv_list and dev_write() will cast it to \"struct plock_xop\" and access\nfields which are only available in those structures. At this point an\ninvalid read happens by accessing those fields.\n\nTo fix this issue the \"callback\" field is moved to \"struct plock_op\" to\nindicate that a cast to \"plock_xop\" is allowed and does the additional\n\"plock_xop\" handling if set.\n\nExample of the KASAN output which showed the invalid read:\n\n[ 2064.296453] ==================================================================\n[ 2064.304852] BUG: KASAN: slab-out-of-bounds in dev_write+0x52b/0x5a0 [dlm]\n[ 2064.306491] Read of size 8 at addr ffff88800ef227d8 by task dlm_controld/7484\n[ 2064.308168]\n[ 2064.308575] CPU: 0 PID: 7484 Comm: dlm_controld Kdump: loaded Not tainted 5.14.0+ #9\n[ 2064.310292] Hardware name: Red Hat KVM, BIOS 0.5.1 01/01/2011\n[ 2064.311618] Call Trace:\n[ 2064.312218]  dump_stack_lvl+0x56/0x7b\n[ 2064.313150]  print_address_description.constprop.8+0x21/0x150\n[ 2064.314578]  ? dev_write+0x52b/0x5a0 [dlm]\n[ 2064.315610]  ? dev_write+0x52b/0x5a0 [dlm]\n[ 2064.316595]  kasan_report.cold.14+0x7f/0x11b\n[ 2064.317674]  ? dev_write+0x52b/0x5a0 [dlm]\n[ 2064.318687]  dev_write+0x52b/0x5a0 [dlm]\n[ 2064.319629]  ? dev_read+0x4a0/0x4a0 [dlm]\n[ 2064.320713]  ? bpf_lsm_kernfs_init_security+0x10/0x10\n[ 2064.321926]  vfs_write+0x17e/0x930\n[ 2064.322769]  ? __fget_light+0x1aa/0x220\n[ 2064.323753]  ksys_write+0xf1/0x1c0\n[ 2064.324548]  ? __ia32_sys_read+0xb0/0xb0\n[ 2064.325464]  do_syscall_64+0x3a/0x80\n[ 2064.326387]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n[ 2064.327606] RIP: 0033:0x7f807e4ba96f\n[ 2064.328470] Code: 89 54 24 18 48 89 74 24 10 89 7c 24 08 e8 39 87 f8 ff 48 8b 54 24 18 48 8b 74 24 10 41 89 c0 8b 7c 24 08 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 31 44 89 c7 48 89 44 24 08 e8 7c 87 f8 ff 48\n[ 2064.332902] RSP: 002b:00007ffd50cfe6e0 EFLAGS: 00000293 ORIG_RAX: 0000000000000001\n[ 2064.334658] RAX: ffffffffffffffda RBX: 000055cc3886eb30 RCX: 00007f807e4ba96f\n[ 2064.336275] RDX: 0000000000000040 RSI: 00007ffd50cfe7e0 RDI: 0000000000000010\n[ 2064.337980] RBP: 00007ffd50cfe7e0 R08: 0000000000000000 R09: 0000000000000001\n[ 2064.339560] R10: 000055cc3886eb30 R11: 0000000000000293 R12: 000055cc3886eb80\n[ 2064.341237] R13: 000055cc3886eb00 R14: 000055cc3886f590 R15: 0000000000000001\n[ 2064.342857]\n[ 2064.343226] Allocated by task 12438:\n[ 2064.344057]  kasan_save_stack+0x1c/0x40\n[ 2064.345079]  __kasan_kmalloc+0x84/0xa0\n[ 2064.345933]  kmem_cache_alloc_trace+0x13b/0x220\n[ 2064.346953]  dlm_posix_unlock+0xec/0x720 [dlm]\n[ 2064.348811]  do_lock_file_wait.part.32+0xca/0x1d0\n[ 2064.351070]  fcntl_setlk+0x281/0xbc0\n[ 2064.352879]  do_fcntl+0x5e4/0xfe0\n[ 2064.354657]  __x64_sys_fcntl+0x11f/0x170\n[ 2064.356550]  do_syscall_64+0x3a/0x80\n[ 2064.358259]  entry_SYSCALL_64_after_hwframe+0x44/0xae\n[ 2064.360745]\n[ 2064.361511] Last potentially related work creation:\n[ 2064.363957]  kasan_save_stack+0x1c/0x40\n[ 2064.365811]  __kasan_record_aux_stack+0xaf/0xc0\n[ 2064.368100]  call_rcu+0x11b/0xf70\n[ 2064.369785]  dlm_process_incoming_buffer+0x47d/0xfd0 [dlm]\n[ 2064.372404]  receive_from_sock+0x290/0x770 [dlm]\n[ 2064.374607]  process_recv_sockets+0x32/0x40 [dlm]\n[ 2064.377290]  process_one_work+0x9a8/0x16e0\n[ 2064.379357]  worker_thread+0x87/0xbf0\n[ 2064.381188]  kthread+0x3ac/0x490\n[ 2064.383460]  ret_from_fork+0x22/0x30\n[ 2064.385588]\n[ 2064.386518] Second to last potentially related work creation:\n[ 2064.389219]  kasan_save_stack+0x1c/0x40\n[ 2064.391043]  __kasan_record_aux_stack+0xaf/0xc0\n[ 2064.393303]  call_rcu+0x11b/0xf70\n[ 2064.394885]  dlm_process_incoming_buffer+0x47d/0xfd0 [dlm]\n[ 2064.397694]  receive_from_sock+0x290/0x770 \n---truncated---", "datePublished": "2025-09-22T21:30:17", "dateUpdated": "2025-09-22T21:30:17", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/2c55155cc365861044d9e6e80e342693e8805e33", "https://git.kernel.org/stable/c/72f2f68970f9bdc252d59e119b385a6441b0b155", "https://git.kernel.org/stable/c/5a1765adf9855cf0f6d3f7e0eb4b78ca66f70dee", "https://git.kernel.org/stable/c/49cd9eb7b9a7b88124b31e31f8e539acaf1b3a6d", "https://git.kernel.org/stable/c/899bc4429174861122f0c236588700a4710c1fec", "https://git.kernel.org/stable/c/acdad5bc9827922ec2f2e84fd198718aa8e8ab92", "https://git.kernel.org/stable/c/56aa8d1fbd02357f3bf81bdfba1cde87ce8402fc", "https://git.kernel.org/stable/c/e421872fa17542cf33747071fb141b0130ce9ef7", "https://git.kernel.org/stable/c/42252d0d2aa9b94d168241710a761588b3959019", "https://nvd.nist.gov/vuln/detail/CVE-2022-49407"], "aliases": ["CVE-2022-49407"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "01b58828-2507-34ab-bdf2-8398b60e71e9", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <49cd9eb7b9a7b88124b31e31f8e539acaf1b3a6d"}, {"id": "04442785-a1f8-3e19-b8d7-92db9750b696", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <56aa8d1fbd02357f3bf81bdfba1cde87ce8402fc"}, {"id": "159fe2af-3f91-3c75-9669-aa3af3bce343", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <2c55155cc365861044d9e6e80e342693e8805e33"}, {"id": "20f3da6d-7572-3ba2-b90a-94120fbb1715", "product": {"name": "Linux"}, "product_version": "patch: 5.15.46"}, {"id": "30d62ca8-d9f4-3ba9-a5aa-0ac4581b85b9", "product": {"name": "Linux"}, "product_version": "patch: 5.10.121"}, {"id": "322ba513-b7f3-393a-b74b-16984fc5f6b4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "324374c7-3501-3ac5-aba5-889967ae4185", "product": {"name": "Linux"}, "product_version": "patch: 4.19.247"}, {"id": "36638226-f2dc-3e5d-b318-cb18f8287bd9", "product": {"name": "Linux"}, "product_version": "patch: 5.18.3"}, {"id": "3a182d6e-057a-3c90-bcd3-30924bd40243", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <72f2f68970f9bdc252d59e119b385a6441b0b155"}, {"id": "66d3c075-49bf-3eea-acea-990a5a1c6eb4", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <acdad5bc9827922ec2f2e84fd198718aa8e8ab92"}, {"id": "69f259fb-b18d-3b13-84e1-43fcece4e971", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <42252d0d2aa9b94d168241710a761588b3959019"}, {"id": "74994d0f-60e1-3b60-a9c7-db26f76ceb3a", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <5a1765adf9855cf0f6d3f7e0eb4b78ca66f70dee"}, {"id": "906a92e1-1138-38ec-8cb2-753baed66a63", "product": {"name": "Linux"}, "product_version": "patch: 4.9.318"}, {"id": "9d82a771-a771-30f6-860b-61d0904b9a86", "product": {"name": "Linux"}, "product_version": "patch: 5.4.198"}, {"id": "9e2e42bf-71c4-3ef6-b82a-d6737c304ba4", "product": {"name": "Linux"}, "product_version": "patch: 5.17.14"}, {"id": "a201774e-4683-325a-bd8b-350a0b08ae7b", "product": {"name": "Linux"}, "product_version": "2.6.22"}, {"id": "c205269f-e5f7-37da-b9b4-8b2ea9948d94", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <e421872fa17542cf33747071fb141b0130ce9ef7"}, {"id": "c88d9957-7d9f-300d-9d93-7dd2a507b26b", "product": {"name": "Linux"}, "product_version": "586759f03e2e9031ac5589912a51a909ed53c30a <899bc4429174861122f0c236588700a4710c1fec"}, {"id": "dd32e6c3-fdf4-3421-ad89-136a0aa348ee", "product": {"name": "Linux"}, "product_version": "patch: 5.19"}, {"id": "fd7623d8-ee77-382e-ab6b-05821a6965b7", "product": {"name": "Linux"}, "product_version": "patch: 4.14.283"}], "enisaIdVendor": [{"id": "7d856507-c65c-3239-9299-4ee2b675254e", "vendor": {"name": "Linux"}}], "isExploited": false}