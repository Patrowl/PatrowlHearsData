{"id": "EUVD-2022-55031", "enisaUuid": "ec5faac3-54a6-3b32-be1c-600c9ee6853a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: dsa: fix panic on shutdown if multi-chip tree failed to probe\n\nDSA probing is atypical because a tree of devices must probe all at\nonce, so out of N switches which call dsa_tree_setup_routing_table()\nduring probe, for (N - 1) of them, \"complete\" will return false and they\nwill exit probing early. The Nth switch will set up the whole tree on\ntheir behalf.\n\nThe implication is that for (N - 1) switches, the driver binds to the\ndevice successfully, without doing anything. When the driver is bound,\nthe ->shutdown() method may run. But if the Nth switch has failed to\ninitialize the tree, there is nothing to do for the (N - 1) driver\ninstances, since the slave devices have not been created, etc. Moreover,\ndsa_switch_shutdown() expects that the calling @ds has been in fact\ninitialized, so it jumps at dereferencing the various data structures,\nwhich is incorrect.\n\nAvoid the ensuing NULL pointer dereferences by simply checking whether\nthe Nth switch has previously set \"ds->setup = true\" for the switch\nwhich is currently shutting down. The entire setup is serialized under\ndsa2_mutex which we already hold.", "datePublished": "2025-09-23T15:31:08", "dateUpdated": "2025-09-23T15:31:08", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/95df5cd5a446df6738d2d45872e08594819080e4", "https://git.kernel.org/stable/c/b6e668ff43ebd87ccc8a19e5481345c428672295", "https://git.kernel.org/stable/c/b864d5350c18bea9369d0bdd9e7eb6f6172cc283", "https://git.kernel.org/stable/c/8fd36358ce82382519b50b05f437493e1e00c4a9", "https://nvd.nist.gov/vuln/detail/CVE-2022-49195"], "aliases": ["CVE-2022-49195"], "assigner": "Linux", "epss": 0.07, "enisaIdProduct": [{"id": "1f76ddac-6381-3306-b95b-b89bef3ee473", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "28a54638-9670-327c-aab4-1a312ed824e6", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "3c09f4bb-f911-3d48-9571-56b962a759e3", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "3e9dc057-e08f-3b55-a04c-c54a82aa37a8", "product": {"name": "Linux"}, "product_version": "0650bf52b31ff35dc6430fc2e37969c36baba724 <b6e668ff43ebd87ccc8a19e5481345c428672295"}, {"id": "4f622ef0-2d71-37c2-8d1e-f57d482901b3", "product": {"name": "Linux"}, "product_version": "0650bf52b31ff35dc6430fc2e37969c36baba724 <95df5cd5a446df6738d2d45872e08594819080e4"}, {"id": "5e28faad-755a-3f2a-9113-e1606be2d2f3", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "8a5e6df4-8aed-3142-abbe-57b774eb3cdc", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "9e28e820-2a9c-3140-a68c-f3d956c9938d", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}, {"id": "bc9a8855-f9a8-36c7-9df2-37587ae404d6", "product": {"name": "Linux"}, "product_version": "0650bf52b31ff35dc6430fc2e37969c36baba724 <b864d5350c18bea9369d0bdd9e7eb6f6172cc283"}, {"id": "d5321ee7-8847-3cdc-90ee-874895d27baf", "product": {"name": "Linux"}, "product_version": "0650bf52b31ff35dc6430fc2e37969c36baba724 <8fd36358ce82382519b50b05f437493e1e00c4a9"}], "enisaIdVendor": [{"id": "1919255e-eb6e-36b4-9b5b-2f2a4f79f0b1", "vendor": {"name": "Linux"}}], "isExploited": false}