{"id": "EUVD-2022-53610", "enisaUuid": "4d10c6a1-59c1-3937-bacf-5020b2ac12c6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/kmemleak: avoid scanning potential huge holes\n\nWhen using devm_request_free_mem_region() and devm_memremap_pages() to\nadd ZONE_DEVICE memory, if requested free mem region's end pfn were\nhuge(e.g., 0x400000000), the node_end_pfn() will be also huge (see\nmove_pfn_range_to_zone()).  Thus it creates a huge hole between\nnode_start_pfn() and node_end_pfn().\n\nWe found on some AMD APUs, amdkfd requested such a free mem region and\ncreated a huge hole.  In such a case, following code snippet was just\ndoing busy test_bit() looping on the huge hole.\n\n  for (pfn = start_pfn; pfn < end_pfn; pfn++) {\n\tstruct page *page = pfn_to_online_page(pfn);\n\t\tif (!page)\n\t\t\tcontinue;\n\t...\n  }\n\nSo we got a soft lockup:\n\n  watchdog: BUG: soft lockup - CPU#6 stuck for 26s! [bash:1221]\n  CPU: 6 PID: 1221 Comm: bash Not tainted 5.15.0-custom #1\n  RIP: 0010:pfn_to_online_page+0x5/0xd0\n  Call Trace:\n    ? kmemleak_scan+0x16a/0x440\n    kmemleak_write+0x306/0x3a0\n    ? common_file_perm+0x72/0x170\n    full_proxy_write+0x5c/0x90\n    vfs_write+0xb9/0x260\n    ksys_write+0x67/0xe0\n    __x64_sys_write+0x1a/0x20\n    do_syscall_64+0x3b/0xc0\n    entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nI did some tests with the patch.\n\n(1) amdgpu module unloaded\n\nbefore the patch:\n\n  real    0m0.976s\n  user    0m0.000s\n  sys     0m0.968s\n\nafter the patch:\n\n  real    0m0.981s\n  user    0m0.000s\n  sys     0m0.973s\n\n(2) amdgpu module loaded\n\nbefore the patch:\n\n  real    0m35.365s\n  user    0m0.000s\n  sys     0m35.354s\n\nafter the patch:\n\n  real    0m1.049s\n  user    0m0.000s\n  sys     0m1.042s", "datePublished": "2024-06-20T11:13:19", "dateUpdated": "2025-12-23T13:20:06", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/d3533ee20e9a0e2e8f60384da7450d43d1c63d1a", "https://git.kernel.org/stable/c/352715593e81b917ce1b321e794549815b850134", "https://git.kernel.org/stable/c/a5389c80992f0001ee505838fe6a8b20897ce96e", "https://git.kernel.org/stable/c/cebb0aceb21ad91429617a40e3a17444fabf1529", "https://git.kernel.org/stable/c/c10a0f877fe007021d70f9cada240f42adc2b5db"], "aliases": ["CVE-2022-48731"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "03b82ce4-5c03-3f6c-8333-58ac20bb1f86", "product": {"name": "Linux"}, "product_version": "patch: 5.16.8"}, {"id": "18010040-2991-35df-b51b-f219398657a9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cebb0aceb21ad91429617a40e3a17444fabf1529"}, {"id": "1e627efa-b6da-38a2-bed2-5f2655e9ae12", "product": {"name": "Linux"}, "product_version": "patch: 5.4.178"}, {"id": "24624fe2-1920-3cc0-b8b0-b78bcb77a307", "product": {"name": "Linux"}, "product_version": "4ef589dc9b10cdcae75a2b2b0e9b2c5e8a92c378 <cebb0aceb21ad91429617a40e3a17444fabf1529"}, {"id": "2d4d35e7-a6db-3bc9-ba9f-acda82f6c935", "product": {"name": "Linux"}, "product_version": "4ef589dc9b10cdcae75a2b2b0e9b2c5e8a92c378 <c10a0f877fe007021d70f9cada240f42adc2b5db"}, {"id": "594b8b08-1a54-380b-b7c6-398a4ec70102", "product": {"name": "Linux"}, "product_version": "patch: 5.17"}, {"id": "5d51e6f6-8bc4-3d25-80e5-d3181e8d8433", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d3533ee20e9a0e2e8f60384da7450d43d1c63d1a"}, {"id": "5dcbb608-6cc0-3907-85e8-e2f72e919b16", "product": {"name": "Linux"}, "product_version": "patch: 5.10.99"}, {"id": "66fd29af-339b-3fb9-a749-85ed5a7d10e7", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "6baede8c-d848-34fb-a482-865d0613b7d2", "product": {"name": "Linux"}, "product_version": "4ef589dc9b10cdcae75a2b2b0e9b2c5e8a92c378 <352715593e81b917ce1b321e794549815b850134"}, {"id": "7261b39b-3310-3068-b477-3e967b88feb8", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a5389c80992f0001ee505838fe6a8b20897ce96e"}, {"id": "79f33b51-2e5c-3248-9c9e-7af8168f7075", "product": {"name": "Linux"}, "product_version": "4ef589dc9b10cdcae75a2b2b0e9b2c5e8a92c378 <a5389c80992f0001ee505838fe6a8b20897ce96e"}, {"id": "ac2e6c64-0711-3bc7-8a58-3ceeed102f6f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.22"}, {"id": "b0e709cc-4c19-3319-9f21-149dc45659b6", "product": {"name": "Linux"}, "product_version": "4.14"}, {"id": "cd89cfcf-06c8-3465-956f-286d7ab7ec7e", "product": {"name": "Linux"}, "product_version": "4ef589dc9b10cdcae75a2b2b0e9b2c5e8a92c378 <d3533ee20e9a0e2e8f60384da7450d43d1c63d1a"}, {"id": "ef93a64d-c82e-3993-a48d-78a025f6ca03", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c10a0f877fe007021d70f9cada240f42adc2b5db"}, {"id": "f7f6f275-6d24-3786-9e75-b1a28d846697", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <352715593e81b917ce1b321e794549815b850134"}], "enisaIdVendor": [{"id": "b41b3855-bb34-30eb-823c-94d63aa37ec2", "vendor": {"name": "Linux"}}], "isExploited": false}