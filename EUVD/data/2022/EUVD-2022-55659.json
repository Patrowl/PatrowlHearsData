{"id": "EUVD-2022-55659", "enisaUuid": "2d38d8bd-5d3c-38f4-a97a-a0346e27328a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nxfrm: Update ipcomp_scratches with NULL when freed\n\nCurrently if ipcomp_alloc_scratches() fails to allocate memory\nipcomp_scratches holds obsolete address. So when we try to free the\npercpu scratches using ipcomp_free_scratches() it tries to vfree non\nexistent vm area. Described below:\n\nstatic void * __percpu *ipcomp_alloc_scratches(void)\n{\n        ...\n        scratches = alloc_percpu(void *);\n        if (!scratches)\n                return NULL;\nipcomp_scratches does not know about this allocation failure.\nTherefore holding the old obsolete address.\n        ...\n}\n\nSo when we free,\n\nstatic void ipcomp_free_scratches(void)\n{\n        ...\n        scratches = ipcomp_scratches;\nAssigning obsolete address from ipcomp_scratches\n\n        if (!scratches)\n                return;\n\n        for_each_possible_cpu(i)\n               vfree(*per_cpu_ptr(scratches, i));\nTrying to free non existent page, causing warning: trying to vfree\nexistent vm area.\n        ...\n}\n\nFix this breakage by updating ipcomp_scrtches with NULL when scratches\nis freed", "datePublished": "2025-10-22T13:23:25", "dateUpdated": "2025-12-23T13:30:04", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/debca61df6bc2f65e020656c9c5b878d6b38d30f", "https://git.kernel.org/stable/c/a39f456d62810c0efb43cead22f98d95b53e4b1a", "https://git.kernel.org/stable/c/1e8abde895b3ac6a368cbdb372e8800c49e73a28", "https://git.kernel.org/stable/c/18373ed500f7cd53e24d9b0bd0f1c09d78dba87e", "https://git.kernel.org/stable/c/be81c44242b20fc3bdcc73480ef8aaee56f5d0b6", "https://git.kernel.org/stable/c/03155680191ef0f004b1d6a5714c5b8cd271ab61", "https://git.kernel.org/stable/c/f3bdba4440d82e0da2b1bfc35d3836c8a8e00677", "https://git.kernel.org/stable/c/2c19945ce8095d065df550e7fe350cd5cc40c6e6", "https://git.kernel.org/stable/c/8a04d2fc700f717104bfb95b0f6694e448a4537f", "https://nvd.nist.gov/vuln/detail/CVE-2022-50569"], "aliases": ["CVE-2022-50569"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "042acaa0-592b-33f3-b3ce-0f0a9915aac7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <03155680191ef0f004b1d6a5714c5b8cd271ab61"}, {"id": "376f08a2-a5b1-3bae-a5bc-ca47c61cf361", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1e8abde895b3ac6a368cbdb372e8800c49e73a28"}, {"id": "3d8c4c8f-fcd0-33b0-a1b9-faf903acd628", "product": {"name": "Linux"}, "product_version": "2.6.12"}, {"id": "45779d55-ad5b-3edb-bc5d-13f8472ce8d7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.220"}, {"id": "45b84768-717b-37d6-8d5e-f4d4a0f7d779", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f3bdba4440d82e0da2b1bfc35d3836c8a8e00677"}, {"id": "5980e7ed-cbb7-3096-9532-0168cde31568", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5add31fd-e237-3725-bb01-1f2586010019", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a39f456d62810c0efb43cead22f98d95b53e4b1a"}, {"id": "5ef3a91e-5ec1-3b24-b9f6-33d7cd18434d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <debca61df6bc2f65e020656c9c5b878d6b38d30f"}, {"id": "74004838-dedb-3927-8f4d-05dbd4f69925", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "76868d3c-e5a1-3f8a-adfd-fb65ca417f04", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "79a717be-0003-3df3-8edb-a9c068638567", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "a24da921-d1e8-3697-9956-9c5393eac9d6", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "ab8757dc-7b45-3363-94eb-57167a66a33d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "b392b6c5-4efb-3888-92fb-b26d54ce490e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <18373ed500f7cd53e24d9b0bd0f1c09d78dba87e"}, {"id": "b93cfd38-cba2-3791-bdb4-a5fb814a7e02", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <be81c44242b20fc3bdcc73480ef8aaee56f5d0b6"}, {"id": "c8941b40-abbe-3198-bd21-c5f5f8d1b856", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2c19945ce8095d065df550e7fe350cd5cc40c6e6"}, {"id": "daa543a6-ffa5-362f-8588-9256caee52cf", "product": {"name": "Linux"}, "product_version": "patch: 4.19.262"}, {"id": "dc26d387-68b6-3164-94ce-bb8e2dbf16ef", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8a04d2fc700f717104bfb95b0f6694e448a4537f"}, {"id": "dd9abc97-b750-38e4-b524-c6583a6211c9", "product": {"name": "Linux"}, "product_version": "patch: 4.14.296"}, {"id": "e83f8366-5b19-31d2-9365-f295cbfdf6e9", "product": {"name": "Linux"}, "product_version": "patch: 4.9.331"}], "enisaIdVendor": [{"id": "010753d8-499e-3d9f-a5b2-4522194dd1f9", "vendor": {"name": "Linux"}}], "isExploited": false}