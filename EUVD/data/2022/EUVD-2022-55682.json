{"id": "EUVD-2022-55682", "enisaUuid": "cd51837a-f88e-3d88-a4f3-303c651c1f9e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: hugetlb: fix UAF in hugetlb_handle_userfault\n\nThe vma_lock and hugetlb_fault_mutex are dropped before handling userfault\nand reacquire them again after handle_userfault(), but reacquire the\nvma_lock could lead to UAF[1,2] due to the following race,\n\nhugetlb_fault\n  hugetlb_no_page\n    /*unlock vma_lock */\n    hugetlb_handle_userfault\n      handle_userfault\n        /* unlock mm->mmap_lock*/\n                                           vm_mmap_pgoff\n                                             do_mmap\n                                               mmap_region\n                                                 munmap_vma_range\n                                                   /* clean old vma */\n        /* lock vma_lock again  <--- UAF */\n    /* unlock vma_lock */\n\nSince the vma_lock will unlock immediately after\nhugetlb_handle_userfault(), let's drop the unneeded lock and unlock in\nhugetlb_handle_userfault() to fix the issue.\n\n[1] https://lore.kernel.org/linux-mm/000000000000d5e00a05e834962e@google.com/\n[2] https://lore.kernel.org/linux-mm/20220921014457.1668-1-liuzixian4@huawei.com/", "datePublished": "2025-12-08T03:31:03", "dateUpdated": "2025-12-08T03:31:03", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/45c33966759ea1b4040c08dacda99ef623c0ca29", "https://git.kernel.org/stable/c/0db2efb3bff879566f05341d94c3de00ac95c4cc", "https://git.kernel.org/stable/c/dd691973f67b2800a97db723b1ff6f07fdcf7f5a", "https://git.kernel.org/stable/c/78504bcedb2f1bbfb353b4d233c24d641c4dda33", "https://git.kernel.org/stable/c/958f32ce832ba781ac20e11bb2d12a9352ea28fc", "https://nvd.nist.gov/vuln/detail/CVE-2022-50630"], "aliases": ["CVE-2022-50630"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0e4b9f60-75e5-3cee-a4f6-963ecabeef69", "product": {"name": "Linux"}, "product_version": "1a1aad8a9b7bd34f60cdf98cd7915f00ae892c45 <45c33966759ea1b4040c08dacda99ef623c0ca29"}, {"id": "309ac14e-59d5-312f-9acc-85105c1bc96d", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "3e3ccebc-ff17-3bb7-bb3a-04b1ec48a1ac", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "4afd5673-5557-358e-878c-0c9a036c2391", "product": {"name": "Linux"}, "product_version": "1a1aad8a9b7bd34f60cdf98cd7915f00ae892c45 <78504bcedb2f1bbfb353b4d233c24d641c4dda33"}, {"id": "571b64d8-7152-3179-b6aa-787c2f1541b0", "product": {"name": "Linux"}, "product_version": "1a1aad8a9b7bd34f60cdf98cd7915f00ae892c45 <0db2efb3bff879566f05341d94c3de00ac95c4cc"}, {"id": "7a069675-747d-358b-b07c-5c6036e7d622", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "c7bda491-2e47-31e4-a269-07fbaa46db0f", "product": {"name": "Linux"}, "product_version": "1a1aad8a9b7bd34f60cdf98cd7915f00ae892c45 <958f32ce832ba781ac20e11bb2d12a9352ea28fc"}, {"id": "c9aa68d7-601f-3194-8fdc-92103eea55d6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "dc3ffdc2-dcd9-3ac4-8076-b724c87ddb7c", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "ec7a10b8-3d80-3375-a2bd-ce636da832b4", "product": {"name": "Linux"}, "product_version": "1a1aad8a9b7bd34f60cdf98cd7915f00ae892c45 <dd691973f67b2800a97db723b1ff6f07fdcf7f5a"}, {"id": "fa57f254-a741-3e61-9c95-adeae70d26bb", "product": {"name": "Linux"}, "product_version": "4.11"}, {"id": "fdec7711-121e-3f27-aae2-2fbe2699ebac", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}], "enisaIdVendor": [{"id": "6cecaaa2-1870-3152-8689-b2a203e91541", "vendor": {"name": "Linux"}}], "isExploited": false}