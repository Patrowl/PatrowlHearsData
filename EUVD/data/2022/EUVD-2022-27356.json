{"id": "EUVD-2022-27356", "enisaUuid": "ecaf0dbc-f11f-3a7a-9ee9-736f5ffb32d8", "description": "A Missing Release of Memory after Effective Lifetime vulnerability in the kernel of Juniper Networks Junos OS allows an unauthenticated network based attacker to cause a Denial of Service (DoS). On all Junos platforms, the Kernel Routing Table (KRT) queue can get stuck due to a memory leak triggered by interface flaps or route churn leading to RIB and PFEs getting out of sync. The memory leak causes RTNEXTHOP/route and next-hop memory pressure issue and the KRT queue will eventually get stuck with the error- 'ENOMEM -- Cannot allocate memory'. The out-of-sync state between RIB and FIB can be seen with the \"show route\" and \"show route forwarding-table\" command. This issue will lead to failures for adding new routes. The KRT queue status can be checked using the CLI command \"show krt queue\": user@host > show krt state High-priority add queue: 1 queued ADD nhtype Router index 0 (31212) error 'ENOMEM -- Cannot allocate memory' kqp '0x8ad5e40' The following messages will be observed in /var/log/messages, which indicate high memory for routes/nexthops: host rpd[16279]: RPD_RT_HWM_NOTICE: New RIB highwatermark for routes: 266 [2022-03-04 05:06:07] host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: Cannot allocate memory host rpd[16279]: RPD_KRT_Q_RETRIES: nexthop ADD: Cannot allocate memory host kernel: rts_veto_net_delayed_unref_limit: Route/nexthop memory is severe pressure. User Application to perform recovery actions. O p 8 err 12, rtsm_id 0:-1, msg type 10, veto simulation: 0. host kernel: rts_veto_net_delayed_unref_limit: Memory usage of M_RTNEXTHOP type = (806321208) Max size possible for M_RTNEXTHOP type = (689432176) Current delayed unref = (0), Max delayed unref on this platform = (120000) Current delayed weight unref = (0) Max delayed weight unref on this platform = (400000) curproc = rpd. This issue affects: Juniper Networks Junos OS 21.2 versions prior to 21.2R3; 21.3 versions prior to 21.3R2-S1, 21.3R3; 21.4 versions prior to 21.4R1-S2, 21.4R2; This issue does not affect Juniper Networks Junos OS versions prior to 21.2R1.", "datePublished": "2022-07-20T14:14:38", "dateUpdated": "2024-09-17T00:10:57", "baseScore": 7.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA69713"], "aliases": ["CVE-2022-22209"], "assigner": "juniper", "epss": 1.45, "enisaIdProduct": [{"id": "c90cf876-e5cd-3c10-b8b1-b83cfa12029b", "product": {"name": "Junos OS"}, "product_version": "21.2 <21.2R3"}, {"id": "ccdb9709-6bfe-3db4-a778-ed8d74e5b412", "product": {"name": "Junos OS"}, "product_version": "21.4 <21.4R1-S2, 21.4R2"}, {"id": "e5845082-a367-3ee5-85a1-fff22a248970", "product": {"name": "Junos OS"}, "product_version": "21.3 <21.3R2-S1, 21.3R3"}], "enisaIdVendor": [{"id": "7d02cc9f-889b-37a7-b09e-fb73b4008549", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}