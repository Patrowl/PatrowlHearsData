{"id": "EUVD-2020-12525", "enisaUuid": "7f13f2a9-1892-3f92-93af-3e4a83e5805a", "description": "On Juniper Networks Junos OS and Junos OS Evolved devices, BGP session flapping can lead to a routing process daemon (RPD) crash and restart, limiting the attack surface to configured BGP peers. This issue only affects devices with BGP damping in combination with accepted-prefix-limit configuration. When the issue occurs the following messages will appear in the /var/log/messages: rpd[6046]: %DAEMON-4-BGP_PREFIX_THRESH_EXCEEDED: XXXX (External AS x): Configured maximum accepted prefix-limit threshold(1800) exceeded for inet6-unicast nlri: 1984 (instance master) rpd[6046]: %DAEMON-3-BGP_CEASE_PREFIX_LIMIT_EXCEEDED: 2001:x:x:x::2 (External AS x): Shutting down peer due to exceeding configured maximum accepted prefix-limit(2000) for inet6-unicast nlri: 2001 (instance master) rpd[6046]: %DAEMON-4: bgp_rt_maxprefixes_check_common:9284: NOTIFICATION sent to 2001:x:x:x::2 (External AS x): code 6 (Cease) subcode 1 (Maximum Number of Prefixes Reached) AFI: 2 SAFI: 1 prefix limit 2000 kernel: %KERN-5: mastership_relinquish_on_process_exit: RPD crashed on master RE. Sending SIGUSR2 to chassisd (5612:chassisd) to trigger RE switchover This issue affects: Juniper Networks Junos OS: 17.2R3-S3; 17.3 version 17.3R3-S3 and later versions, prior to 17.3R3-S8; 17.4 version 17.4R2-S4, 17.4R3 and later versions, prior to 17.4R2-S10, 17.4R3-S2; 18.1 version 18.1R3-S6 and later versions, prior to 18.1R3-S10; 18.2 version 18.2R3 and later versions, prior to 18.2R3-S4; 18.2X75 version 18.2X75-D50, 18.2X75-D60 and later versions, prior to 18.2X75-D53, 18.2X75-D65; 18.3 version 18.3R2 and later versions, prior to 18.3R2-S4, 18.3R3-S2; 18.4 version 18.4R2 and later versions, prior to 18.4R2-S5, 18.4R3-S2; 19.1 version 19.1R1 and later versions, prior to 19.1R2-S2, 19.1R3-S1; 19.2 version 19.2R1 and later versions, prior to 19.2R1-S5, 19.2R2; 19.3 versions prior to 19.3R2-S3, 19.3R3; 19.4 versions prior to 19.4R1-S3, 19.4R2; 20.1 versions prior to 20.1R1-S2, 20.1R2. Juniper Networks Junos OS Evolved prior to 20.1R2-EVO. This issue does not affect Juniper Networks Junos OS versions prior to 17.2R3-S3.", "datePublished": "2020-10-16T20:31:26", "dateUpdated": "2024-09-16T19:04:48", "baseScore": 7.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA11059"], "aliases": ["CVE-2020-1662"], "assigner": "juniper", "epss": 0.39, "enisaIdProduct": [{"id": "041f6f06-fde2-389b-80d7-1b6895f2c72a", "product": {"name": "Junos OS"}, "product_version": "18.2X75-D50, 18.2X75-D60 <18.2X75*"}, {"id": "06b65529-b03e-3514-ac75-1245846f4303", "product": {"name": "Junos OS"}, "product_version": "17.4R2-S4, 17.4R3 <17.4*"}, {"id": "17d53885-6a40-3e1f-a967-76c20dcf0757", "product": {"name": "Junos OS"}, "product_version": "17.2R3-S3"}, {"id": "2897f001-447f-3c21-a156-eb84d518796f", "product": {"name": "Junos OS"}, "product_version": "17.3R3-S3 <17.3*"}, {"id": "312b4b20-662b-3448-ac7c-5bebe8541ff1", "product": {"name": "Junos OS"}, "product_version": "18.3R2 <18.3*"}, {"id": "67cc13a8-1959-3cec-abc6-d23e4dd37e59", "product": {"name": "Junos OS Evolved"}, "product_version": "19.4-EVO"}, {"id": "76fda0cb-f0b6-32c0-8915-79885ff3d64c", "product": {"name": "Junos OS"}, "product_version": "19.1R1 <19.1*"}, {"id": "8fd00250-8e4c-3597-a18b-186ec9b8786e", "product": {"name": "Junos OS"}, "product_version": "18.4R2 <18.4*"}, {"id": "a185ccf5-65bd-3e22-90f5-1600c70b31a2", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R2-S3, 19.3R3"}, {"id": "aeeabb9a-9b75-3c27-8469-5b6fd03b2082", "product": {"name": "Junos OS"}, "product_version": "19.4 <19.4R1-S3, 19.4R2"}, {"id": "b344b7d3-8136-38df-ae44-336c01e8ebd8", "product": {"name": "Junos OS"}, "product_version": "18.1R3-S6 <18.1*"}, {"id": "b3bb2f4f-f693-354e-9612-8aa11eb4927d", "product": {"name": "Junos OS"}, "product_version": "20.1 <20.1R1-S2, 20.1R2"}, {"id": "c3ee27fd-5987-3e2d-b6ed-d1cf106ea64d", "product": {"name": "Junos OS Evolved"}, "product_version": "20.1-EVO <20.1R2-EVO"}, {"id": "ed05eed8-85b1-341d-8c5a-32b755f5b621", "product": {"name": "Junos OS"}, "product_version": "18.2R3 <18.2*"}, {"id": "f755c3c9-fb6c-3bc6-a3b2-33eb4ef9d5cc", "product": {"name": "Junos OS"}, "product_version": "19.2R1 <19.2*"}], "enisaIdVendor": [{"id": "844ee2e4-c80f-378e-a430-56ba0e46064d", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}