{"id": "EUVD-2020-12541", "enisaUuid": "de8f972a-b145-3071-b862-6c21d747ba1a", "description": "On Juniper Networks PTX and QFX Series devices with packet sampling configured using tunnel-observation mpls-over-udp, sampling of a malformed packet can cause the Kernel Routing Table (KRT) queue to become stuck. KRT is the module within the Routing Process Daemon (RPD) that synchronized the routing tables with the forwarding tables in the kernel. This table is then synchronized to the Packet Forwarding Engine (PFE) via the KRT queue. Thus, when KRT queue become stuck, it can lead to unexpected packet forwarding issues. An administrator can monitor the following command to check if there is the KRT queue is stuck: user@device > show krt state ... Number of async queue entries: 65007 <--- this value keep on increasing. When this issue occurs, the following message might appear in the /var/log/messages: DATE DEVICE kernel: %KERN-3: rt_pfe_veto: Too many delayed route/nexthop unrefs. Op 2 err 55, rtsm_id 5:-1, msg type 2 DATE DEVICE kernel: %KERN-3: rt_pfe_veto: Memory usage of M_RTNEXTHOP type = (0) Max size possible for M_RTNEXTHOP type = (7297134592) Current delayed unref = (60000), Current unique delayed unref = (18420), Max delayed unref on this platform = (40000) Current delayed weight unref = (60000) Max delayed weight unref on this platform= (400000) curproc = rpd This issue affects Juniper Networks Junos OS on PTX/QFX Series: 17.2X75 versions prior to 17.2X75-D105; 18.1 versions prior to 18.1R3-S11; 18.2 versions prior to 18.2R3-S5; 18.2X75 versions prior to 18.2X75-D420, 18.2X75-D53, 18.2X75-D65; 18.3 versions prior to 18.3R2-S4, 18.3R3-S3; 18.4 versions prior to 18.4R1-S7, 18.4R2-S5, 18.4R3-S4; 19.1 versions prior to 19.1R2-S2, 19.1R3-S2; 19.2 versions prior to 19.2R1-S5, 19.2R3; 19.3 versions prior to 19.3R2-S3, 19.3R3; 19.4 versions prior to 19.4R1-S2, 19.4R2-S1, 19.4R3; 20.1 versions prior to 20.1R1-S2, 20.1R2. This issue does not affect Juniper Networks Junos OS prior to 18.1R1.", "datePublished": "2020-10-16T20:31:34", "dateUpdated": "2024-09-16T19:19:08", "baseScore": 7.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA11076"], "aliases": ["CVE-2020-1679"], "assigner": "juniper", "epss": 0.39, "enisaIdProduct": [{"id": "46ad1a00-33d1-3605-95f7-fd4f67bc321a", "product": {"name": "Junos OS"}, "product_version": "18.3 <18.3R2-S4, 18.3R3-S3"}, {"id": "488450f4-c096-3862-84fc-d387ce3d8721", "product": {"name": "Junos OS"}, "product_version": "19.2 <19.2R1-S5, 19.2R3"}, {"id": "67f5708f-eb28-364d-a45d-68e4192ec43f", "product": {"name": "Junos OS"}, "product_version": "17.2X75 <17.2X75-D105"}, {"id": "8eed45e8-bbbb-39cd-826c-883b826ef077", "product": {"name": "Junos OS"}, "product_version": "18.2X75 <18.2X75-D420, 18.2X75-D53, 18.2X75-D65"}, {"id": "99c7ade5-ba99-3494-80c1-0184ad54da97", "product": {"name": "Junos OS"}, "product_version": "18.2 <18.2R3-S5"}, {"id": "9b8e4a12-a962-367a-8cbe-a3d17fdb7070", "product": {"name": "Junos OS"}, "product_version": "18.1 <18.1R3-S11"}, {"id": "a6793dad-e8cd-32f6-bc18-76f249d3a3ce", "product": {"name": "Junos OS"}, "product_version": "20.1 <20.1R1-S2, 20.1R2"}, {"id": "c3309672-0d24-31b2-b950-0fefa8576c7b", "product": {"name": "Junos OS"}, "product_version": "19.1 <19.1R2-S2, 19.1R3-S2"}, {"id": "d033c0a5-6bda-37e3-96f8-e20999ff6894", "product": {"name": "Junos OS"}, "product_version": "18.4 <18.4R1-S7, 18.4R2-S5, 18.4R3-S4"}, {"id": "d6fc5167-fdcd-3203-b01f-33aa8e6e1da8", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R2-S3, 19.3R3"}, {"id": "e86e5d23-3995-3989-ac4c-679cc9685503", "product": {"name": "Junos OS"}, "product_version": "19.4 <19.4R1-S2, 19.4R2-S1, 19.4R3"}], "enisaIdVendor": [{"id": "f68de066-474f-3de4-8c6f-3f24275c0ffc", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}