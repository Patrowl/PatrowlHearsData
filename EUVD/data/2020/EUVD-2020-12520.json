{"id": "EUVD-2020-12520", "enisaUuid": "91baa1ff-c9c3-3bb3-8c51-c5a35db41e95", "description": "When a device running Juniper Networks Junos OS with MPC7, MPC8, or MPC9 line cards installed and the system is configured for inline IP reassembly, used by L2TP, MAP-E, GRE, and IPIP, the packet forwarding engine (PFE) will become disabled upon receipt of large packets requiring fragmentation, generating the following error messages: [LOG: Err] MQSS(0): WO: Packet Error - Error Packets 1, Connection 29 [LOG: Err] eachip_hmcif_rx_intr_handler(7259): EA[0:0]: HMCIF Rx: Injected checksum error detected on WO response - Chunk Address 0x0 [LOG: Err] MQSS(0): DRD: RORD1: CMD reorder ID error - Command 11, Reorder ID 1838, QID 0 [LOG: Err] MQSS(0): DRD: UNROLL0: HMC chunk length error in stage 5 - Chunk Address: 0x4321f3 [LOG: Err] MQSS(0): DRD: UNROLL0: HMC chunk address error in stage 5 - Chunk Address: 0x0 [LOG: Notice] Error: /fpc/8/pfe/0/cm/0/MQSS(0)/0/MQSS_CMERROR_DRD_RORD_ENG_INT_REG_CMD_FSM_STATE_ERR (0x2203cc), scope: pfe, category: functional, severity: major, module: MQSS(0), type: DRD_RORD_ENG_INT: CMD FSM State Error [LOG: Notice] Performing action cmalarm for error /fpc/8/pfe/0/cm/0/MQSS(0)/0/MQSS_CMERROR_DRD_RORD_ENG_INT_REG_CMD_FSM_STATE_ERR (0x2203cc) in module: MQSS(0) with scope: pfe category: functional level: major [LOG: Notice] Performing action get-state for error /fpc/8/pfe/0/cm/0/MQSS(0)/0/MQSS_CMERROR_DRD_RORD_ENG_INT_REG_CMD_FSM_STATE_ERR (0x2203cc) in module: MQSS(0) with scope: pfe category: functional level: major [LOG: Notice] Performing action disable-pfe for error /fpc/8/pfe/0/cm/0/MQSS(0)/0/MQSS_CMERROR_DRD_RORD_ENG_INT_REG_CMD_FSM_STATE_ERR (0x2203cc) in module: MQSS(0) with scope: pfe category: functional level: major By continuously sending fragmented packets that cannot be reassembled, an attacker can repeatedly disable the PFE causing a sustained Denial of Service (DoS). This issue affects Juniper Networks Junos OS: 17.2 versions prior to 17.2R3-S4 on MX Series; 17.3 versions prior to 17.3R3-S8 on MX Series; 17.4 versions prior to 17.4R2-S10, 17.4R3-S2 on MX Series; 18.1 versions prior to 18.1R3-S10 on MX Series; 18.2 versions prior to 18.2R3-S3 on MX Series; 18.2X75 versions prior to 18.2X75-D41, 18.2X75-D430, 18.2X75-D65 on MX Series; 18.3 versions prior to 18.3R1-S7, 18.3R2-S4, 18.3R3-S1 on MX Series; 18.4 versions prior to 18.4R1-S7, 18.4R2-S4, 18.4R3 on MX Series; 19.1 versions prior to 19.1R1-S5, 19.1R2-S1, 19.1R3 on MX Series; 19.2 versions prior to 19.2R1-S4, 19.2R2 on MX Series; 19.3 versions prior to 19.3R2-S2, 19.3R3 on MX Series. This issue is specific to inline IP reassembly, introduced in Junos OS 17.2. Versions of Junos OS prior to 17.2 are unaffected by this vulnerability.", "datePublished": "2020-07-17T18:40:45", "dateUpdated": "2024-09-16T17:38:55", "baseScore": 5.3, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "references": ["https://www.juniper.net/documentation/en_US/junos/topics/topic-map/l2tp-lns-inline-service-interfaces.html", "https://kb.juniper.net/JSA11041"], "aliases": ["CVE-2020-1655"], "assigner": "juniper", "epss": 0.33, "enisaIdProduct": [{"id": "05750434-29f0-358f-a7aa-d8d6108edba9", "product": {"name": "Junos OS"}, "product_version": "18.2X75 <18.2X75-D41, 18.2X75-D430, 18.2X75-D65"}, {"id": "1b2c85f7-76a5-340c-aaf6-0e84df46d578", "product": {"name": "Junos OS"}, "product_version": "17.4 <17.4R2-S10, 17.4R3-S2"}, {"id": "2de40c69-9ba9-3190-97d2-7f70715d154e", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R2-S2, 19.3R3"}, {"id": "33962f6f-219c-327f-8253-45013b76378e", "product": {"name": "Junos OS"}, "product_version": "19.2 <19.2R1-S4, 19.2R2"}, {"id": "3a244095-422c-361c-a086-4115c90e3ea4", "product": {"name": "Junos OS"}, "product_version": "18.2 <18.2R3-S3"}, {"id": "686e10af-20d7-3b2e-9633-299077c962cc", "product": {"name": "Junos OS"}, "product_version": "19.1 <19.1R1-S5, 19.1R2-S1, 19.1R3"}, {"id": "823af66b-f98e-3da5-8fa4-01423b949ffe", "product": {"name": "Junos OS"}, "product_version": "18.4 <18.4R1-S7, 18.4R2-S4, 18.4R3"}, {"id": "b9b9a5ca-71fb-3d38-a71d-5dbf22033dba", "product": {"name": "Junos OS"}, "product_version": "17.2 <17.2R3-S4"}, {"id": "bb161226-c272-3b13-b828-4b5a6ef720df", "product": {"name": "Junos OS"}, "product_version": "18.1 <18.1R3-S10"}, {"id": "d0676812-d61b-3736-afdc-b435e216a505", "product": {"name": "Junos OS"}, "product_version": "17.3 <17.3R3-S8"}, {"id": "d81dc897-2b97-3406-8222-efb82bc31def", "product": {"name": "Junos OS"}, "product_version": "18.3 <18.3R1-S7, 18.3R2-S4, 18.3R3-S1"}], "enisaIdVendor": [{"id": "7368cf93-1a77-315e-9ed7-9beffd9164e2", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}