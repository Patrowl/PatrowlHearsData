{"id": "EUVD-2024-33374", "enisaUuid": "283406df-c90b-331d-915d-806d11a9ecd5", "description": "Incomplete tracking in PostgreSQL of tables with row security allows a reused query to view or change different rows from those intended.  CVE-2023-2455 and CVE-2016-2193 fixed most interaction between row security and user ID changes.  They missed cases where a subquery, WITH query, security invoker view, or SQL-language function references a table with a row-level security policy.  This has the same consequences as the two earlier CVEs.  That is to say, it leads to potentially incorrect policies being applied in cases where role-specific policies are used and a given query is planned under one role and then executed under other roles.  This scenario can happen under security definer functions or when a common user and query is planned initially and then re-used across multiple SET ROLEs.  Applying an incorrect policy may permit a user to complete otherwise-forbidden reads and modifications.  This affects only databases that have used CREATE POLICY to define a row security policy.  An attacker must tailor an attack to a particular application's pattern of query plan reuse, user ID changes, and role-specific row security policies.  Versions before PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21 are affected.", "datePublished": "2024-11-14T15:32:15", "dateUpdated": "2025-11-04T00:32:03", "baseScore": 4.2, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N", "references": ["https://www.postgresql.org/support/security/CVE-2024-10976/", "https://nvd.nist.gov/vuln/detail/CVE-2024-10976", "https://security.netapp.com/advisory/ntap-20250509-0010", "https://lists.debian.org/debian-lts-announce/2024/11/msg00011.html"], "aliases": ["CVE-2024-10976"], "assigner": "PostgreSQL", "epss": 1.22, "enisaIdProduct": [{"id": "5b81253d-a510-34bc-ac8e-eba8f10ab172", "product": {"name": "PostgreSQL"}, "product_version": "13 <13.17"}, {"id": "5de7eef3-b004-3da7-8750-46d035094ffc", "product": {"name": "PostgreSQL"}, "product_version": "15 <15.9"}, {"id": "665d1086-2756-381a-ad10-dfe1ea09d43a", "product": {"name": "PostgreSQL"}, "product_version": "14 <14.14"}, {"id": "91de9821-d540-3cec-a4ba-c745a1128f58", "product": {"name": "PostgreSQL"}, "product_version": "16 <16.5"}, {"id": "c1e74411-34c6-34d9-ad7a-9b14187ca5bd", "product": {"name": "PostgreSQL"}, "product_version": "17 <17.1"}, {"id": "cd81da7f-625b-3d94-bdb3-233a9a3fda2a", "product": {"name": "PostgreSQL"}, "product_version": "0 <12.21"}], "enisaIdVendor": [{"id": "0a445ba6-5114-378d-88af-8725a8e375e4", "vendor": {"name": "n/a"}}], "isExploited": false}