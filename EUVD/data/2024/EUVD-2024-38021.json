{"id": "EUVD-2024-38021", "enisaUuid": "7ade6b21-bad2-3f8e-83ab-57b61911923b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ngreybus: Fix use-after-free bug in gb_interface_release due to race condition.\n\nIn gb_interface_create, &intf->mode_switch_completion is bound with\ngb_interface_mode_switch_work. Then it will be started by\ngb_interface_request_mode_switch. Here is the relevant code.\nif (!queue_work(system_long_wq, &intf->mode_switch_work)) {\n\t...\n}\n\nIf we call gb_interface_release to make cleanup, there may be an\nunfinished work. This function will call kfree to free the object\n\"intf\". However, if gb_interface_mode_switch_work is scheduled to\nrun after kfree, it may cause use-after-free error as\ngb_interface_mode_switch_work will use the object \"intf\".\nThe possible execution flow that may lead to the issue is as follows:\n\nCPU0                            CPU1\n\n                            |   gb_interface_create\n                            |   gb_interface_request_mode_switch\ngb_interface_release        |\nkfree(intf) (free)          |\n                            |   gb_interface_mode_switch_work\n                            |   mutex_lock(&intf->mutex) (use)\n\nFix it by canceling the work before kfree.", "datePublished": "2024-07-12T12:20:31", "dateUpdated": "2025-11-03T21:56:12", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/74cd0a421896b2e07eafe7da4275302bfecef201", "https://git.kernel.org/stable/c/2b6bb0b4abfd79b8698ee161bb73c0936a2aaf83", "https://git.kernel.org/stable/c/fb071f5c75d4b1c177824de74ee75f9dd34123b9", "https://git.kernel.org/stable/c/9a733d69a4a59c2d08620e6589d823c24be773dc", "https://git.kernel.org/stable/c/0b8fba38bdfb848fac52e71270b2aa3538c996ea", "https://git.kernel.org/stable/c/03ea2b129344152157418929f06726989efc0445", "https://git.kernel.org/stable/c/5c9c5d7f26acc2c669c1dcf57d1bb43ee99220ce", "https://nvd.nist.gov/vuln/detail/CVE-2024-39495", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-39495"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "270149da-d32a-3b41-99f9-c18807293b03", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <74cd0a421896b2e07eafe7da4275302bfecef201"}, {"id": "29b7a59e-0c47-328d-978b-466877e1ed0d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.35"}, {"id": "4ab3d7e8-3447-3635-b4bb-af1eeef8e049", "product": {"name": "Linux"}, "product_version": "patch: 6.1.95"}, {"id": "57bea84c-9920-307d-b73e-7a745a8e4d07", "product": {"name": "Linux"}, "product_version": "patch: 5.4.279"}, {"id": "6e5c406a-c32b-37fc-a2a2-f2c950089c4a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5c9c5d7f26acc2c669c1dcf57d1bb43ee99220ce"}, {"id": "6f11cbe9-28e7-3655-91ea-f88ce23ae264", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0b8fba38bdfb848fac52e71270b2aa3538c996ea"}, {"id": "91397488-50bf-35c4-b12b-8d1b4a33a5a6", "product": {"name": "Linux"}, "product_version": "patch: 6.9.6"}, {"id": "924bf229-da32-311d-9ac5-b160fb1afa84", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fb071f5c75d4b1c177824de74ee75f9dd34123b9"}, {"id": "9282c8b7-2aa4-300b-8d23-dd27cc320550", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <03ea2b129344152157418929f06726989efc0445"}, {"id": "aad1746d-a2db-3a5e-9b91-46e6ded16db4", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9a733d69a4a59c2d08620e6589d823c24be773dc"}, {"id": "c82d6cf7-fef2-3362-93ad-4f8876930231", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2b6bb0b4abfd79b8698ee161bb73c0936a2aaf83"}, {"id": "d0f87dcc-795e-3b18-9f3a-a4b51b7ffec0", "product": {"name": "Linux"}, "product_version": "patch: 5.10.221"}, {"id": "dc434f1d-bda2-3499-89f8-8b268dbd01e7", "product": {"name": "Linux"}, "product_version": "patch: 6.10"}, {"id": "e45ce451-2ed8-3af3-9321-55b6143636d4", "product": {"name": "Linux"}, "product_version": "patch: 5.15.162"}], "enisaIdVendor": [{"id": "2027b7b8-5406-35c2-80da-1471cc5593e5", "vendor": {"name": "Linux"}}], "isExploited": false}