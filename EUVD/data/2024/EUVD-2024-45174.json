{"id": "EUVD-2024-45174", "enisaUuid": "83cc3087-7234-3eba-aebd-03fa09b2b7d4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm cache: fix flushing uninitialized delayed_work on cache_ctr error\n\nAn unexpected WARN_ON from flush_work() may occur when cache creation\nfails, caused by destroying the uninitialized delayed_work waker in the\nerror path of cache_create(). For example, the warning appears on the\nsuperblock checksum error.\n\nReproduce steps:\n\ndmsetup create cmeta --table \"0 8192 linear /dev/sdc 0\"\ndmsetup create cdata --table \"0 65536 linear /dev/sdc 8192\"\ndmsetup create corig --table \"0 524288 linear /dev/sdc 262144\"\ndd if=/dev/urandom of=/dev/mapper/cmeta bs=4k count=1 oflag=direct\ndmsetup create cache --table \"0 524288 cache /dev/mapper/cmeta \\\n/dev/mapper/cdata /dev/mapper/corig 128 2 metadata2 writethrough smq 0\"\n\nKernel logs:\n\n(snip)\nWARNING: CPU: 0 PID: 84 at kernel/workqueue.c:4178 __flush_work+0x5d4/0x890\n\nFix by pulling out the cancel_delayed_work_sync() from the constructor's\nerror path. This patch doesn't affect the use-after-free fix for\nconcurrent dm_resume and dm_destroy (commit 6a459d8edbdb (\"dm cache: Fix\nUAF in destroy()\")) as cache_dtr is not changed.", "datePublished": "2024-11-19T01:30:21", "dateUpdated": "2025-11-03T22:27:59", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/5a754d3c771280f2d06bf8ab716d6a0d36ca256e", "https://git.kernel.org/stable/c/8cc12dab635333c4ea28e72d7b947be7d0543c2c", "https://git.kernel.org/stable/c/aee3ecda73ce13af7c3e556383342b57e6bd0718", "https://git.kernel.org/stable/c/135496c208ba26fd68cdef10b64ed7a91ac9a7ff", "https://git.kernel.org/stable/c/40fac0271c7aedf60d81ed8214e80851e5b26312", "https://git.kernel.org/stable/c/d154b333a5667b6c1b213a11a41ad7aaccd10c3d", "https://nvd.nist.gov/vuln/detail/CVE-2024-50280", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50280"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "06e0acc4-2707-362f-86df-321729945d45", "product": {"name": "Linux"}, "product_version": "patch: 6.6.61"}, {"id": "09b2ac2e-ab8e-31e3-a2d4-6cc7c3a184bb", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "2d9e04cc-1ce1-3b0a-b522-f3100f222cf5", "product": {"name": "Linux"}, "product_version": "6a459d8edbdbe7b24db42a5a9f21e6aa9e00c2aa <8cc12dab635333c4ea28e72d7b947be7d0543c2c"}, {"id": "3694f158-e5d7-398b-bddf-e5ee09b6323b", "product": {"name": "Linux"}, "product_version": "2f097dfac7579fd84ff98eb1d3acd41d53a485f3"}, {"id": "45e3534a-2d25-357b-876f-1a1234bcc66f", "product": {"name": "Linux"}, "product_version": "993406104d2b28fe470126a062ad37a1e21e792e"}, {"id": "46e382a9-692f-3901-94d4-b93f9d512f9e", "product": {"name": "Linux"}, "product_version": "034cbc8d3b47a56acd89453c29632a9c117de09d"}, {"id": "6a506117-37cc-398a-bdac-886147309c38", "product": {"name": "Linux"}, "product_version": "6.2"}, {"id": "72ad49fd-decb-33b9-af9d-b4154ed329c8", "product": {"name": "Linux"}, "product_version": "6ac4f36910764cb510bafc4c3768544f86ca48ca"}, {"id": "80036318-0a8e-3ed7-b78a-d9c4be183a32", "product": {"name": "Linux"}, "product_version": "patch: 6.11.8"}, {"id": "81dc216c-8b5d-37ca-8eab-d8f46ca202a9", "product": {"name": "Linux"}, "product_version": "4d20032dd90664de09f2902a7ea49ae2f7771746"}, {"id": "8ad88fb8-97c2-3779-a6f5-284473d6cc64", "product": {"name": "Linux"}, "product_version": "6a459d8edbdbe7b24db42a5a9f21e6aa9e00c2aa <aee3ecda73ce13af7c3e556383342b57e6bd0718"}, {"id": "a240be16-185b-3f1a-b045-630bf2631510", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "b93f58b3-1a2d-3897-8843-1ff823c8a408", "product": {"name": "Linux"}, "product_version": "d2a0b298ebf83ab6236f66788a3541e91ce75a70 <d154b333a5667b6c1b213a11a41ad7aaccd10c3d"}, {"id": "cb5e9b07-3a11-3fb1-ace3-0157ec371c91", "product": {"name": "Linux"}, "product_version": "6a3e412c2ab131c54945327a7676b006f000a209 <5a754d3c771280f2d06bf8ab716d6a0d36ca256e"}, {"id": "cd21d456-aa6b-3ad9-be32-caa504dbc575", "product": {"name": "Linux"}, "product_version": "2b17026685a270b2beaf1cdd9857fcedd3505c7e <40fac0271c7aedf60d81ed8214e80851e5b26312"}, {"id": "d4d0e051-3435-3253-ba0b-1b1c6b58c089", "product": {"name": "Linux"}, "product_version": "patch: 5.10.237"}, {"id": "dc564190-26bf-3311-92cf-561250d926cd", "product": {"name": "Linux"}, "product_version": "patch: 6.1.117"}, {"id": "e7893410-5614-305b-b495-ad40f358163a", "product": {"name": "Linux"}, "product_version": "6a459d8edbdbe7b24db42a5a9f21e6aa9e00c2aa <135496c208ba26fd68cdef10b64ed7a91ac9a7ff"}, {"id": "e965e99c-9e3e-3cc4-aa53-1181ac780a9b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.181"}], "enisaIdVendor": [{"id": "a5025f8b-31e3-3bdc-89cc-9957f161e567", "vendor": {"name": "Linux"}}], "isExploited": false}