{"id": "EUVD-2024-44649", "enisaUuid": "e2bd5b96-d018-3255-923b-49994661bc60", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Fix command bitmask initialization\n\nCommand bitmask have a dedicated bit for MANAGE_PAGES command, this bit\nisn't Initialize during command bitmask Initialization, only during\nMANAGE_PAGES.\n\nIn addition, mlx5_cmd_trigger_completions() is trying to trigger\ncompletion for MANAGE_PAGES command as well.\n\nHence, in case health error occurred before any MANAGE_PAGES command\nhave been invoke (for example, during mlx5_enable_hca()),\nmlx5_cmd_trigger_completions() will try to trigger completion for\nMANAGE_PAGES command, which will result in null-ptr-deref error.[1]\n\nFix it by Initialize command bitmask correctly.\n\nWhile at it, re-write the code for better understanding.\n\n[1]\nBUG: KASAN: null-ptr-deref in mlx5_cmd_trigger_completions+0x1db/0x600 [mlx5_core]\nWrite of size 4 at addr 0000000000000214 by task kworker/u96:2/12078\nCPU: 10 PID: 12078 Comm: kworker/u96:2 Not tainted 6.9.0-rc2_for_upstream_debug_2024_04_07_19_01 #1\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nWorkqueue: mlx5_health0000:08:00.0 mlx5_fw_fatal_reporter_err_work [mlx5_core]\nCall Trace:\n <TASK>\n dump_stack_lvl+0x7e/0xc0\n kasan_report+0xb9/0xf0\n kasan_check_range+0xec/0x190\n mlx5_cmd_trigger_completions+0x1db/0x600 [mlx5_core]\n mlx5_cmd_flush+0x94/0x240 [mlx5_core]\n enter_error_state+0x6c/0xd0 [mlx5_core]\n mlx5_fw_fatal_reporter_err_work+0xf3/0x480 [mlx5_core]\n process_one_work+0x787/0x1490\n ? lockdep_hardirqs_on_prepare+0x400/0x400\n ? pwq_dec_nr_in_flight+0xda0/0xda0\n ? assign_work+0x168/0x240\n worker_thread+0x586/0xd30\n ? rescuer_thread+0xae0/0xae0\n kthread+0x2df/0x3b0\n ? kthread_complete_and_exit+0x20/0x20\n ret_from_fork+0x2d/0x70\n ? kthread_complete_and_exit+0x20/0x20\n ret_from_fork_asm+0x11/0x20\n </TASK>", "datePublished": "2024-11-07T09:31:24", "dateUpdated": "2025-11-03T22:26:05", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/d1606090bb294cecb7de3c4ed177f5aa0abd4c4e", "https://git.kernel.org/stable/c/d88564c79d1cedaf2655f12261eca0d2796bde4e", "https://git.kernel.org/stable/c/2feac1e562be0efc621a6722644a90f355d53473", "https://git.kernel.org/stable/c/d62b14045c6511a7b2d4948d1a83a4e592deeb05", "https://nvd.nist.gov/vuln/detail/CVE-2024-50147", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50147"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "01a7fdc5-45a1-378b-a66c-a854d620ce62", "product": {"name": "Linux"}, "product_version": "9b98d395b85dd042fe83fb696b1ac02e6c93a520 <2feac1e562be0efc621a6722644a90f355d53473"}, {"id": "1a33a8b5-f310-3bf2-a587-f79555d6fa1c", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "335e1513-65ef-3c07-ba84-446b7f9555da", "product": {"name": "Linux"}, "product_version": "patch: 6.11.6"}, {"id": "4da126a8-3f3d-386e-b972-ddd2e6f79ee5", "product": {"name": "Linux"}, "product_version": "9b98d395b85dd042fe83fb696b1ac02e6c93a520 <d62b14045c6511a7b2d4948d1a83a4e592deeb05"}, {"id": "5b311b60-bfad-3fd8-b36b-1023f1acc261", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "cc510907-4ce9-3ba9-8e28-122f2503c620", "product": {"name": "Linux"}, "product_version": "patch: 6.6.59"}, {"id": "d371d89d-32ea-32b4-b84b-4493dac41e15", "product": {"name": "Linux"}, "product_version": "patch: 6.1.115"}, {"id": "d9034a0b-ee8b-3aa0-a8bc-55116b3a35d3", "product": {"name": "Linux"}, "product_version": "9b98d395b85dd042fe83fb696b1ac02e6c93a520 <d1606090bb294cecb7de3c4ed177f5aa0abd4c4e"}, {"id": "efb9a4bd-b7f8-3267-9299-51c22101e5df", "product": {"name": "Linux"}, "product_version": "9b98d395b85dd042fe83fb696b1ac02e6c93a520 <d88564c79d1cedaf2655f12261eca0d2796bde4e"}, {"id": "f78554bd-bb9a-397f-8fb4-fb76d28f8bdb", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "bf11c66c-7a10-3573-9073-d8c4a76d6206", "vendor": {"name": "Linux"}}], "isExploited": false}