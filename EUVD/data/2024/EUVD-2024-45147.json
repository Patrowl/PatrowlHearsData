{"id": "EUVD-2024-45147", "enisaUuid": "3b92ee4b-d49b-3884-9331-f2f0eeb648c9", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: sched: use RCU read-side critical section in taprio_dump()\n\nFix possible use-after-free in 'taprio_dump()' by adding RCU\nread-side critical section there. Never seen on x86 but\nfound on a KASAN-enabled arm64 system when investigating\nhttps://syzkaller.appspot.com/bug?extid=b65e0af58423fc8a73aa:\n\n[T15862] BUG: KASAN: slab-use-after-free in taprio_dump+0xa0c/0xbb0\n[T15862] Read of size 4 at addr ffff0000d4bb88f8 by task repro/15862\n[T15862]\n[T15862] CPU: 0 UID: 0 PID: 15862 Comm: repro Not tainted 6.11.0-rc1-00293-gdefaf1a2113a-dirty #2\n[T15862] Hardware name: QEMU QEMU Virtual Machine, BIOS edk2-20240524-5.fc40 05/24/2024\n[T15862] Call trace:\n[T15862]  dump_backtrace+0x20c/0x220\n[T15862]  show_stack+0x2c/0x40\n[T15862]  dump_stack_lvl+0xf8/0x174\n[T15862]  print_report+0x170/0x4d8\n[T15862]  kasan_report+0xb8/0x1d4\n[T15862]  __asan_report_load4_noabort+0x20/0x2c\n[T15862]  taprio_dump+0xa0c/0xbb0\n[T15862]  tc_fill_qdisc+0x540/0x1020\n[T15862]  qdisc_notify.isra.0+0x330/0x3a0\n[T15862]  tc_modify_qdisc+0x7b8/0x1838\n[T15862]  rtnetlink_rcv_msg+0x3c8/0xc20\n[T15862]  netlink_rcv_skb+0x1f8/0x3d4\n[T15862]  rtnetlink_rcv+0x28/0x40\n[T15862]  netlink_unicast+0x51c/0x790\n[T15862]  netlink_sendmsg+0x79c/0xc20\n[T15862]  __sock_sendmsg+0xe0/0x1a0\n[T15862]  ____sys_sendmsg+0x6c0/0x840\n[T15862]  ___sys_sendmsg+0x1ac/0x1f0\n[T15862]  __sys_sendmsg+0x110/0x1d0\n[T15862]  __arm64_sys_sendmsg+0x74/0xb0\n[T15862]  invoke_syscall+0x88/0x2e0\n[T15862]  el0_svc_common.constprop.0+0xe4/0x2a0\n[T15862]  do_el0_svc+0x44/0x60\n[T15862]  el0_svc+0x50/0x184\n[T15862]  el0t_64_sync_handler+0x120/0x12c\n[T15862]  el0t_64_sync+0x190/0x194\n[T15862]\n[T15862] Allocated by task 15857:\n[T15862]  kasan_save_stack+0x3c/0x70\n[T15862]  kasan_save_track+0x20/0x3c\n[T15862]  kasan_save_alloc_info+0x40/0x60\n[T15862]  __kasan_kmalloc+0xd4/0xe0\n[T15862]  __kmalloc_cache_noprof+0x194/0x334\n[T15862]  taprio_change+0x45c/0x2fe0\n[T15862]  tc_modify_qdisc+0x6a8/0x1838\n[T15862]  rtnetlink_rcv_msg+0x3c8/0xc20\n[T15862]  netlink_rcv_skb+0x1f8/0x3d4\n[T15862]  rtnetlink_rcv+0x28/0x40\n[T15862]  netlink_unicast+0x51c/0x790\n[T15862]  netlink_sendmsg+0x79c/0xc20\n[T15862]  __sock_sendmsg+0xe0/0x1a0\n[T15862]  ____sys_sendmsg+0x6c0/0x840\n[T15862]  ___sys_sendmsg+0x1ac/0x1f0\n[T15862]  __sys_sendmsg+0x110/0x1d0\n[T15862]  __arm64_sys_sendmsg+0x74/0xb0\n[T15862]  invoke_syscall+0x88/0x2e0\n[T15862]  el0_svc_common.constprop.0+0xe4/0x2a0\n[T15862]  do_el0_svc+0x44/0x60\n[T15862]  el0_svc+0x50/0x184\n[T15862]  el0t_64_sync_handler+0x120/0x12c\n[T15862]  el0t_64_sync+0x190/0x194\n[T15862]\n[T15862] Freed by task 6192:\n[T15862]  kasan_save_stack+0x3c/0x70\n[T15862]  kasan_save_track+0x20/0x3c\n[T15862]  kasan_save_free_info+0x4c/0x80\n[T15862]  poison_slab_object+0x110/0x160\n[T15862]  __kasan_slab_free+0x3c/0x74\n[T15862]  kfree+0x134/0x3c0\n[T15862]  taprio_free_sched_cb+0x18c/0x220\n[T15862]  rcu_core+0x920/0x1b7c\n[T15862]  rcu_core_si+0x10/0x1c\n[T15862]  handle_softirqs+0x2e8/0xd64\n[T15862]  __do_softirq+0x14/0x20", "datePublished": "2024-11-05T17:10:53", "dateUpdated": "2025-11-03T22:25:47", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/b911fa9e92ee586e36479ad57b88f20471acaca1", "https://git.kernel.org/stable/c/5d282467245f267c0b9ada3f7f309ff838521536", "https://git.kernel.org/stable/c/e4369cb6acf6b895ac2453cc1cdf2f4326122c6d", "https://git.kernel.org/stable/c/b22db8b8befe90b61c98626ca1a2fbb0505e9fe3", "https://nvd.nist.gov/vuln/detail/CVE-2024-50126", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50126"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "6242843b-faa5-325e-ba3c-cfe8aa9f6ed5", "product": {"name": "Linux"}, "product_version": "patch: 6.11.6"}, {"id": "697830fe-612f-35d9-81f5-991a92ca533f", "product": {"name": "Linux"}, "product_version": "18cdd2f0998a4967b1fff4c43ed9aef049e42c39 <e4369cb6acf6b895ac2453cc1cdf2f4326122c6d"}, {"id": "73501af1-3f69-30f9-b91a-e94d1463157a", "product": {"name": "Linux"}, "product_version": "patch: 6.1.117"}, {"id": "8705742a-6b79-3db1-9801-e5aedca18660", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "901036a9-7a1c-34a5-a3cb-4f3fcde38486", "product": {"name": "Linux"}, "product_version": "18cdd2f0998a4967b1fff4c43ed9aef049e42c39 <b911fa9e92ee586e36479ad57b88f20471acaca1"}, {"id": "acdda397-56b1-324e-9717-05810cbcee38", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "bdcea435-fe7a-3c06-9532-4fca600d42c7", "product": {"name": "Linux"}, "product_version": "18cdd2f0998a4967b1fff4c43ed9aef049e42c39 <b22db8b8befe90b61c98626ca1a2fbb0505e9fe3"}, {"id": "d572396f-a589-3272-a0f9-f32ae1134e2f", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "e7e7e741-b318-3492-a7bf-ab1b0bc01482", "product": {"name": "Linux"}, "product_version": "18cdd2f0998a4967b1fff4c43ed9aef049e42c39 <5d282467245f267c0b9ada3f7f309ff838521536"}, {"id": "f3e2a1e4-8249-33a9-ad01-7b9887c96b33", "product": {"name": "Linux"}, "product_version": "patch: 6.6.59"}], "enisaIdVendor": [{"id": "fe5e2147-fff8-300a-8b0c-3bbd154ea046", "vendor": {"name": "Linux"}}], "isExploited": false}