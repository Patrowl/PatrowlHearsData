{"id": "EUVD-2024-51894", "enisaUuid": "4c0c6160-4868-36f7-8e9d-5fdc981a5bb9", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nzram: fix NULL pointer in comp_algorithm_show()\n\nLTP reported a NULL pointer dereference as followed:\n\n CPU: 7 UID: 0 PID: 5995 Comm: cat Kdump: loaded Not tainted 6.12.0-rc6+ #3\n Hardware name: QEMU KVM Virtual Machine, BIOS 0.0.0 02/06/2015\n pstate: 40400005 (nZcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n pc : __pi_strcmp+0x24/0x140\n lr : zcomp_available_show+0x60/0x100 [zram]\n sp : ffff800088b93b90\n x29: ffff800088b93b90 x28: 0000000000000001 x27: 0000000000400cc0\n x26: 0000000000000ffe x25: ffff80007b3e2388 x24: 0000000000000000\n x23: ffff80007b3e2390 x22: ffff0004041a9000 x21: ffff80007b3e2900\n x20: 0000000000000000 x19: 0000000000000000 x18: 0000000000000000\n x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000\n x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000000000\n x11: 0000000000000000 x10: ffff80007b3e2900 x9 : ffff80007b3cb280\n x8 : 0101010101010101 x7 : 0000000000000000 x6 : 0000000000000000\n x5 : 0000000000000040 x4 : 0000000000000000 x3 : 00656c722d6f7a6c\n x2 : 0000000000000000 x1 : ffff80007b3e2900 x0 : 0000000000000000\n Call trace:\n  __pi_strcmp+0x24/0x140\n  comp_algorithm_show+0x40/0x70 [zram]\n  dev_attr_show+0x28/0x80\n  sysfs_kf_seq_show+0x90/0x140\n  kernfs_seq_show+0x34/0x48\n  seq_read_iter+0x1d4/0x4e8\n  kernfs_fop_read_iter+0x40/0x58\n  new_sync_read+0x9c/0x168\n  vfs_read+0x1a8/0x1f8\n  ksys_read+0x74/0x108\n  __arm64_sys_read+0x24/0x38\n  invoke_syscall+0x50/0x120\n  el0_svc_common.constprop.0+0xc8/0xf0\n  do_el0_svc+0x24/0x38\n  el0_svc+0x38/0x138\n  el0t_64_sync_handler+0xc0/0xc8\n  el0t_64_sync+0x188/0x190\n\nThe zram->comp_algs[ZRAM_PRIMARY_COMP] can be NULL in zram_add() if\ncomp_algorithm_set() has not been called.  User can access the zram device\nby sysfs after device_add_disk(), so there is a time window to trigger the\nNULL pointer dereference.  Move it ahead device_add_disk() to make sure\nwhen user can access the zram device, it is ready.  comp_algorithm_set()\nis protected by zram->init_lock in other places and no such problem.", "datePublished": "2024-12-27T15:31:52", "dateUpdated": "2025-03-24T18:30:46", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/843d366ff19708668d95cda16bb8aba109a93dba", "https://git.kernel.org/stable/c/f364cdeb38938f9d03061682b8ff3779dd1730e5", "https://git.kernel.org/stable/c/c7ee791e538537b281f60945298796f0a3971bbd", "https://nvd.nist.gov/vuln/detail/CVE-2024-53222"], "aliases": ["CVE-2024-53222"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "00d7410f-c3ae-3864-9f36-6539484be6df", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1447e3d1-903e-37cd-885d-0bafdf1e52a4", "product": {"name": "Linux"}, "product_version": "7ac07a26dea79c3892436bce41cce03dcbd3c4c7 <c7ee791e538537b281f60945298796f0a3971bbd"}, {"id": "20daa284-d853-3b8b-81fa-b5391b270a78", "product": {"name": "Linux"}, "product_version": "7ac07a26dea79c3892436bce41cce03dcbd3c4c7 <f364cdeb38938f9d03061682b8ff3779dd1730e5"}, {"id": "84b9d203-540e-3cc5-857a-17e1ce23d7ea", "product": {"name": "Linux"}, "product_version": "6.2"}, {"id": "ad1a56d3-f608-32da-9085-a03379d81982", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "c20ce6fc-2001-3837-ba96-e2cb8ceb5d64", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "cc0f349c-cf4e-395d-a61a-265f471c90e9", "product": {"name": "Linux"}, "product_version": "7ac07a26dea79c3892436bce41cce03dcbd3c4c7 <843d366ff19708668d95cda16bb8aba109a93dba"}, {"id": "e5ea13f1-130c-3f73-a226-17fa0f10e5b9", "product": {"name": "Linux"}, "product_version": "patch: 6.6.84"}], "enisaIdVendor": [{"id": "5643109e-3591-37d3-a56b-336f18be7749", "vendor": {"name": "Linux"}}], "isExploited": false}