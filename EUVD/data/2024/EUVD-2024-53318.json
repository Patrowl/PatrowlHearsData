{"id": "EUVD-2024-53318", "enisaUuid": "7402e293-9fa7-315f-b3b4-512f6138f54f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: u_serial: Fix the issue that gs_start_io crashed due to accessing null pointer\n\nConsidering that in some extreme cases,\nwhen u_serial driver is accessed by multiple threads,\nThread A is executing the open operation and calling the gs_open,\nThread B is executing the disconnect operation and calling the\ngserial_disconnect function,The port->port_usb pointer will be set to NULL.\n\nE.g.\n    Thread A                                 Thread B\n    gs_open()                                gadget_unbind_driver()\n    gs_start_io()                            composite_disconnect()\n    gs_start_rx()                            gserial_disconnect()\n    ...                                      ...\n    spin_unlock(&port->port_lock)\n    status = usb_ep_queue()                  spin_lock(&port->port_lock)\n    spin_lock(&port->port_lock)              port->port_usb = NULL\n    gs_free_requests(port->port_usb->in)     spin_unlock(&port->port_lock)\n    Crash\n\nThis causes thread A to access a null pointer (port->port_usb is null)\nwhen calling the gs_free_requests function, causing a crash.\n\nIf port_usb is NULL, the release request will be skipped as it\nwill be done by gserial_disconnect.\n\nSo add a null pointer check to gs_start_io before attempting\nto access the value of the pointer port->port_usb.\n\nCall trace:\n gs_start_io+0x164/0x25c\n gs_open+0x108/0x13c\n tty_open+0x314/0x638\n chrdev_open+0x1b8/0x258\n do_dentry_open+0x2c4/0x700\n vfs_open+0x2c/0x3c\n path_openat+0xa64/0xc60\n do_filp_open+0xb8/0x164\n do_sys_openat2+0x84/0xf0\n __arm64_sys_openat+0x70/0x9c\n invoke_syscall+0x58/0x114\n el0_svc_common+0x80/0xe0\n do_el0_svc+0x1c/0x28\n el0_svc+0x38/0x68", "datePublished": "2024-12-27T15:31:56", "dateUpdated": "2025-11-03T21:32:00", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/4efdfdc32d8d6307f968cd99f1db64468471bab1", "https://git.kernel.org/stable/c/28b3c03a6790de1f6f2683919ad657840f0f0f58", "https://git.kernel.org/stable/c/1247e1df086aa6c17ab53cd1bedce70dd7132765", "https://git.kernel.org/stable/c/c83213b6649d22656b3a4e92544ceeea8a2c6c07", "https://git.kernel.org/stable/c/8ca07a3d18f39b1669927ef536e485787e856df6", "https://git.kernel.org/stable/c/dd6b0ca6025f64ccb465a6a3460c5b0307ed9c44", "https://git.kernel.org/stable/c/4cfbca86f6a8b801f3254e0e3c8f2b1d2d64be2b", "https://nvd.nist.gov/vuln/detail/CVE-2024-56670", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-56670"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "007052d2-2d3c-314a-a8ff-ef2096b63e51", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0831c1fb-aea5-35e3-b8c0-cdd2c614b0d5", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <28b3c03a6790de1f6f2683919ad657840f0f0f58"}, {"id": "1a9a1969-c94c-3f3b-bbc4-fff1124f0f87", "product": {"name": "Linux"}, "product_version": "patch: 5.10.232"}, {"id": "3fc0a3f8-2cc5-32bf-afd8-1808b308e3d2", "product": {"name": "Linux"}, "product_version": "patch: 6.1.121"}, {"id": "4dab3a86-46c5-323e-9035-a82a26591c43", "product": {"name": "Linux"}, "product_version": "patch: 5.4.288"}, {"id": "68c12ff6-aae2-3773-aec3-44f6a267ad7b", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <1247e1df086aa6c17ab53cd1bedce70dd7132765"}, {"id": "7a65cab0-339a-3539-a8b3-addc84e74a66", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <4cfbca86f6a8b801f3254e0e3c8f2b1d2d64be2b"}, {"id": "7d34ad19-234f-3125-9e2a-a555ffb66b13", "product": {"name": "Linux"}, "product_version": "patch: 5.15.175"}, {"id": "941c42e0-8a4c-366a-b127-08cdcd36dc48", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <dd6b0ca6025f64ccb465a6a3460c5b0307ed9c44"}, {"id": "956fa736-0f72-36a6-b216-0f49249a667d", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <c83213b6649d22656b3a4e92544ceeea8a2c6c07"}, {"id": "a3478b28-d764-3f72-94b4-4045230517f3", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "b8c8e454-f90d-34ad-858c-02fbeca2676c", "product": {"name": "Linux"}, "product_version": "patch: 6.6.67"}, {"id": "c66ef955-6bbd-3553-b6e1-c2ddf9658145", "product": {"name": "Linux"}, "product_version": "2.6.27"}, {"id": "cdd12880-5b46-3522-bb76-489e2f64be8d", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <8ca07a3d18f39b1669927ef536e485787e856df6"}, {"id": "dbfecda0-2b95-346f-bc12-280e1c54fc4c", "product": {"name": "Linux"}, "product_version": "c1dca562be8ada614ef193aa246c6f8705bcd6b9 <4efdfdc32d8d6307f968cd99f1db64468471bab1"}, {"id": "e7d0a5ad-4b08-3869-acb2-c6c0a0b27b42", "product": {"name": "Linux"}, "product_version": "patch: 6.12.6"}], "enisaIdVendor": [{"id": "224b80a0-240f-307a-a35a-c453508dece0", "vendor": {"name": "Linux"}}], "isExploited": false}