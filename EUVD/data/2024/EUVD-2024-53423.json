{"id": "EUVD-2024-53423", "enisaUuid": "fb4a0541-353f-3c49-9149-e714bbd9d76f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nquota: flush quota_release_work upon quota writeback\n\nOne of the paths quota writeback is called from is:\n\nfreeze_super()\n  sync_filesystem()\n    ext4_sync_fs()\n      dquot_writeback_dquots()\n\nSince we currently don't always flush the quota_release_work queue in\nthis path, we can end up with the following race:\n\n 1. dquot are added to releasing_dquots list during regular operations.\n 2. FS Freeze starts, however, this does not flush the quota_release_work queue.\n 3. Freeze completes.\n 4. Kernel eventually tries to flush the workqueue while FS is frozen which\n    hits a WARN_ON since transaction gets started during frozen state:\n\n  ext4_journal_check_start+0x28/0x110 [ext4] (unreliable)\n  __ext4_journal_start_sb+0x64/0x1c0 [ext4]\n  ext4_release_dquot+0x90/0x1d0 [ext4]\n  quota_release_workfn+0x43c/0x4d0\n\nWhich is the following line:\n\n  WARN_ON(sb->s_writers.frozen == SB_FREEZE_COMPLETE);\n\nWhich ultimately results in generic/390 failing due to dmesg\nnoise. This was detected on powerpc machine 15 cores.\n\nTo avoid this, make sure to flush the workqueue during\ndquot_writeback_dquots() so we dont have any pending workitems after\nfreeze.", "datePublished": "2025-01-08T18:30:49", "dateUpdated": "2025-11-03T21:32:05", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/a5abba5e0e586e258ded3e798fe5f69c66fec198", "https://git.kernel.org/stable/c/6f3821acd7c3143145999248087de5fb4b48cf26", "https://git.kernel.org/stable/c/ab6cfcf8ed2c7496f55d020b65b1d8cd55d9a2cb", "https://git.kernel.org/stable/c/3e6ff207cd5bd924ad94cd1a7c633bcdac0ba1cb", "https://git.kernel.org/stable/c/bcacb52a985f1b6d280f698a470b873dfe52728a", "https://git.kernel.org/stable/c/8ea87e34792258825d290f4dc5216276e91cb224", "https://git.kernel.org/stable/c/ac6f420291b3fee1113f21d612fa88b628afab5b", "https://nvd.nist.gov/vuln/detail/CVE-2024-56780", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-56780"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "1535b23c-2717-3101-81bb-bcce5a358b95", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "1b64a009-1901-3c43-9ffc-629a5244e1b1", "product": {"name": "Linux"}, "product_version": "patch: 5.4.287"}, {"id": "1d81c9a2-6954-3ab0-9b8c-707ccdb3275c", "product": {"name": "Linux"}, "product_version": "patch: 6.6.64"}, {"id": "2fd35fc4-50ba-367c-9ab1-bbf500c9a23b", "product": {"name": "Linux"}, "product_version": "903fc5d8cb48b0d2de7095ef40e39fd32bb27bd0"}, {"id": "4eb52a64-701b-356f-b713-a1442f9c3d93", "product": {"name": "Linux"}, "product_version": "3027e200dd58d5b437f16634dbbd355b29ffe0a6 <3e6ff207cd5bd924ad94cd1a7c633bcdac0ba1cb"}, {"id": "62b9de70-5aef-3be8-896f-3ffea278ead8", "product": {"name": "Linux"}, "product_version": "patch: 5.10.231"}, {"id": "6fb97a4b-8d70-3dca-b9b0-b5aea06e2148", "product": {"name": "Linux"}, "product_version": "86d89987f0998c98f57d641e308b40452a994045 <6f3821acd7c3143145999248087de5fb4b48cf26"}, {"id": "985ab1a0-f35f-3788-b929-d42b6732a738", "product": {"name": "Linux"}, "product_version": "d40c192e119892799dd4ddf94f5cea6fa93775ef <a5abba5e0e586e258ded3e798fe5f69c66fec198"}, {"id": "b5460280-365f-3636-af21-27f924f84a9d", "product": {"name": "Linux"}, "product_version": "dabc8b20756601b9e1cc85a81d47d3f98ed4d13a <8ea87e34792258825d290f4dc5216276e91cb224"}, {"id": "b9a94a3d-e6c2-3f32-b574-5fd63c538520", "product": {"name": "Linux"}, "product_version": "patch: 6.1.120"}, {"id": "c438ba54-cb36-3ff3-add4-919f5193f721", "product": {"name": "Linux"}, "product_version": "dabc8b20756601b9e1cc85a81d47d3f98ed4d13a <bcacb52a985f1b6d280f698a470b873dfe52728a"}, {"id": "c53982d1-87e9-3228-a40e-8820f819bc52", "product": {"name": "Linux"}, "product_version": "patch: 6.12.4"}, {"id": "dd9e79dc-80c2-34f2-9131-303b392156f5", "product": {"name": "Linux"}, "product_version": "31bed65eecbc5ce57592cfe31947eaa64e3d678e"}, {"id": "ec144950-8855-3e0a-b162-4fc9356ec84b", "product": {"name": "Linux"}, "product_version": "dabc8b20756601b9e1cc85a81d47d3f98ed4d13a <ac6f420291b3fee1113f21d612fa88b628afab5b"}, {"id": "eea595ad-85c4-3600-a1a8-18cb9fbd47f4", "product": {"name": "Linux"}, "product_version": "6.6"}, {"id": "f1f25d64-aa47-335f-b40f-7b99c1b23382", "product": {"name": "Linux"}, "product_version": "f3e9a2bbdeb8987508dd6bb2b701dea911d4daec"}, {"id": "f98f28ec-e861-3f97-9060-ee5a7afabb28", "product": {"name": "Linux"}, "product_version": "patch: 5.15.174"}, {"id": "faff31af-bc43-3b9c-8a43-4f2db87184f3", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "fc948006-af43-3b30-a650-f61f92ee50bc", "product": {"name": "Linux"}, "product_version": "89602de9a2d7080b7a4029d5c1bf8f78d295ff5f <ab6cfcf8ed2c7496f55d020b65b1d8cd55d9a2cb"}], "enisaIdVendor": [{"id": "65edb5ec-3144-3c79-82f2-e37f275458c1", "vendor": {"name": "Linux"}}], "isExploited": false}