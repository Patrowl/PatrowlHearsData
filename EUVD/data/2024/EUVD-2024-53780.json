{"id": "EUVD-2024-53780", "enisaUuid": "0e75c9e2-7927-3edd-9a76-43c640a121b3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64: ptrace: fix partial SETREGSET for NT_ARM_POE\n\nCurrently poe_set() doesn't initialize the temporary 'ctrl' variable,\nand a SETREGSET call with a length of zero will leave this\nuninitialized. Consequently an arbitrary value will be written back to\ntarget->thread.por_el0, potentially leaking up to 64 bits of memory from\nthe kernel stack. The read is limited to a specific slot on the stack,\nand the issue does not provide a write mechanism.\n\nFix this by initializing the temporary value before copying the regset\nfrom userspace, as for other regsets (e.g. NT_PRSTATUS, NT_PRFPREG,\nNT_ARM_SYSTEM_CALL). In the case of a zero-length write, the existing\ncontents of POR_EL1 will be retained.\n\nBefore this patch:\n\n| # ./poe-test\n| Attempting to write NT_ARM_POE::por_el0 = 0x900d900d900d900d\n| SETREGSET(nt=0x40f, len=8) wrote 8 bytes\n|\n| Attempting to read NT_ARM_POE::por_el0\n| GETREGSET(nt=0x40f, len=8) read 8 bytes\n| Read NT_ARM_POE::por_el0 = 0x900d900d900d900d\n|\n| Attempting to write NT_ARM_POE (zero length)\n| SETREGSET(nt=0x40f, len=0) wrote 0 bytes\n|\n| Attempting to read NT_ARM_POE::por_el0\n| GETREGSET(nt=0x40f, len=8) read 8 bytes\n| Read NT_ARM_POE::por_el0 = 0xffff8000839c3d50\n\nAfter this patch:\n\n| # ./poe-test\n| Attempting to write NT_ARM_POE::por_el0 = 0x900d900d900d900d\n| SETREGSET(nt=0x40f, len=8) wrote 8 bytes\n|\n| Attempting to read NT_ARM_POE::por_el0\n| GETREGSET(nt=0x40f, len=8) read 8 bytes\n| Read NT_ARM_POE::por_el0 = 0x900d900d900d900d\n|\n| Attempting to write NT_ARM_POE (zero length)\n| SETREGSET(nt=0x40f, len=0) wrote 0 bytes\n|\n| Attempting to read NT_ARM_POE::por_el0\n| GETREGSET(nt=0x40f, len=8) read 8 bytes\n| Read NT_ARM_POE::por_el0 = 0x900d900d900d900d", "datePublished": "2025-01-11T14:49:03", "dateUpdated": "2025-10-01T19:57:19", "baseScore": 6.1, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H", "references": ["https://git.kernel.org/stable/c/4105dd76bc8ad6529d47157ef0565cb84ca6676c", "https://git.kernel.org/stable/c/594bfc4947c4fcabba1318d8384c61a29a6b89fb"], "aliases": ["CVE-2024-57877"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0b67de6b-6ecb-3a67-a1c2-7eabfe0ddc05", "product": {"name": "Linux"}, "product_version": "6.12"}, {"id": "47392613-0cdc-3117-89dd-2c231134524a", "product": {"name": "Linux"}, "product_version": "17519819926211e6b2834e00e4554bec0daf22ac <594bfc4947c4fcabba1318d8384c61a29a6b89fb"}, {"id": "4a6859cf-6253-3d29-90b5-34d2abf23926", "product": {"name": "Linux"}, "product_version": "17519819926211e6b2834e00e4554bec0daf22ac <4105dd76bc8ad6529d47157ef0565cb84ca6676c"}, {"id": "c527fb00-c745-3493-9fe6-20e9df8cfda3", "product": {"name": "Linux"}, "product_version": "patch: 6.12.5"}, {"id": "dfa80f6e-4cb7-3b5e-bdb9-f68acdc829e4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f405219b-469b-33d7-9af6-333ab45e7571", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}], "enisaIdVendor": [{"id": "e1b88cf2-8d0c-3355-beb2-9e7afe5f5caa", "vendor": {"name": "Linux"}}], "isExploited": false}