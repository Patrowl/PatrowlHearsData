{"id": "EUVD-2024-51883", "enisaUuid": "edc77033-ee4e-3f48-9f31-104cd56601dd", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/l2tp: fix warning in l2tp_exit_net found by syzbot\n\nIn l2tp's net exit handler, we check that an IDR is empty before\ndestroying it:\n\n\tWARN_ON_ONCE(!idr_is_empty(&pn->l2tp_tunnel_idr));\n\tidr_destroy(&pn->l2tp_tunnel_idr);\n\nBy forcing memory allocation failures in idr_alloc_32, syzbot is able\nto provoke a condition where idr_is_empty returns false despite there\nbeing no items in the IDR. This turns out to be because the radix tree\nof the IDR contains only internal radix-tree nodes and it is this that\ncauses idr_is_empty to return false. The internal nodes are cleaned by\nidr_destroy.\n\nUse idr_for_each to check that the IDR is empty instead of\nidr_is_empty to avoid the problem.", "datePublished": "2024-12-27T15:31:51", "dateUpdated": "2025-10-08T15:32:25", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/a487cc8986d6dd75b60b59004f3bd2ea9b4dd541", "https://git.kernel.org/stable/c/5d066766c5f1252f98ff859265bcd1a5b52ac46c", "https://nvd.nist.gov/vuln/detail/CVE-2024-53211"], "aliases": ["CVE-2024-53211"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "03f56c54-6075-37b5-b92a-daeb075b57e5", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "137f95d7-07b6-369d-a28b-0875ea1a9566", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "82fadc84-19df-3cca-b1f4-6cd670c26dcf", "product": {"name": "Linux"}, "product_version": "73d33bd063c4cfef3db17f9bec3d202928ed8631 <a487cc8986d6dd75b60b59004f3bd2ea9b4dd541"}, {"id": "b41c6022-540a-3660-83c2-120929b540b3", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "b6837627-03c4-39ff-b89a-8c500a6cb1f4", "product": {"name": "Linux"}, "product_version": "6.12"}, {"id": "d23c0da4-c7b3-3c97-af2d-ac80d7c358c9", "product": {"name": "Linux"}, "product_version": "73d33bd063c4cfef3db17f9bec3d202928ed8631 <5d066766c5f1252f98ff859265bcd1a5b52ac46c"}], "enisaIdVendor": [{"id": "b10e8a73-cf8c-35cb-b92a-cb2814702f38", "vendor": {"name": "Linux"}}], "isExploited": false}