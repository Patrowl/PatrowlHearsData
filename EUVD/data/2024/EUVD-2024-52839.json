{"id": "EUVD-2024-52839", "enisaUuid": "53b82be9-2438-30e2-a62c-d66d948de85c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: x86: Play nice with protected guests in complete_hypercall_exit()\n\nUse is_64_bit_hypercall() instead of is_64_bit_mode() to detect a 64-bit\nhypercall when completing said hypercall.  For guests with protected state,\ne.g. SEV-ES and SEV-SNP, KVM must assume the hypercall was made in 64-bit\nmode as the vCPU state needed to detect 64-bit mode is unavailable.\n\nHacking the sev_smoke_test selftest to generate a KVM_HC_MAP_GPA_RANGE\nhypercall via VMGEXIT trips the WARN:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 273 PID: 326626 at arch/x86/kvm/x86.h:180 complete_hypercall_exit+0x44/0xe0 [kvm]\n  Modules linked in: kvm_amd kvm ... [last unloaded: kvm]\n  CPU: 273 UID: 0 PID: 326626 Comm: sev_smoke_test Not tainted 6.12.0-smp--392e932fa0f3-feat #470\n  Hardware name: Google Astoria/astoria, BIOS 0.20240617.0-0 06/17/2024\n  RIP: 0010:complete_hypercall_exit+0x44/0xe0 [kvm]\n  Call Trace:\n   <TASK>\n   kvm_arch_vcpu_ioctl_run+0x2400/0x2720 [kvm]\n   kvm_vcpu_ioctl+0x54f/0x630 [kvm]\n   __se_sys_ioctl+0x6b/0xc0\n   do_syscall_64+0x83/0x160\n   entry_SYSCALL_64_after_hwframe+0x76/0x7e\n   </TASK>\n  ---[ end trace 0000000000000000 ]---", "datePublished": "2025-01-11T12:35:44", "dateUpdated": "2025-11-03T20:48:49", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/0840d360a8909c722fb62459f42836afe32ededb", "https://git.kernel.org/stable/c/7ed4db315094963de0678a8adfd43c46471b9349", "https://git.kernel.org/stable/c/3d2634ec0d1dbe8f4b511cf5261f327c6a76f4b6", "https://git.kernel.org/stable/c/22b5c2acd65dbe949032f619d4758a35a82fffc3", "https://git.kernel.org/stable/c/9b42d1e8e4fe9dc631162c04caa69b0d1860b0f0", "https://nvd.nist.gov/vuln/detail/CVE-2024-55881", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html"], "aliases": ["CVE-2024-55881"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "2ba31186-11fd-3c1f-8391-9692bdcff7d9", "product": {"name": "Linux"}, "product_version": "patch: 6.1.122"}, {"id": "2c9ccdde-00ca-3edf-9f24-6f3add69c5c6", "product": {"name": "Linux"}, "product_version": "patch: 6.6.68"}, {"id": "4a613c1a-d885-3821-a7b3-e58661547fa2", "product": {"name": "Linux"}, "product_version": "patch: 5.15.176"}, {"id": "64ff0a63-764f-3987-b687-1add56e90515", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7d1e70a5-5d7c-3faf-b5b1-f563c1419f04", "product": {"name": "Linux"}, "product_version": "b5aead0064f33ae5e693a364e3204fe1c0ac9af2 <9b42d1e8e4fe9dc631162c04caa69b0d1860b0f0"}, {"id": "89dcde86-9454-32f4-a161-7d3f8fa9c699", "product": {"name": "Linux"}, "product_version": "5969e2435cbd7f0ce8c28d717bfc39987ee8d8f1 <0840d360a8909c722fb62459f42836afe32ededb"}, {"id": "a479b148-ee29-35ee-9a13-f606c0cb2ee9", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "ae0e28dd-2be8-3ad5-b632-bb6cdb51f0ae", "product": {"name": "Linux"}, "product_version": "patch: 6.12.7"}, {"id": "c51b7e4e-c555-3731-a386-97e74f2ece9c", "product": {"name": "Linux"}, "product_version": "5.16"}, {"id": "ebb03eab-c8a9-3b74-990e-02fa8c89820f", "product": {"name": "Linux"}, "product_version": "b5aead0064f33ae5e693a364e3204fe1c0ac9af2 <22b5c2acd65dbe949032f619d4758a35a82fffc3"}, {"id": "f1958dfd-ec4a-35bd-b538-a87091ed1bf4", "product": {"name": "Linux"}, "product_version": "b5aead0064f33ae5e693a364e3204fe1c0ac9af2 <7ed4db315094963de0678a8adfd43c46471b9349"}, {"id": "f97eecac-579b-3b3f-9ee8-30e4b17926c1", "product": {"name": "Linux"}, "product_version": "b5aead0064f33ae5e693a364e3204fe1c0ac9af2 <3d2634ec0d1dbe8f4b511cf5261f327c6a76f4b6"}], "enisaIdVendor": [{"id": "33a9ec42-dd6d-3477-bd51-b0604e43c0f8", "vendor": {"name": "Linux"}}], "isExploited": false}