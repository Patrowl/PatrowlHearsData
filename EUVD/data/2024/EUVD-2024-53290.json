{"id": "EUVD-2024-53290", "enisaUuid": "16a75af9-bf82-302e-a38c-bf67e81b4e33", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntipc: Fix use-after-free of kernel socket in cleanup_bearer().\n\nsyzkaller reported a use-after-free of UDP kernel socket\nin cleanup_bearer() without repro. [0][1]\n\nWhen bearer_disable() calls tipc_udp_disable(), cleanup\nof the UDP kernel socket is deferred by work calling\ncleanup_bearer().\n\ntipc_exit_net() waits for such works to finish by checking\ntipc_net(net)->wq_count.  However, the work decrements the\ncount too early before releasing the kernel socket,\nunblocking cleanup_net() and resulting in use-after-free.\n\nLet's move the decrement after releasing the socket in\ncleanup_bearer().\n\n[0]:\nref_tracker: net notrefcnt@000000009b3d1faf has 1/1 users at\n     sk_alloc+0x438/0x608\n     inet_create+0x4c8/0xcb0\n     __sock_create+0x350/0x6b8\n     sock_create_kern+0x58/0x78\n     udp_sock_create4+0x68/0x398\n     udp_sock_create+0x88/0xc8\n     tipc_udp_enable+0x5e8/0x848\n     __tipc_nl_bearer_enable+0x84c/0xed8\n     tipc_nl_bearer_enable+0x38/0x60\n     genl_family_rcv_msg_doit+0x170/0x248\n     genl_rcv_msg+0x400/0x5b0\n     netlink_rcv_skb+0x1dc/0x398\n     genl_rcv+0x44/0x68\n     netlink_unicast+0x678/0x8b0\n     netlink_sendmsg+0x5e4/0x898\n     ____sys_sendmsg+0x500/0x830\n\n[1]:\nBUG: KMSAN: use-after-free in udp_hashslot include/net/udp.h:85 [inline]\nBUG: KMSAN: use-after-free in udp_lib_unhash+0x3b8/0x930 net/ipv4/udp.c:1979\n udp_hashslot include/net/udp.h:85 [inline]\n udp_lib_unhash+0x3b8/0x930 net/ipv4/udp.c:1979\n sk_common_release+0xaf/0x3f0 net/core/sock.c:3820\n inet_release+0x1e0/0x260 net/ipv4/af_inet.c:437\n inet6_release+0x6f/0xd0 net/ipv6/af_inet6.c:489\n __sock_release net/socket.c:658 [inline]\n sock_release+0xa0/0x210 net/socket.c:686\n cleanup_bearer+0x42d/0x4c0 net/tipc/udp_media.c:819\n process_one_work kernel/workqueue.c:3229 [inline]\n process_scheduled_works+0xcaf/0x1c90 kernel/workqueue.c:3310\n worker_thread+0xf6c/0x1510 kernel/workqueue.c:3391\n kthread+0x531/0x6b0 kernel/kthread.c:389\n ret_from_fork+0x60/0x80 arch/x86/kernel/process.c:147\n ret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:244\n\nUninit was created at:\n slab_free_hook mm/slub.c:2269 [inline]\n slab_free mm/slub.c:4580 [inline]\n kmem_cache_free+0x207/0xc40 mm/slub.c:4682\n net_free net/core/net_namespace.c:454 [inline]\n cleanup_net+0x16f2/0x19d0 net/core/net_namespace.c:647\n process_one_work kernel/workqueue.c:3229 [inline]\n process_scheduled_works+0xcaf/0x1c90 kernel/workqueue.c:3310\n worker_thread+0xf6c/0x1510 kernel/workqueue.c:3391\n kthread+0x531/0x6b0 kernel/kthread.c:389\n ret_from_fork+0x60/0x80 arch/x86/kernel/process.c:147\n ret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:244\n\nCPU: 0 UID: 0 PID: 54 Comm: kworker/0:2 Not tainted 6.12.0-rc1-00131-gf66ebf37d69c #7 91723d6f74857f70725e1583cba3cf4adc716cfa\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014\nWorkqueue: events cleanup_bearer", "datePublished": "2024-12-27T15:31:55", "dateUpdated": "2025-11-03T21:31:56", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/4e69457f9dfae67435f3ccf29008768eae860415", "https://git.kernel.org/stable/c/650ee9a22d7a2de8999fac2d45983597a0c22359", "https://git.kernel.org/stable/c/d2a4894f238551eae178904e7f45af87577074fd", "https://git.kernel.org/stable/c/d62d5180c036eeac09f80660edc7a602b369125f", "https://git.kernel.org/stable/c/d00d4470bf8c4282617a3a10e76b20a9c7e4cffa", "https://git.kernel.org/stable/c/e48b211c4c59062cb6dd6c2c37c51a7cc235a464", "https://git.kernel.org/stable/c/6a2fa13312e51a621f652d522d7e2df7066330b6", "https://nvd.nist.gov/vuln/detail/CVE-2024-56642", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-56642"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "0a4fe29b-ba38-30b4-a6d2-48a693f287bd", "product": {"name": "Linux"}, "product_version": "patch: 6.12.5"}, {"id": "1b48a739-8779-386d-aba5-608dc13230d1", "product": {"name": "Linux"}, "product_version": "patch: 6.1.120"}, {"id": "2052fde4-33c9-33cd-b6bc-2ac1e7dff331", "product": {"name": "Linux"}, "product_version": "patch: 6.6.66"}, {"id": "24e2ef24-7d6f-3fc2-bce0-a9120f50c5aa", "product": {"name": "Linux"}, "product_version": "patch: 5.10.231"}, {"id": "25a3172b-84e9-3c90-81c3-01165a2ae640", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "26f80b34-3336-34f3-8939-d3f222f6fdf3", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <d00d4470bf8c4282617a3a10e76b20a9c7e4cffa"}, {"id": "3b69e69c-1819-3a83-8226-b39372c9e23d", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "3eadea33-03f2-3441-99e4-e945e9850db6", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <e48b211c4c59062cb6dd6c2c37c51a7cc235a464"}, {"id": "40b7bc11-6c22-331b-b131-7d40ab32df91", "product": {"name": "Linux"}, "product_version": "4.2"}, {"id": "445bd154-7b6a-3f40-a3a4-cde8d876a760", "product": {"name": "Linux"}, "product_version": "5195ec5e365a2a9331bfeb585b613a6e94f98dba <650ee9a22d7a2de8999fac2d45983597a0c22359"}, {"id": "56caa921-525c-3c30-99ac-5c56d975704d", "product": {"name": "Linux"}, "product_version": "5.13"}, {"id": "5c45f513-774a-31f6-8fa7-2447465d61b1", "product": {"name": "Linux"}, "product_version": "04c26faa51d1e2fe71cf13c45791f5174c37f986 <d62d5180c036eeac09f80660edc7a602b369125f"}, {"id": "69811b20-f341-3832-b607-16c1615efbcf", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <4e69457f9dfae67435f3ccf29008768eae860415"}, {"id": "8545bcda-872e-35cf-b924-5809b9632a5b", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <650ee9a22d7a2de8999fac2d45983597a0c22359"}, {"id": "93c7253c-d0b8-35f7-b9ea-feaef873ec19", "product": {"name": "Linux"}, "product_version": "04c26faa51d1e2fe71cf13c45791f5174c37f986 <d2a4894f238551eae178904e7f45af87577074fd"}, {"id": "94bfeb8f-7bb6-3e2a-9fdf-f57119549f00", "product": {"name": "Linux"}, "product_version": "patch: 5.4.287"}, {"id": "9b4edea2-80a3-3d76-bc2c-2d775583b1d7", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <d2a4894f238551eae178904e7f45af87577074fd"}, {"id": "a42c82c6-cd75-34a7-b799-333de7fe66bc", "product": {"name": "Linux"}, "product_version": "patch: 5.15.174"}, {"id": "b08a540b-d33c-313b-bc3d-57cd5fe40a58", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <6a2fa13312e51a621f652d522d7e2df7066330b6"}, {"id": "b12f4fef-efcb-3c87-a260-a42442351f7f", "product": {"name": "Linux"}, "product_version": "04c26faa51d1e2fe71cf13c45791f5174c37f986 <e48b211c4c59062cb6dd6c2c37c51a7cc235a464"}, {"id": "bd71ac09-49ea-3f8e-b6e2-c956b1f89438", "product": {"name": "Linux"}, "product_version": "b9f5b7ad4ac3af006443f535b1ce7bff1d130d7d"}, {"id": "c5190b0c-9ffd-3ac1-9e5c-6bb4669db432", "product": {"name": "Linux"}, "product_version": "04c26faa51d1e2fe71cf13c45791f5174c37f986 <6a2fa13312e51a621f652d522d7e2df7066330b6"}, {"id": "e49333d8-0118-3adb-a8e0-3af146eb53f2", "product": {"name": "Linux"}, "product_version": "d1f76dfadaf8f47ed1753f97dbcbd41c16215ffa <4e69457f9dfae67435f3ccf29008768eae860415"}, {"id": "f6099b6c-d728-3653-9142-ba2286e9b960", "product": {"name": "Linux"}, "product_version": "04c26faa51d1e2fe71cf13c45791f5174c37f986 <d00d4470bf8c4282617a3a10e76b20a9c7e4cffa"}, {"id": "f7a2844e-487b-3405-8958-a4704c78e926", "product": {"name": "Linux"}, "product_version": "26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe <d62d5180c036eeac09f80660edc7a602b369125f"}], "enisaIdVendor": [{"id": "74c05510-e3e0-307b-9ff5-b7d18513cbd9", "vendor": {"name": "Linux"}}], "isExploited": false}