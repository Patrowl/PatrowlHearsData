{"id": "EUVD-2024-53403", "enisaUuid": "35479baa-ff0c-369b-89f3-a4ffddac19e6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI/MSI: Handle lack of irqdomain gracefully\n\nAlexandre observed a warning emitted from pci_msi_setup_msi_irqs() on a\nRISCV platform which does not provide PCI/MSI support:\n\n WARNING: CPU: 1 PID: 1 at drivers/pci/msi/msi.h:121 pci_msi_setup_msi_irqs+0x2c/0x32\n __pci_enable_msix_range+0x30c/0x596\n pci_msi_setup_msi_irqs+0x2c/0x32\n pci_alloc_irq_vectors_affinity+0xb8/0xe2\n\nRISCV uses hierarchical interrupt domains and correctly does not implement\nthe legacy fallback. The warning triggers from the legacy fallback stub.\n\nThat warning is bogus as the PCI/MSI layer knows whether a PCI/MSI parent\ndomain is associated with the device or not. There is a check for MSI-X,\nwhich has a legacy assumption. But that legacy fallback assumption is only\nvalid when legacy support is enabled, but otherwise the check should simply\nreturn -ENOTSUPP.\n\nLoongarch tripped over the same problem and blindly enabled legacy support\nwithout implementing the legacy fallbacks. There are weak implementations\nwhich return an error, so the problem was papered over.\n\nCorrect pci_msi_domain_supports() to evaluate the legacy mode and add\nthe missing supported check into the MSI enable path to complete it.", "datePublished": "2025-01-06T16:20:40", "dateUpdated": "2025-10-01T20:07:01", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/b1f7476e07b93d65a1a3643dcb4a7bed80d4328d", "https://git.kernel.org/stable/c/aed157301c659a48f5564cc4568cf0e5c8831af0", "https://git.kernel.org/stable/c/a60b990798eb17433d0283788280422b1bd94b18"], "aliases": ["CVE-2024-56760"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0c70b30d-4a8f-3f04-ba4f-143f23f8eeaa", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1ae187c4-4700-3ec1-b54f-123fd3f7e7cb", "product": {"name": "Linux"}, "product_version": "patch: 6.6.69"}, {"id": "36cc2c1a-9420-3fc6-a0ae-11a7df623947", "product": {"name": "Linux"}, "product_version": "d2a463b297415ca6dd4d60bb1c867dd7c931587b <a60b990798eb17433d0283788280422b1bd94b18"}, {"id": "467192c3-72ec-3bfb-a739-f7a2e7d27969", "product": {"name": "Linux"}, "product_version": "d2a463b297415ca6dd4d60bb1c867dd7c931587b <b1f7476e07b93d65a1a3643dcb4a7bed80d4328d"}, {"id": "b4c73d27-d9b2-3d1d-9708-fce93e9e53bd", "product": {"name": "Linux"}, "product_version": "6.2"}, {"id": "d2933b18-378b-3e0a-b2c2-62646bce01a4", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "f836d767-9c9a-3f23-be39-bd61bdf682f7", "product": {"name": "Linux"}, "product_version": "d2a463b297415ca6dd4d60bb1c867dd7c931587b <aed157301c659a48f5564cc4568cf0e5c8831af0"}, {"id": "fe3072ea-ee80-342f-9133-9ffe2b4c7ee3", "product": {"name": "Linux"}, "product_version": "patch: 6.12.8"}], "enisaIdVendor": [{"id": "1069c9da-9a0e-3a7f-9c9d-dec36c6c5f97", "vendor": {"name": "Linux"}}], "isExploited": false}