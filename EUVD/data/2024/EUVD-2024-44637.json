{"id": "EUVD-2024-44637", "enisaUuid": "fb26d44f-0275-30fc-9a24-549bd7c0a603", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnvme-pci: fix race condition between reset and nvme_dev_disable()\n\nnvme_dev_disable() modifies the dev->online_queues field, therefore\nnvme_pci_update_nr_queues() should avoid racing against it, otherwise\nwe could end up passing invalid values to blk_mq_update_nr_hw_queues().\n\n WARNING: CPU: 39 PID: 61303 at drivers/pci/msi/api.c:347\n          pci_irq_get_affinity+0x187/0x210\n Workqueue: nvme-reset-wq nvme_reset_work [nvme]\n RIP: 0010:pci_irq_get_affinity+0x187/0x210\n Call Trace:\n  <TASK>\n  ? blk_mq_pci_map_queues+0x87/0x3c0\n  ? pci_irq_get_affinity+0x187/0x210\n  blk_mq_pci_map_queues+0x87/0x3c0\n  nvme_pci_map_queues+0x189/0x460 [nvme]\n  blk_mq_update_nr_hw_queues+0x2a/0x40\n  nvme_reset_work+0x1be/0x2a0 [nvme]\n\nFix the bug by locking the shutdown_lock mutex before using\ndev->online_queues. Give up if nvme_dev_disable() is running or if\nit has been executed already.", "datePublished": "2024-11-05T17:10:59", "dateUpdated": "2025-10-01T20:27:14", "baseScore": 4.7, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/4ed32cc0939b64e3d7b48c8c0d63ea038775f304", "https://git.kernel.org/stable/c/b33e49a5f254474b33ce98fd45dd0ffdc247a0be", "https://git.kernel.org/stable/c/26bc0a81f64ce00fc4342c38eeb2eddaad084dd2"], "aliases": ["CVE-2024-50135"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0440855a-71ab-3793-a572-5b0f8829f9f3", "product": {"name": "Linux"}, "product_version": "4.6"}, {"id": "1507b27f-3f5b-3c04-9d9d-bf0668c081d1", "product": {"name": "Linux"}, "product_version": "949928c1c731417cc0f070912c63878b62b544f4 <b33e49a5f254474b33ce98fd45dd0ffdc247a0be"}, {"id": "258e7c77-ce68-32aa-9cd0-e891cd1a9fb5", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "6a581802-6965-3d68-9464-f736b1c8e113", "product": {"name": "Linux"}, "product_version": "patch: 6.6.59"}, {"id": "87788d47-7cab-321e-af20-abb08a1b7571", "product": {"name": "Linux"}, "product_version": "949928c1c731417cc0f070912c63878b62b544f4 <26bc0a81f64ce00fc4342c38eeb2eddaad084dd2"}, {"id": "e0e8e838-e4b3-3fe1-826b-944457642646", "product": {"name": "Linux"}, "product_version": "949928c1c731417cc0f070912c63878b62b544f4 <4ed32cc0939b64e3d7b48c8c0d63ea038775f304"}, {"id": "f023a931-b5a8-3a65-9116-64ce61848f27", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "ff4c9ccc-beff-3246-a766-2c3d2f2676a9", "product": {"name": "Linux"}, "product_version": "patch: 6.11.6"}], "enisaIdVendor": [{"id": "9845c2e3-e1e6-31b3-82b9-922791171560", "vendor": {"name": "Linux"}}], "isExploited": false}