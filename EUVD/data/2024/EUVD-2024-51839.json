{"id": "EUVD-2024-51839", "enisaUuid": "b7186e26-da3d-3acd-b8d9-02031cbcd7ea", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnfs/blocklayout: Don't attempt unregister for invalid block device\n\nSince commit d869da91cccb (\"nfs/blocklayout: Fix premature PR key\nunregistration\") an unmount of a pNFS SCSI layout-enabled NFS may\ndereference a NULL block_device in:\n\n  bl_unregister_scsi+0x16/0xe0 [blocklayoutdriver]\n  bl_free_device+0x70/0x80 [blocklayoutdriver]\n  bl_free_deviceid_node+0x12/0x30 [blocklayoutdriver]\n  nfs4_put_deviceid_node+0x60/0xc0 [nfsv4]\n  nfs4_deviceid_purge_client+0x132/0x190 [nfsv4]\n  unset_pnfs_layoutdriver+0x59/0x60 [nfsv4]\n  nfs4_destroy_server+0x36/0x70 [nfsv4]\n  nfs_free_server+0x23/0xe0 [nfs]\n  deactivate_locked_super+0x30/0xb0\n  cleanup_mnt+0xba/0x150\n  task_work_run+0x59/0x90\n  syscall_exit_to_user_mode+0x217/0x220\n  do_syscall_64+0x8e/0x160\n\nThis happens because even though we were able to create the\nnfs4_deviceid_node, the lookup for the device was unable to attach the\nblock device to the pnfs_block_dev.\n\nIf we never found a block device to register, we can avoid this case with\nthe PNFS_BDEV_REGISTERED flag.  Move the deref behind the test for the\nflag.", "datePublished": "2024-12-27T15:31:50", "dateUpdated": "2025-10-08T15:32:24", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3402704a424f34bbcca7f4a4503859357f422217", "https://git.kernel.org/stable/c/faa4bacfaeed827a4ca8cb8529a3ce65a9e8ef46", "https://git.kernel.org/stable/c/3a4ce14d9a6b868e0787e4582420b721c04ee41e", "https://nvd.nist.gov/vuln/detail/CVE-2024-53167"], "aliases": ["CVE-2024-53167"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "26555dbe-1cbe-30a5-8066-4558ecb6cc8c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "3b7e0be2-052d-3390-b44e-c4c4bb5852ec", "product": {"name": "Linux"}, "product_version": "d869da91cccb90320e101a2758f1e2b3803ade5c <3402704a424f34bbcca7f4a4503859357f422217"}, {"id": "43b28914-223d-33f7-870d-f36c77c58996", "product": {"name": "Linux"}, "product_version": "d869da91cccb90320e101a2758f1e2b3803ade5c <faa4bacfaeed827a4ca8cb8529a3ce65a9e8ef46"}, {"id": "58273ff9-5f48-343a-8209-95fb64b0e9e0", "product": {"name": "Linux"}, "product_version": "6.11"}, {"id": "90402dea-c69a-3893-8175-3bcf7136f33e", "product": {"name": "Linux"}, "product_version": "patch: 6.11.11"}, {"id": "c7ecfb80-6d3f-3d75-815f-9a826638c9cf", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "f1909cdb-3b4e-316d-b5d0-76aea996ceaa", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "f1dfe2d9-03b8-3039-9fa8-9ba732e657ee", "product": {"name": "Linux"}, "product_version": "d869da91cccb90320e101a2758f1e2b3803ade5c <3a4ce14d9a6b868e0787e4582420b721c04ee41e"}], "enisaIdVendor": [{"id": "a5652587-a299-3a00-8f82-658b6b4118df", "vendor": {"name": "Linux"}}], "isExploited": false}