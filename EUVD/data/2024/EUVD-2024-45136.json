{"id": "EUVD-2024-45136", "enisaUuid": "0f085a19-e0f4-3494-9154-ce2e5f3911cc", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntty: n_gsm: Fix use-after-free in gsm_cleanup_mux\n\nBUG: KASAN: slab-use-after-free in gsm_cleanup_mux+0x77b/0x7b0\ndrivers/tty/n_gsm.c:3160 [n_gsm]\nRead of size 8 at addr ffff88815fe99c00 by task poc/3379\nCPU: 0 UID: 0 PID: 3379 Comm: poc Not tainted 6.11.0+ #56\nHardware name: VMware, Inc. VMware Virtual Platform/440BX\nDesktop Reference Platform, BIOS 6.00 11/12/2020\nCall Trace:\n <TASK>\n gsm_cleanup_mux+0x77b/0x7b0 drivers/tty/n_gsm.c:3160 [n_gsm]\n __pfx_gsm_cleanup_mux+0x10/0x10 drivers/tty/n_gsm.c:3124 [n_gsm]\n __pfx_sched_clock_cpu+0x10/0x10 kernel/sched/clock.c:389\n update_load_avg+0x1c1/0x27b0 kernel/sched/fair.c:4500\n __pfx_min_vruntime_cb_rotate+0x10/0x10 kernel/sched/fair.c:846\n __rb_insert_augmented+0x492/0xbf0 lib/rbtree.c:161\n gsmld_ioctl+0x395/0x1450 drivers/tty/n_gsm.c:3408 [n_gsm]\n _raw_spin_lock_irqsave+0x92/0xf0 arch/x86/include/asm/atomic.h:107\n __pfx_gsmld_ioctl+0x10/0x10 drivers/tty/n_gsm.c:3822 [n_gsm]\n ktime_get+0x5e/0x140 kernel/time/timekeeping.c:195\n ldsem_down_read+0x94/0x4e0 arch/x86/include/asm/atomic64_64.h:79\n __pfx_ldsem_down_read+0x10/0x10 drivers/tty/tty_ldsem.c:338\n __pfx_do_vfs_ioctl+0x10/0x10 fs/ioctl.c:805\n tty_ioctl+0x643/0x1100 drivers/tty/tty_io.c:2818\n\nAllocated by task 65:\n gsm_data_alloc.constprop.0+0x27/0x190 drivers/tty/n_gsm.c:926 [n_gsm]\n gsm_send+0x2c/0x580 drivers/tty/n_gsm.c:819 [n_gsm]\n gsm1_receive+0x547/0xad0 drivers/tty/n_gsm.c:3038 [n_gsm]\n gsmld_receive_buf+0x176/0x280 drivers/tty/n_gsm.c:3609 [n_gsm]\n tty_ldisc_receive_buf+0x101/0x1e0 drivers/tty/tty_buffer.c:391\n tty_port_default_receive_buf+0x61/0xa0 drivers/tty/tty_port.c:39\n flush_to_ldisc+0x1b0/0x750 drivers/tty/tty_buffer.c:445\n process_scheduled_works+0x2b0/0x10d0 kernel/workqueue.c:3229\n worker_thread+0x3dc/0x950 kernel/workqueue.c:3391\n kthread+0x2a3/0x370 kernel/kthread.c:389\n ret_from_fork+0x2d/0x70 arch/x86/kernel/process.c:147\n ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:257\n\nFreed by task 3367:\n kfree+0x126/0x420 mm/slub.c:4580\n gsm_cleanup_mux+0x36c/0x7b0 drivers/tty/n_gsm.c:3160 [n_gsm]\n gsmld_ioctl+0x395/0x1450 drivers/tty/n_gsm.c:3408 [n_gsm]\n tty_ioctl+0x643/0x1100 drivers/tty/tty_io.c:2818\n\n[Analysis]\ngsm_msg on the tx_ctrl_list or tx_data_list of gsm_mux\ncan be freed by multi threads through ioctl,which leads\nto the occurrence of uaf. Protect it by gsm tx lock.", "datePublished": "2024-10-29T00:50:15", "dateUpdated": "2025-11-03T22:25:08", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/bf171b5e86e41de4c1cf32fb7aefa275c3d7de49", "https://git.kernel.org/stable/c/c29f192e0d44cc1cbaf698fa1ff198f63556691a", "https://git.kernel.org/stable/c/0eec592c6a7460ba795d7de29f3dc95cb5422e62", "https://git.kernel.org/stable/c/9462f4ca56e7d2430fdb6dcc8498244acbfc4489", "https://nvd.nist.gov/vuln/detail/CVE-2024-50073", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50073"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "56cb3d59-405f-308a-9d59-2de9e10716c9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bf171b5e86e41de4c1cf32fb7aefa275c3d7de49"}, {"id": "5dce8b01-d09f-307d-8c01-71936bbda1e6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0eec592c6a7460ba795d7de29f3dc95cb5422e62"}, {"id": "5df308e9-2114-3677-99af-607d0abdd493", "product": {"name": "Linux"}, "product_version": "patch: 6.11.5"}, {"id": "6a061925-b658-30e8-8988-6f9f564e620b", "product": {"name": "Linux"}, "product_version": "patch: 6.1.114"}, {"id": "7b3ca4f6-2ea3-30d7-9492-004b6ace7c6d", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "8a7927bd-ea7b-38fd-b34d-e154129e6f50", "product": {"name": "Linux"}, "product_version": "patch: 6.6.58"}, {"id": "962c3484-24fd-395e-91c0-b1fb9be1412e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9462f4ca56e7d2430fdb6dcc8498244acbfc4489"}, {"id": "dabb38ae-03c9-31ae-91b7-aecbe1a46de3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c29f192e0d44cc1cbaf698fa1ff198f63556691a"}], "enisaIdVendor": [{"id": "29410370-874b-3edf-8d13-05e3e68cc457", "vendor": {"name": "Linux"}}], "isExploited": false}