{"id": "EUVD-2024-45168", "enisaUuid": "388f787d-61e0-35dc-acec-c8593ac54bbf", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmacsec: Fix use-after-free while sending the offloading packet\n\nKASAN reports the following UAF. The metadata_dst, which is used to\nstore the SCI value for macsec offload, is already freed by\nmetadata_dst_free() in macsec_free_netdev(), while driver still use it\nfor sending the packet.\n\nTo fix this issue, dst_release() is used instead to release\nmetadata_dst. So it is not freed instantly in macsec_free_netdev() if\nstill referenced by skb.\n\n BUG: KASAN: slab-use-after-free in mlx5e_xmit+0x1e8f/0x4190 [mlx5_core]\n Read of size 2 at addr ffff88813e42e038 by task kworker/7:2/714\n [...]\n Workqueue: mld mld_ifc_work\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0x51/0x60\n  print_report+0xc1/0x600\n  kasan_report+0xab/0xe0\n  mlx5e_xmit+0x1e8f/0x4190 [mlx5_core]\n  dev_hard_start_xmit+0x120/0x530\n  sch_direct_xmit+0x149/0x11e0\n  __qdisc_run+0x3ad/0x1730\n  __dev_queue_xmit+0x1196/0x2ed0\n  vlan_dev_hard_start_xmit+0x32e/0x510 [8021q]\n  dev_hard_start_xmit+0x120/0x530\n  __dev_queue_xmit+0x14a7/0x2ed0\n  macsec_start_xmit+0x13e9/0x2340\n  dev_hard_start_xmit+0x120/0x530\n  __dev_queue_xmit+0x14a7/0x2ed0\n  ip6_finish_output2+0x923/0x1a70\n  ip6_finish_output+0x2d7/0x970\n  ip6_output+0x1ce/0x3a0\n  NF_HOOK.constprop.0+0x15f/0x190\n  mld_sendpack+0x59a/0xbd0\n  mld_ifc_work+0x48a/0xa80\n  process_one_work+0x5aa/0xe50\n  worker_thread+0x79c/0x1290\n  kthread+0x28f/0x350\n  ret_from_fork+0x2d/0x70\n  ret_from_fork_asm+0x11/0x20\n  </TASK>\n\n Allocated by task 3922:\n  kasan_save_stack+0x20/0x40\n  kasan_save_track+0x10/0x30\n  __kasan_kmalloc+0x77/0x90\n  __kmalloc_noprof+0x188/0x400\n  metadata_dst_alloc+0x1f/0x4e0\n  macsec_newlink+0x914/0x1410\n  __rtnl_newlink+0xe08/0x15b0\n  rtnl_newlink+0x5f/0x90\n  rtnetlink_rcv_msg+0x667/0xa80\n  netlink_rcv_skb+0x12c/0x360\n  netlink_unicast+0x551/0x770\n  netlink_sendmsg+0x72d/0xbd0\n  __sock_sendmsg+0xc5/0x190\n  ____sys_sendmsg+0x52e/0x6a0\n  ___sys_sendmsg+0xeb/0x170\n  __sys_sendmsg+0xb5/0x140\n  do_syscall_64+0x4c/0x100\n  entry_SYSCALL_64_after_hwframe+0x4b/0x53\n\n Freed by task 4011:\n  kasan_save_stack+0x20/0x40\n  kasan_save_track+0x10/0x30\n  kasan_save_free_info+0x37/0x50\n  poison_slab_object+0x10c/0x190\n  __kasan_slab_free+0x11/0x30\n  kfree+0xe0/0x290\n  macsec_free_netdev+0x3f/0x140\n  netdev_run_todo+0x450/0xc70\n  rtnetlink_rcv_msg+0x66f/0xa80\n  netlink_rcv_skb+0x12c/0x360\n  netlink_unicast+0x551/0x770\n  netlink_sendmsg+0x72d/0xbd0\n  __sock_sendmsg+0xc5/0x190\n  ____sys_sendmsg+0x52e/0x6a0\n  ___sys_sendmsg+0xeb/0x170\n  __sys_sendmsg+0xb5/0x140\n  do_syscall_64+0x4c/0x100\n  entry_SYSCALL_64_after_hwframe+0x4b/0x53", "datePublished": "2024-11-09T10:15:14", "dateUpdated": "2025-11-03T22:27:40", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/872932cf75cf859804370a265dd58118129386fa", "https://git.kernel.org/stable/c/9f5ae743dbe9a2458540a7d35fff0f990df025cf", "https://git.kernel.org/stable/c/4614640f1d5c93c22272117dc256e9940ccac8e8", "https://git.kernel.org/stable/c/f1e54d11b210b53d418ff1476c6b58a2f434dfc0", "https://nvd.nist.gov/vuln/detail/CVE-2024-50261", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50261"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0f6e9a6f-8969-3939-9729-e6bf0d69ba83", "product": {"name": "Linux"}, "product_version": "0a28bfd4971fd570d1f3e4653b21415becefc92c <4614640f1d5c93c22272117dc256e9940ccac8e8"}, {"id": "331f6829-a319-3999-ad3d-701c9953ff58", "product": {"name": "Linux"}, "product_version": "0a28bfd4971fd570d1f3e4653b21415becefc92c <872932cf75cf859804370a265dd58118129386fa"}, {"id": "34426d9f-49aa-380e-a2da-111816bbab99", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "35d8c532-5f21-3781-9b7e-e9cd2cdcd18a", "product": {"name": "Linux"}, "product_version": "0a28bfd4971fd570d1f3e4653b21415becefc92c <f1e54d11b210b53d418ff1476c6b58a2f434dfc0"}, {"id": "56c951db-b55c-3a7b-8abc-2137002b3fdc", "product": {"name": "Linux"}, "product_version": "patch: 6.1.116"}, {"id": "6d04a5e8-3668-391f-b946-225932358dba", "product": {"name": "Linux"}, "product_version": "0a28bfd4971fd570d1f3e4653b21415becefc92c <9f5ae743dbe9a2458540a7d35fff0f990df025cf"}, {"id": "a0ffa0bf-9784-341f-8e60-cc85518b403b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "cdad907c-412c-3b63-ae69-ff8bb27f1354", "product": {"name": "Linux"}, "product_version": "patch: 6.11.7"}, {"id": "e781ab6b-fdf6-3782-824b-a7adc4d6af2e", "product": {"name": "Linux"}, "product_version": "patch: 6.6.60"}, {"id": "ece523fd-2745-3133-ba4d-9ea8c4953f08", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}], "enisaIdVendor": [{"id": "44ebd3e9-b543-3673-a2df-5e45374e3f5a", "vendor": {"name": "Linux"}}], "isExploited": false}