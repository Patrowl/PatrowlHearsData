{"id": "EUVD-2024-53295", "enisaUuid": "a7fbbd88-6b1d-3e84-8952-46313fbb26b2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: Fix icmp host relookup triggering ip_rt_bug\n\narp link failure may trigger ip_rt_bug while xfrm enabled, call trace is:\n\nWARNING: CPU: 0 PID: 0 at net/ipv4/route.c:1241 ip_rt_bug+0x14/0x20\nModules linked in:\nCPU: 0 UID: 0 PID: 0 Comm: swapper/0 Not tainted 6.12.0-rc6-00077-g2e1b3cc9d7f7\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996),\nBIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nRIP: 0010:ip_rt_bug+0x14/0x20\nCall Trace:\n <IRQ>\n ip_send_skb+0x14/0x40\n __icmp_send+0x42d/0x6a0\n ipv4_link_failure+0xe2/0x1d0\n arp_error_report+0x3c/0x50\n neigh_invalidate+0x8d/0x100\n neigh_timer_handler+0x2e1/0x330\n call_timer_fn+0x21/0x120\n __run_timer_base.part.0+0x1c9/0x270\n run_timer_softirq+0x4c/0x80\n handle_softirqs+0xac/0x280\n irq_exit_rcu+0x62/0x80\n sysvec_apic_timer_interrupt+0x77/0x90\n\nThe script below reproduces this scenario:\nip xfrm policy add src 0.0.0.0/0 dst 0.0.0.0/0 \\\n\tdir out priority 0 ptype main flag localok icmp\nip l a veth1 type veth\nip a a 192.168.141.111/24 dev veth0\nip l s veth0 up\nping 192.168.141.155 -c 1\n\nicmp_route_lookup() create input routes for locally generated packets\nwhile xfrm relookup ICMP traffic.Then it will set input route\n(dst->out = ip_rt_bug) to skb for DESTUNREACH.\n\nFor ICMP err triggered by locally generated packets, dst->dev of output\nroute is loopback. Generally, xfrm relookup verification is not required\non loopback interfaces (net.ipv4.conf.lo.disable_xfrm = 1).\n\nSkip icmp relookup for locally generated packets to fix it.", "datePublished": "2024-12-27T15:02:47", "dateUpdated": "2025-10-01T20:07:11", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/9545011e7b2a8fc0cbd6e387a09f12cd41d7d82f", "https://git.kernel.org/stable/c/c44daa7e3c73229f7ac74985acb8c7fb909c4e0a"], "aliases": ["CVE-2024-56647"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "20192930-7127-34bb-956e-0ecfa5ad9b69", "product": {"name": "Linux"}, "product_version": "patch: 6.12.5"}, {"id": "30b15440-5e46-3d95-9d70-46725d06ad40", "product": {"name": "Linux"}, "product_version": "2.6.25"}, {"id": "5beac5a0-70e9-357f-9be3-9ef02a5abf1a", "product": {"name": "Linux"}, "product_version": "8b7817f3a959ed99d7443afc12f78a7e1fcc2063 <9545011e7b2a8fc0cbd6e387a09f12cd41d7d82f"}, {"id": "672063b7-c28d-3095-a792-d8a1e4927624", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "99f62a30-bf7e-3aaa-aca1-dd581d5ef93d", "product": {"name": "Linux"}, "product_version": "8b7817f3a959ed99d7443afc12f78a7e1fcc2063 <c44daa7e3c73229f7ac74985acb8c7fb909c4e0a"}, {"id": "e82855db-b988-3693-abb8-13a2fa83f7ac", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "4b3510cb-50bb-3f4d-8df2-a45b1aa90952", "vendor": {"name": "Linux"}}], "isExploited": false}