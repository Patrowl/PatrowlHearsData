{"id": "EUVD-2024-24267", "enisaUuid": "d1c1ec64-beef-32d1-a2dc-6b46eac588a2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ninterconnect: Don't access req_list while it's being manipulated\n\nThe icc_lock mutex was split into separate icc_lock and icc_bw_lock\nmutexes in [1] to avoid lockdep splats. However, this didn't adequately\nprotect access to icc_node::req_list.\n\nThe icc_set_bw() function will eventually iterate over req_list while\nonly holding icc_bw_lock, but req_list can be modified while only\nholding icc_lock. This causes races between icc_set_bw(), of_icc_get(),\nand icc_put().\n\nExample A:\n\n  CPU0                               CPU1\n  ----                               ----\n  icc_set_bw(path_a)\n    mutex_lock(&icc_bw_lock);\n                                     icc_put(path_b)\n                                       mutex_lock(&icc_lock);\n    aggregate_requests()\n      hlist_for_each_entry(r, ...\n                                       hlist_del(...\n        <r = invalid pointer>\n\nExample B:\n\n  CPU0                               CPU1\n  ----                               ----\n  icc_set_bw(path_a)\n    mutex_lock(&icc_bw_lock);\n                                     path_b = of_icc_get()\n                                       of_icc_get_by_index()\n                                         mutex_lock(&icc_lock);\n                                         path_find()\n                                           path_init()\n    aggregate_requests()\n      hlist_for_each_entry(r, ...\n                                             hlist_add_head(...\n        <r = invalid pointer>\n\nFix this by ensuring icc_bw_lock is always held before manipulating\nicc_node::req_list. The additional places icc_bw_lock is held don't\nperform any memory allocations, so we should still be safe from the\noriginal lockdep splats that motivated the separate locks.\n\n[1] commit af42269c3523 (\"interconnect: Fix locking for runpm vs reclaim\")", "datePublished": "2024-05-01T05:28:59", "dateUpdated": "2025-12-23T16:40:04", "baseScore": 6.3, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:H", "references": ["https://git.kernel.org/stable/c/d0d04efa2e367921654b5106cc5c05e3757c2b42", "https://git.kernel.org/stable/c/4c65507121ea8e0b47fae6d2049c8688390d46b6", "https://git.kernel.org/stable/c/de1bf25b6d771abdb52d43546cf57ad775fb68a1", "https://nvd.nist.gov/vuln/detail/CVE-2024-27005", "https://git.kernel.org/stable/c/19ec82b3cad1abef2a929262b8c1528f4e0c192d", "https://git.kernel.org/stable/c/fe549d8e976300d0dd75bd904eb216bed8b145e0", "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EZ6PJW7VOZ224TD7N4JZNU6KV32ZJ53", "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DAMSOZXJEPUOXW33WZYWCVAY7Z5S7OOY", "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GCBZZEC7L7KTWWAS2NLJK6SO3IZIL4WW"], "aliases": ["CVE-2024-27005"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "05021061-e1a1-3942-a34f-0716fe8d8768", "product": {"name": "Linux"}, "product_version": "af42269c3523492d71ebbe11fefae2653e9cdc78 <4c65507121ea8e0b47fae6d2049c8688390d46b6"}, {"id": "08ce562a-ac54-3256-811f-1c7891d204fe", "product": {"name": "Linux"}, "product_version": "6.6"}, {"id": "0ac4e25a-99b0-361f-8f79-75fac69cc4da", "product": {"name": "Linux"}, "product_version": "2f3a124696d43de3c837f87a9f767c56ee86cf2a"}, {"id": "10017fd4-f478-339e-8805-a77616108178", "product": {"name": "Linux"}, "product_version": "af42269c3523492d71ebbe11fefae2653e9cdc78 <d0d04efa2e367921654b5106cc5c05e3757c2b42"}, {"id": "2d6e6c3b-803f-35c1-bf56-be2b26b2f769", "product": {"name": "Linux"}, "product_version": "9be2957f014d91088db1eb5dd09d9a03d7184dce <fe549d8e976300d0dd75bd904eb216bed8b145e0"}, {"id": "3ad342cf-79be-3696-8fbb-ddd80bb0a157", "product": {"name": "Linux"}, "product_version": "ee42bfc791aa3cd78e29046f26a09d189beb3efb <19ec82b3cad1abef2a929262b8c1528f4e0c192d"}, {"id": "3e392538-9d34-3c8b-9224-cf9279586d7d", "product": {"name": "Linux"}, "product_version": "patch: 6.8.8"}, {"id": "3f5dc3d5-6b7d-3eb9-a72f-67659ae5f722", "product": {"name": "Linux"}, "product_version": "patch: 6.6.29"}, {"id": "3fe79b22-d7ca-3c77-93ba-6ba0bac107a0", "product": {"name": "Linux"}, "product_version": "patch: 6.1.81"}, {"id": "78983304-5381-34a5-922a-9f7560187198", "product": {"name": "Linux"}, "product_version": "af42269c3523492d71ebbe11fefae2653e9cdc78 <de1bf25b6d771abdb52d43546cf57ad775fb68a1"}, {"id": "797a2500-fa10-3748-be7a-1beb852dbdd3", "product": {"name": "Linux"}, "product_version": "patch: 6.9"}, {"id": "b5bf19aa-718b-3d86-9470-a254af632cff", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "eedfb408-d60f-359e-b716-cf6d6a03483b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.151"}], "enisaIdVendor": [{"id": "e5763643-9c3a-38dd-ae05-7d0d89762340", "vendor": {"name": "Linux"}}], "isExploited": false}