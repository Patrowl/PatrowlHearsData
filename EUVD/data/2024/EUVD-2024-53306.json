{"id": "EUVD-2024-53306", "enisaUuid": "8a7a1aa8-ef8f-30c1-ba43-ef3930fbc9f4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: defer final 'struct net' free in netns dismantle\n\nIlya reported a slab-use-after-free in dst_destroy [1]\n\nIssue is in xfrm6_net_init() and xfrm4_net_init() :\n\nThey copy xfrm[46]_dst_ops_template into net->xfrm.xfrm[46]_dst_ops.\n\nBut net structure might be freed before all the dst callbacks are\ncalled. So when dst_destroy() calls later :\n\nif (dst->ops->destroy)\n    dst->ops->destroy(dst);\n\ndst->ops points to the old net->xfrm.xfrm[46]_dst_ops, which has been freed.\n\nSee a relevant issue fixed in :\n\nac888d58869b (\"net: do not delay dst_entries_add() in dst_release()\")\n\nA fix is to queue the 'struct net' to be freed after one\nanother cleanup_net() round (and existing rcu_barrier())\n\n[1]\n\nBUG: KASAN: slab-use-after-free in dst_destroy (net/core/dst.c:112)\nRead of size 8 at addr ffff8882137ccab0 by task swapper/37/0\nDec 03 05:46:18 kernel:\nCPU: 37 UID: 0 PID: 0 Comm: swapper/37 Kdump: loaded Not tainted 6.12.0 #67\nHardware name: Red Hat KVM/RHEL, BIOS 1.16.1-1.el9 04/01/2014\nCall Trace:\n <IRQ>\ndump_stack_lvl (lib/dump_stack.c:124)\nprint_address_description.constprop.0 (mm/kasan/report.c:378)\n? dst_destroy (net/core/dst.c:112)\nprint_report (mm/kasan/report.c:489)\n? dst_destroy (net/core/dst.c:112)\n? kasan_addr_to_slab (mm/kasan/common.c:37)\nkasan_report (mm/kasan/report.c:603)\n? dst_destroy (net/core/dst.c:112)\n? rcu_do_batch (kernel/rcu/tree.c:2567)\ndst_destroy (net/core/dst.c:112)\nrcu_do_batch (kernel/rcu/tree.c:2567)\n? __pfx_rcu_do_batch (kernel/rcu/tree.c:2491)\n? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4339 kernel/locking/lockdep.c:4406)\nrcu_core (kernel/rcu/tree.c:2825)\nhandle_softirqs (kernel/softirq.c:554)\n__irq_exit_rcu (kernel/softirq.c:589 kernel/softirq.c:428 kernel/softirq.c:637)\nirq_exit_rcu (kernel/softirq.c:651)\nsysvec_apic_timer_interrupt (arch/x86/kernel/apic/apic.c:1049 arch/x86/kernel/apic/apic.c:1049)\n </IRQ>\n <TASK>\nasm_sysvec_apic_timer_interrupt (./arch/x86/include/asm/idtentry.h:702)\nRIP: 0010:default_idle (./arch/x86/include/asm/irqflags.h:37 ./arch/x86/include/asm/irqflags.h:92 arch/x86/kernel/process.c:743)\nCode: 00 4d 29 c8 4c 01 c7 4c 29 c2 e9 6e ff ff ff 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 66 90 0f 00 2d c7 c9 27 00 fb f4 <fa> c3 cc cc cc cc 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 90\nRSP: 0018:ffff888100d2fe00 EFLAGS: 00000246\nRAX: 00000000001870ed RBX: 1ffff110201a5fc2 RCX: ffffffffb61a3e46\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffffffb3d4d123\nRBP: 0000000000000000 R08: 0000000000000001 R09: ffffed11c7e1835d\nR10: ffff888e3f0c1aeb R11: 0000000000000000 R12: 0000000000000000\nR13: ffff888100d20000 R14: dffffc0000000000 R15: 0000000000000000\n? ct_kernel_exit.constprop.0 (kernel/context_tracking.c:148)\n? cpuidle_idle_call (kernel/sched/idle.c:186)\ndefault_idle_call (./include/linux/cpuidle.h:143 kernel/sched/idle.c:118)\ncpuidle_idle_call (kernel/sched/idle.c:186)\n? __pfx_cpuidle_idle_call (kernel/sched/idle.c:168)\n? lock_release (kernel/locking/lockdep.c:467 kernel/locking/lockdep.c:5848)\n? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4347 kernel/locking/lockdep.c:4406)\n? tsc_verify_tsc_adjust (arch/x86/kernel/tsc_sync.c:59)\ndo_idle (kernel/sched/idle.c:326)\ncpu_startup_entry (kernel/sched/idle.c:423 (discriminator 1))\nstart_secondary (arch/x86/kernel/smpboot.c:202 arch/x86/kernel/smpboot.c:282)\n? __pfx_start_secondary (arch/x86/kernel/smpboot.c:232)\n? soft_restart_cpu (arch/x86/kernel/head_64.S:452)\ncommon_startup_64 (arch/x86/kernel/head_64.S:414)\n </TASK>\nDec 03 05:46:18 kernel:\nAllocated by task 12184:\nkasan_save_stack (mm/kasan/common.c:48)\nkasan_save_track (./arch/x86/include/asm/current.h:49 mm/kasan/common.c:60 mm/kasan/common.c:69)\n__kasan_slab_alloc (mm/kasan/common.c:319 mm/kasan/common.c:345)\nkmem_cache_alloc_noprof (mm/slub.c:4085 mm/slub.c:4134 mm/slub.c:4141)\ncopy_net_ns (net/core/net_namespace.c:421 net/core/net_namespace.c:480)\ncreate_new_namespaces\n---truncated---", "datePublished": "2024-12-27T15:31:56", "dateUpdated": "2025-11-03T21:31:58", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/3267b254dc0a04dfa362a2be24573cfa6d2d78f5", "https://git.kernel.org/stable/c/b7a79e51297f7b82adb687086f5cb2da446f1e40", "https://git.kernel.org/stable/c/6610c7f8a8d47fd1123eed55ba8c11c2444d8842", "https://git.kernel.org/stable/c/0f6ede9fbc747e2553612271bce108f7517e7a45", "https://git.kernel.org/stable/c/c261dcd61c9e88a8f1a66654354d32295a975230", "https://git.kernel.org/stable/c/dac465986a4a38cd2f13e934f562b6ca344e5720", "https://nvd.nist.gov/vuln/detail/CVE-2024-56658", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html"], "aliases": ["CVE-2024-56658"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "12490375-b737-342c-b6c2-f413ee338e54", "product": {"name": "Linux"}, "product_version": "eeca98948d8c4922e6deb16bfc9ee0bd9902dbb0"}, {"id": "14767146-c5e5-3a55-a922-c3a8a38e41fb", "product": {"name": "Linux"}, "product_version": "1bd631fc9a4515878c1bb7effd19335d2f2d87c2"}, {"id": "1c3f8df1-dcc0-3aa4-9710-935849c25cf3", "product": {"name": "Linux"}, "product_version": "patch: 6.12.6"}, {"id": "36b5131a-823b-32e8-9144-0fe10f1155f9", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "3fdfb790-9367-3dd7-9006-4782e4fa30ac", "product": {"name": "Linux"}, "product_version": "3e29fa5b742479f73400468314a1c6b9cf553ee4"}, {"id": "44888778-4b48-3afc-9b70-f2d93cd75dd3", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <b7a79e51297f7b82adb687086f5cb2da446f1e40"}, {"id": "534ac08b-0007-3376-a3be-b51e9fdab774", "product": {"name": "Linux"}, "product_version": "patch: 5.15.181"}, {"id": "5c030396-fac9-39ad-bbbf-f55cf02a0b59", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7e303bd9-b861-32c9-b91b-5d38f5642123", "product": {"name": "Linux"}, "product_version": "4.4"}, {"id": "80fd5fe4-356b-3ecf-b4a3-69074d293a0a", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <3267b254dc0a04dfa362a2be24573cfa6d2d78f5"}, {"id": "9df7493f-1db4-36df-85ce-a35022b1996c", "product": {"name": "Linux"}, "product_version": "ce43f6a650a6689551a217276fb0dcca33790425"}, {"id": "9e65a800-d70d-3306-ab71-9d13f1435ad9", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <dac465986a4a38cd2f13e934f562b6ca344e5720"}, {"id": "9e9b2530-8208-31a5-97e6-714e83053dc2", "product": {"name": "Linux"}, "product_version": "patch: 5.10.237"}, {"id": "a1f88949-61c7-39cd-b86f-4b5dc1a2dcbc", "product": {"name": "Linux"}, "product_version": "patch: 6.6.67"}, {"id": "ab1255f1-8fd1-3d54-9d6a-75f4d8b79b47", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <c261dcd61c9e88a8f1a66654354d32295a975230"}, {"id": "af5de616-4acb-3686-a465-5325288c2398", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <6610c7f8a8d47fd1123eed55ba8c11c2444d8842"}, {"id": "b4e73362-44fc-30af-9d97-e1c66d3db8c2", "product": {"name": "Linux"}, "product_version": "a8a572a6b5f2a79280d6e302cb3c1cb1fbaeb3e8 <0f6ede9fbc747e2553612271bce108f7517e7a45"}, {"id": "b694972e-1c5e-3cf9-bcc1-5853473c0c5c", "product": {"name": "Linux"}, "product_version": "patch: 6.1.121"}], "enisaIdVendor": [{"id": "ad44969a-ac16-364f-ba1a-dd21116dfb7d", "vendor": {"name": "Linux"}}], "isExploited": false}