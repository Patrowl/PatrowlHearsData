{"id": "EUVD-2024-24246", "enisaUuid": "9933394a-36f3-354f-989a-37b38f0dd5d6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnouveau: fix instmem race condition around ptr stores\n\nRunning a lot of VK CTS in parallel against nouveau, once every\nfew hours you might see something like this crash.\n\nBUG: kernel NULL pointer dereference, address: 0000000000000008\nPGD 8000000114e6e067 P4D 8000000114e6e067 PUD 109046067 PMD 0\nOops: 0000 [#1] PREEMPT SMP PTI\nCPU: 7 PID: 53891 Comm: deqp-vk Not tainted 6.8.0-rc6+ #27\nHardware name: Gigabyte Technology Co., Ltd. Z390 I AORUS PRO WIFI/Z390 I AORUS PRO WIFI-CF, BIOS F8 11/05/2021\nRIP: 0010:gp100_vmm_pgt_mem+0xe3/0x180 [nouveau]\nCode: c7 48 01 c8 49 89 45 58 85 d2 0f 84 95 00 00 00 41 0f b7 46 12 49 8b 7e 08 89 da 42 8d 2c f8 48 8b 47 08 41 83 c7 01 48 89 ee <48> 8b 40 08 ff d0 0f 1f 00 49 8b 7e 08 48 89 d9 48 8d 75 04 48 c1\nRSP: 0000:ffffac20c5857838 EFLAGS: 00010202\nRAX: 0000000000000000 RBX: 00000000004d8001 RCX: 0000000000000001\nRDX: 00000000004d8001 RSI: 00000000000006d8 RDI: ffffa07afe332180\nRBP: 00000000000006d8 R08: ffffac20c5857ad0 R09: 0000000000ffff10\nR10: 0000000000000001 R11: ffffa07af27e2de0 R12: 000000000000001c\nR13: ffffac20c5857ad0 R14: ffffa07a96fe9040 R15: 000000000000001c\nFS:  00007fe395eed7c0(0000) GS:ffffa07e2c980000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000000000000008 CR3: 000000011febe001 CR4: 00000000003706f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n\n...\n\n ? gp100_vmm_pgt_mem+0xe3/0x180 [nouveau]\n ? gp100_vmm_pgt_mem+0x37/0x180 [nouveau]\n nvkm_vmm_iter+0x351/0xa20 [nouveau]\n ? __pfx_nvkm_vmm_ref_ptes+0x10/0x10 [nouveau]\n ? __pfx_gp100_vmm_pgt_mem+0x10/0x10 [nouveau]\n ? __pfx_gp100_vmm_pgt_mem+0x10/0x10 [nouveau]\n ? __lock_acquire+0x3ed/0x2170\n ? __pfx_gp100_vmm_pgt_mem+0x10/0x10 [nouveau]\n nvkm_vmm_ptes_get_map+0xc2/0x100 [nouveau]\n ? __pfx_nvkm_vmm_ref_ptes+0x10/0x10 [nouveau]\n ? __pfx_gp100_vmm_pgt_mem+0x10/0x10 [nouveau]\n nvkm_vmm_map_locked+0x224/0x3a0 [nouveau]\n\nAdding any sort of useful debug usually makes it go away, so I hand\nwrote the function in a line, and debugged the asm.\n\nEvery so often pt->memory->ptrs is NULL. This ptrs ptr is set in\nthe nv50_instobj_acquire called from nvkm_kmap.\n\nIf Thread A and Thread B both get to nv50_instobj_acquire around\nthe same time, and Thread A hits the refcount_set line, and in\nlockstep thread B succeeds at refcount_inc_not_zero, there is a\nchance the ptrs value won't have been stored since refcount_set\nis unordered. Force a memory barrier here, I picked smp_mb, since\nwe want it on all CPUs and it's write followed by a read.\n\nv2: use paired smp_rmb/smp_wmb.", "datePublished": "2024-05-01T05:27:20", "dateUpdated": "2025-11-04T17:15:10", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/bba8ec5e9b16649d85bc9e9086bf7ae5b5716ff9", "https://git.kernel.org/stable/c/1bc4825d4c3ec6abe43cf06c3c39d664d044cbf7", "https://git.kernel.org/stable/c/13d76b2f443dc371842916dd8768009ff1594716", "https://git.kernel.org/stable/c/3ab056814cd8ab84744c9a19ef51360b2271c572", "https://git.kernel.org/stable/c/ad74d208f213c06d860916ad40f609ade8c13039", "https://git.kernel.org/stable/c/a019b44b1bc6ed224c46fb5f88a8a10dd116e525", "https://git.kernel.org/stable/c/21ca9539f09360fd83654f78f2c361f2f5ddcb52", "https://git.kernel.org/stable/c/fff1386cc889d8fb4089d285f883f8cba62d82ce"], "aliases": ["CVE-2024-26984"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "07fa1490-c8a5-3e1e-9618-b35ab6f60eef", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <1bc4825d4c3ec6abe43cf06c3c39d664d044cbf7"}, {"id": "0ccf4f6b-a5b0-3adf-b45d-e48c123201dc", "product": {"name": "Linux"}, "product_version": "patch: 6.6.29"}, {"id": "18c992c1-9bc8-3ca4-b62d-7dc5cbad2468", "product": {"name": "Linux"}, "product_version": "patch: 6.1.88"}, {"id": "250d8cb4-54fe-3f02-9c4e-2f21d8ee28cf", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "27eac19c-e225-3655-8253-d62416b169a6", "product": {"name": "Linux"}, "product_version": "patch: 5.10.216"}, {"id": "28fd8013-be1d-35cb-b851-33703dc0dc2a", "product": {"name": "Linux"}, "product_version": "patch: 5.15.157"}, {"id": "3b195ec3-b46c-3e03-9e09-0a089529276d", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <3ab056814cd8ab84744c9a19ef51360b2271c572"}, {"id": "40beefa7-a9b1-3444-91c3-2c36ea3b48bc", "product": {"name": "Linux"}, "product_version": "4.15"}, {"id": "53f57726-0bdc-3e54-a32e-1a67291bf9a7", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <fff1386cc889d8fb4089d285f883f8cba62d82ce"}, {"id": "66142a4e-901c-3c5d-86ef-be9dfe339ef4", "product": {"name": "Linux"}, "product_version": "patch: 6.8.8"}, {"id": "80512290-28fc-3393-9361-b54fd20141e8", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <ad74d208f213c06d860916ad40f609ade8c13039"}, {"id": "959f6ec0-c339-377f-9c1f-4b45732edaaf", "product": {"name": "Linux"}, "product_version": "patch: 5.4.275"}, {"id": "b931b0d4-b602-327f-ba78-7a25982af7f1", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <bba8ec5e9b16649d85bc9e9086bf7ae5b5716ff9"}, {"id": "b954a7a7-f152-3fd7-806b-45c77022d253", "product": {"name": "Linux"}, "product_version": "patch: 6.9"}, {"id": "c71039ee-2d85-3038-a6dd-9d8d14d3272b", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <21ca9539f09360fd83654f78f2c361f2f5ddcb52"}, {"id": "d331132d-3821-3240-a6a5-f443d23720eb", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <13d76b2f443dc371842916dd8768009ff1594716"}, {"id": "db26a3f5-5998-342c-8f4a-2d1cf4759be1", "product": {"name": "Linux"}, "product_version": "patch: 4.19.313"}, {"id": "e196d1b4-358f-3a7a-9fcd-186d89fa5a1d", "product": {"name": "Linux"}, "product_version": "be55287aa5ba6895e9d4d3ed2f08a1be7a065957 <a019b44b1bc6ed224c46fb5f88a8a10dd116e525"}], "enisaIdVendor": [{"id": "d6a9ef9b-39af-351b-8a62-873c54306867", "vendor": {"name": "Linux"}}], "isExploited": false}