{"id": "EUVD-2024-44775", "enisaUuid": "7aa34efb-da2e-3fc4-8227-368b3e09fe90", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: reinitialize delayed ref list after deleting it from the list\n\nAt insert_delayed_ref() if we need to update the action of an existing\nref to BTRFS_DROP_DELAYED_REF, we delete the ref from its ref head's\nref_add_list using list_del(), which leaves the ref's add_list member\nnot reinitialized, as list_del() sets the next and prev members of the\nlist to LIST_POISON1 and LIST_POISON2, respectively.\n\nIf later we end up calling drop_delayed_ref() against the ref, which can\nhappen during merging or when destroying delayed refs due to a transaction\nabort, we can trigger a crash since at drop_delayed_ref() we call\nlist_empty() against the ref's add_list, which returns false since\nthe list was not reinitialized after the list_del() and as a consequence\nwe call list_del() again at drop_delayed_ref(). This results in an\ninvalid list access since the next and prev members are set to poison\npointers, resulting in a splat if CONFIG_LIST_HARDENED and\nCONFIG_DEBUG_LIST are set or invalid poison pointer dereferences\notherwise.\n\nSo fix this by deleting from the list with list_del_init() instead.", "datePublished": "2024-11-19T01:30:12", "dateUpdated": "2025-11-03T22:27:54", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/2fd0948a483e9cb2d669c7199bc620a21c97673d", "https://git.kernel.org/stable/c/93c5b8decc0ef39ba84f4211d2db6da0a4aefbeb", "https://git.kernel.org/stable/c/bf0b0c6d159767c0d1c21f793950d78486690ee0", "https://git.kernel.org/stable/c/c24fa427fc0ae827b2a3a07f13738cbf82c3f851", "https://git.kernel.org/stable/c/2cb1a73d1d44a1c11b0ee5eeced765dd80ec48e6", "https://git.kernel.org/stable/c/f04be6d68f715c1473a8422fc0460f57b5e99931", "https://git.kernel.org/stable/c/50a3933760b427759afdd23156a7280a19357a92", "https://git.kernel.org/stable/c/c9a75ec45f1111ef530ab186c2a7684d0a0c9245", "https://nvd.nist.gov/vuln/detail/CVE-2024-50273", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html", "https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html"], "aliases": ["CVE-2024-50273"], "assigner": "Linux", "epss": 0.07, "enisaIdProduct": [{"id": "0373c2eb-a5bf-3dd7-8d96-247925066c25", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <2fd0948a483e9cb2d669c7199bc620a21c97673d"}, {"id": "0f71e41a-79ba-3d85-9750-5c9ef3bfc6e3", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <50a3933760b427759afdd23156a7280a19357a92"}, {"id": "1351213f-3643-3b9e-8112-1dedb4f29965", "product": {"name": "Linux"}, "product_version": "patch: 5.10.230"}, {"id": "19dbf5fb-5722-3673-a359-b4cf169e11e0", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <c9a75ec45f1111ef530ab186c2a7684d0a0c9245"}, {"id": "373be50e-bd56-33d1-92fd-49e4f38ef54c", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <bf0b0c6d159767c0d1c21f793950d78486690ee0"}, {"id": "42a144f2-796e-3f7c-8b2c-3dec87c52ab1", "product": {"name": "Linux"}, "product_version": "patch: 5.4.286"}, {"id": "55fab6ee-c949-31b5-8bc2-c86f9b44a814", "product": {"name": "Linux"}, "product_version": "patch: 5.15.172"}, {"id": "6a3e6996-5d59-32fb-949d-1a73e5c7c50f", "product": {"name": "Linux"}, "product_version": "4.10"}, {"id": "6cced1ce-a5ff-3999-b239-77c3829ba159", "product": {"name": "Linux"}, "product_version": "patch: 6.11.8"}, {"id": "6d490b6b-e188-36cb-95e7-867e3807383c", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <2cb1a73d1d44a1c11b0ee5eeced765dd80ec48e6"}, {"id": "7508b107-2abd-3f6f-b26e-9cf3044c6541", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "76d7295b-19e4-3746-b99b-8f5c6dca5ac8", "product": {"name": "Linux"}, "product_version": "patch: 4.19.324"}, {"id": "ad70b178-2944-3ddf-8599-56c2797c2a5d", "product": {"name": "Linux"}, "product_version": "patch: 6.1.117"}, {"id": "b63c7408-f3f4-3cb2-ad76-d6163e4e8e30", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "c684755e-d416-3dc5-bc4a-2623012840a0", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <93c5b8decc0ef39ba84f4211d2db6da0a4aefbeb"}, {"id": "d9631b1c-ad7f-336f-a45c-d2d87fe6eb25", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <f04be6d68f715c1473a8422fc0460f57b5e99931"}, {"id": "e9c8b666-d453-31a4-b670-393d973589b3", "product": {"name": "Linux"}, "product_version": "1d57ee941692d0cc928526e21a1557b2ae3e11db <c24fa427fc0ae827b2a3a07f13738cbf82c3f851"}, {"id": "f32b9fb1-22d5-352a-8746-ad65126a03ae", "product": {"name": "Linux"}, "product_version": "patch: 6.6.61"}], "enisaIdVendor": [{"id": "5f33ed24-eee8-38cf-b34a-53c197e19de8", "vendor": {"name": "Linux"}}], "isExploited": false}