{"id": "EUVD-2024-1080", "enisaUuid": "baa1d4a6-2002-32c5-801b-3c7b2f6dcc75", "description": "Evmos is a scalable, high-throughput Proof-of-Stake EVM blockchain that is fully compatible and interoperable with Ethereum. Prior to 17.0.0, there is a way to mint arbitrary tokens due to the possibility to have two different states not in sync during the execution of a transaction. The exploit is based on the fact that to sync the Cosmos SDK state and the EVM one, we rely on the `stateDB.Commit()` method. When we call this method, we iterate though all the `dirtyStorage` and, **if and only if** it is different than the `originStorage`, we set the new state. Setting the new state means we update the Cosmos SDK KVStore.  If a contract storage state that is the same before and after a transaction, but is changed during the transaction and can call an external contract after the change, it can be exploited to make the transaction similar to non-atomic. The vulnerability is **critical** since this could lead to drain of funds through creative SC interactions.  The issue has been patched in versions >=V17.0.0.", "datePublished": "2024-04-19T14:53:44", "dateUpdated": "2024-08-02T02:13:40", "baseScore": 9.1, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "references": ["https://github.com/evmos/evmos/security/advisories/GHSA-3fp5-2xwh-fxm6", "https://nvd.nist.gov/vuln/detail/CVE-2024-32644", "https://github.com/evmos/evmos/commit/08982b5ee726b97bc50eaf58d1914829648b6a5f", "https://github.com/evmos/evmos", "https://github.com/evmos/evmos/blob/b196a522ba4951890b40992e9f97aa610f8b5f9c/x/evm/statedb/state_object.go#L53-L68", "https://github.com/evmos/evmos/blob/b196a522ba4951890b40992e9f97aa610f8b5f9c/x/evm/statedb/statedb.go#L33-L55", "https://github.com/evmos/evmos/blob/b196a522ba4951890b40992e9f97aa610f8b5f9c/x/evm/statedb/statedb.go#L460-L465"], "aliases": ["CVE-2024-32644", "GHSA-3fp5-2xwh-fxm6"], "assigner": "GitHub_M", "epss": 0.62, "enisaIdProduct": [{"id": "6508c7c9-e30b-3564-beb3-55562775d8d7", "product": {"name": "evmos"}, "product_version": "< 17.0.0"}, {"id": "b45a2b97-d0a7-3515-a141-17961602024e", "product": {"name": "evmos"}}], "enisaIdVendor": [{"id": "b45a2b97-d0a7-3515-a141-17961602024e", "vendor": {"name": "evmos"}}], "isExploited": false}