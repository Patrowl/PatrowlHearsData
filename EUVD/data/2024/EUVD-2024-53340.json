{"id": "EUVD-2024-53340", "enisaUuid": "d8b0d9f7-5a4f-3e9f-98eb-23de6c7eb614", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on node blkaddr in truncate_node()\n\nsyzbot reports a f2fs bug as below:\n\n------------[ cut here ]------------\nkernel BUG at fs/f2fs/segment.c:2534!\nRIP: 0010:f2fs_invalidate_blocks+0x35f/0x370 fs/f2fs/segment.c:2534\nCall Trace:\n truncate_node+0x1ae/0x8c0 fs/f2fs/node.c:909\n f2fs_remove_inode_page+0x5c2/0x870 fs/f2fs/node.c:1288\n f2fs_evict_inode+0x879/0x15c0 fs/f2fs/inode.c:856\n evict+0x4e8/0x9b0 fs/inode.c:723\n f2fs_handle_failed_inode+0x271/0x2e0 fs/f2fs/inode.c:986\n f2fs_create+0x357/0x530 fs/f2fs/namei.c:394\n lookup_open fs/namei.c:3595 [inline]\n open_last_lookups fs/namei.c:3694 [inline]\n path_openat+0x1c03/0x3590 fs/namei.c:3930\n do_filp_open+0x235/0x490 fs/namei.c:3960\n do_sys_openat2+0x13e/0x1d0 fs/open.c:1415\n do_sys_open fs/open.c:1430 [inline]\n __do_sys_openat fs/open.c:1446 [inline]\n __se_sys_openat fs/open.c:1441 [inline]\n __x64_sys_openat+0x247/0x2a0 fs/open.c:1441\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0010:f2fs_invalidate_blocks+0x35f/0x370 fs/f2fs/segment.c:2534\n\nThe root cause is: on a fuzzed image, blkaddr in nat entry may be\ncorrupted, then it will cause system panic when using it in\nf2fs_invalidate_blocks(), to avoid this, let's add sanity check on\nnat blkaddr in truncate_node().", "datePublished": "2024-12-28T09:46:17", "dateUpdated": "2025-10-01T20:07:08", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/27d6e7eff07f8cce8e83b162d8f21a07458c860d", "https://git.kernel.org/stable/c/c1077078ce4589b5e5387f6b0aaa0d4534b9eb57", "https://git.kernel.org/stable/c/0a5c8b3fbf6200f1c66062d307c9a52084917788", "https://git.kernel.org/stable/c/6babe00ccd34fc65b78ef8b99754e32b4385f23d"], "aliases": ["CVE-2024-56692"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "048440fa-ad77-3588-9425-b97fd1c1723a", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "342ffdc4-7a5b-3573-8331-b714bd295308", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0a5c8b3fbf6200f1c66062d307c9a52084917788"}, {"id": "3cb1177d-7edb-3c81-af8c-1ad786f21dd6", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <27d6e7eff07f8cce8e83b162d8f21a07458c860d"}, {"id": "3ed15658-4482-3e85-8c23-ba1e3d44e234", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "612ba0ae-342b-3ba6-9fad-e7b453803e48", "product": {"name": "Linux"}, "product_version": "patch: 6.6.64"}, {"id": "79378c45-4d31-3b3e-bce7-55b882d1b7a0", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "94fb5cec-36d2-3932-b054-bdf910b6322e", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <6babe00ccd34fc65b78ef8b99754e32b4385f23d"}, {"id": "af394687-4c0d-3fc6-a51e-794224fc2f05", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "b66fa7b7-015e-31c4-a4d2-f860743be8e9", "product": {"name": "Linux"}, "product_version": "patch: 6.11.11"}, {"id": "d16872de-99fb-3c4a-a748-69c143b026f4", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6babe00ccd34fc65b78ef8b99754e32b4385f23d"}, {"id": "e0c97781-6b9c-3951-b9b5-40c4bb37f20b", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <c1077078ce4589b5e5387f6b0aaa0d4534b9eb57"}, {"id": "e4c5c305-44a3-3b88-92e0-6d10d1c29a3e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c1077078ce4589b5e5387f6b0aaa0d4534b9eb57"}, {"id": "e71ce31d-9fdd-30b2-a9a3-1c58b57d5418", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <0a5c8b3fbf6200f1c66062d307c9a52084917788"}, {"id": "f06d85cd-bea3-314e-8401-6a3e52cde84d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <27d6e7eff07f8cce8e83b162d8f21a07458c860d"}], "enisaIdVendor": [{"id": "215b5440-bcc6-3e4c-b8e8-06d5f3fddf80", "vendor": {"name": "Linux"}}], "isExploited": false}