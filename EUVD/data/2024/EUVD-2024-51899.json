{"id": "EUVD-2024-51899", "enisaUuid": "a9bf0ce7-143b-323e-a07c-eb1fb0f80174", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: bfa: Fix use-after-free in bfad_im_module_exit()\n\nBUG: KASAN: slab-use-after-free in __lock_acquire+0x2aca/0x3a20\nRead of size 8 at addr ffff8881082d80c8 by task modprobe/25303\n\nCall Trace:\n <TASK>\n dump_stack_lvl+0x95/0xe0\n print_report+0xcb/0x620\n kasan_report+0xbd/0xf0\n __lock_acquire+0x2aca/0x3a20\n lock_acquire+0x19b/0x520\n _raw_spin_lock+0x2b/0x40\n attribute_container_unregister+0x30/0x160\n fc_release_transport+0x19/0x90 [scsi_transport_fc]\n bfad_im_module_exit+0x23/0x60 [bfa]\n bfad_init+0xdb/0xff0 [bfa]\n do_one_initcall+0xdc/0x550\n do_init_module+0x22d/0x6b0\n load_module+0x4e96/0x5ff0\n init_module_from_file+0xcd/0x130\n idempotent_init_module+0x330/0x620\n __x64_sys_finit_module+0xb3/0x110\n do_syscall_64+0xc1/0x1d0\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n </TASK>\n\nAllocated by task 25303:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n __kasan_kmalloc+0x7f/0x90\n fc_attach_transport+0x4f/0x4740 [scsi_transport_fc]\n bfad_im_module_init+0x17/0x80 [bfa]\n bfad_init+0x23/0xff0 [bfa]\n do_one_initcall+0xdc/0x550\n do_init_module+0x22d/0x6b0\n load_module+0x4e96/0x5ff0\n init_module_from_file+0xcd/0x130\n idempotent_init_module+0x330/0x620\n __x64_sys_finit_module+0xb3/0x110\n do_syscall_64+0xc1/0x1d0\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nFreed by task 25303:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n kasan_save_free_info+0x3b/0x60\n __kasan_slab_free+0x38/0x50\n kfree+0x212/0x480\n bfad_im_module_init+0x7e/0x80 [bfa]\n bfad_init+0x23/0xff0 [bfa]\n do_one_initcall+0xdc/0x550\n do_init_module+0x22d/0x6b0\n load_module+0x4e96/0x5ff0\n init_module_from_file+0xcd/0x130\n idempotent_init_module+0x330/0x620\n __x64_sys_finit_module+0xb3/0x110\n do_syscall_64+0xc1/0x1d0\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nAbove issue happens as follows:\n\nbfad_init\n  error = bfad_im_module_init()\n    fc_release_transport(bfad_im_scsi_transport_template);\n  if (error)\n    goto ext;\n\next:\n  bfad_im_module_exit();\n    fc_release_transport(bfad_im_scsi_transport_template);\n    --> Trigger double release\n\nDon't call bfad_im_module_exit() if bfad_im_module_init() failed.", "datePublished": "2024-12-27T15:31:52", "dateUpdated": "2025-11-03T21:31:50", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/0ceac8012d3ddea3317f0d82934293d05feb8af1", "https://git.kernel.org/stable/c/3932c753f805a02e9364a4c58b590f21901f8490", "https://git.kernel.org/stable/c/ef2c2580189ea88a0dcaf56eb3a565763a900edb", "https://git.kernel.org/stable/c/e76181a5be90abcc3ed8a300bd13878aa214d022", "https://git.kernel.org/stable/c/8f5a97443b547b4c83f876f1d6a11df0f1fd4efb", "https://git.kernel.org/stable/c/c28409f851abd93b37969cac7498828ad533afd9", "https://git.kernel.org/stable/c/1ffdde30a90bf8efe8f270407f486706962b3292", "https://git.kernel.org/stable/c/a2b5035ab0e368e8d8a371e27fbc72f133c0bd40", "https://git.kernel.org/stable/c/178b8f38932d635e90f5f0e9af1986c6f4a89271", "https://nvd.nist.gov/vuln/detail/CVE-2024-53227", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-53227"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "158b70af-b546-3b53-9a19-28ca5da6230f", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "29205a7c-4674-35bf-b4b8-1107ac3b2757", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <3932c753f805a02e9364a4c58b590f21901f8490"}, {"id": "2cfce56f-e29a-382a-a5e8-223c0c55312b", "product": {"name": "Linux"}, "product_version": "patch: 6.1.120"}, {"id": "2e4ca20f-b1b8-3067-a9a1-7edbade41653", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "3250e1ea-f7a2-3ed7-be58-bd608038ee30", "product": {"name": "Linux"}, "product_version": "patch: 6.6.64"}, {"id": "36135c3e-3101-3be2-ad7d-9e036dfd0f97", "product": {"name": "Linux"}, "product_version": "patch: 4.19.325"}, {"id": "3a7294f0-ece8-38f0-a535-355ef59223d0", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "423aee00-3b71-3c4c-8686-0395aeba1ae8", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <c28409f851abd93b37969cac7498828ad533afd9"}, {"id": "5214555a-5a8e-3b5a-a9ed-98c7d5c6d1ae", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <ef2c2580189ea88a0dcaf56eb3a565763a900edb"}, {"id": "698515ba-aa9d-3857-bbba-07fac52ca482", "product": {"name": "Linux"}, "product_version": "patch: 5.4.287"}, {"id": "771eee21-a30c-31e4-ad8e-756ab7ad977b", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <1ffdde30a90bf8efe8f270407f486706962b3292"}, {"id": "810557c7-f614-3036-bfc0-77858ed8f9da", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <e76181a5be90abcc3ed8a300bd13878aa214d022"}, {"id": "8b6869ee-3cd8-37cf-b1ff-d94bb44bc8d2", "product": {"name": "Linux"}, "product_version": "patch: 6.11.11"}, {"id": "970ba9cc-36c7-30b5-8f41-b87e2dcd8ac2", "product": {"name": "Linux"}, "product_version": "2.6.32"}, {"id": "aa5987a4-d489-371a-8ac9-5b450ab2e447", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <0ceac8012d3ddea3317f0d82934293d05feb8af1"}, {"id": "b15ea140-185f-3f5a-8272-2505ea554353", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <8f5a97443b547b4c83f876f1d6a11df0f1fd4efb"}, {"id": "b632298c-f178-332f-9ae5-27cc5cf6e7c9", "product": {"name": "Linux"}, "product_version": "patch: 5.10.231"}, {"id": "bfb20a00-7654-3c60-ada5-ea66cf98ee6d", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <178b8f38932d635e90f5f0e9af1986c6f4a89271"}, {"id": "df108d26-782e-31d6-ac92-eb0e4244d28c", "product": {"name": "Linux"}, "product_version": "patch: 5.15.174"}, {"id": "ee4fd1e8-5c05-3deb-abea-df9d560ef540", "product": {"name": "Linux"}, "product_version": "7725ccfda59715ecf8f99e3b520a0b84cc2ea79e <a2b5035ab0e368e8d8a371e27fbc72f133c0bd40"}], "enisaIdVendor": [{"id": "0a042841-acb0-3fb6-9e76-41af59a7ea02", "vendor": {"name": "Linux"}}], "isExploited": false}