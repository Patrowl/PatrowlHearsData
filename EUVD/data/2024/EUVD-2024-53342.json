{"id": "EUVD-2024-53342", "enisaUuid": "b6b0f042-4b5b-3340-8db5-98ce9862993d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: fix recursive lock when verdict program return SK_PASS\n\nWhen the stream_verdict program returns SK_PASS, it places the received skb\ninto its own receive queue, but a recursive lock eventually occurs, leading\nto an operating system deadlock. This issue has been present since v6.9.\n\n'''\nsk_psock_strp_data_ready\n    write_lock_bh(&sk->sk_callback_lock)\n    strp_data_ready\n      strp_read_sock\n        read_sock -> tcp_read_sock\n          strp_recv\n            cb.rcv_msg -> sk_psock_strp_read\n              # now stream_verdict return SK_PASS without peer sock assign\n              __SK_PASS = sk_psock_map_verd(SK_PASS, NULL)\n              sk_psock_verdict_apply\n                sk_psock_skb_ingress_self\n                  sk_psock_skb_ingress_enqueue\n                    sk_psock_data_ready\n                      read_lock_bh(&sk->sk_callback_lock) <= dead lock\n\n'''\n\nThis topic has been discussed before, but it has not been fixed.\nPrevious discussion:\nhttps://lore.kernel.org/all/6684a5864ec86_403d20898@john.notmuch", "datePublished": "2024-12-28T12:30:47", "dateUpdated": "2025-11-03T21:32:01", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/078f7e1521442a55db4bed812a2fbaf02ac33819", "https://git.kernel.org/stable/c/221109ba2127eabd0aa64718543638b58b15df56", "https://git.kernel.org/stable/c/6694f7acd625ed854bf6342926e771d65dad7f69", "https://git.kernel.org/stable/c/386efa339e08563dd33e83bc951aea5d407fe578", "https://git.kernel.org/stable/c/da2bc8a0c8f3ac66fdf980fc59936f851a083561", "https://git.kernel.org/stable/c/01f1b88acfd79103da0610b45471f6c88ea98d72", "https://git.kernel.org/stable/c/f84c5ef6ca23cc2f72f3b830d74f67944684bb05", "https://git.kernel.org/stable/c/8ca2a1eeadf09862190b2810697702d803ceef2d", "https://nvd.nist.gov/vuln/detail/CVE-2024-56694", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-56694"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "0de42655-64ff-38f5-91e7-4d374daf12d4", "product": {"name": "Linux"}, "product_version": "6648e613226e18897231ab5e42ffc29e63fa3365 <8ca2a1eeadf09862190b2810697702d803ceef2d"}, {"id": "15ea292d-5dc9-3660-b34d-1087deb4ca2d", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1d0ccf16-bbf6-3e32-8493-db2cce2ff22a", "product": {"name": "Linux"}, "product_version": "c0809c128dad4c3413818384eb06a341633db973 <221109ba2127eabd0aa64718543638b58b15df56"}, {"id": "4b39889d-82b6-3ec2-b14f-0e5c11f4f9a7", "product": {"name": "Linux"}, "product_version": "patch: 6.1.120"}, {"id": "57e1bfe6-c842-3738-947c-be296c58ffa4", "product": {"name": "Linux"}, "product_version": "6648e613226e18897231ab5e42ffc29e63fa3365 <01f1b88acfd79103da0610b45471f6c88ea98d72"}, {"id": "5d29a4ca-da29-310c-b7c7-3cfee39fa448", "product": {"name": "Linux"}, "product_version": "b397a0ab8582c533ec0c6b732392f141fc364f87 <da2bc8a0c8f3ac66fdf980fc59936f851a083561"}, {"id": "66b78b86-f49b-326d-b400-a41c688e15cd", "product": {"name": "Linux"}, "product_version": "patch: 5.15.174"}, {"id": "6eda961e-0fd3-3ce2-9e5c-e4e34df1c9c9", "product": {"name": "Linux"}, "product_version": "5965bc7535fb87510b724e5465ccc1a1cf00916d <6694f7acd625ed854bf6342926e771d65dad7f69"}, {"id": "71a29b5d-aab3-3187-b066-b3264fe6646b", "product": {"name": "Linux"}, "product_version": "6.9"}, {"id": "7781172b-bbfe-3b28-96fe-17087366458c", "product": {"name": "Linux"}, "product_version": "6648e613226e18897231ab5e42ffc29e63fa3365 <f84c5ef6ca23cc2f72f3b830d74f67944684bb05"}, {"id": "84d09b15-718a-3eeb-8a93-6ca0ddb8d29b", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "af57654e-5a29-3d4e-852a-76de650ae539", "product": {"name": "Linux"}, "product_version": "patch: 6.6.64"}, {"id": "b82321bd-db4e-3957-91b8-0359ff6dbf98", "product": {"name": "Linux"}, "product_version": "patch: 6.12.2"}, {"id": "c61625b6-41e9-3892-b764-e8e7941e4878", "product": {"name": "Linux"}, "product_version": "patch: 5.10.233"}, {"id": "cbab248e-75b4-36b9-8daa-068acc665aec", "product": {"name": "Linux"}, "product_version": "patch: 6.11.11"}, {"id": "de4b70d4-4bf5-30b2-b532-b042031e0491", "product": {"name": "Linux"}, "product_version": "patch: 5.4.289"}, {"id": "f150228a-ca6f-3dee-869b-f634d21e763d", "product": {"name": "Linux"}, "product_version": "6648e613226e18897231ab5e42ffc29e63fa3365 <078f7e1521442a55db4bed812a2fbaf02ac33819"}, {"id": "f31197e3-2310-31e2-a119-b7aa012f07dc", "product": {"name": "Linux"}, "product_version": "39dc9e1442385d6e9be0b6491ee488dddd55ae27 <386efa339e08563dd33e83bc951aea5d407fe578"}, {"id": "feb88bb9-5d26-382d-9c75-140a85dd2c13", "product": {"name": "Linux"}, "product_version": "772d5729b5ff0df0d37b32db600ce635b2172f80"}], "enisaIdVendor": [{"id": "31763461-d031-3485-90f0-2cc3851c4f7c", "vendor": {"name": "Linux"}}], "isExploited": false}