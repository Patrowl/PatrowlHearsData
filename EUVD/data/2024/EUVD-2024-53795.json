{"id": "EUVD-2024-53795", "enisaUuid": "669e282f-0929-33c9-9b42-0e74abf46017", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: fix slab-use-after-free due to dangling pointer dqi_priv\n\nWhen mounting ocfs2 and then remounting it as read-only, a\nslab-use-after-free occurs after the user uses a syscall to\nquota_getnextquota.  Specifically, sb_dqinfo(sb, type)->dqi_priv is the\ndangling pointer.\n\nDuring the remounting process, the pointer dqi_priv is freed but is never\nset as null leaving it to be accessed.  Additionally, the read-only option\nfor remounting sets the DQUOT_SUSPENDED flag instead of setting the\nDQUOT_USAGE_ENABLED flags.  Moreover, later in the process of getting the\nnext quota, the function ocfs2_get_next_id is called and only checks the\nquota usage flags and not the quota suspended flags.\n\nTo fix this, I set dqi_priv to null when it is freed after remounting with\nread-only and put a check for DQUOT_SUSPENDED in ocfs2_get_next_id.\n\n[akpm@linux-foundation.org: coding-style cleanups]", "datePublished": "2025-01-15T15:31:24", "dateUpdated": "2025-11-03T21:32:12", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/58f9e20e2a7602e1dd649a1ec4790077c251cb6c", "https://git.kernel.org/stable/c/8ff6f635a08c30559ded0c110c7ce03ba7747d11", "https://git.kernel.org/stable/c/f44e6d70c100614c211703f065cad448050e4a0e", "https://git.kernel.org/stable/c/2d431192486367eee03cc28d0b53b97dafcb8e63", "https://git.kernel.org/stable/c/2e3d203b1adede46bbba049e497765d67865be18", "https://git.kernel.org/stable/c/ba950a02d8d23811aa1120affd3adedcfac6153d", "https://git.kernel.org/stable/c/5f3fd772d152229d94602bca243fbb658068a597", "https://nvd.nist.gov/vuln/detail/CVE-2024-57892", "https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html", "https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html"], "aliases": ["CVE-2024-57892"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "02b9247e-5e42-3d15-bb27-12e46f3bf481", "product": {"name": "Linux"}, "product_version": "patch: 5.10.234"}, {"id": "08d6d1ff-9bbc-34ce-819e-a04916a05aef", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <ba950a02d8d23811aa1120affd3adedcfac6153d"}, {"id": "2448e280-3225-32bb-8c38-e7c90078bd38", "product": {"name": "Linux"}, "product_version": "patch: 6.13"}, {"id": "2b8f5895-bac0-30c9-a40e-04dfad5974be", "product": {"name": "Linux"}, "product_version": "patch: 5.4.290"}, {"id": "3e8220e5-af0d-3a87-a819-378ab70c7799", "product": {"name": "Linux"}, "product_version": "patch: 6.12.9"}, {"id": "3fb27882-c0c5-3234-8e5e-6518157113a7", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <8ff6f635a08c30559ded0c110c7ce03ba7747d11"}, {"id": "549af667-a9d0-37b8-a2e1-3de3c84627db", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7e7b9540-208a-3673-8dd0-9f7a5e1e6bcc", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <2e3d203b1adede46bbba049e497765d67865be18"}, {"id": "8a33593a-bad3-3a28-818f-3c4aa200f67f", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <2d431192486367eee03cc28d0b53b97dafcb8e63"}, {"id": "8aa6ef5d-e18f-325e-bb2c-7b754e202cf4", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <58f9e20e2a7602e1dd649a1ec4790077c251cb6c"}, {"id": "8ab5b2ab-77aa-3b02-a951-42682b24fd92", "product": {"name": "Linux"}, "product_version": "patch: 6.1.125"}, {"id": "aa4bc0a2-6d5d-3907-a3c5-3b439a8723cf", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <f44e6d70c100614c211703f065cad448050e4a0e"}, {"id": "d28fb06a-716c-3c15-826f-dacd063d582c", "product": {"name": "Linux"}, "product_version": "4.6"}, {"id": "d7f26d79-47b2-3d4d-b348-ca1255885fc1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.177"}, {"id": "fc4ef5be-ddb4-37f6-95eb-43c6685b776e", "product": {"name": "Linux"}, "product_version": "8f9e8f5fcc059a3cba87ce837c88316797ef3645 <5f3fd772d152229d94602bca243fbb658068a597"}, {"id": "fc8c0e0e-a66d-3542-925b-ea19665b159d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.70"}], "enisaIdVendor": [{"id": "6bd695a5-0059-3572-b847-5cf65343ccb8", "vendor": {"name": "Linux"}}], "isExploited": false}