{"id": "EUVD-2026-2288", "enisaUuid": "e39cd182-198c-3dd8-86c9-4c040dc4bb8a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nipvs: fix ipv4 null-ptr-deref in route error path\n\nThe IPv4 code path in __ip_vs_get_out_rt() calls dst_link_failure()\nwithout ensuring skb->dev is set, leading to a NULL pointer dereference\nin fib_compute_spec_dst() when ipv4_link_failure() attempts to send\nICMP destination unreachable messages.\n\nThe issue emerged after commit ed0de45a1008 (\"ipv4: recompile ip options\nin ipv4_link_failure\") started calling __ip_options_compile() from\nipv4_link_failure(). This code path eventually calls fib_compute_spec_dst()\nwhich dereferences skb->dev. An attempt was made to fix the NULL skb->dev\ndereference in commit 0113d9c9d1cc (\"ipv4: fix null-deref in\nipv4_link_failure\"), but it only addressed the immediate dev_net(skb->dev)\ndereference by using a fallback device. The fix was incomplete because\nfib_compute_spec_dst() later in the call chain still accesses skb->dev\ndirectly, which remains NULL when IPVS calls dst_link_failure().\n\nThe crash occurs when:\n1. IPVS processes a packet in NAT mode with a misconfigured destination\n2. Route lookup fails in __ip_vs_get_out_rt() before establishing a route\n3. The error path calls dst_link_failure(skb) with skb->dev == NULL\n4. ipv4_link_failure() \u2192 ipv4_send_dest_unreach() \u2192\n   __ip_options_compile() \u2192 fib_compute_spec_dst()\n5. fib_compute_spec_dst() dereferences NULL skb->dev\n\nApply the same fix used for IPv6 in commit 326bf17ea5d4 (\"ipvs: fix\nipv6 route unreach panic\"): set skb->dev from skb_dst(skb)->dev before\ncalling dst_link_failure().\n\nKASAN: null-ptr-deref in range [0x0000000000000328-0x000000000000032f]\nCPU: 1 PID: 12732 Comm: syz.1.3469 Not tainted 6.6.114 #2\nRIP: 0010:__in_dev_get_rcu include/linux/inetdevice.h:233\nRIP: 0010:fib_compute_spec_dst+0x17a/0x9f0 net/ipv4/fib_frontend.c:285\nCall Trace:\n  <TASK>\n  spec_dst_fill net/ipv4/ip_options.c:232\n  spec_dst_fill net/ipv4/ip_options.c:229\n  __ip_options_compile+0x13a1/0x17d0 net/ipv4/ip_options.c:330\n  ipv4_send_dest_unreach net/ipv4/route.c:1252\n  ipv4_link_failure+0x702/0xb80 net/ipv4/route.c:1265\n  dst_link_failure include/net/dst.h:437\n  __ip_vs_get_out_rt+0x15fd/0x19e0 net/netfilter/ipvs/ip_vs_xmit.c:412\n  ip_vs_nat_xmit+0x1d8/0xc80 net/netfilter/ipvs/ip_vs_xmit.c:764", "datePublished": "2026-01-13T15:29:18", "dateUpdated": "2026-01-13T15:29:18", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68813", "https://git.kernel.org/stable/c/25ab24df31f7af843c96a38e0781b9165216e1a8", "https://git.kernel.org/stable/c/4729ff0581fbb7ad098b6153b76b6f5aac94618a", "https://git.kernel.org/stable/c/689a627d14788ad772e0fa24c2e57a23dbc7ce90", "https://git.kernel.org/stable/c/ad891bb3d079a46a821bf2b8867854645191bab0", "https://git.kernel.org/stable/c/cdeff10851c37a002d87a035818ebd60fdb74447"], "aliases": ["CVE-2025-68813", "GHSA-r9w6-9rjj-r9c5"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "07aec2a1-2b80-3646-8e42-b804464f59f3", "product": {"name": "Linux"}, "product_version": "ed0de45a1008991fdaa27a0152befcb74d126a8b <4729ff0581fbb7ad098b6153b76b6f5aac94618a"}, {"id": "0c8806bb-e678-374b-802d-1978425471cd", "product": {"name": "Linux"}, "product_version": "6bd1ee0a993fc9574ae43c1994c54a60cb23a380"}, {"id": "20e26fcd-6911-393f-875f-7b39a4b42fcf", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc2"}, {"id": "21c66af0-1c7c-3cb6-b7e5-7ad76b69ea7d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.120"}, {"id": "22ad4c51-9be8-3357-b9be-d856351fd967", "product": {"name": "Linux"}, "product_version": "ff71f99d5fb2daf54340e8b290d0bc4e6b4c1d38"}, {"id": "27f7ebab-0b2e-3e7c-bedc-6553749ac5e4", "product": {"name": "Linux"}, "product_version": "6c2fa855d8178699706b1192db2f1f8102b0ba1e"}, {"id": "2dcf58f5-2d01-3804-9843-245bcb62546b", "product": {"name": "Linux"}, "product_version": "patch: 6.18.3"}, {"id": "3ded2e86-c438-37a6-8ee7-8e018e7b19f1", "product": {"name": "Linux"}, "product_version": "ed0de45a1008991fdaa27a0152befcb74d126a8b <25ab24df31f7af843c96a38e0781b9165216e1a8"}, {"id": "3f215af3-820f-3d6b-ad34-ad0409e0f3a7", "product": {"name": "Linux"}, "product_version": "patch: 6.12.64"}, {"id": "83f1b6c5-3f91-3c5c-b933-ef09d2767fb0", "product": {"name": "Linux"}, "product_version": "patch: 6.1.160"}, {"id": "aadcba89-23ec-3565-8cbd-58e398362570", "product": {"name": "Linux"}, "product_version": "ed0de45a1008991fdaa27a0152befcb74d126a8b <689a627d14788ad772e0fa24c2e57a23dbc7ce90"}, {"id": "c43b2bb1-3796-3971-9869-d13ba3ef862c", "product": {"name": "Linux"}, "product_version": "5.1"}, {"id": "db4a236f-33ae-3ad5-993e-669313a131cc", "product": {"name": "Linux"}, "product_version": "3d988fcddbe7b8673a231958bd2fba61b5a7ced9"}, {"id": "dd778d30-eb0b-3f39-a822-e5da0138fde5", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e405775d-c716-34d8-bf60-364f4119f4bb", "product": {"name": "Linux"}, "product_version": "ed0de45a1008991fdaa27a0152befcb74d126a8b <cdeff10851c37a002d87a035818ebd60fdb74447"}, {"id": "e63d1b7d-a618-3ecf-a1b4-bfba4187bf35", "product": {"name": "Linux"}, "product_version": "8a430e56a6485267a1b2d3747209d26c54d1a34b"}, {"id": "ec64ee37-9cf5-34ef-9254-712ec93816ab", "product": {"name": "Linux"}, "product_version": "fbf569d2beee2a4a7a0bc8b619c26101d1211a88"}, {"id": "fe99c2c2-4c73-331a-81c8-7530c0c97218", "product": {"name": "Linux"}, "product_version": "ed0de45a1008991fdaa27a0152befcb74d126a8b <ad891bb3d079a46a821bf2b8867854645191bab0"}], "enisaIdVendor": [{"id": "eed8dab8-6cf3-35ca-bdf0-860f729eaa26", "vendor": {"name": "Linux"}}], "isExploited": false}