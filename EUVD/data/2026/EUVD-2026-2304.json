{"id": "EUVD-2026-2304", "enisaUuid": "533cf146-dc1d-3448-9760-fff6d059d790", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: Disallow toggling KVM_MEM_GUEST_MEMFD on an existing memslot\n\nReject attempts to disable KVM_MEM_GUEST_MEMFD on a memslot that was\ninitially created with a guest_memfd binding, as KVM doesn't support\ntoggling KVM_MEM_GUEST_MEMFD on existing memslots.  KVM prevents enabling\nKVM_MEM_GUEST_MEMFD, but doesn't prevent clearing the flag.\n\nFailure to reject the new memslot results in a use-after-free due to KVM\nnot unbinding from the guest_memfd instance.  Unbinding on a FLAGS_ONLY\nchange is easy enough, and can/will be done as a hardening measure (in\nanticipation of KVM supporting dirty logging on guest_memfd at some point),\nbut fixing the use-after-free would only address the immediate symptom.\n\n  ==================================================================\n  BUG: KASAN: slab-use-after-free in kvm_gmem_release+0x362/0x400 [kvm]\n  Write of size 8 at addr ffff8881111ae908 by task repro/745\n\n  CPU: 7 UID: 1000 PID: 745 Comm: repro Not tainted 6.18.0-rc6-115d5de2eef3-next-kasan #3 NONE\n  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 0.0.0 02/06/2015\n  Call Trace:\n   <TASK>\n   dump_stack_lvl+0x51/0x60\n   print_report+0xcb/0x5c0\n   kasan_report+0xb4/0xe0\n   kvm_gmem_release+0x362/0x400 [kvm]\n   __fput+0x2fa/0x9d0\n   task_work_run+0x12c/0x200\n   do_exit+0x6ae/0x2100\n   do_group_exit+0xa8/0x230\n   __x64_sys_exit_group+0x3a/0x50\n   x64_sys_call+0x737/0x740\n   do_syscall_64+0x5b/0x900\n   entry_SYSCALL_64_after_hwframe+0x4b/0x53\n  RIP: 0033:0x7f581f2eac31\n   </TASK>\n\n  Allocated by task 745 on cpu 6 at 9.746971s:\n   kasan_save_stack+0x20/0x40\n   kasan_save_track+0x13/0x50\n   __kasan_kmalloc+0x77/0x90\n   kvm_set_memory_region.part.0+0x652/0x1110 [kvm]\n   kvm_vm_ioctl+0x14b0/0x3290 [kvm]\n   __x64_sys_ioctl+0x129/0x1a0\n   do_syscall_64+0x5b/0x900\n   entry_SYSCALL_64_after_hwframe+0x4b/0x53\n\n  Freed by task 745 on cpu 6 at 9.747467s:\n   kasan_save_stack+0x20/0x40\n   kasan_save_track+0x13/0x50\n   __kasan_save_free_info+0x37/0x50\n   __kasan_slab_free+0x3b/0x60\n   kfree+0xf5/0x440\n   kvm_set_memslot+0x3c2/0x1160 [kvm]\n   kvm_set_memory_region.part.0+0x86a/0x1110 [kvm]\n   kvm_vm_ioctl+0x14b0/0x3290 [kvm]\n   __x64_sys_ioctl+0x129/0x1a0\n   do_syscall_64+0x5b/0x900\n   entry_SYSCALL_64_after_hwframe+0x4b/0x53", "datePublished": "2026-01-13T15:29:16", "dateUpdated": "2026-01-13T15:29:16", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68810", "https://git.kernel.org/stable/c/89dbbe6ff323fc34659621a577fe0af913f47386", "https://git.kernel.org/stable/c/9935df5333aa503a18de5071f53762b65c783c4c", "https://git.kernel.org/stable/c/cb51bef465d8ec60a968507330e01020e35dc127"], "aliases": ["CVE-2025-68810", "GHSA-65g7-h87v-v85m"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "13241cdd-5d70-37ef-806e-d5866a763b4c", "product": {"name": "Linux"}, "product_version": "a7800aa80ea4d5356b8474c2302812e9d4926fa6 <cb51bef465d8ec60a968507330e01020e35dc127"}, {"id": "2167fbbe-b0fc-348e-ae86-03f20e7655ac", "product": {"name": "Linux"}, "product_version": "6.8"}, {"id": "3fd053f5-21c9-3c7e-bf63-03f8ecedbad8", "product": {"name": "Linux"}, "product_version": "a7800aa80ea4d5356b8474c2302812e9d4926fa6 <9935df5333aa503a18de5071f53762b65c783c4c"}, {"id": "667a27d6-01cb-3600-b2a3-b16aaf74cae3", "product": {"name": "Linux"}, "product_version": "a7800aa80ea4d5356b8474c2302812e9d4926fa6 <89dbbe6ff323fc34659621a577fe0af913f47386"}, {"id": "7e8aed18-a04f-30d6-8b84-fa8a240b0ccb", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc2"}, {"id": "9a687085-8a9f-3a70-b80d-3a45db9f998a", "product": {"name": "Linux"}, "product_version": "patch: 6.12.64"}, {"id": "a90499ac-1aaf-300a-b9b2-3ed7b0296aeb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d28e5b9e-09fa-34b7-bb2d-6d7f9ca0061b", "product": {"name": "Linux"}, "product_version": "patch: 6.18.3"}], "enisaIdVendor": [{"id": "51652ec7-eda0-38d9-9d44-9521b59bd35e", "vendor": {"name": "Linux"}}], "isExploited": false}