{"id": "EUVD-2026-2337", "enisaUuid": "3a919f68-428c-3313-b30c-e7fea7d22928", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: fix missing hfs_bnode_get() in __hfs_bnode_create\n\nWhen sync() and link() are called concurrently, both threads may\nenter hfs_bnode_find() without finding the node in the hash table\nand proceed to create it.\n\nThread A:\n  hfsplus_write_inode()\n    -> hfsplus_write_system_inode()\n      -> hfs_btree_write()\n        -> hfs_bnode_find(tree, 0)\n          -> __hfs_bnode_create(tree, 0)\n\nThread B:\n  hfsplus_create_cat()\n    -> hfs_brec_insert()\n      -> hfs_bnode_split()\n        -> hfs_bmap_alloc()\n          -> hfs_bnode_find(tree, 0)\n            -> __hfs_bnode_create(tree, 0)\n\nIn this case, thread A creates the bnode, sets refcnt=1, and hashes it.\nThread B also tries to create the same bnode, notices it has already\nbeen inserted, drops its own instance, and uses the hashed one without\ngetting the node.\n\n```\n\n\tnode2 = hfs_bnode_findhash(tree, cnid);\n\tif (!node2) {                                 <- Thread A\n\t\thash = hfs_bnode_hash(cnid);\n\t\tnode->next_hash = tree->node_hash[hash];\n\t\ttree->node_hash[hash] = node;\n\t\ttree->node_hash_cnt++;\n\t} else {                                      <- Thread B\n\t\tspin_unlock(&tree->hash_lock);\n\t\tkfree(node);\n\t\twait_event(node2->lock_wq,\n\t\t\t!test_bit(HFS_BNODE_NEW, &node2->flags));\n\t\treturn node2;\n\t}\n```\n\nHowever, hfs_bnode_find() requires each call to take a reference.\nHere both threads end up setting refcnt=1. When they later put the node,\nthis triggers:\n\nBUG_ON(!atomic_read(&node->refcnt))\n\nIn this scenario, Thread B in fact finds the node in the hash table\nrather than creating a new one, and thus must take a reference.\n\nFix this by calling hfs_bnode_get() when reusing a bnode newly created by\nanother thread to ensure the refcount is updated correctly.\n\nA similar bug was fixed in HFS long ago in commit\na9dc087fd3c4 (\"fix missing hfs_bnode_get() in __hfs_bnode_create\")\nbut the same issue remained in HFS+ until now.", "datePublished": "2026-01-13T15:28:51", "dateUpdated": "2026-01-13T15:28:51", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68774", "https://git.kernel.org/stable/c/152af114287851583cf7e0abc10129941f19466a", "https://git.kernel.org/stable/c/457f795e7abd7770de10216d7f9994a3f12a56d6", "https://git.kernel.org/stable/c/5882e7c8cdbb5e254a69628b780acff89c78071e", "https://git.kernel.org/stable/c/b68dc4134b18a3922cd33439ec614aad4172bc86", "https://git.kernel.org/stable/c/b9d1c6bb5f19460074ce9862cb80be86b5fb0a50"], "aliases": ["CVE-2025-68774", "GHSA-2wrv-52xx-6xxv"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1289acc4-7a06-300f-9d29-cb07922c58da", "product": {"name": "Linux"}, "product_version": "patch: 6.6.120"}, {"id": "179144de-3a47-3d0d-ab3d-753d3fa088e0", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b68dc4134b18a3922cd33439ec614aad4172bc86"}, {"id": "71c85d77-453f-3727-b250-d570dde0094f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <457f795e7abd7770de10216d7f9994a3f12a56d6"}, {"id": "7c0d42c0-3f82-333a-87d1-15a2097774e7", "product": {"name": "Linux"}, "product_version": "patch: 6.1.160"}, {"id": "94c98ac0-da1d-386a-9df5-fb23d06fa658", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b9d1c6bb5f19460074ce9862cb80be86b5fb0a50"}, {"id": "ba43ca70-dfd0-33ff-ae35-4bea8137390f", "product": {"name": "Linux"}, "product_version": "patch: 6.18.3"}, {"id": "cd069b90-74df-3f4f-b424-040c37bacbfe", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <152af114287851583cf7e0abc10129941f19466a"}, {"id": "edabd750-c2cd-320c-8c42-f5495d32fcc2", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc1"}, {"id": "fa50a391-9ff7-3c55-ba40-1f335fdca0db", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5882e7c8cdbb5e254a69628b780acff89c78071e"}, {"id": "fb77a525-4cf8-307a-a9ce-287b28428446", "product": {"name": "Linux"}, "product_version": "patch: 6.12.64"}], "enisaIdVendor": [{"id": "8458173e-2287-39d7-ac1e-1ee2ee6b6bc8", "vendor": {"name": "Linux"}}], "isExploited": false}