{"id": "EUVD-2026-2330", "enisaUuid": "34aae125-f876-363d-b67a-46a520c069c2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ninet: frags: flush pending skbs in fqdir_pre_exit()\n\nWe have been seeing occasional deadlocks on pernet_ops_rwsem since\nSeptember in NIPA. The stuck task was usually modprobe (often loading\na driver like ipvlan), trying to take the lock as a Writer.\nlockdep does not track readers for rwsems so the read wasn't obvious\nfrom the reports.\n\nOn closer inspection the Reader holding the lock was conntrack looping\nforever in nf_conntrack_cleanup_net_list(). Based on past experience\nwith occasional NIPA crashes I looked thru the tests which run before\nthe crash and noticed that the crash follows ip_defrag.sh. An immediate\nred flag. Scouring thru (de)fragmentation queues reveals skbs sitting\naround, holding conntrack references.\n\nThe problem is that since conntrack depends on nf_defrag_ipv6,\nnf_defrag_ipv6 will load first. Since nf_defrag_ipv6 loads first its\nnetns exit hooks run _after_ conntrack's netns exit hook.\n\nFlush all fragment queue SKBs during fqdir_pre_exit() to release\nconntrack references before conntrack cleanup runs. Also flush\nthe queues in timer expiry handlers when they discover fqdir->dead\nis set, in case packet sneaks in while we're running the pre_exit\nflush.\n\nThe commit under Fixes is not exactly the culprit, but I think\npreviously the timer firing would eventually unblock the spinning\nconntrack.", "datePublished": "2026-01-13T15:28:47", "dateUpdated": "2026-01-13T15:28:47", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68768", "https://git.kernel.org/stable/c/006a5035b495dec008805df249f92c22c89c3d2e", "https://git.kernel.org/stable/c/c70df25214ac9b32b53e18e6ae3b8f073ffa6903"], "aliases": ["CVE-2025-68768", "GHSA-6g94-rwcj-hwx9"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "06264349-daac-31f3-ba58-cf8f74b80bf7", "product": {"name": "Linux"}, "product_version": "d5dd88794a13c2f24cce31abad7a0a6c5e0ed2db <006a5035b495dec008805df249f92c22c89c3d2e"}, {"id": "17b5ae80-d543-38fc-a39e-0f2751f9eaf1", "product": {"name": "Linux"}, "product_version": "d5dd88794a13c2f24cce31abad7a0a6c5e0ed2db <c70df25214ac9b32b53e18e6ae3b8f073ffa6903"}, {"id": "b3aea557-94c8-3b06-8677-07b2870ead50", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc2"}, {"id": "ca06a3da-0ab9-361f-a92b-538cb284d797", "product": {"name": "Linux"}, "product_version": "5.3"}, {"id": "db56794d-3c52-3f80-80c1-d9defe31c111", "product": {"name": "Linux"}, "product_version": "patch: 6.18.3"}, {"id": "defb8cd2-7ae9-3d4b-8507-25be2f9662a3", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "ef563f8c-0f9d-3b60-9266-52f17562fe20", "vendor": {"name": "Linux"}}], "isExploited": false}