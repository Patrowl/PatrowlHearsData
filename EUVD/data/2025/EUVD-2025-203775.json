{"id": "EUVD-2025-203775", "enisaUuid": "7fa82583-c3fc-3f68-b041-2c071b103035", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: hci_sock: Prevent race in socket write iter and sock bind\n\nThere is a potential race condition between sock bind and socket write\niter. bind may free the same cmd via mgmt_pending before write iter sends\nthe cmd, just as syzbot reported in UAF[1].\n\nHere we use hci_dev_lock to synchronize the two, thereby avoiding the\nUAF mentioned in [1].\n\n[1]\nsyzbot reported:\nBUG: KASAN: slab-use-after-free in mgmt_pending_remove+0x3b/0x210 net/bluetooth/mgmt_util.c:316\nRead of size 8 at addr ffff888077164818 by task syz.0.17/5989\nCall Trace:\n mgmt_pending_remove+0x3b/0x210 net/bluetooth/mgmt_util.c:316\n set_link_security+0x5c2/0x710 net/bluetooth/mgmt.c:1918\n hci_mgmt_cmd+0x9c9/0xef0 net/bluetooth/hci_sock.c:1719\n hci_sock_sendmsg+0x6ca/0xef0 net/bluetooth/hci_sock.c:1839\n sock_sendmsg_nosec net/socket.c:727 [inline]\n __sock_sendmsg+0x21c/0x270 net/socket.c:742\n sock_write_iter+0x279/0x360 net/socket.c:1195\n\nAllocated by task 5989:\n mgmt_pending_add+0x35/0x140 net/bluetooth/mgmt_util.c:296\n set_link_security+0x557/0x710 net/bluetooth/mgmt.c:1910\n hci_mgmt_cmd+0x9c9/0xef0 net/bluetooth/hci_sock.c:1719\n hci_sock_sendmsg+0x6ca/0xef0 net/bluetooth/hci_sock.c:1839\n sock_sendmsg_nosec net/socket.c:727 [inline]\n __sock_sendmsg+0x21c/0x270 net/socket.c:742\n sock_write_iter+0x279/0x360 net/socket.c:1195\n\nFreed by task 5991:\n mgmt_pending_free net/bluetooth/mgmt_util.c:311 [inline]\n mgmt_pending_foreach+0x30d/0x380 net/bluetooth/mgmt_util.c:257\n mgmt_index_removed+0x112/0x2f0 net/bluetooth/mgmt.c:9477\n hci_sock_bind+0xbe9/0x1000 net/bluetooth/hci_sock.c:1314", "datePublished": "2025-12-16T18:31:34", "dateUpdated": "2025-12-16T18:31:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/fe68510fc99bb4b88c9c611f83699749002d515a", "https://git.kernel.org/stable/c/e90c05fc5bbea956450a05cc3b36b8fa29cf195e", "https://git.kernel.org/stable/c/69fcb0344bc0dd5b13d7e4e98f8b6bf25a6d4ff7", "https://git.kernel.org/stable/c/89bb613511cc21ed5ba6bddc1c9b9ae9c0dad392", "https://nvd.nist.gov/vuln/detail/CVE-2025-68305"], "aliases": ["CVE-2025-68305"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0ceb06c4-2430-3945-80ef-6d851eef3249", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "1f43b1b9-a7fd-3c69-be73-1ad1aa9dd7d1", "product": {"name": "Linux"}, "product_version": "patch: 6.17.11"}, {"id": "29b994a0-06af-39f3-8f0a-52f2f4c2fe8f", "product": {"name": "Linux"}, "product_version": "4e83f2dbb2bf677e614109df24426c4dded472d4 <e90c05fc5bbea956450a05cc3b36b8fa29cf195e"}, {"id": "2b154a75-ffa3-37e5-8b08-a0b3e749a25c", "product": {"name": "Linux"}, "product_version": "d7882db79135c829a922daf3571f33ea1e056ae3"}, {"id": "5ac66b92-6c18-3af0-82c2-38143a2687e8", "product": {"name": "Linux"}, "product_version": "patch: 6.12.61"}, {"id": "5d7a1430-fad1-3136-8f99-4e424bf2c284", "product": {"name": "Linux"}, "product_version": "bdd56875c6926d8009914f427df71797693e90d4 <fe68510fc99bb4b88c9c611f83699749002d515a"}, {"id": "670ef012-52cb-36c6-a26d-a1cd107dbd08", "product": {"name": "Linux"}, "product_version": "6.16"}, {"id": "8d558d80-f5ce-3fb4-a523-05a6cd4a9747", "product": {"name": "Linux"}, "product_version": "patch: 6.6.119"}, {"id": "91d2d5d1-6843-398e-bc93-467505370db0", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "a111de35-6d47-3499-8f9e-29dae45331e1", "product": {"name": "Linux"}, "product_version": "6fe26f694c824b8a4dbf50c635bee1302e3f099c <69fcb0344bc0dd5b13d7e4e98f8b6bf25a6d4ff7"}, {"id": "ff9ad83f-730c-3b86-9de2-bb2c9441ef0a", "product": {"name": "Linux"}, "product_version": "6fe26f694c824b8a4dbf50c635bee1302e3f099c <89bb613511cc21ed5ba6bddc1c9b9ae9c0dad392"}], "enisaIdVendor": [{"id": "c594cf2e-0a89-3bbf-b307-1905ce433c0f", "vendor": {"name": "Linux"}}], "isExploited": false}