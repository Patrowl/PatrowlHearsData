{"id": "EUVD-2025-19814", "enisaUuid": "e620514c-5729-3161-b295-ca8024f86354", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npage_pool: Fix use-after-free in page_pool_recycle_in_ring\n\nsyzbot reported a uaf in page_pool_recycle_in_ring:\n\nBUG: KASAN: slab-use-after-free in lock_release+0x151/0xa30 kernel/locking/lockdep.c:5862\nRead of size 8 at addr ffff8880286045a0 by task syz.0.284/6943\n\nCPU: 0 UID: 0 PID: 6943 Comm: syz.0.284 Not tainted 6.13.0-rc3-syzkaller-gdfa94ce54f41 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:94 [inline]\n dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:378 [inline]\n print_report+0x169/0x550 mm/kasan/report.c:489\n kasan_report+0x143/0x180 mm/kasan/report.c:602\n lock_release+0x151/0xa30 kernel/locking/lockdep.c:5862\n __raw_spin_unlock_bh include/linux/spinlock_api_smp.h:165 [inline]\n _raw_spin_unlock_bh+0x1b/0x40 kernel/locking/spinlock.c:210\n spin_unlock_bh include/linux/spinlock.h:396 [inline]\n ptr_ring_produce_bh include/linux/ptr_ring.h:164 [inline]\n page_pool_recycle_in_ring net/core/page_pool.c:707 [inline]\n page_pool_put_unrefed_netmem+0x748/0xb00 net/core/page_pool.c:826\n page_pool_put_netmem include/net/page_pool/helpers.h:323 [inline]\n page_pool_put_full_netmem include/net/page_pool/helpers.h:353 [inline]\n napi_pp_put_page+0x149/0x2b0 net/core/skbuff.c:1036\n skb_pp_recycle net/core/skbuff.c:1047 [inline]\n skb_free_head net/core/skbuff.c:1094 [inline]\n skb_release_data+0x6c4/0x8a0 net/core/skbuff.c:1125\n skb_release_all net/core/skbuff.c:1190 [inline]\n __kfree_skb net/core/skbuff.c:1204 [inline]\n sk_skb_reason_drop+0x1c9/0x380 net/core/skbuff.c:1242\n kfree_skb_reason include/linux/skbuff.h:1263 [inline]\n __skb_queue_purge_reason include/linux/skbuff.h:3343 [inline]\n\nroot cause is:\n\npage_pool_recycle_in_ring\n  ptr_ring_produce\n    spin_lock(&r->producer_lock);\n    WRITE_ONCE(r->queue[r->producer++], ptr)\n      //recycle last page to pool\n\t\t\t\tpage_pool_release\n\t\t\t\t  page_pool_scrub\n\t\t\t\t    page_pool_empty_ring\n\t\t\t\t      ptr_ring_consume\n\t\t\t\t      page_pool_return_page  //release all page\n\t\t\t\t  __page_pool_destroy\n\t\t\t\t     free_percpu(pool->recycle_stats);\n\t\t\t\t     free(pool) //free\n\n     spin_unlock(&r->producer_lock); //pool->ring uaf read\n  recycle_stat_inc(pool, ring);\n\npage_pool can be free while page pool recycle the last page in ring.\nAdd producer-lock barrier to page_pool_release to prevent the page\npool from being free before all pages have been recycled.\n\nrecycle_stat_inc() is empty when CONFIG_PAGE_POOL_STATS is not\nenabled, which will trigger Wempty-body build warning. Add definition\nfor pool stat macro to fix warning.", "datePublished": "2025-07-03T09:30:33", "dateUpdated": "2025-11-20T21:30:29", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e869a85acc2e60dc554579b910826a4919d8cd98", "https://git.kernel.org/stable/c/4ab8c0f8905c9c4d05e7f437e65a9a365573ff02", "https://git.kernel.org/stable/c/271683bb2cf32e5126c592b5d5e6a756fa374fd9", "https://nvd.nist.gov/vuln/detail/CVE-2025-38129"], "aliases": ["CVE-2025-38129"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "08ab64c8-66d1-35c2-87f8-8a6622149866", "product": {"name": "Linux"}, "product_version": "ff7d6b27f894f1469dc51ccb828b7363ccd9799f <e869a85acc2e60dc554579b910826a4919d8cd98"}, {"id": "12102c24-93d5-37c4-ac5f-2f7952431e01", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "14b92c54-e7dd-3efe-b3df-b74597ac4699", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "1b37f434-e104-3a6f-b5f7-aff2527b908e", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "20188437-61c7-3d34-8a5a-aa611db79bc1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "862af785-8ea6-32bc-8711-d097874189f5", "product": {"name": "Linux"}, "product_version": "4.18"}, {"id": "aa3a11c3-6229-39a5-a8ec-e7146eebac58", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "f1567ebd-582b-3932-b593-850d1c3f5ed1", "product": {"name": "Linux"}, "product_version": "ff7d6b27f894f1469dc51ccb828b7363ccd9799f <271683bb2cf32e5126c592b5d5e6a756fa374fd9"}, {"id": "f362f655-c879-321d-9c46-63d2266aebe2", "product": {"name": "Linux"}, "product_version": "ff7d6b27f894f1469dc51ccb828b7363ccd9799f <4ab8c0f8905c9c4d05e7f437e65a9a365573ff02"}], "enisaIdVendor": [{"id": "5ff62295-d9d1-3c7b-a4f5-00532e5951e7", "vendor": {"name": "Linux"}}], "isExploited": false}