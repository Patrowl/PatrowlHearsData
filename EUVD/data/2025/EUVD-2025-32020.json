{"id": "EUVD-2025-32020", "enisaUuid": "7eff9acf-c1b6-3b35-943c-d4d9e87cf794", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: reject invalid reloc tree root keys with stack dump\n\n[BUG]\nSyzbot reported a crash that an ASSERT() got triggered inside\nprepare_to_merge().\n\nThat ASSERT() makes sure the reloc tree is properly pointed back by its\nsubvolume tree.\n\n[CAUSE]\nAfter more debugging output, it turns out we had an invalid reloc tree:\n\n  BTRFS error (device loop1): reloc tree mismatch, root 8 has no reloc root, expect reloc root key (-8, 132, 8) gen 17\n\nNote the above root key is (TREE_RELOC_OBJECTID, ROOT_ITEM,\nQUOTA_TREE_OBJECTID), meaning it's a reloc tree for quota tree.\n\nBut reloc trees can only exist for subvolumes, as for non-subvolume\ntrees, we just COW the involved tree block, no need to create a reloc\ntree since those tree blocks won't be shared with other trees.\n\nOnly subvolumes tree can share tree blocks with other trees (thus they\nhave BTRFS_ROOT_SHAREABLE flag).\n\nThus this new debug output proves my previous assumption that corrupted\non-disk data can trigger that ASSERT().\n\n[FIX]\nBesides the dedicated fix and the graceful exit, also let tree-checker to\ncheck such root keys, to make sure reloc trees can only exist for subvolumes.", "datePublished": "2025-10-07T15:19:25", "dateUpdated": "2025-10-07T15:19:25", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53618", "https://git.kernel.org/stable/c/314135b7bae9618a317874ae195272682cf2d5d4", "https://git.kernel.org/stable/c/3ae93b316ca4b8b3c33798ef1d210355f2fb9318", "https://git.kernel.org/stable/c/6ebcd021c92b8e4b904552e4d87283032100796d", "https://git.kernel.org/stable/c/84256e00eeca73c529fc6196e478cc89b8098157"], "aliases": ["CVE-2023-53618", "GHSA-2244-8r8j-955v"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "00d9cef6-d5cc-3321-b3b0-3085bf97e4b9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <84256e00eeca73c529fc6196e478cc89b8098157"}, {"id": "2285f25e-ae04-310f-b264-1bc2c77fae72", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <314135b7bae9618a317874ae195272682cf2d5d4"}, {"id": "485ab1ff-c35c-3883-82c3-15af3f383293", "product": {"name": "Linux"}, "product_version": "patch: 6.1.46"}, {"id": "4b9535b2-16d4-3b97-9207-86f70277c050", "product": {"name": "Linux"}, "product_version": "patch: 6.4.11"}, {"id": "623519ba-225e-388c-8565-07e2f1763d7b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.127"}, {"id": "8f05848a-c6b2-33b9-a911-e0f863a88b36", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "95d3c0f4-0adb-3eeb-93a1-e22d6f1411b8", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6ebcd021c92b8e4b904552e4d87283032100796d"}, {"id": "d18712d3-1831-3003-a748-f270535c97f6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3ae93b316ca4b8b3c33798ef1d210355f2fb9318"}], "enisaIdVendor": [{"id": "0f1694ff-3091-3c03-a6cc-54d29704827f", "vendor": {"name": "Linux"}}], "isExploited": false}