{"id": "EUVD-2025-203781", "enisaUuid": "58c6bd5c-9681-3aac-848e-cb3621e7924c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nafs: Fix delayed allocation of a cell's anonymous key\n\nThe allocation of a cell's anonymous key is done in a background thread\nalong with other cell setup such as doing a DNS upcall.  In the reported\nbug, this is triggered by afs_parse_source() parsing the device name given\nto mount() and calling afs_lookup_cell() with the name of the cell.\n\nThe normal key lookup then tries to use the key description on the\nanonymous authentication key as the reference for request_key() - but it\nmay not yet be set and so an oops can happen.\n\nThis has been made more likely to happen by the fix for dynamic lookup\nfailure.\n\nFix this by firstly allocating a reference name and attaching it to the\nafs_cell record when the record is created.  It can share the memory\nallocation with the cell name (unfortunately it can't just overlap the cell\nname by prepending it with \"afs@\" as the cell name already has a '.'\nprepended for other purposes).  This reference name is then passed to\nrequest_key().\n\nSecondly, the anon key is now allocated on demand at the point a key is\nrequested in afs_request_key() if it is not already allocated.  A mutex is\nused to prevent multiple allocation for a cell.\n\nThirdly, make afs_request_key_rcu() return NULL if the anonymous key isn't\nyet allocated (if we need it) and then the caller can return -ECHILD to\ndrop out of RCU-mode and afs_request_key() can be called.\n\nNote that the anonymous key is kind of necessary to make the key lookup\ncache work as that doesn't currently cache a negative lookup, but it's\nprobably worth some investigation to see if NULL can be used instead.", "datePublished": "2025-12-16T18:31:33", "dateUpdated": "2025-12-16T18:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/5613bde937dfac6725e9c3fc766b9d6b8481e55b", "https://git.kernel.org/stable/c/d27c71257825dced46104eefe42e4d9964bd032e", "https://nvd.nist.gov/vuln/detail/CVE-2025-68299"], "aliases": ["CVE-2025-68299"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "119e7af6-73e1-3332-a93c-73bb789ae621", "product": {"name": "Linux"}, "product_version": "330e2c514823008b22e6afd2055715bc46dd8d55 <d27c71257825dced46104eefe42e4d9964bd032e"}, {"id": "7538861a-53e4-33bc-a0bf-d7de8bc7d80b", "product": {"name": "Linux"}, "product_version": "7e33b15d5a6578a99ebf189cea34983270ae92dd <5613bde937dfac6725e9c3fc766b9d6b8481e55b"}, {"id": "feb998e6-cb73-33e3-bd1b-59bc9c05f901", "product": {"name": "Linux"}, "product_version": "6.17.9 <6.17.11"}], "enisaIdVendor": [{"id": "1903dded-66f7-33d7-bc50-eae4ed2291af", "vendor": {"name": "Linux"}}], "isExploited": false}