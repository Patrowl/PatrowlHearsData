{"id": "EUVD-2025-22886", "enisaUuid": "139df9c0-87e5-31f7-be9f-96449c4eda3c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrpl: Fix use-after-free in rpl_do_srh_inline().\n\nRunning lwt_dst_cache_ref_loop.sh in selftest with KASAN triggers\nthe splat below [0].\n\nrpl_do_srh_inline() fetches ipv6_hdr(skb) and accesses it after\nskb_cow_head(), which is illegal as the header could be freed then.\n\nLet's fix it by making oldhdr to a local struct instead of a pointer.\n\n[0]:\n[root@fedora net]# ./lwt_dst_cache_ref_loop.sh\n...\nTEST: rpl (input)\n[   57.631529] ==================================================================\nBUG: KASAN: slab-use-after-free in rpl_do_srh_inline.isra.0 (net/ipv6/rpl_iptunnel.c:174)\nRead of size 40 at addr ffff888122bf96d8 by task ping6/1543\n\nCPU: 50 UID: 0 PID: 1543 Comm: ping6 Not tainted 6.16.0-rc5-01302-gfadd1e6231b1 #23 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\nCall Trace:\n <IRQ>\n dump_stack_lvl (lib/dump_stack.c:122)\n print_report (mm/kasan/report.c:409 mm/kasan/report.c:521)\n kasan_report (mm/kasan/report.c:221 mm/kasan/report.c:636)\n kasan_check_range (mm/kasan/generic.c:175 (discriminator 1) mm/kasan/generic.c:189 (discriminator 1))\n __asan_memmove (mm/kasan/shadow.c:94 (discriminator 2))\n rpl_do_srh_inline.isra.0 (net/ipv6/rpl_iptunnel.c:174)\n rpl_input (net/ipv6/rpl_iptunnel.c:201 net/ipv6/rpl_iptunnel.c:282)\n lwtunnel_input (net/core/lwtunnel.c:459)\n ipv6_rcv (./include/net/dst.h:471 (discriminator 1) ./include/net/dst.h:469 (discriminator 1) net/ipv6/ip6_input.c:79 (discriminator 1) ./include/linux/netfilter.h:317 (discriminator 1) ./include/linux/netfilter.h:311 (discriminator 1) net/ipv6/ip6_input.c:311 (discriminator 1))\n __netif_receive_skb_one_core (net/core/dev.c:5967)\n process_backlog (./include/linux/rcupdate.h:869 net/core/dev.c:6440)\n __napi_poll.constprop.0 (net/core/dev.c:7452)\n net_rx_action (net/core/dev.c:7518 net/core/dev.c:7643)\n handle_softirqs (kernel/softirq.c:579)\n do_softirq (kernel/softirq.c:480 (discriminator 20))\n </IRQ>\n <TASK>\n __local_bh_enable_ip (kernel/softirq.c:407)\n __dev_queue_xmit (net/core/dev.c:4740)\n ip6_finish_output2 (./include/linux/netdevice.h:3358 ./include/net/neighbour.h:526 ./include/net/neighbour.h:540 net/ipv6/ip6_output.c:141)\n ip6_finish_output (net/ipv6/ip6_output.c:215 net/ipv6/ip6_output.c:226)\n ip6_output (./include/linux/netfilter.h:306 net/ipv6/ip6_output.c:248)\n ip6_send_skb (net/ipv6/ip6_output.c:1983)\n rawv6_sendmsg (net/ipv6/raw.c:588 net/ipv6/raw.c:918)\n __sys_sendto (net/socket.c:714 (discriminator 1) net/socket.c:729 (discriminator 1) net/socket.c:2228 (discriminator 1))\n __x64_sys_sendto (net/socket.c:2231)\n do_syscall_64 (arch/x86/entry/syscall_64.c:63 (discriminator 1) arch/x86/entry/syscall_64.c:94 (discriminator 1))\n entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\nRIP: 0033:0x7f68cffb2a06\nCode: 5d e8 41 8b 93 08 03 00 00 59 5e 48 83 f8 fc 75 19 83 e2 39 83 fa 08 75 11 e8 26 ff ff ff 66 0f 1f 44 00 00 48 8b 45 10 0f 05 <48> 8b 5d f8 c9 c3 0f 1f 40 00 f3 0f 1e fa 55 48 89 e5 48 83 ec 08\nRSP: 002b:00007ffefb7c53d0 EFLAGS: 00000202 ORIG_RAX: 000000000000002c\nRAX: ffffffffffffffda RBX: 0000564cd69f10a0 RCX: 00007f68cffb2a06\nRDX: 0000000000000040 RSI: 0000564cd69f10a4 RDI: 0000000000000003\nRBP: 00007ffefb7c53f0 R08: 0000564cd6a032ac R09: 000000000000001c\nR10: 0000000000000000 R11: 0000000000000202 R12: 0000564cd69f10a4\nR13: 0000000000000040 R14: 00007ffefb7c66e0 R15: 0000564cd69f10a0\n </TASK>\n\nAllocated by task 1543:\n kasan_save_stack (mm/kasan/common.c:48)\n kasan_save_track (mm/kasan/common.c:60 (discriminator 1) mm/kasan/common.c:69 (discriminator 1))\n __kasan_slab_alloc (mm/kasan/common.c:319 mm/kasan/common.c:345)\n kmem_cache_alloc_node_noprof (./include/linux/kasan.h:250 mm/slub.c:4148 mm/slub.c:4197 mm/slub.c:4249)\n kmalloc_reserve (net/core/skbuff.c:581 (discriminator 88))\n __alloc_skb (net/core/skbuff.c:669)\n __ip6_append_data (net/ipv6/ip6_output.c:1672 (discriminator 1))\n ip6_\n---truncated---", "datePublished": "2025-07-28T12:30:35", "dateUpdated": "2025-12-22T21:30:31", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e8101506ab86dd78f823b7028f2036a380f3a12a", "https://git.kernel.org/stable/c/62dcd9d6e61c39122d2f251a26829e2e55b0a11d", "https://git.kernel.org/stable/c/06ec83b6c792fde1f710c1de3e836da6e257c4c4", "https://git.kernel.org/stable/c/034b428aa3583373a5a20b1c5931bb2b3cae1f36", "https://git.kernel.org/stable/c/b640daa2822a39ff76e70200cb2b7b892b896dce", "https://git.kernel.org/stable/c/c09e21dfc08d8afb92d9ea3bee3457adbe3ef297", "https://git.kernel.org/stable/c/8ba6c2362b85089b8972ac5f20b24fc71a4b8ffc", "https://nvd.nist.gov/vuln/detail/CVE-2025-38476", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38476"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "021c6758-8518-3db0-9ef4-23ff29a4e72a", "product": {"name": "Linux"}, "product_version": "patch: 6.15.8"}, {"id": "11872f46-83e4-3f27-82c8-02224c279800", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "32bd470b-a5d3-3908-ba51-88d3e8af473c", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <8ba6c2362b85089b8972ac5f20b24fc71a4b8ffc"}, {"id": "378e4f85-1faf-34b8-95e6-a857e44506aa", "product": {"name": "Linux"}, "product_version": "patch: 6.6.100"}, {"id": "4960e755-0bb9-3bf9-b4fc-0719e5810133", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <e8101506ab86dd78f823b7028f2036a380f3a12a"}, {"id": "5cd38c80-c198-3f5e-a34d-497354794d57", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <034b428aa3583373a5a20b1c5931bb2b3cae1f36"}, {"id": "6ecb780a-2b3f-3cee-9b1d-1af1c9aa7775", "product": {"name": "Linux"}, "product_version": "5.7"}, {"id": "6f334077-6118-3c32-8a67-bdfd5de9597a", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <b640daa2822a39ff76e70200cb2b7b892b896dce"}, {"id": "83740db6-2a7d-38b1-b1e3-9892ac3bc9a2", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <62dcd9d6e61c39122d2f251a26829e2e55b0a11d"}, {"id": "9688a963-462a-38ef-a2ef-1612a7d5ea74", "product": {"name": "Linux"}, "product_version": "patch: 6.1.147"}, {"id": "97a48ddb-6d01-3a3f-8f87-b117be72d3ce", "product": {"name": "Linux"}, "product_version": "patch: 6.12.40"}, {"id": "a3cbabea-c4ea-3cfd-babd-bb531f8b2767", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "ae33fb06-732f-31de-ba96-68d9ae480bc1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c3560913-c030-3ae7-a77e-5b6db6634805", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "d6b0c753-20e2-3f86-9c0a-ddb09471fec9", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <c09e21dfc08d8afb92d9ea3bee3457adbe3ef297"}, {"id": "d7f1cb5a-6a3a-306d-8ba1-518e618f94ec", "product": {"name": "Linux"}, "product_version": "a7a29f9c361f8542604ef959ae6627f423b7a412 <06ec83b6c792fde1f710c1de3e836da6e257c4c4"}], "enisaIdVendor": [{"id": "c70333b1-fc1d-30ca-bb65-09d3c66860d4", "vendor": {"name": "Linux"}}], "isExploited": false}