{"id": "EUVD-2025-201224", "enisaUuid": "6591a917-7db6-3aa4-b2bc-5a742e7edcdc", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: directly free partially initialized fs_info in btrfs_check_leaked_roots()\n\nIf fs_info->super_copy or fs_info->super_for_commit allocated failed in\nbtrfs_get_tree_subvol(), then no need to call btrfs_free_fs_info().\nOtherwise btrfs_check_leaked_roots() would access NULL pointer because\nfs_info->allocated_roots had not been initialised.\n\nsyzkaller reported the following information:\n  ------------[ cut here ]------------\n  BUG: unable to handle page fault for address: fffffffffffffbb0\n  #PF: supervisor read access in kernel mode\n  #PF: error_code(0x0000) - not-present page\n  PGD 64c9067 P4D 64c9067 PUD 64cb067 PMD 0\n  Oops: Oops: 0000 [#1] SMP KASAN PTI\n  CPU: 0 UID: 0 PID: 1402 Comm: syz.1.35 Not tainted 6.15.8 #4 PREEMPT(lazy)\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), (...)\n  RIP: 0010:arch_atomic_read arch/x86/include/asm/atomic.h:23 [inline]\n  RIP: 0010:raw_atomic_read include/linux/atomic/atomic-arch-fallback.h:457 [inline]\n  RIP: 0010:atomic_read include/linux/atomic/atomic-instrumented.h:33 [inline]\n  RIP: 0010:refcount_read include/linux/refcount.h:170 [inline]\n  RIP: 0010:btrfs_check_leaked_roots+0x18f/0x2c0 fs/btrfs/disk-io.c:1230\n  [...]\n  Call Trace:\n   <TASK>\n   btrfs_free_fs_info+0x310/0x410 fs/btrfs/disk-io.c:1280\n   btrfs_get_tree_subvol+0x592/0x6b0 fs/btrfs/super.c:2029\n   btrfs_get_tree+0x63/0x80 fs/btrfs/super.c:2097\n   vfs_get_tree+0x98/0x320 fs/super.c:1759\n   do_new_mount+0x357/0x660 fs/namespace.c:3899\n   path_mount+0x716/0x19c0 fs/namespace.c:4226\n   do_mount fs/namespace.c:4239 [inline]\n   __do_sys_mount fs/namespace.c:4450 [inline]\n   __se_sys_mount fs/namespace.c:4427 [inline]\n   __x64_sys_mount+0x28c/0x310 fs/namespace.c:4427\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0x92/0x180 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x76/0x7e\n  RIP: 0033:0x7f032eaffa8d\n  [...]", "datePublished": "2025-12-04T15:31:25", "dateUpdated": "2025-12-04T15:31:25", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b1c2b4e6ffd307720ab6ce42f6749b0c02ba0a73", "https://git.kernel.org/stable/c/0c2b2d4d053e9840e6da6ed581befa20309f281a", "https://git.kernel.org/stable/c/17679ac6df6c4830ba711835aa8cf961be36cfa1", "https://nvd.nist.gov/vuln/detail/CVE-2025-40235"], "aliases": ["CVE-2025-40235"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "06f76c94-e063-3c05-af04-44aa94c97bff", "product": {"name": "Linux"}, "product_version": "patch: 6.17.6"}, {"id": "335ba780-79c0-3e55-84bb-7210d5ac923b", "product": {"name": "Linux"}, "product_version": "patch: 6.12.56"}, {"id": "65a52f58-9b52-34bd-8fe7-48bd346d3124", "product": {"name": "Linux"}, "product_version": "3bb17a25bcb09abbd667c6ac86c7c9109ae82bcd <0c2b2d4d053e9840e6da6ed581befa20309f281a"}, {"id": "6b4883f8-8594-3eed-b611-70b4bd1e192c", "product": {"name": "Linux"}, "product_version": "3bb17a25bcb09abbd667c6ac86c7c9109ae82bcd <17679ac6df6c4830ba711835aa8cf961be36cfa1"}, {"id": "795b28ab-656b-3bf9-8186-6c6ca8c1d090", "product": {"name": "Linux"}, "product_version": "6.8"}, {"id": "8e701dde-5df1-3d55-93a9-5b8e30bfb4d9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ccc54a67-630e-3a18-9683-b0c40155d15f", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "e754a292-36a0-3d3c-b948-60084e8e41b4", "product": {"name": "Linux"}, "product_version": "3bb17a25bcb09abbd667c6ac86c7c9109ae82bcd <b1c2b4e6ffd307720ab6ce42f6749b0c02ba0a73"}], "enisaIdVendor": [{"id": "afc65f72-5453-3a44-8868-3fece06ea49d", "vendor": {"name": "Linux"}}], "isExploited": false}