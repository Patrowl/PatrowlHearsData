{"id": "EUVD-2025-19824", "enisaUuid": "77f2faa4-e9ba-35b2-a9dd-997109dd52f1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: core: ufs: Fix a hang in the error handler\n\nufshcd_err_handling_prepare() calls ufshcd_rpm_get_sync(). The latter\nfunction can only succeed if UFSHCD_EH_IN_PROGRESS is not set because\nresuming involves submitting a SCSI command and ufshcd_queuecommand()\nreturns SCSI_MLQUEUE_HOST_BUSY if UFSHCD_EH_IN_PROGRESS is set. Fix this\nhang by setting UFSHCD_EH_IN_PROGRESS after ufshcd_rpm_get_sync() has\nbeen called instead of before.\n\nBacktrace:\n__switch_to+0x174/0x338\n__schedule+0x600/0x9e4\nschedule+0x7c/0xe8\nschedule_timeout+0xa4/0x1c8\nio_schedule_timeout+0x48/0x70\nwait_for_common_io+0xa8/0x160 //waiting on START_STOP\nwait_for_completion_io_timeout+0x10/0x20\nblk_execute_rq+0xe4/0x1e4\nscsi_execute_cmd+0x108/0x244\nufshcd_set_dev_pwr_mode+0xe8/0x250\n__ufshcd_wl_resume+0x94/0x354\nufshcd_wl_runtime_resume+0x3c/0x174\nscsi_runtime_resume+0x64/0xa4\nrpm_resume+0x15c/0xa1c\n__pm_runtime_resume+0x4c/0x90 // Runtime resume ongoing\nufshcd_err_handler+0x1a0/0xd08\nprocess_one_work+0x174/0x808\nworker_thread+0x15c/0x490\nkthread+0xf4/0x1ec\nret_from_fork+0x10/0x20\n\n[ bvanassche: rewrote patch description ]", "datePublished": "2025-07-03T09:30:33", "dateUpdated": "2025-12-17T18:31:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/f592eb12b43f21dbc972cbe583a12d256901e569", "https://git.kernel.org/stable/c/ded80255c59a57cd3270d98461f6508730f9767c", "https://git.kernel.org/stable/c/21f071261f946c5ca1adf378f818082a112b34d2", "https://git.kernel.org/stable/c/3464a707d137efc8aea1d4ae234d26a28d82b78c", "https://git.kernel.org/stable/c/bb37f795d01961286b8f768a6d7152f32b589067", "https://git.kernel.org/stable/c/8a3514d348de87a9d5e2ac00fbac4faae0b97996", "https://nvd.nist.gov/vuln/detail/CVE-2025-38119", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38119"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "084a7d40-48e2-324d-bc35-7a61501aca48", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <8a3514d348de87a9d5e2ac00fbac4faae0b97996"}, {"id": "101e92d0-9e7a-35a1-a5f9-181bf6557dc0", "product": {"name": "Linux"}, "product_version": "patch: 6.6.94"}, {"id": "270d43f6-85d3-31de-9988-e2cd9533813e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "65e57340-fcef-300f-9df1-e4ffc6120ae8", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <3464a707d137efc8aea1d4ae234d26a28d82b78c"}, {"id": "70ccbec5-4ee6-3159-a124-ed9527961c3e", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <ded80255c59a57cd3270d98461f6508730f9767c"}, {"id": "70e255fc-9956-30c8-8e1f-94ad1d844dcd", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <21f071261f946c5ca1adf378f818082a112b34d2"}, {"id": "768326d4-0c42-3382-aaad-a22db3cef054", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "88019ec1-81b6-319b-8f5b-e37c17a59982", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}, {"id": "a762a34f-9641-3685-b99a-16152e8f7420", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "ad2e6fff-4ac8-3942-b949-f2e0a2b0e589", "product": {"name": "Linux"}, "product_version": "3.12"}, {"id": "b00de1ff-cd9e-380a-be8b-185ac5cc5d74", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <f592eb12b43f21dbc972cbe583a12d256901e569"}, {"id": "c30df917-2a38-3bbc-a8ea-1a85dd9adb36", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "de23f139-1825-39db-9e92-0fbcd5de370c", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc2"}, {"id": "e6d2096e-4545-31ed-a2fa-6afb36b5bcc8", "product": {"name": "Linux"}, "product_version": "62694735ca95c74dac4eb9068d59801ac0ddebaf <bb37f795d01961286b8f768a6d7152f32b589067"}, {"id": "f7ae14d5-2bf5-387e-9e14-460a0c2bdc05", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}], "enisaIdVendor": [{"id": "65a8dad3-21c9-330d-b2cf-91bfe802ba5b", "vendor": {"name": "Linux"}}], "isExploited": false}