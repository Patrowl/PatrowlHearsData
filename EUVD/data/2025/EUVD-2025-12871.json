{"id": "EUVD-2025-12871", "enisaUuid": "b44e9924-2707-3d02-8c59-3dc8b0a1df6d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock: Fix possible memory leak for rq_wb on add_disk failure\n\nkmemleak reported memory leaks in device_add_disk():\n\nkmemleak: 3 new suspected memory leaks\n\nunreferenced object 0xffff88800f420800 (size 512):\n  comm \"modprobe\", pid 4275, jiffies 4295639067 (age 223.512s)\n  hex dump (first 32 bytes):\n    04 00 00 00 08 00 00 00 01 00 00 00 00 00 00 00  ................\n    00 e1 f5 05 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [<00000000d3662699>] kmalloc_trace+0x26/0x60\n    [<00000000edc7aadc>] wbt_init+0x50/0x6f0\n    [<0000000069601d16>] wbt_enable_default+0x157/0x1c0\n    [<0000000028fc393f>] blk_register_queue+0x2a4/0x420\n    [<000000007345a042>] device_add_disk+0x6fd/0xe40\n    [<0000000060e6aab0>] nbd_dev_add+0x828/0xbf0 [nbd]\n    ...\n\nIt is because the memory allocated in wbt_enable_default() is not\nreleased in device_add_disk() error path.\nNormally, these memory are freed in:\n\ndel_gendisk()\n  rq_qos_exit()\n    rqos->ops->exit(rqos);\n      wbt_exit()\n\nSo rq_qos_exit() is called to free the rq_wb memory for wbt_init().\nHowever in the error path of device_add_disk(), only\nblk_unregister_queue() is called and make rq_wb memory leaked.\n\nAdd rq_qos_exit() to the error path to fix it.", "datePublished": "2025-05-01T14:10:47", "dateUpdated": "2025-10-01T14:59:06", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-49902", "https://git.kernel.org/stable/c/4e68c5da60cd79950bd56287ae80b39d6261f995", "https://git.kernel.org/stable/c/528677d3b4af985445bd4ac667485ded1ed11220", "https://git.kernel.org/stable/c/fa81cbafbf5764ad5053512152345fab37a1fe18"], "aliases": ["CVE-2022-49902", "GHSA-8p4q-63f6-rqfp"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "1061ea58-a429-31f6-8972-bb31c85471a1", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "3f9efa83-eb58-3316-8731-e5a98297278d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.78"}, {"id": "412b3b7b-b7fa-3c31-833f-382af99abbfc", "product": {"name": "Linux"}, "product_version": "patch: 6.0.8"}, {"id": "50e7ea86-f0cc-3e2f-b9a6-217451d48a0d", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "532c0d26-5d96-3b51-842a-e4dd8376ecda", "product": {"name": "Linux"}, "product_version": "83cbce9574462c6b4eed6797bdaf18fae6859ab3 <4e68c5da60cd79950bd56287ae80b39d6261f995"}, {"id": "a9f2a6a3-48f9-3a65-9129-03419e9b8017", "product": {"name": "Linux"}, "product_version": "83cbce9574462c6b4eed6797bdaf18fae6859ab3 <528677d3b4af985445bd4ac667485ded1ed11220"}, {"id": "c0e7a328-e089-3fb8-8b89-177e3fb81457", "product": {"name": "Linux"}, "product_version": "83cbce9574462c6b4eed6797bdaf18fae6859ab3 <fa81cbafbf5764ad5053512152345fab37a1fe18"}, {"id": "c5479c1f-338f-3258-9930-e98711f13f6b", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "c952b0a1-c87d-3dcf-87c3-0a194156bdee", "vendor": {"name": "Linux"}}], "isExploited": false}