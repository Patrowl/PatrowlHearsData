{"id": "EUVD-2025-150375", "enisaUuid": "26b4baf0-2501-3abe-bbe4-833f09cbd791", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npage_pool: Fix PP_MAGIC_MASK to avoid crashing on some 32-bit arches\n\nHelge reported that the introduction of PP_MAGIC_MASK let to crashes on\nboot on his 32-bit parisc machine. The cause of this is the mask is set\ntoo wide, so the page_pool_page_is_pp() incurs false positives which\ncrashes the machine.\n\nJust disabling the check in page_pool_is_pp() will lead to the page_pool\ncode itself malfunctioning; so instead of doing this, this patch changes\nthe define for PP_DMA_INDEX_BITS to avoid mistaking arbitrary kernel\npointers for page_pool-tagged pages.\n\nThe fix relies on the kernel pointers that alias with the pp_magic field\nalways being above PAGE_OFFSET. With this assumption, we can use the\nlowest bit of the value of PAGE_OFFSET as the upper bound of the\nPP_DMA_INDEX_MASK, which should avoid the false positives.\n\nBecause we cannot rely on PAGE_OFFSET always being a compile-time\nconstant, nor on it always being >0, we fall back to disabling the\ndma_index storage when there are not enough bits available. This leaves\nus in the situation we were in before the patch in the Fixes tag, but\nonly on a subset of architecture configurations. This seems to be the\nbest we can do until the transition to page types in complete for\npage_pool pages.\n\nv2:\n- Make sure there's at least 8 bits available and that the PAGE_OFFSET\n  bit calculation doesn't wrap", "datePublished": "2025-11-12T21:56:33", "dateUpdated": "2025-12-01T06:20:00", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/15b8a5b4cdc16e9a8bb2a548e12a0fd92997605a", "https://git.kernel.org/stable/c/f62934cea32c8f7b11b747975d69bf5afe4264cf", "https://git.kernel.org/stable/c/95920c2ed02bde551ab654e9749c2ca7bc3100e0", "https://nvd.nist.gov/vuln/detail/CVE-2025-40199"], "aliases": ["CVE-2025-40199"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1490ffad-b409-3dd6-a7d2-f6c4cd5d2fe1", "product": {"name": "Linux"}, "product_version": "4f51fb0d257ff4d406ec27966902de075e3b118e <15b8a5b4cdc16e9a8bb2a548e12a0fd92997605a"}, {"id": "3bed5dd1-cbcd-3dcc-b344-c0023912a485", "product": {"name": "Linux"}, "product_version": "ee62ce7a1d909ccba0399680a03c2dee83bcae95 <f62934cea32c8f7b11b747975d69bf5afe4264cf"}, {"id": "4a321a4b-4684-3387-8609-19ebd0464c5a", "product": {"name": "Linux"}, "product_version": "ee62ce7a1d909ccba0399680a03c2dee83bcae95 <95920c2ed02bde551ab654e9749c2ca7bc3100e0"}, {"id": "5781e880-b8fa-3e7d-bf28-491b161a65de", "product": {"name": "Linux"}, "product_version": "6.16"}, {"id": "718c5684-14d6-385b-8fbc-28a5659aa202", "product": {"name": "Linux"}, "product_version": "patch: 6.12.54"}, {"id": "87a5fda7-218f-3ff2-8237-f0747f5f95e1", "product": {"name": "Linux"}, "product_version": "patch: 6.17.4"}, {"id": "97cbaa96-2a50-3603-8dd7-125c5e0c1153", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "a9893189-13c0-3be8-9aab-53af3f6706cf", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "bd04d859-5e3b-3006-ab36-c1dd7ed40c17", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "f13b58c0-7230-336f-b7f0-0dff2ef07875", "product": {"name": "Linux"}, "product_version": "c30ae60f41f9edd6e1b5cad41cf28ce04dae39e4"}], "enisaIdVendor": [{"id": "ba2beccc-64b2-3a62-9833-e26e75aa30a6", "vendor": {"name": "Linux"}}], "isExploited": false}