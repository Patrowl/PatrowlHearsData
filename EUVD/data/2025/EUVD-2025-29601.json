{"id": "EUVD-2025-29601", "enisaUuid": "c2301f74-5e21-3834-90a7-8effc5b4814a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nftrace: Fix potential warning in trace_printk_seq during ftrace_dump\n\nWhen calling ftrace_dump_one() concurrently with reading trace_pipe,\na WARN_ON_ONCE() in trace_printk_seq() can be triggered due to a race\ncondition.\n\nThe issue occurs because:\n\nCPU0 (ftrace_dump)                              CPU1 (reader)\necho z > /proc/sysrq-trigger\n\n!trace_empty(&iter)\ntrace_iterator_reset(&iter) <- len = size = 0\n                                                cat /sys/kernel/tracing/trace_pipe\ntrace_find_next_entry_inc(&iter)\n  __find_next_entry\n    ring_buffer_empty_cpu <- all empty\n  return NULL\n\ntrace_printk_seq(&iter.seq)\n  WARN_ON_ONCE(s->seq.len >= s->seq.size)\n\nIn the context between trace_empty() and trace_find_next_entry_inc()\nduring ftrace_dump, the ring buffer data was consumed by other readers.\nThis caused trace_find_next_entry_inc to return NULL, failing to populate\n`iter.seq`. At this point, due to the prior trace_iterator_reset, both\n`iter.seq.len` and `iter.seq.size` were set to 0. Since they are equal,\nthe WARN_ON_ONCE condition is triggered.\n\nMove the trace_printk_seq() into the if block that checks to make sure the\nreturn value of trace_find_next_entry_inc() is non-NULL in\nftrace_dump_one(), ensuring the 'iter.seq' is properly populated before\nsubsequent operations.", "datePublished": "2025-09-16T15:32:35", "dateUpdated": "2025-11-03T18:31:41", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/f299353e7ccbcc5c2ed8993c48fbe7609cbe729a", "https://git.kernel.org/stable/c/5ab0ec206deb99eb3baf8f1d7602aeaa91dbcc85", "https://git.kernel.org/stable/c/a6f0f8873cc30fd4543b09adf03f7f51d293f0e6", "https://git.kernel.org/stable/c/e80ff23ba8bdb0f41a1afe2657078e4097d13a9a", "https://git.kernel.org/stable/c/28c8fb7ae2ad27d81c8de3c4fe608c509f6a18aa", "https://git.kernel.org/stable/c/ced94e137e6cd5e79c65564841d3b7695d0f5fa3", "https://git.kernel.org/stable/c/fbd4cf7ee4db65ef36796769fe978e9eba6f0de4", "https://git.kernel.org/stable/c/4013aef2ced9b756a410f50d12df9ebe6a883e4a", "https://nvd.nist.gov/vuln/detail/CVE-2025-39813", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-39813"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "05894256-7504-3618-a91e-13653f7feb84", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <a6f0f8873cc30fd4543b09adf03f7f51d293f0e6"}, {"id": "180701a8-280c-388e-8e00-42ca49a94e58", "product": {"name": "Linux"}, "product_version": "patch: 5.4.298"}, {"id": "1ab25045-fb6b-3fd8-a3c4-e4c0e952bf31", "product": {"name": "Linux"}, "product_version": "patch: 6.12.45"}, {"id": "1dd90dbc-7c14-39cb-a972-e54db4a80561", "product": {"name": "Linux"}, "product_version": "patch: 6.6.104"}, {"id": "2edb6282-f16a-34aa-b903-74b14734f406", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <fbd4cf7ee4db65ef36796769fe978e9eba6f0de4"}, {"id": "3261a455-5bbb-3c8d-bfed-6f3c0299feb8", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc3"}, {"id": "3c3ca201-8538-34d0-b89e-e0189c02bb9a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "49a932fd-0bf2-37d7-bff1-67188add4129", "product": {"name": "Linux"}, "product_version": "patch: 5.15.191"}, {"id": "541aa685-f3d3-357e-b21c-4012cfbeeb3f", "product": {"name": "Linux"}, "product_version": "patch: 6.16.5"}, {"id": "58d640a4-a345-3bf5-b735-0b17681f446e", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <5ab0ec206deb99eb3baf8f1d7602aeaa91dbcc85"}, {"id": "5e8f9c90-ea82-3f08-a589-b77724670ce8", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <ced94e137e6cd5e79c65564841d3b7695d0f5fa3"}, {"id": "62d586b4-da00-3554-8b05-f87e0d97790c", "product": {"name": "Linux"}, "product_version": "2.6.28"}, {"id": "6328f5b5-bb88-3f64-b6e9-71dc07b32a89", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <28c8fb7ae2ad27d81c8de3c4fe608c509f6a18aa"}, {"id": "7a27fff6-9bad-3fe8-84ab-0eec4a105b73", "product": {"name": "Linux"}, "product_version": "patch: 6.1.150"}, {"id": "80c6a023-faf8-3ad6-9068-4381d2497d14", "product": {"name": "Linux"}, "product_version": "patch: 5.10.242"}, {"id": "914233e2-cc88-3337-a8d2-b7e493d8f072", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <4013aef2ced9b756a410f50d12df9ebe6a883e4a"}, {"id": "bce8b2d1-2db3-335f-8292-fd363b98c8b7", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <e80ff23ba8bdb0f41a1afe2657078e4097d13a9a"}, {"id": "e0c01e4c-cb6f-35cc-a0fc-3850104b1cbb", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "e77464fe-8b03-3137-8dea-d8ab3ed5730d", "product": {"name": "Linux"}, "product_version": "d769041f865330034131525ee6a7f72eb4af2a24 <f299353e7ccbcc5c2ed8993c48fbe7609cbe729a"}], "enisaIdVendor": [{"id": "079fd628-374e-3016-8c01-c05f9c33d3aa", "vendor": {"name": "Linux"}}], "isExploited": false}