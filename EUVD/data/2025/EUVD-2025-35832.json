{"id": "EUVD-2025-35832", "enisaUuid": "21e14546-97d2-3676-84e3-be7ab2812da2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nipvs: Defer ip_vs_ftp unregister during netns cleanup\n\nOn the netns cleanup path, __ip_vs_ftp_exit() may unregister ip_vs_ftp\nbefore connections with valid cp->app pointers are flushed, leading to a\nuse-after-free.\n\nFix this by introducing a global `exiting_module` flag, set to true in\nip_vs_ftp_exit() before unregistering the pernet subsystem. In\n__ip_vs_ftp_exit(), skip ip_vs_ftp unregister if called during netns\ncleanup (when exiting_module is false) and defer it to\n__ip_vs_cleanup_batch(), which unregisters all apps after all connections\nare flushed. If called during module exit, unregister ip_vs_ftp\nimmediately.", "datePublished": "2025-10-24T11:44:28", "dateUpdated": "2025-12-01T06:16:24", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1d79471414d7b9424d699afff2aa79fff322f52d", "https://git.kernel.org/stable/c/53717f8a4347b78eac6488072ad8e5adbaff38d9", "https://git.kernel.org/stable/c/8cbe2a21d85727b66d7c591fd5d83df0d8c4f757", "https://git.kernel.org/stable/c/dc1a481359a72ee7e548f1f5da671282a7c13b8f", "https://git.kernel.org/stable/c/a343811ef138a265407167294275201621e9ebb2", "https://git.kernel.org/stable/c/134121bfd99a06d44ef5ba15a9beb075297c0821", "https://nvd.nist.gov/vuln/detail/CVE-2025-40018", "https://git.kernel.org/stable/c/8a6ecab3847c213ce2855b0378e63ce839085de3", "https://git.kernel.org/stable/c/421b1ae1574dfdda68b835c15ac4921ec0030182"], "aliases": ["CVE-2025-40018"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "1cd052f4-6a55-3492-8bf9-5a0c21a69c1c", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <134121bfd99a06d44ef5ba15a9beb075297c0821"}, {"id": "3b4562eb-98ed-3f3f-8ea3-0e7a8d110369", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <53717f8a4347b78eac6488072ad8e5adbaff38d9"}, {"id": "3df56c89-5178-3857-8483-cec75bc29d54", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <8a6ecab3847c213ce2855b0378e63ce839085de3"}, {"id": "43842586-74ef-327c-b6dc-68cdae2b115a", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "4d6fa924-0978-3233-b263-c84ed57fecbb", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "57e7ff26-4d3e-3c5d-863f-4108d4f9dda6", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <1d79471414d7b9424d699afff2aa79fff322f52d"}, {"id": "5d9b8df2-a8a3-3f2a-bc1e-e2fa4cdc5ee3", "product": {"name": "Linux"}, "product_version": "patch: 5.15.195"}, {"id": "6010b229-67df-36e0-825f-1466a38040c2", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "66f21be9-e70f-327a-89de-41897314a903", "product": {"name": "Linux"}, "product_version": "patch: 6.1.156"}, {"id": "689ebadd-09fd-36db-ad2f-c646cd576df6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7bd9c9c6-fc2a-3b75-a90e-e527f53f77fb", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <a343811ef138a265407167294275201621e9ebb2"}, {"id": "8f14ff32-3b02-3c92-b6f0-3b70c0320957", "product": {"name": "Linux"}, "product_version": "2.6.39"}, {"id": "946fefde-3413-3f1f-8bb9-3fb50115d702", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <421b1ae1574dfdda68b835c15ac4921ec0030182"}, {"id": "b53f745c-90a8-380a-885f-5bc2f3490cdb", "product": {"name": "Linux"}, "product_version": "patch: 6.12.53"}, {"id": "b6bc1764-8d17-3c38-8e50-5e6ef2b2a80a", "product": {"name": "Linux"}, "product_version": "patch: 6.6.112"}, {"id": "bc98b30c-dde0-3daa-96bf-d5212f6de6e6", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <dc1a481359a72ee7e548f1f5da671282a7c13b8f"}, {"id": "bda9fab0-4042-3827-875a-ab4586e94960", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "c9f2a01f-7d77-3a48-8ade-497674d235e3", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "e8daf7de-9315-38ac-a125-3e0dc66978bb", "product": {"name": "Linux"}, "product_version": "61b1ab4583e275af216c8454b9256de680499b19 <8cbe2a21d85727b66d7c591fd5d83df0d8c4f757"}], "enisaIdVendor": [{"id": "38dea134-52b4-33d7-9142-7fb12d03e1f9", "vendor": {"name": "Linux"}}], "isExploited": false}