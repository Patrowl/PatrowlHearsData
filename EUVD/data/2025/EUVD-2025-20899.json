{"id": "EUVD-2025-20899", "enisaUuid": "f89263fe-1c33-37fe-b32d-992b9e478e07", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on ino and xnid\n\nsyzbot reported a f2fs bug as below:\n\nINFO: task syz-executor140:5308 blocked for more than 143 seconds.\n      Not tainted 6.14.0-rc7-syzkaller-00069-g81e4f8d68c66 #0\n\"echo 0 > /proc/sys/kernel/hung_task_timeout_secs\" disables this message.\ntask:syz-executor140 state:D stack:24016 pid:5308  tgid:5308  ppid:5306   task_flags:0x400140 flags:0x00000006\nCall Trace:\n <TASK>\n context_switch kernel/sched/core.c:5378 [inline]\n __schedule+0x190e/0x4c90 kernel/sched/core.c:6765\n __schedule_loop kernel/sched/core.c:6842 [inline]\n schedule+0x14b/0x320 kernel/sched/core.c:6857\n io_schedule+0x8d/0x110 kernel/sched/core.c:7690\n folio_wait_bit_common+0x839/0xee0 mm/filemap.c:1317\n __folio_lock mm/filemap.c:1664 [inline]\n folio_lock include/linux/pagemap.h:1163 [inline]\n __filemap_get_folio+0x147/0xb40 mm/filemap.c:1917\n pagecache_get_page+0x2c/0x130 mm/folio-compat.c:87\n find_get_page_flags include/linux/pagemap.h:842 [inline]\n f2fs_grab_cache_page+0x2b/0x320 fs/f2fs/f2fs.h:2776\n __get_node_page+0x131/0x11b0 fs/f2fs/node.c:1463\n read_xattr_block+0xfb/0x190 fs/f2fs/xattr.c:306\n lookup_all_xattrs fs/f2fs/xattr.c:355 [inline]\n f2fs_getxattr+0x676/0xf70 fs/f2fs/xattr.c:533\n __f2fs_get_acl+0x52/0x870 fs/f2fs/acl.c:179\n f2fs_acl_create fs/f2fs/acl.c:375 [inline]\n f2fs_init_acl+0xd7/0x9b0 fs/f2fs/acl.c:418\n f2fs_init_inode_metadata+0xa0f/0x1050 fs/f2fs/dir.c:539\n f2fs_add_inline_entry+0x448/0x860 fs/f2fs/inline.c:666\n f2fs_add_dentry+0xba/0x1e0 fs/f2fs/dir.c:765\n f2fs_do_add_link+0x28c/0x3a0 fs/f2fs/dir.c:808\n f2fs_add_link fs/f2fs/f2fs.h:3616 [inline]\n f2fs_mknod+0x2e8/0x5b0 fs/f2fs/namei.c:766\n vfs_mknod+0x36d/0x3b0 fs/namei.c:4191\n unix_bind_bsd net/unix/af_unix.c:1286 [inline]\n unix_bind+0x563/0xe30 net/unix/af_unix.c:1379\n __sys_bind_socket net/socket.c:1817 [inline]\n __sys_bind+0x1e4/0x290 net/socket.c:1848\n __do_sys_bind net/socket.c:1853 [inline]\n __se_sys_bind net/socket.c:1851 [inline]\n __x64_sys_bind+0x7a/0x90 net/socket.c:1851\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nLet's dump and check metadata of corrupted inode, it shows its xattr_nid\nis the same to its i_ino.\n\ndump.f2fs -i 3 chaseyu.img.raw\ni_xattr_nid                             [0x       3 : 3]\n\nSo that, during mknod in the corrupted directory, it tries to get and\nlock inode page twice, result in deadlock.\n\n- f2fs_mknod\n - f2fs_add_inline_entry\n  - f2fs_get_inode_page --- lock dir's inode page\n   - f2fs_init_acl\n    - f2fs_acl_create(dir,..)\n     - __f2fs_get_acl\n      - f2fs_getxattr\n       - lookup_all_xattrs\n        - __get_node_page --- try to lock dir's inode page\n\nIn order to fix this, let's add sanity check on ino and xnid.", "datePublished": "2025-07-10T09:32:31", "dateUpdated": "2025-12-19T18:31:06", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/aaddc6c696bd1bff20eaacfa88579d6eae64d541", "https://git.kernel.org/stable/c/fed611bd8c7b76b070aa407d0c7558e20d9e1f68", "https://git.kernel.org/stable/c/5a06d97d5340c00510f24e80e8de821bd3bd9285", "https://git.kernel.org/stable/c/061cf3a84bde038708eb0f1d065b31b7c2456533", "https://git.kernel.org/stable/c/44e904a1ad09e84039058dcbbb1b9ea5b8d7d75d", "https://git.kernel.org/stable/c/ecff54aa20b5b21db82e63e46066b55e43d72e78", "https://git.kernel.org/stable/c/c4029044cc408b149e63db7dc8617a0783a3f10d", "https://git.kernel.org/stable/c/e98dc1909f3d5bc078ec7a605524f1e3f4c0eb14", "https://nvd.nist.gov/vuln/detail/CVE-2025-38347", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38347"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "01653504-3157-32a9-8af9-0de7d089d245", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0167bbff-de59-3f1d-be3b-aeaea9ba9747", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <fed611bd8c7b76b070aa407d0c7558e20d9e1f68"}, {"id": "05694d2d-8036-3bd7-a74e-c28d137fe507", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <aaddc6c696bd1bff20eaacfa88579d6eae64d541"}, {"id": "1de286cf-a9ad-3588-8597-cf7f88704cf5", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "20607241-d2fe-32e2-a0bd-0f095b9f671e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <061cf3a84bde038708eb0f1d065b31b7c2456533"}, {"id": "27be216d-4b93-31d2-89f0-940112a1d79c", "product": {"name": "Linux"}, "product_version": "patch: 6.15.4"}, {"id": "3078d7af-1c25-3dc9-bf30-7e6fae5220c3", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "32ad56db-868a-34b9-83c4-4bd605c3db6d", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <e98dc1909f3d5bc078ec7a605524f1e3f4c0eb14"}, {"id": "35850397-ca46-3412-97cc-ef7f7dd910a9", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <c4029044cc408b149e63db7dc8617a0783a3f10d"}, {"id": "3a244cd9-998d-304e-88df-0823f7091f5f", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <44e904a1ad09e84039058dcbbb1b9ea5b8d7d75d"}, {"id": "3f21041c-e066-3781-adcc-93753edd228f", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <ecff54aa20b5b21db82e63e46066b55e43d72e78"}, {"id": "4b7a945e-0b8d-326c-891f-534b3fd6a2a5", "product": {"name": "Linux"}, "product_version": "patch: 6.1.149"}, {"id": "561fbf52-da01-3277-bb04-8193666685ca", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <aaddc6c696bd1bff20eaacfa88579d6eae64d541"}, {"id": "5a33b11e-78c3-331a-be25-e101f96311f0", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "6fd104f0-b007-36e4-b90e-1bc19f015c08", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <5a06d97d5340c00510f24e80e8de821bd3bd9285"}, {"id": "795d0857-d9e6-3000-95fa-11aa938884d0", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "8932930e-2c91-31fb-b21a-739f4dcd36d1", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "ac35a5e9-bc18-37f0-ab96-ddd4eb977034", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5a06d97d5340c00510f24e80e8de821bd3bd9285"}, {"id": "b1471e23-e676-3599-a117-b4b5ea43a7ae", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <061cf3a84bde038708eb0f1d065b31b7c2456533"}, {"id": "d318a400-797e-3eba-bf5a-dae17fd1d064", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fed611bd8c7b76b070aa407d0c7558e20d9e1f68"}, {"id": "e2f906c0-a291-3ce3-9136-50c72551a8ea", "product": {"name": "Linux"}, "product_version": "patch: 6.12.35"}, {"id": "e4e9740f-d2e0-3f97-bd77-e49d67472b80", "product": {"name": "Linux"}, "product_version": "patch: 6.6.95"}, {"id": "f7bf5e42-7b2f-37b4-aa4c-48f7888e6fb1", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}], "enisaIdVendor": [{"id": "6ec172e2-95f3-3397-b47a-72918a0d60d2", "vendor": {"name": "Linux"}}], "isExploited": false}