{"id": "EUVD-2025-14197", "enisaUuid": "ecabd117-23e3-3ea5-963a-a7be3a0af799", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvmxnet3: Fix packet corruption in vmxnet3_xdp_xmit_frame\n\nAndrew and Nikolay reported connectivity issues with Cilium's service\nload-balancing in case of vmxnet3.\n\nIf a BPF program for native XDP adds an encapsulation header such as\nIPIP and transmits the packet out the same interface, then in case\nof vmxnet3 a corrupted packet is being sent and subsequently dropped\non the path.\n\nvmxnet3_xdp_xmit_frame() which is called e.g. via vmxnet3_run_xdp()\nthrough vmxnet3_xdp_xmit_back() calculates an incorrect DMA address:\n\n  page = virt_to_page(xdpf->data);\n  tbi->dma_addr = page_pool_get_dma_addr(page) +\n                  VMXNET3_XDP_HEADROOM;\n  dma_sync_single_for_device(&adapter->pdev->dev,\n                             tbi->dma_addr, buf_size,\n                             DMA_TO_DEVICE);\n\nThe above assumes a fixed offset (VMXNET3_XDP_HEADROOM), but the XDP\nBPF program could have moved xdp->data. While the passed buf_size is\ncorrect (xdpf->len), the dma_addr needs to have a dynamic offset which\ncan be calculated as xdpf->data - (void *)xdpf, that is, xdp->data -\nxdp->data_hard_start.", "datePublished": "2025-04-29T11:45:30", "dateUpdated": "2025-10-01T16:12:26", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2024-58099", "https://git.kernel.org/stable/c/4678adf94da4a9e9683817b246b58ce15fb81782", "https://git.kernel.org/stable/c/59ba6cdadb9c26b606a365eb9c9b25eb2052622d", "https://git.kernel.org/stable/c/f82eb34fb59a8fb96c19f4f492c20eb774140bb5"], "aliases": ["CVE-2024-58099", "GHSA-274g-94c9-xmph"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "04698774-2be5-3ac6-b5d6-88a937a8a85c", "product": {"name": "Linux"}, "product_version": "patch: 6.6.59"}, {"id": "21d536a3-1701-3318-a797-872a4e71ea7a", "product": {"name": "Linux"}, "product_version": "54f00cce11786742bd11e5e68c3bf85e6dc048c9 <4678adf94da4a9e9683817b246b58ce15fb81782"}, {"id": "6c5e5fd5-4ed7-3cfc-83d6-3c12ced2b2d5", "product": {"name": "Linux"}, "product_version": "patch: 6.12"}, {"id": "6cd83232-ec30-3772-8939-1c0ebe95bdca", "product": {"name": "Linux"}, "product_version": "54f00cce11786742bd11e5e68c3bf85e6dc048c9 <59ba6cdadb9c26b606a365eb9c9b25eb2052622d"}, {"id": "87083a9e-ebc9-3f5b-9929-2f1890ee0a3a", "product": {"name": "Linux"}, "product_version": "6.6"}, {"id": "8fb94235-63b9-3c5d-9b84-c1f5331c69f9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "bcf8245a-b750-3556-8b3f-4b441f24d460", "product": {"name": "Linux"}, "product_version": "54f00cce11786742bd11e5e68c3bf85e6dc048c9 <f82eb34fb59a8fb96c19f4f492c20eb774140bb5"}, {"id": "c2fff30b-3024-341d-a1ea-ebfe2bea978d", "product": {"name": "Linux"}, "product_version": "patch: 6.11.6"}], "enisaIdVendor": [{"id": "b1a4ddba-19d7-3add-87e9-7f359d4e54e3", "vendor": {"name": "Linux"}}], "isExploited": false}