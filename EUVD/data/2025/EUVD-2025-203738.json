{"id": "EUVD-2025-203738", "enisaUuid": "6664dff4-5002-379d-9dd9-ccd61600e046", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: refresh inline data size before write operations\n\nThe cached ei->i_inline_size can become stale between the initial size\ncheck and when ext4_update_inline_data()/ext4_create_inline_data() use\nit. Although ext4_get_max_inline_size() reads the correct value at the\ntime of the check, concurrent xattr operations can modify i_inline_size\nbefore ext4_write_lock_xattr() is acquired.\n\nThis causes ext4_update_inline_data() and ext4_create_inline_data() to\nwork with stale capacity values, leading to a BUG_ON() crash in\next4_write_inline_data():\n\n  kernel BUG at fs/ext4/inline.c:1331!\n  BUG_ON(pos + len > EXT4_I(inode)->i_inline_size);\n\nThe race window:\n1. ext4_get_max_inline_size() reads i_inline_size = 60 (correct)\n2. Size check passes for 50-byte write\n3. [Another thread adds xattr, i_inline_size changes to 40]\n4. ext4_write_lock_xattr() acquires lock\n5. ext4_update_inline_data() uses stale i_inline_size = 60\n6. Attempts to write 50 bytes but only 40 bytes actually available\n7. BUG_ON() triggers\n\nFix this by recalculating i_inline_size via ext4_find_inline_data_nolock()\nimmediately after acquiring xattr_sem. This ensures ext4_update_inline_data()\nand ext4_create_inline_data() work with current values that are protected\nfrom concurrent modifications.\n\nThis is similar to commit a54c4613dac1 (\"ext4: fix race writing to an\ninline_data file while its xattrs are changing\") which fixed i_inline_off\nstaleness. This patch addresses the related i_inline_size staleness issue.", "datePublished": "2025-12-16T15:30:47", "dateUpdated": "2025-12-16T15:30:47", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68264", "https://git.kernel.org/stable/c/210ac60a86a3ad2c76ae60e0dc71c34af6e7ea0b", "https://git.kernel.org/stable/c/58df743faf21ceb1880f930aa5dd428e2a5e415d", "https://git.kernel.org/stable/c/892e1cf17555735e9d021ab036c36bc7b58b0e3b", "https://git.kernel.org/stable/c/ca43ea29b4c4d2764aec8a26cffcfb677a871e6e"], "aliases": ["CVE-2025-68264", "GHSA-wp53-jh6w-3pf7"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "4c1c9c83-793e-34e8-8746-abec9113bbb6", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc1"}, {"id": "54d21f30-d1e8-3157-af1d-95a8e6b08891", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <58df743faf21ceb1880f930aa5dd428e2a5e415d"}, {"id": "7483300d-69a9-3c7d-8a68-ccf7ca853e11", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <210ac60a86a3ad2c76ae60e0dc71c34af6e7ea0b"}, {"id": "7acb9440-918a-3dc2-ae50-8ca33fed78dc", "product": {"name": "Linux"}, "product_version": "patch: 6.12.62"}, {"id": "a54e13ae-93df-3224-9a17-07f8f76da5ae", "product": {"name": "Linux"}, "product_version": "patch: 6.18.1"}, {"id": "b38a58c2-eba3-355e-9d89-8a64fa94c154", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <892e1cf17555735e9d021ab036c36bc7b58b0e3b"}, {"id": "bea1323d-1a2f-325e-b387-bda3cb97f3b9", "product": {"name": "Linux"}, "product_version": "patch: 6.17.12"}, {"id": "e8fbeb35-ddd0-370d-9451-49007e3d3a14", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ca43ea29b4c4d2764aec8a26cffcfb677a871e6e"}], "enisaIdVendor": [{"id": "25186343-1dc6-3665-8b53-2fc89d23c807", "vendor": {"name": "Linux"}}], "isExploited": false}