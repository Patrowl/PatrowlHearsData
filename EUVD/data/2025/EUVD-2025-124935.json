{"id": "EUVD-2025-124935", "enisaUuid": "d51710f1-aac6-3663-8509-c396430b47cb", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: Add NULL pointer checks in dc_stream cursor attribute functions\n\nThe function dc_stream_set_cursor_attributes() currently dereferences\nthe `stream` pointer and nested members `stream->ctx->dc->current_state`\nwithout checking for NULL.\n\nAll callers of these functions, such as in\n`dcn30_apply_idle_power_optimizations()` and\n`amdgpu_dm_plane_handle_cursor_update()`, already perform NULL checks\nbefore calling these functions.\n\nFixes below:\ndrivers/gpu/drm/amd/amdgpu/../display/dc/core/dc_stream.c:336 dc_stream_program_cursor_attributes()\nerror: we previously assumed 'stream' could be null (see line 334)\n\ndrivers/gpu/drm/amd/amdgpu/../display/dc/core/dc_stream.c\n    327 bool dc_stream_program_cursor_attributes(\n    328         struct dc_stream_state *stream,\n    329         const struct dc_cursor_attributes *attributes)\n    330 {\n    331         struct dc  *dc;\n    332         bool reset_idle_optimizations = false;\n    333\n    334         dc = stream ? stream->ctx->dc : NULL;\n                     ^^^^^^\nThe old code assumed stream could be NULL.\n\n    335\n--> 336         if (dc_stream_set_cursor_attributes(stream, attributes)) {\n                                                    ^^^^^^\nThe refactor added an unchecked dereference.\n\ndrivers/gpu/drm/amd/amdgpu/../display/dc/core/dc_stream.c\n   313  bool dc_stream_set_cursor_attributes(\n   314          struct dc_stream_state *stream,\n   315          const struct dc_cursor_attributes *attributes)\n   316  {\n   317          bool result = false;\n   318\n   319          if (dc_stream_check_cursor_attributes(stream, stream->ctx->dc->current_state, attributes)) {\n                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Here.\nThis function used to check for if stream as NULL and return false at\nthe start. Probably we should add that back.", "datePublished": "2025-11-12T10:23:26", "dateUpdated": "2025-12-01T06:18:57", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/01e793e7d4d402c473f1a61ca5824f086693be65", "https://git.kernel.org/stable/c/bf4e4b97d0fdc66f04fc19d807e24dd8421b8f11", "https://nvd.nist.gov/vuln/detail/CVE-2025-40148"], "aliases": ["CVE-2025-40148"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "18d635c2-d73b-3a65-95f1-51dc20a78cd2", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "1921d7e2-76c5-3fd8-b94a-2a61b65d88da", "product": {"name": "Linux"}, "product_version": "6.16"}, {"id": "33c4fbc0-25f2-37ef-aa44-550067e5d412", "product": {"name": "Linux"}, "product_version": "4465dd0e41e8223a46a41ce4fcdfc55fabd319d8 <01e793e7d4d402c473f1a61ca5824f086693be65"}, {"id": "8d944f65-b77b-36b4-88d4-23cdedbc9f4b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "92b71076-d024-3d95-980a-662278a806a9", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "932da3c6-4bc1-3e7f-9feb-b7e645abcde5", "product": {"name": "Linux"}, "product_version": "4465dd0e41e8223a46a41ce4fcdfc55fabd319d8 <bf4e4b97d0fdc66f04fc19d807e24dd8421b8f11"}, {"id": "cb61b49b-5f4a-3235-91e4-212cec0c11e6", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}], "enisaIdVendor": [{"id": "2d2bd041-69d9-33b0-9000-fbab4cfee9f4", "vendor": {"name": "Linux"}}], "isExploited": false}