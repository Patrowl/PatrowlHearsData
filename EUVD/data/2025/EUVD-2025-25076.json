{"id": "EUVD-2025-25076", "enisaUuid": "81522023-cc52-3d97-b992-5773310f519a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix oob access in cgroup local storage\n\nLonial reported that an out-of-bounds access in cgroup local storage\ncan be crafted via tail calls. Given two programs each utilizing a\ncgroup local storage with a different value size, and one program\ndoing a tail call into the other. The verifier will validate each of\nthe indivial programs just fine. However, in the runtime context\nthe bpf_cg_run_ctx holds an bpf_prog_array_item which contains the\nBPF program as well as any cgroup local storage flavor the program\nuses. Helpers such as bpf_get_local_storage() pick this up from the\nruntime context:\n\n  ctx = container_of(current->bpf_ctx, struct bpf_cg_run_ctx, run_ctx);\n  storage = ctx->prog_item->cgroup_storage[stype];\n\n  if (stype == BPF_CGROUP_STORAGE_SHARED)\n    ptr = &READ_ONCE(storage->buf)->data[0];\n  else\n    ptr = this_cpu_ptr(storage->percpu_buf);\n\nFor the second program which was called from the originally attached\none, this means bpf_get_local_storage() will pick up the former\nprogram's map, not its own. With mismatching sizes, this can result\nin an unintended out-of-bounds access.\n\nTo fix this issue, we need to extend bpf_map_owner with an array of\nstorage_cookie[] to match on i) the exact maps from the original\nprogram if the second program was using bpf_get_local_storage(), or\nii) allow the tail call combination if the second program was not\nusing any of the cgroup local storage maps.", "datePublished": "2025-08-16T12:30:32", "dateUpdated": "2025-11-03T18:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/19341d5c59e8c7e8528e40f8663e99d67810473c", "https://git.kernel.org/stable/c/abad3d0bad72a52137e0c350c59542d75ae4f513", "https://git.kernel.org/stable/c/c1c74584b9b4043c52e41fec415226e582d266a3", "https://git.kernel.org/stable/c/66da7cee78590259b400e51a70622ccd41da7bb2", "https://git.kernel.org/stable/c/7acfa07c585e3d7a64654d38f0a5c762877d0b9b", "https://git.kernel.org/stable/c/41688d1fc5d163a6c2c0e95c0419e2cb31a44648", "https://nvd.nist.gov/vuln/detail/CVE-2025-38502", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38502"], "assigner": "Linux", "epss": 0.07, "enisaIdProduct": [{"id": "11658cc0-2242-3812-8964-0e68ef2e564a", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <c1c74584b9b4043c52e41fec415226e582d266a3"}, {"id": "1682df66-7ee2-3d0b-bf94-e7c54bbeb483", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <7acfa07c585e3d7a64654d38f0a5c762877d0b9b"}, {"id": "33ee370a-9cd5-344f-810c-a11051499c1f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.192"}, {"id": "45e4418e-8a50-3b2d-a362-d670213425fd", "product": {"name": "Linux"}, "product_version": "patch: 6.12.46"}, {"id": "561fe5a8-55a6-341d-a652-d22d53bf939d", "product": {"name": "Linux"}, "product_version": "patch: 6.16.1"}, {"id": "5e7811f1-23e9-327e-9174-8e0d873ffb13", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <abad3d0bad72a52137e0c350c59542d75ae4f513"}, {"id": "692a82af-3f42-3750-b294-a40238f9118c", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <66da7cee78590259b400e51a70622ccd41da7bb2"}, {"id": "6fef8918-d81e-314f-aa7f-cdf64c72ac31", "product": {"name": "Linux"}, "product_version": "patch: 6.1.151"}, {"id": "702179d7-3f3b-32a5-bc4d-bda9100a75b6", "product": {"name": "Linux"}, "product_version": "patch: 6.6.105"}, {"id": "9562c74d-0cac-3142-9116-ab7f3d6f63f2", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}, {"id": "96f864d5-278d-3089-af1b-976b035cd490", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <19341d5c59e8c7e8528e40f8663e99d67810473c"}, {"id": "ac92d6a8-35e0-3f8b-b000-e6db63d88030", "product": {"name": "Linux"}, "product_version": "7d9c3427894fe70d1347b4820476bf37736d2ff0 <41688d1fc5d163a6c2c0e95c0419e2cb31a44648"}, {"id": "b06f1871-03df-34a0-9c85-3cc98e326012", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "b09a0252-a2e1-3006-b394-6e0dd8dc0d86", "product": {"name": "Linux"}, "product_version": "5.9"}, {"id": "cde064bf-e489-3f49-a1cc-baa9d29f384b", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "759eed79-f348-3d25-9f8e-4f6e0f0b2d29", "vendor": {"name": "Linux"}}], "isExploited": false}