{"id": "EUVD-2025-30845", "enisaUuid": "872b0409-b433-32b2-b393-146b8fa05a07", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/memory-failure: fix VM_BUG_ON_PAGE(PagePoisoned(page)) when unpoison memory\n\nWhen I did memory failure tests, below panic occurs:\n\npage dumped because: VM_BUG_ON_PAGE(PagePoisoned(page))\nkernel BUG at include/linux/page-flags.h:616!\nOops: invalid opcode: 0000 [#1] PREEMPT SMP NOPTI\nCPU: 3 PID: 720 Comm: bash Not tainted 6.10.0-rc1-00195-g148743902568 #40\nRIP: 0010:unpoison_memory+0x2f3/0x590\nRSP: 0018:ffffa57fc8787d60 EFLAGS: 00000246\nRAX: 0000000000000037 RBX: 0000000000000009 RCX: ffff9be25fcdc9c8\nRDX: 0000000000000000 RSI: 0000000000000027 RDI: ffff9be25fcdc9c0\nRBP: 0000000000300000 R08: ffffffffb4956f88 R09: 0000000000009ffb\nR10: 0000000000000284 R11: ffffffffb4926fa0 R12: ffffe6b00c000000\nR13: ffff9bdb453dfd00 R14: 0000000000000000 R15: fffffffffffffffe\nFS:  00007f08f04e4740(0000) GS:ffff9be25fcc0000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000564787a30410 CR3: 000000010d4e2000 CR4: 00000000000006f0\nCall Trace:\n <TASK>\n unpoison_memory+0x2f3/0x590\n simple_attr_write_xsigned.constprop.0.isra.0+0xb3/0x110\n debugfs_attr_write+0x42/0x60\n full_proxy_write+0x5b/0x80\n vfs_write+0xd5/0x540\n ksys_write+0x64/0xe0\n do_syscall_64+0xb9/0x1d0\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f08f0314887\nRSP: 002b:00007ffece710078 EFLAGS: 00000246 ORIG_RAX: 0000000000000001\nRAX: ffffffffffffffda RBX: 0000000000000009 RCX: 00007f08f0314887\nRDX: 0000000000000009 RSI: 0000564787a30410 RDI: 0000000000000001\nRBP: 0000564787a30410 R08: 000000000000fefe R09: 000000007fffffff\nR10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000009\nR13: 00007f08f041b780 R14: 00007f08f0417600 R15: 00007f08f0416a00\n </TASK>\nModules linked in: hwpoison_inject\n---[ end trace 0000000000000000 ]---\nRIP: 0010:unpoison_memory+0x2f3/0x590\nRSP: 0018:ffffa57fc8787d60 EFLAGS: 00000246\nRAX: 0000000000000037 RBX: 0000000000000009 RCX: ffff9be25fcdc9c8\nRDX: 0000000000000000 RSI: 0000000000000027 RDI: ffff9be25fcdc9c0\nRBP: 0000000000300000 R08: ffffffffb4956f88 R09: 0000000000009ffb\nR10: 0000000000000284 R11: ffffffffb4926fa0 R12: ffffe6b00c000000\nR13: ffff9bdb453dfd00 R14: 0000000000000000 R15: fffffffffffffffe\nFS:  00007f08f04e4740(0000) GS:ffff9be25fcc0000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000564787a30410 CR3: 000000010d4e2000 CR4: 00000000000006f0\nKernel panic - not syncing: Fatal exception\nKernel Offset: 0x31c00000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)\n---[ end Kernel panic - not syncing: Fatal exception ]---\n\nThe root cause is that unpoison_memory() tries to check the PG_HWPoison\nflags of an uninitialized page.  So VM_BUG_ON_PAGE(PagePoisoned(page)) is\ntriggered.  This can be reproduced by below steps:\n\n1.Offline memory block:\n\n echo offline > /sys/devices/system/memory/memory12/state\n\n2.Get offlined memory pfn:\n\n page-types -b n -rlN\n\n3.Write pfn to unpoison-pfn\n\n echo <pfn> > /sys/kernel/debug/hwpoison/unpoison-pfn\n\nThis scenario can be identified by pfn_to_online_page() returning NULL. \nAnd ZONE_DEVICE pages are never expected, so we can simply fail if\npfn_to_online_page() == NULL to fix the bug.", "datePublished": "2025-09-23T06:30:28", "dateUpdated": "2025-11-03T18:31:43", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-39883", "https://git.kernel.org/stable/c/3d278e89c2ea62b1aaa4b0d8a9766a35b3a3164a", "https://git.kernel.org/stable/c/63a327a2375a8ce7a47dec5aaa4d8a9ae0a00b96", "https://git.kernel.org/stable/c/7618fd443aa4cfa553a64cacf5721581653ee7b0", "https://git.kernel.org/stable/c/d613f53c83ec47089c4e25859d5e8e0359f6f8da", "https://git.kernel.org/stable/c/e4ec6def5643a1c9511115b3884eb879572294c6", "https://git.kernel.org/stable/c/8e01ea186a52c90694c08a9ff57bea1b0e78256a", "https://git.kernel.org/stable/c/99f7048957f5ae3cee1c01189147e73a9a96de02", "https://git.kernel.org/stable/c/fb65803ccff37cf9123c50c1c02efd1ed73c4ed5", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-39883", "GHSA-r5ff-446r-jr83"], "assigner": "Linux", "epss": 0.07, "enisaIdProduct": [{"id": "03a6640d-5eeb-3719-a393-372c3d7ccd94", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <3d278e89c2ea62b1aaa4b0d8a9766a35b3a3164a"}, {"id": "082ff50c-90fe-3809-a479-8b16478d9483", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <63a327a2375a8ce7a47dec5aaa4d8a9ae0a00b96"}, {"id": "207c44f5-1949-3a60-bdd0-5d0cc300294d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.245"}, {"id": "36e7c800-ab91-3100-b684-e88694052eb3", "product": {"name": "Linux"}, "product_version": "patch: 5.15.194"}, {"id": "4cc9ba69-8b3e-3afa-838a-93ed2a5d66bb", "product": {"name": "Linux"}, "product_version": "patch: 6.16.8"}, {"id": "57a94ec1-7cc6-3703-bbfe-a30540f98579", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "61042aac-681f-3765-8430-1359b03e928a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "61d41142-19f5-3a35-aced-ff9851a868a1", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <8e01ea186a52c90694c08a9ff57bea1b0e78256a"}, {"id": "6e6978d4-03e8-3c60-bb35-5cd9fd8f751b", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <d613f53c83ec47089c4e25859d5e8e0359f6f8da"}, {"id": "70339b97-b53a-39af-99d1-3ffd6eb4e3ac", "product": {"name": "Linux"}, "product_version": "patch: 6.1.153"}, {"id": "72b551f7-073e-3b65-b58b-4ddbd155681b", "product": {"name": "Linux"}, "product_version": "4.13"}, {"id": "8368e312-5b0f-3003-b6fd-2171f32f531f", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <e4ec6def5643a1c9511115b3884eb879572294c6"}, {"id": "91410f77-ec9b-31b7-be6b-ef4a4f1f1476", "product": {"name": "Linux"}, "product_version": "patch: 5.4.300"}, {"id": "92e411c4-872c-3495-b1ce-176b5499f339", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <7618fd443aa4cfa553a64cacf5721581653ee7b0"}, {"id": "a952e30e-de74-3aae-88ac-1a74f903a102", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <fb65803ccff37cf9123c50c1c02efd1ed73c4ed5"}, {"id": "d53453ce-e9ae-35be-aa58-984a5b5b069c", "product": {"name": "Linux"}, "product_version": "f1dd2cd13c4bbbc9a7c4617b3b034fa643de98fe <99f7048957f5ae3cee1c01189147e73a9a96de02"}, {"id": "db67c74c-4859-3272-bcf2-97245e2cd30d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.107"}, {"id": "f49e6bea-e978-3e86-beab-295f76a67821", "product": {"name": "Linux"}, "product_version": "patch: 6.12.48"}, {"id": "f9b30004-e148-33fe-8846-50654946daf1", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc6"}], "enisaIdVendor": [{"id": "50293766-dfea-3021-8607-919d3ae85596", "vendor": {"name": "Linux"}}], "isExploited": false}