{"id": "EUVD-2025-5248", "enisaUuid": "999f10fe-b9ef-3d29-8169-f7e44d31d3d0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: handle fastopen disconnect correctly\n\nSyzbot was able to trigger a data stream corruption:\n\n  WARNING: CPU: 0 PID: 9846 at net/mptcp/protocol.c:1024 __mptcp_clean_una+0xddb/0xff0 net/mptcp/protocol.c:1024\n  Modules linked in:\n  CPU: 0 UID: 0 PID: 9846 Comm: syz-executor351 Not tainted 6.13.0-rc2-syzkaller-00059-g00a5acdbf398 #0\n  Hardware name: Google Compute Engine/Google Compute Engine, BIOS Google 11/25/2024\n  RIP: 0010:__mptcp_clean_una+0xddb/0xff0 net/mptcp/protocol.c:1024\n  Code: fa ff ff 48 8b 4c 24 18 80 e1 07 fe c1 38 c1 0f 8c 8e fa ff ff 48 8b 7c 24 18 e8 e0 db 54 f6 e9 7f fa ff ff e8 e6 80 ee f5 90 <0f> 0b 90 4c 8b 6c 24 40 4d 89 f4 e9 04 f5 ff ff 44 89 f1 80 e1 07\n  RSP: 0018:ffffc9000c0cf400 EFLAGS: 00010293\n  RAX: ffffffff8bb0dd5a RBX: ffff888033f5d230 RCX: ffff888059ce8000\n  RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000000\n  RBP: ffffc9000c0cf518 R08: ffffffff8bb0d1dd R09: 1ffff110170c8928\n  R10: dffffc0000000000 R11: ffffed10170c8929 R12: 0000000000000000\n  R13: ffff888033f5d220 R14: dffffc0000000000 R15: ffff8880592b8000\n  FS:  00007f6e866496c0(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000\n  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n  CR2: 00007f6e86f491a0 CR3: 00000000310e6000 CR4: 00000000003526f0\n  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n  Call Trace:\n   <TASK>\n   __mptcp_clean_una_wakeup+0x7f/0x2d0 net/mptcp/protocol.c:1074\n   mptcp_release_cb+0x7cb/0xb30 net/mptcp/protocol.c:3493\n   release_sock+0x1aa/0x1f0 net/core/sock.c:3640\n   inet_wait_for_connect net/ipv4/af_inet.c:609 [inline]\n   __inet_stream_connect+0x8bd/0xf30 net/ipv4/af_inet.c:703\n   mptcp_sendmsg_fastopen+0x2a2/0x530 net/mptcp/protocol.c:1755\n   mptcp_sendmsg+0x1884/0x1b10 net/mptcp/protocol.c:1830\n   sock_sendmsg_nosec net/socket.c:711 [inline]\n   __sock_sendmsg+0x1a6/0x270 net/socket.c:726\n   ____sys_sendmsg+0x52a/0x7e0 net/socket.c:2583\n   ___sys_sendmsg net/socket.c:2637 [inline]\n   __sys_sendmsg+0x269/0x350 net/socket.c:2669\n   do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n   do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n   entry_SYSCALL_64_after_hwframe+0x77/0x7f\n  RIP: 0033:0x7f6e86ebfe69\n  Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 b1 1f 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b0 ff ff ff f7 d8 64 89 01 48\n  RSP: 002b:00007f6e86649168 EFLAGS: 00000246 ORIG_RAX: 000000000000002e\n  RAX: ffffffffffffffda RBX: 00007f6e86f491b8 RCX: 00007f6e86ebfe69\n  RDX: 0000000030004001 RSI: 0000000020000080 RDI: 0000000000000003\n  RBP: 00007f6e86f491b0 R08: 00007f6e866496c0 R09: 0000000000000000\n  R10: 0000000000000000 R11: 0000000000000246 R12: 00007f6e86f491bc\n  R13: 000000000000006e R14: 00007ffe445d9420 R15: 00007ffe445d9508\n   </TASK>\n\nThe root cause is the bad handling of disconnect() generated internally\nby the MPTCP protocol in case of connect FASTOPEN errors.\n\nAddress the issue increasing the socket disconnect counter even on such\na case, to allow other threads waiting on the same socket lock to\nproperly error out.", "datePublished": "2025-02-27T02:07:19", "dateUpdated": "2025-11-03T19:35:56", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-21705", "https://git.kernel.org/stable/c/0263fb2e7b7b88075a5d86e74c4384ee4400828d", "https://git.kernel.org/stable/c/619af16b3b57a3a4ee50b9a30add9ff155541e71", "https://git.kernel.org/stable/c/6ec806762318a4adde0ea63342d42d0feae95079", "https://git.kernel.org/stable/c/73e268b4be27b36ae68ea10755cb003f43b38884", "https://git.kernel.org/stable/c/84ac44d9fed3a56440971cbd7600a02b70b5b32a", "https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html"], "aliases": ["CVE-2025-21705", "GHSA-924q-jxwc-x679"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "1f1c8542-ca6e-35f8-9b20-536c70ec67c4", "product": {"name": "Linux"}, "product_version": "9c998d59a6b1359ad43d1ef38538af5f55fd01a2"}, {"id": "24a4d40e-2f14-35c8-8d71-af9e55fc8e5a", "product": {"name": "Linux"}, "product_version": "c2b2ae3925b65070adb27d5a31a31c376f26dec7 <0263fb2e7b7b88075a5d86e74c4384ee4400828d"}, {"id": "2a0527e4-2d3b-3756-bea3-e98c3001d5fe", "product": {"name": "Linux"}, "product_version": "c2b2ae3925b65070adb27d5a31a31c376f26dec7 <619af16b3b57a3a4ee50b9a30add9ff155541e71"}, {"id": "3a6d29f4-d151-39ff-9256-62c6addeb5e3", "product": {"name": "Linux"}, "product_version": "c2b2ae3925b65070adb27d5a31a31c376f26dec7 <6ec806762318a4adde0ea63342d42d0feae95079"}, {"id": "3b150f91-6d41-3c63-821a-454a1a77e23c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "673fa431-ff0f-3f88-9ec0-d8af33261a18", "product": {"name": "Linux"}, "product_version": "c2b2ae3925b65070adb27d5a31a31c376f26dec7 <84ac44d9fed3a56440971cbd7600a02b70b5b32a"}, {"id": "696a4ea6-ef66-3cd5-9cc5-76a6eb7ac425", "product": {"name": "Linux"}, "product_version": "patch: 6.6.76"}, {"id": "7ab46467-f623-33fb-a092-77631875b1fb", "product": {"name": "Linux"}, "product_version": "patch: 6.12.13"}, {"id": "8c4ceda8-c3f4-3522-a1a7-8e35b33ce8af", "product": {"name": "Linux"}, "product_version": "patch: 6.14"}, {"id": "98ad8dac-ae75-350d-9423-3e354335b168", "product": {"name": "Linux"}, "product_version": "patch: 6.1.129"}, {"id": "98b270f9-271f-3c8e-8a37-6b07a930e330", "product": {"name": "Linux"}, "product_version": "b7bb71dfb541df376c21c24451369fea83c4f327 <73e268b4be27b36ae68ea10755cb003f43b38884"}, {"id": "a3c5a805-ef5d-3d64-beca-822e0ed01e1c", "product": {"name": "Linux"}, "product_version": "6.4"}, {"id": "c6288bb7-a117-3bc9-a944-1507150f4d53", "product": {"name": "Linux"}, "product_version": "patch: 6.13.2"}], "enisaIdVendor": [{"id": "066ab95c-3d8e-3caa-9a7e-59f822545279", "vendor": {"name": "Linux"}}], "isExploited": false}