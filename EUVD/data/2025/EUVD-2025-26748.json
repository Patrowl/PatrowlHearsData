{"id": "EUVD-2025-26748", "enisaUuid": "4b7af822-f684-3c1b-8151-5f77d03ddcba", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: ctnetlink: fix refcount leak on table dump\n\nThere is a reference count leak in ctnetlink_dump_table():\n      if (res < 0) {\n                nf_conntrack_get(&ct->ct_general); // HERE\n                cb->args[1] = (unsigned long)ct;\n                ...\n\nWhile its very unlikely, its possible that ct == last.\nIf this happens, then the refcount of ct was already incremented.\nThis 2nd increment is never undone.\n\nThis prevents the conntrack object from being released, which in turn\nkeeps prevents cnet->count from dropping back to 0.\n\nThis will then block the netns dismantle (or conntrack rmmod) as\nnf_conntrack_cleanup_net_list() will wait forever.\n\nThis can be reproduced by running conntrack_resize.sh selftest in a loop.\nIt takes ~20 minutes for me on a preemptible kernel on average before\nI see a runaway kworker spinning in nf_conntrack_cleanup_net_list.\n\nOne fix would to change this to:\n        if (res < 0) {\n\t\tif (ct != last)\n\t                nf_conntrack_get(&ct->ct_general);\n\nBut this reference counting isn't needed in the first place.\nWe can just store a cookie value instead.\n\nA followup patch will do the same for ctnetlink_exp_dump_table,\nit looks to me as if this has the same problem and like\nctnetlink_dump_table, we only need a 'skip hint', not the actual\nobject so we can apply the same cookie strategy there as well.", "datePublished": "2025-09-05T18:31:17", "dateUpdated": "2025-11-03T18:31:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/586892e341fbf698e7cbaca293e1353957db725a", "https://git.kernel.org/stable/c/962518c6ca9f9a13df099cafa429f72f68ad61f0", "https://git.kernel.org/stable/c/19b909a4b1452fb97e477d2f08b97f8d04095619", "https://git.kernel.org/stable/c/41462f4cfc583513833f87f9ee55d12da651a7e3", "https://git.kernel.org/stable/c/30cf811058552b8cd0e98dff677ef3f89d6d34ce", "https://git.kernel.org/stable/c/a2cb4df7872de069f809de2f076ec8e54d649fe3", "https://git.kernel.org/stable/c/e14f72aa66c029db106921d621edcedef68e065b", "https://git.kernel.org/stable/c/a62d6aa3f31f216b637a4c71b7a8bfc7c57f049b", "https://git.kernel.org/stable/c/de788b2e6227462b6dcd0e07474e72c089008f74", "https://nvd.nist.gov/vuln/detail/CVE-2025-38721", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38721"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "04f58ceb-c219-3232-b9b5-f88bb0781df0", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <19b909a4b1452fb97e477d2f08b97f8d04095619"}, {"id": "0ca64a34-2edb-39d8-97be-133c1e8cae11", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc2"}, {"id": "17b01de7-45ac-36de-9642-fc942f1dc465", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <30cf811058552b8cd0e98dff677ef3f89d6d34ce"}, {"id": "242e328f-007d-3387-9eb5-34f4a26028b8", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <586892e341fbf698e7cbaca293e1353957db725a"}, {"id": "34962bc4-1f20-3d56-ae50-a69dd4d9fa00", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <41462f4cfc583513833f87f9ee55d12da651a7e3"}, {"id": "390fd04c-7b21-3212-9637-64354ff11723", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "3c947532-f244-3c8a-854c-ff7796365197", "product": {"name": "Linux"}, "product_version": "patch: 6.16.2"}, {"id": "4ab08e6c-d1f0-323d-81a9-28b09800d555", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "52a42a03-1264-3057-8ee8-b3ff46cdecd0", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <962518c6ca9f9a13df099cafa429f72f68ad61f0"}, {"id": "57068a37-0daf-3435-a31b-5d7fe8fee290", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}, {"id": "6aff9080-70de-3ce2-8c9d-cab7c9080776", "product": {"name": "Linux"}, "product_version": "patch: 6.6.103"}, {"id": "73f96e03-5973-30bc-971a-c32a55332deb", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <e14f72aa66c029db106921d621edcedef68e065b"}, {"id": "7ec34e46-728d-3eef-b2d7-ae0264847145", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "8897701a-4ebc-3e28-951e-3d2d720c4e16", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8a31c478-7547-339b-8441-569bebf1b91c", "product": {"name": "Linux"}, "product_version": "patch: 6.12.43"}, {"id": "a462e599-6348-3fb4-960f-15268791aed6", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <a62d6aa3f31f216b637a4c71b7a8bfc7c57f049b"}, {"id": "bbf92a11-e5c5-3a4f-bf77-9c46d0a736d9", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <de788b2e6227462b6dcd0e07474e72c089008f74"}, {"id": "e4d3ae03-c95b-3cb6-ad0d-985a8448f2ea", "product": {"name": "Linux"}, "product_version": "2.6.18"}, {"id": "e6105ab2-1ad7-30fd-bf80-74a4632c0c13", "product": {"name": "Linux"}, "product_version": "patch: 6.15.11"}, {"id": "e73c64e7-1fff-3f75-832e-5afb0807926e", "product": {"name": "Linux"}, "product_version": "d205dc40798d97d63ad348bfaf7394f445d152d4 <a2cb4df7872de069f809de2f076ec8e54d649fe3"}, {"id": "fd762e97-3b61-311c-8b08-0dac3b9fc63b", "product": {"name": "Linux"}, "product_version": "patch: 6.1.149"}], "enisaIdVendor": [{"id": "e75fef36-2606-36ba-9632-f0fe65c45142", "vendor": {"name": "Linux"}}], "isExploited": false}