{"id": "EUVD-2025-25535", "enisaUuid": "eb9b5610-5174-3db2-bc8d-3041e8b2db94", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: appletalk: Fix use-after-free in AARP proxy probe\n\nThe AARP proxy\u2010probe routine (aarp_proxy_probe_network) sends a probe,\nreleases the aarp_lock, sleeps, then re-acquires the lock.  During that\nwindow an expire timer thread (__aarp_expire_timer) can remove and\nkfree() the same entry, leading to a use-after-free.\n\nrace condition:\n\n         cpu 0                          |            cpu 1\n    atalk_sendmsg()                     |   atif_proxy_probe_device()\n    aarp_send_ddp()                     |   aarp_proxy_probe_network()\n    mod_timer()                         |   lock(aarp_lock) // LOCK!!\n    timeout around 200ms                |   alloc(aarp_entry)\n    and then call                       |   proxies[hash] = aarp_entry\n    aarp_expire_timeout()               |   aarp_send_probe()\n                                        |   unlock(aarp_lock) // UNLOCK!!\n    lock(aarp_lock) // LOCK!!           |   msleep(100);\n    __aarp_expire_timer(&proxies[ct])   |\n    free(aarp_entry)                    |\n    unlock(aarp_lock) // UNLOCK!!       |\n                                        |   lock(aarp_lock) // LOCK!!\n                                        |   UAF aarp_entry !!\n\n==================================================================\nBUG: KASAN: slab-use-after-free in aarp_proxy_probe_network+0x560/0x630 net/appletalk/aarp.c:493\nRead of size 4 at addr ffff8880123aa360 by task repro/13278\n\nCPU: 3 UID: 0 PID: 13278 Comm: repro Not tainted 6.15.2 #3 PREEMPT(full)\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:94 [inline]\n dump_stack_lvl+0x116/0x1b0 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:408 [inline]\n print_report+0xc1/0x630 mm/kasan/report.c:521\n kasan_report+0xca/0x100 mm/kasan/report.c:634\n aarp_proxy_probe_network+0x560/0x630 net/appletalk/aarp.c:493\n atif_proxy_probe_device net/appletalk/ddp.c:332 [inline]\n atif_ioctl+0xb58/0x16c0 net/appletalk/ddp.c:857\n atalk_ioctl+0x198/0x2f0 net/appletalk/ddp.c:1818\n sock_do_ioctl+0xdc/0x260 net/socket.c:1190\n sock_ioctl+0x239/0x6a0 net/socket.c:1311\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:906 [inline]\n __se_sys_ioctl fs/ioctl.c:892 [inline]\n __x64_sys_ioctl+0x194/0x200 fs/ioctl.c:892\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xcb/0x250 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n </TASK>\n\nAllocated:\n aarp_alloc net/appletalk/aarp.c:382 [inline]\n aarp_proxy_probe_network+0xd8/0x630 net/appletalk/aarp.c:468\n atif_proxy_probe_device net/appletalk/ddp.c:332 [inline]\n atif_ioctl+0xb58/0x16c0 net/appletalk/ddp.c:857\n atalk_ioctl+0x198/0x2f0 net/appletalk/ddp.c:1818\n\nFreed:\n kfree+0x148/0x4d0 mm/slub.c:4841\n __aarp_expire net/appletalk/aarp.c:90 [inline]\n __aarp_expire_timer net/appletalk/aarp.c:261 [inline]\n aarp_expire_timeout+0x480/0x6e0 net/appletalk/aarp.c:317\n\nThe buggy address belongs to the object at ffff8880123aa300\n which belongs to the cache kmalloc-192 of size 192\nThe buggy address is located 96 bytes inside of\n freed 192-byte region [ffff8880123aa300, ffff8880123aa3c0)\n\nMemory state around the buggy address:\n ffff8880123aa200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n ffff8880123aa280: 00 00 00 00 fc fc fc fc fc fc fc fc fc fc fc fc\n>ffff8880123aa300: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n                                                       ^\n ffff8880123aa380: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc\n ffff8880123aa400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n==================================================================", "datePublished": "2025-08-22T18:31:23", "dateUpdated": "2025-11-03T18:31:36", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/2a6209e4649d45fd85d4193abc481911858ffc6f", "https://git.kernel.org/stable/c/e4f1564c5b699eb89b3040688fd6b4e57922f1f6", "https://git.kernel.org/stable/c/5f02ea0f63dd38c41539ea290fcc1693c73aa8e5", "https://git.kernel.org/stable/c/f90b6bb203f3f38bf2b3d976113d51571df9a482", "https://git.kernel.org/stable/c/6c4a92d07b0850342d3becf2e608f805e972467c", "https://git.kernel.org/stable/c/b35694ffabb2af308a1f725d70f60fd8a47d1f3e", "https://git.kernel.org/stable/c/82d19a70ced28b17a38ebf1b6978c6c7db894979", "https://git.kernel.org/stable/c/186942d19c0222617ef61f50e1dba91e269a5963", "https://nvd.nist.gov/vuln/detail/CVE-2025-38666", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38666"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "02c1270d-7cc6-348a-ae84-277de4f5db14", "product": {"name": "Linux"}, "product_version": "2.6.12"}, {"id": "0fdfc8fa-2f30-3537-9f43-0490d05e4bd8", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f90b6bb203f3f38bf2b3d976113d51571df9a482"}, {"id": "16eeab77-d487-3953-a2f7-d2bf94ece184", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "190c0732-de8d-36ae-9d71-e5b1779c4b2c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2a6209e4649d45fd85d4193abc481911858ffc6f"}, {"id": "1d6ac8fb-d385-3a52-a7f8-0e333a5851cf", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <186942d19c0222617ef61f50e1dba91e269a5963"}, {"id": "6a3f13c6-2a86-3413-9ae1-e20d07c2b25e", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "749343e8-4ba5-3645-8d9a-002e6efcc3ab", "product": {"name": "Linux"}, "product_version": "patch: 6.15.9"}, {"id": "afe89d3b-9a54-3510-bee4-87c74ca35e42", "product": {"name": "Linux"}, "product_version": "patch: 6.6.101"}, {"id": "b02f9361-a2af-3184-a43e-145f6d2d96f7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}, {"id": "b03b04ed-b553-3ec6-b1d6-3234af6e436b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6c4a92d07b0850342d3becf2e608f805e972467c"}, {"id": "b2dda968-9925-382b-86f8-7cb43271f2fd", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c8d9bfd1-b93d-3591-8d31-ac1b08a574e1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b35694ffabb2af308a1f725d70f60fd8a47d1f3e"}, {"id": "ddfa8755-8ab7-34b2-bb3f-7039172ebf37", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <82d19a70ced28b17a38ebf1b6978c6c7db894979"}, {"id": "deb5fd9f-1b81-3025-b9e5-590f99889aeb", "product": {"name": "Linux"}, "product_version": "patch: 6.12.41"}, {"id": "e62a9ee4-25af-361c-b9bd-f415e0e98a47", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e4f1564c5b699eb89b3040688fd6b4e57922f1f6"}, {"id": "e89e2bfd-791e-3873-9579-75a65931c9c6", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "f1bf813d-c1ad-3043-bfbe-316407aeb76f", "product": {"name": "Linux"}, "product_version": "patch: 6.1.148"}, {"id": "f49def38-6a8c-3e28-9d90-da73d9d3df74", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5f02ea0f63dd38c41539ea290fcc1693c73aa8e5"}], "enisaIdVendor": [{"id": "4614e8ed-b346-3684-9849-53b4a79544ab", "vendor": {"name": "Linux"}}], "isExploited": false}