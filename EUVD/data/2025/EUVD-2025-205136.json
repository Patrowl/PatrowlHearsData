{"id": "EUVD-2025-205136", "enisaUuid": "1b3c85a3-b662-32cf-a50d-24cc0920f173", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: sf-pdma: pdma_desc memory leak fix\n\nCommit b2cc5c465c2c (\"dmaengine: sf-pdma: Add multithread support for a\nDMA channel\") changed sf_pdma_prep_dma_memcpy() to unconditionally\nallocate a new sf_pdma_desc each time it is called.\n\nThe driver previously recycled descs, by checking the in_use flag, only\nallocating additional descs if the existing one was in use. This logic\nwas removed in commit b2cc5c465c2c (\"dmaengine: sf-pdma: Add multithread\nsupport for a DMA channel\"), but sf_pdma_free_desc() was not changed to\nhandle the new behaviour.\n\nAs a result, each time sf_pdma_prep_dma_memcpy() is called, the previous\ndescriptor is leaked, over time leading to memory starvation:\n\n  unreferenced object 0xffffffe008447300 (size 192):\n  comm \"irq/39-mchp_dsc\", pid 343, jiffies 4294906910 (age 981.200s)\n  hex dump (first 32 bytes):\n    00 00 00 ff 00 00 00 00 b8 c1 00 00 00 00 00 00  ................\n    00 00 70 08 10 00 00 00 00 00 00 c0 00 00 00 00  ..p.............\n  backtrace:\n    [<00000000064a04f4>] kmemleak_alloc+0x1e/0x28\n    [<00000000018927a7>] kmem_cache_alloc+0x11e/0x178\n    [<000000002aea8d16>] sf_pdma_prep_dma_memcpy+0x40/0x112\n\nAdd the missing kfree() to sf_pdma_free_desc(), and remove the redundant\nin_use flag.", "datePublished": "2025-12-24T12:30:28", "dateUpdated": "2025-12-24T12:30:28", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-54020", "https://git.kernel.org/stable/c/03fece43fa109beba7cc9948c02f5e2d1205d607", "https://git.kernel.org/stable/c/8bd5040bd43f2b5ba3c898b09a3197a0c7ace126", "https://git.kernel.org/stable/c/ad222c9af25e3f074c180e389b3477dce42afc4f", "https://git.kernel.org/stable/c/b02e07015a5ac7bbc029da931ae17914b8ae0339"], "aliases": ["CVE-2023-54020", "GHSA-4cm4-vw36-jc7r"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0da073a7-806a-3f86-9844-5131342c7cfd", "product": {"name": "Linux"}, "product_version": "4c7350b1dd8a192af844de32fc99b9e34c876fda"}, {"id": "174d4786-898b-30ee-b072-b5b1aeb97a25", "product": {"name": "Linux"}, "product_version": "b9b4992f897be9b0b9e3a3b956cab6b75ccc3f11"}, {"id": "1e5467c2-8aeb-3053-9f5f-d6f40bffff22", "product": {"name": "Linux"}, "product_version": "a93b3f1e11971a91b6441b6d47488f4492cc113f"}, {"id": "37ec2eb7-4e8c-3074-a0f6-98376ebc810d", "product": {"name": "Linux"}, "product_version": "5ab2782c944e324008ef5d658f2494a9f0e3c5ac <ad222c9af25e3f074c180e389b3477dce42afc4f"}, {"id": "8f58ca1f-abc8-37ee-8cc9-e5014d76c64c", "product": {"name": "Linux"}, "product_version": "b2cc5c465c2cb8ab697c3fd6583c614e3f6cfbcc <03fece43fa109beba7cc9948c02f5e2d1205d607"}, {"id": "a597ff39-c8c2-384c-b7b4-fb574b93bd30", "product": {"name": "Linux"}, "product_version": "b2cc5c465c2cb8ab697c3fd6583c614e3f6cfbcc <8bd5040bd43f2b5ba3c898b09a3197a0c7ace126"}, {"id": "cdca6e56-002a-34a0-828d-f6a003430115", "product": {"name": "Linux"}, "product_version": "b2cc5c465c2cb8ab697c3fd6583c614e3f6cfbcc <b02e07015a5ac7bbc029da931ae17914b8ae0339"}, {"id": "e3c395e8-e318-36d6-b349-2bfe61937cff", "product": {"name": "Linux"}, "product_version": "patch: 5.15.99"}, {"id": "eb2a2f02-975d-3d6c-8e55-244aef10096e", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}, {"id": "ebd352f9-9363-3f53-85ce-372c49d69fac", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "f07d8c52-9358-373c-9396-23e6226bcc17", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "f1446d6c-6050-3042-9d95-804f83310ca4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "fc16d341-f523-3bc9-998e-45f1dcc9aeef", "product": {"name": "Linux"}, "product_version": "6.0"}], "enisaIdVendor": [{"id": "77fa6cdd-4440-31fb-a952-f88e3a00d9e7", "vendor": {"name": "Linux"}}], "isExploited": false}