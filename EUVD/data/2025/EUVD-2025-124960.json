{"id": "EUVD-2025-124960", "enisaUuid": "71f1171c-6c60-30a4-af52-dc1bf0018e63", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Enforce expected_attach_type for tailcall compatibility\n\nYinhao et al. recently reported:\n\n  Our fuzzer tool discovered an uninitialized pointer issue in the\n  bpf_prog_test_run_xdp() function within the Linux kernel's BPF subsystem.\n  This leads to a NULL pointer dereference when a BPF program attempts to\n  deference the txq member of struct xdp_buff object.\n\nThe test initializes two programs of BPF_PROG_TYPE_XDP: progA acts as the\nentry point for bpf_prog_test_run_xdp() and its expected_attach_type can\nneither be of be BPF_XDP_DEVMAP nor BPF_XDP_CPUMAP. progA calls into a slot\nof a tailcall map it owns. progB's expected_attach_type must be BPF_XDP_DEVMAP\nto pass xdp_is_valid_access() validation. The program returns struct xdp_md's\negress_ifindex, and the latter is only allowed to be accessed under mentioned\nexpected_attach_type. progB is then inserted into the tailcall which progA\ncalls.\n\nThe underlying issue goes beyond XDP though. Another example are programs\nof type BPF_PROG_TYPE_CGROUP_SOCK_ADDR. sock_addr_is_valid_access() as well\nas sock_addr_func_proto() have different logic depending on the programs'\nexpected_attach_type. Similarly, a program attached to BPF_CGROUP_INET4_GETPEERNAME\nshould not be allowed doing a tailcall into a program which calls bpf_bind()\nout of BPF which is only enabled for BPF_CGROUP_INET4_CONNECT.\n\nIn short, specifying expected_attach_type allows to open up additional\nfunctionality or restrictions beyond what the basic bpf_prog_type enables.\nThe use of tailcalls must not violate these constraints. Fix it by enforcing\nexpected_attach_type in __bpf_prog_map_compatible().\n\nNote that we only enforce this for tailcall maps, but not for BPF devmaps or\ncpumaps: There, the programs are invoked through dev_map_bpf_prog_run*() and\ncpu_map_bpf_prog_run*() which set up a new environment / context and therefore\nthese situations are not prone to this issue.", "datePublished": "2025-11-12T10:23:19", "dateUpdated": "2025-12-01T06:18:28", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/a99de19128aec0913f3d529f529fbbff5edfaff8", "https://git.kernel.org/stable/c/08cb3dc9d2b44f153d0bcf2cb966e4a94b5d0f32", "https://git.kernel.org/stable/c/f856c598080ba7ce1252867b8ecd6ad5bdaf9a6a", "https://git.kernel.org/stable/c/c1ad19b5d8e23123503dcaf2d4342e1b90b923ad", "https://git.kernel.org/stable/c/4540aed51b12bc13364149bf95f6ecef013197c0", "https://nvd.nist.gov/vuln/detail/CVE-2025-40123"], "aliases": ["CVE-2025-40123"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "177c4b0d-8ecd-3b74-9670-6a05623461a7", "product": {"name": "Linux"}, "product_version": "patch: 6.6.112"}, {"id": "235dc4b4-e0f7-3dcf-92f8-24aa6a1cec3d", "product": {"name": "Linux"}, "product_version": "4.17"}, {"id": "2b8e1d14-eacc-3ab6-8490-fc4cc229d3a4", "product": {"name": "Linux"}, "product_version": "5e43f899b03a3492ce5fc44e8900becb04dae9c0 <c1ad19b5d8e23123503dcaf2d4342e1b90b923ad"}, {"id": "45c45d44-017b-3049-9c6b-10cd74c3ea87", "product": {"name": "Linux"}, "product_version": "5e43f899b03a3492ce5fc44e8900becb04dae9c0 <4540aed51b12bc13364149bf95f6ecef013197c0"}, {"id": "5f89a7d1-60c9-3dcd-84b8-7461b9beb5bf", "product": {"name": "Linux"}, "product_version": "5e43f899b03a3492ce5fc44e8900becb04dae9c0 <a99de19128aec0913f3d529f529fbbff5edfaff8"}, {"id": "67c5176a-8f90-3d1f-b82e-2080b08498ef", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "82c76ce3-a359-30d1-8a1f-fd8dd379531f", "product": {"name": "Linux"}, "product_version": "patch: 6.1.156"}, {"id": "98d4ced4-7f13-32a5-8c92-63e9614defd8", "product": {"name": "Linux"}, "product_version": "patch: 6.12.53"}, {"id": "ae2b24d7-bb4c-3792-97e3-508ec4c94c00", "product": {"name": "Linux"}, "product_version": "5e43f899b03a3492ce5fc44e8900becb04dae9c0 <08cb3dc9d2b44f153d0bcf2cb966e4a94b5d0f32"}, {"id": "dea450f9-7c49-304f-a87d-514fd5d0e782", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "e72682fd-43b2-38c9-9fd3-e2b39a7e181f", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "f03e3e61-e593-34a1-bc89-305200053260", "product": {"name": "Linux"}, "product_version": "5e43f899b03a3492ce5fc44e8900becb04dae9c0 <f856c598080ba7ce1252867b8ecd6ad5bdaf9a6a"}, {"id": "fdc55eae-d55e-387a-9784-dbdaf76c5c79", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "85a39f51-ccd5-346f-b83b-4a36e5ed8b43", "vendor": {"name": "Linux"}}], "isExploited": false}