{"id": "EUVD-2025-29959", "enisaUuid": "215f46d7-388a-3503-9028-4c529ea0f7f2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/mlx5: Fix mlx5_ib_get_hw_stats when used for device\n\nCurrently, when mlx5_ib_get_hw_stats() is used for device (port_num = 0),\nthere is a special handling in order to use the correct counters, but,\nport_num is being passed down the stack without any change.  Also, some\nfunctions assume that port_num >=1. As a result, the following oops can\noccur.\n\n BUG: unable to handle page fault for address: ffff89510294f1a8\n #PF: supervisor write access in kernel mode\n #PF: error_code(0x0002) - not-present page\n PGD 0 P4D 0\n Oops: 0002 [#1] SMP\n CPU: 8 PID: 1382 Comm: devlink Tainted: G W          6.1.0-rc4_for_upstream_base_2022_11_10_16_12 #1\n Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\n RIP: 0010:_raw_spin_lock+0xc/0x20\n Call Trace:\n  <TASK>\n  mlx5_ib_get_native_port_mdev+0x73/0xe0 [mlx5_ib]\n  do_get_hw_stats.constprop.0+0x109/0x160 [mlx5_ib]\n  mlx5_ib_get_hw_stats+0xad/0x180 [mlx5_ib]\n  ib_setup_device_attrs+0xf0/0x290 [ib_core]\n  ib_register_device+0x3bb/0x510 [ib_core]\n  ? atomic_notifier_chain_register+0x67/0x80\n  __mlx5_ib_add+0x2b/0x80 [mlx5_ib]\n  mlx5r_probe+0xb8/0x150 [mlx5_ib]\n  ? auxiliary_match_id+0x6a/0x90\n  auxiliary_bus_probe+0x3c/0x70\n  ? driver_sysfs_add+0x6b/0x90\n  really_probe+0xcd/0x380\n  __driver_probe_device+0x80/0x170\n  driver_probe_device+0x1e/0x90\n  __device_attach_driver+0x7d/0x100\n  ? driver_allows_async_probing+0x60/0x60\n  ? driver_allows_async_probing+0x60/0x60\n  bus_for_each_drv+0x7b/0xc0\n  __device_attach+0xbc/0x200\n  bus_probe_device+0x87/0xa0\n  device_add+0x404/0x940\n  ? dev_set_name+0x53/0x70\n  __auxiliary_device_add+0x43/0x60\n  add_adev+0x99/0xe0 [mlx5_core]\n  mlx5_attach_device+0xc8/0x120 [mlx5_core]\n  mlx5_load_one_devl_locked+0xb2/0xe0 [mlx5_core]\n  devlink_reload+0x133/0x250\n  devlink_nl_cmd_reload+0x480/0x570\n  ? devlink_nl_pre_doit+0x44/0x2b0\n  genl_family_rcv_msg_doit.isra.0+0xc2/0x110\n  genl_rcv_msg+0x180/0x2b0\n  ? devlink_nl_cmd_region_read_dumpit+0x540/0x540\n  ? devlink_reload+0x250/0x250\n  ? devlink_put+0x50/0x50\n  ? genl_family_rcv_msg_doit.isra.0+0x110/0x110\n  netlink_rcv_skb+0x54/0x100\n  genl_rcv+0x24/0x40\n  netlink_unicast+0x1f6/0x2c0\n  netlink_sendmsg+0x237/0x490\n  sock_sendmsg+0x33/0x40\n  __sys_sendto+0x103/0x160\n  ? handle_mm_fault+0x10e/0x290\n  ? do_user_addr_fault+0x1c0/0x5f0\n  __x64_sys_sendto+0x25/0x30\n  do_syscall_64+0x3d/0x90\n  entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nFix it by setting port_num to 1 in order to get device status and remove\nunused variable.", "datePublished": "2025-09-18T15:30:34", "dateUpdated": "2025-12-12T21:31:31", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53393", "https://git.kernel.org/stable/c/38b50aa44495d5eb4218f0b82fc2da76505cec53", "https://git.kernel.org/stable/c/8d89870d63758363b07ace5c2df82d6bf865f78b", "https://git.kernel.org/stable/c/9a97da4674b890b4c28f5f12beba8c33a9cd2f49", "https://git.kernel.org/stable/c/e597b003c736217b0c99ccf1b240c25009105238"], "aliases": ["CVE-2023-53393", "GHSA-2633-6xpw-2gqx"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1f86c15a-cdf5-3d28-a4ac-4a9287935daa", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "248f6155-f455-3aa8-a16a-dd04278c7424", "product": {"name": "Linux"}, "product_version": "aac4492ef23a176b6f1a41aadb99177eceb1fc06 <38b50aa44495d5eb4218f0b82fc2da76505cec53"}, {"id": "28b14fdd-5c43-3928-9560-0faefac1dd2a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "4884617a-2868-3704-bfc1-6efafc13ea87", "product": {"name": "Linux"}, "product_version": "patch: 5.15.87"}, {"id": "4c1eacda-93ef-3fb8-9400-dc5088c2c679", "product": {"name": "Linux"}, "product_version": "4.16"}, {"id": "4f005628-ba5d-31ce-9ccf-92d1420c65ef", "product": {"name": "Linux"}, "product_version": "aac4492ef23a176b6f1a41aadb99177eceb1fc06 <8d89870d63758363b07ace5c2df82d6bf865f78b"}, {"id": "5fb4c84d-aff5-3b74-a108-88050ca17ec4", "product": {"name": "Linux"}, "product_version": "patch: 6.1.5"}, {"id": "b3775d3a-766b-3557-9377-291cbb3b871e", "product": {"name": "Linux"}, "product_version": "aac4492ef23a176b6f1a41aadb99177eceb1fc06 <9a97da4674b890b4c28f5f12beba8c33a9cd2f49"}, {"id": "bde9fd74-c4e8-3082-b23b-12db30fdda29", "product": {"name": "Linux"}, "product_version": "aac4492ef23a176b6f1a41aadb99177eceb1fc06 <e597b003c736217b0c99ccf1b240c25009105238"}, {"id": "fb263f05-8547-3b54-a6ca-47cef0091c07", "product": {"name": "Linux"}, "product_version": "patch: 6.0.19"}], "enisaIdVendor": [{"id": "40091fe7-ee04-3758-bf57-d15b1724e3f0", "vendor": {"name": "Linux"}}], "isExploited": false}