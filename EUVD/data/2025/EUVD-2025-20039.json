{"id": "EUVD-2025-20039", "enisaUuid": "dd614385-ca96-3967-9bc6-acb6f0c32ee6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhwmon: (ftsteutates) Fix TOCTOU race in fts_read()\n\nIn the fts_read() function, when handling hwmon_pwm_auto_channels_temp,\nthe code accesses the shared variable data->fan_source[channel] twice\nwithout holding any locks. It is first checked against\nFTS_FAN_SOURCE_INVALID, and if the check passes, it is read again\nwhen used as an argument to the BIT() macro.\n\nThis creates a Time-of-Check to Time-of-Use (TOCTOU) race condition.\nAnother thread executing fts_update_device() can modify the value of\ndata->fan_source[channel] between the check and its use. If the value\nis changed to FTS_FAN_SOURCE_INVALID (0xff) during this window, the\nBIT() macro will be called with a large shift value (BIT(255)).\nA bit shift by a value greater than or equal to the type width is\nundefined behavior and can lead to a crash or incorrect values being\nreturned to userspace.\n\nFix this by reading data->fan_source[channel] into a local variable\nonce, eliminating the race condition. Additionally, add a bounds check\nto ensure the value is less than BITS_PER_LONG before passing it to\nthe BIT() macro, making the code more robust against undefined behavior.\n\nThis possible bug was found by an experimental static analysis tool\ndeveloped by our team.", "datePublished": "2025-07-04T15:31:09", "dateUpdated": "2025-11-18T15:30:40", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d95d87841d2a575bed3691884e8fedef57d7710d", "https://git.kernel.org/stable/c/83e2ba8971ccd8fc08319fc7593288f070d80a76", "https://git.kernel.org/stable/c/4d646f627d3b7ed1cacca66e598af8bcd632d465", "https://git.kernel.org/stable/c/14c9ede9ca4cd078ad76a6ab9617b81074eb58bf", "https://nvd.nist.gov/vuln/detail/CVE-2025-38217"], "aliases": ["CVE-2025-38217"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "02548393-4255-3214-96a3-d0cb31a0b893", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "04ef1224-944b-3d0b-b9f0-be9a8c748acc", "product": {"name": "Linux"}, "product_version": "patch: 6.15.4"}, {"id": "0a9097ad-471d-3b9c-9f32-f888d4ad50c1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1b4d8dd5-5968-36a2-ab1d-e8cc22b282f2", "product": {"name": "Linux"}, "product_version": "1c5759d8ce054961b454af69568a41e7e3210ee1 <d95d87841d2a575bed3691884e8fedef57d7710d"}, {"id": "1cf53670-6051-3081-a408-29e15fc6002c", "product": {"name": "Linux"}, "product_version": "6.3"}, {"id": "3c6809cf-f75a-3daa-a399-e4855fdbe6e0", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc3"}, {"id": "4bff8e16-c2fe-3370-b853-5333ce6f6ffb", "product": {"name": "Linux"}, "product_version": "1c5759d8ce054961b454af69568a41e7e3210ee1 <83e2ba8971ccd8fc08319fc7593288f070d80a76"}, {"id": "4d817ea0-5a63-3a70-a5e1-85fed421ce59", "product": {"name": "Linux"}, "product_version": "1c5759d8ce054961b454af69568a41e7e3210ee1 <4d646f627d3b7ed1cacca66e598af8bcd632d465"}, {"id": "c836a660-60f6-32c0-98ce-03dd2032749f", "product": {"name": "Linux"}, "product_version": "patch: 6.6.95"}, {"id": "e43121b2-460c-3b43-964d-de2820707141", "product": {"name": "Linux"}, "product_version": "patch: 6.12.35"}, {"id": "f40bd259-9f60-36e2-8b64-3a990e178b9c", "product": {"name": "Linux"}, "product_version": "1c5759d8ce054961b454af69568a41e7e3210ee1 <14c9ede9ca4cd078ad76a6ab9617b81074eb58bf"}], "enisaIdVendor": [{"id": "752b463d-d829-3393-a477-930717078a6b", "vendor": {"name": "Linux"}}], "isExploited": false}