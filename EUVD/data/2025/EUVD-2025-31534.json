{"id": "EUVD-2025-31534", "enisaUuid": "6c9be8ab-e8b2-36ce-9ced-dc0afe9603d1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/buffer: fix use-after-free when call bh_read() helper\n\nThere's issue as follows:\nBUG: KASAN: stack-out-of-bounds in end_buffer_read_sync+0xe3/0x110\nRead of size 8 at addr ffffc9000168f7f8 by task swapper/3/0\nCPU: 3 UID: 0 PID: 0 Comm: swapper/3 Not tainted 6.16.0-862.14.0.6.x86_64\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996)\nCall Trace:\n <IRQ>\n dump_stack_lvl+0x55/0x70\n print_address_description.constprop.0+0x2c/0x390\n print_report+0xb4/0x270\n kasan_report+0xb8/0xf0\n end_buffer_read_sync+0xe3/0x110\n end_bio_bh_io_sync+0x56/0x80\n blk_update_request+0x30a/0x720\n scsi_end_request+0x51/0x2b0\n scsi_io_completion+0xe3/0x480\n ? scsi_device_unbusy+0x11e/0x160\n blk_complete_reqs+0x7b/0x90\n handle_softirqs+0xef/0x370\n irq_exit_rcu+0xa5/0xd0\n sysvec_apic_timer_interrupt+0x6e/0x90\n </IRQ>\n\n Above issue happens when do ntfs3 filesystem mount, issue may happens\n as follows:\n           mount                            IRQ\nntfs_fill_super\n  read_cache_page\n    do_read_cache_folio\n      filemap_read_folio\n        mpage_read_folio\n\t do_mpage_readpage\n\t  ntfs_get_block_vbo\n\t   bh_read\n\t     submit_bh\n\t     wait_on_buffer(bh);\n\t                            blk_complete_reqs\n\t\t\t\t     scsi_io_completion\n\t\t\t\t      scsi_end_request\n\t\t\t\t       blk_update_request\n\t\t\t\t        end_bio_bh_io_sync\n\t\t\t\t\t end_buffer_read_sync\n\t\t\t\t\t  __end_buffer_read_notouch\n\t\t\t\t\t   unlock_buffer\n\n            wait_on_buffer(bh);--> return will return to caller\n\n\t\t\t\t\t  put_bh\n\t\t\t\t\t    --> trigger stack-out-of-bounds\nIn the mpage_read_folio() function, the stack variable 'map_bh' is\npassed to ntfs_get_block_vbo(). Once unlock_buffer() unlocks and\nwait_on_buffer() returns to continue processing, the stack variable\nis likely to be reclaimed. Consequently, during the end_buffer_read_sync()\nprocess, calling put_bh() may result in stack overrun.\n\nIf the bh is not allocated on the stack, it belongs to a folio.  Freeing\na buffer head which belongs to a folio is done by drop_buffers() which\nwill fail to free buffers which are still locked.  So it is safe to call\nput_bh() before __end_buffer_read_notouch().", "datePublished": "2025-09-05T18:31:26", "dateUpdated": "2025-11-03T18:31:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/70a09115da586bf662c3bae9c0c4a1b99251fad9", "https://git.kernel.org/stable/c/3169edb8945c295cf89120fc6b2c35cfe3ad4c9e", "https://git.kernel.org/stable/c/03b40bf5d0389ca23ae6857ee25789f0e0b47ce8", "https://git.kernel.org/stable/c/c58c6b532b7b69537cfd9ef701c7e37cdcf79dc4", "https://git.kernel.org/stable/c/c5aa6ba1127307ab5dc3773eaf40d73a3423841f", "https://git.kernel.org/stable/c/042cf48ecf67f72c8b3846c7fac678f472712ff3", "https://git.kernel.org/stable/c/90b5193edb323fefbee0e4e5bc39ed89dcc37719", "https://git.kernel.org/stable/c/7375f22495e7cd1c5b3b5af9dcc4f6dffe34ce49", "https://nvd.nist.gov/vuln/detail/CVE-2025-39691", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-39691"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "06f990c6-cca0-337e-8b19-8f3b061c6b2b", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "1784b67e-9900-34bb-ae79-88e15c6c60aa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <03b40bf5d0389ca23ae6857ee25789f0e0b47ce8"}, {"id": "1a2d208b-6ea1-3b1b-ab46-bf47db4e32c7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "1c03dd65-3e8a-37a9-9f40-0e3ed636eaa6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c5aa6ba1127307ab5dc3773eaf40d73a3423841f"}, {"id": "1da07674-cfe4-3a14-9005-ae626a7ec9b9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c58c6b532b7b69537cfd9ef701c7e37cdcf79dc4"}, {"id": "1f409201-db12-3aea-b3ba-1169355bca78", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <70a09115da586bf662c3bae9c0c4a1b99251fad9"}, {"id": "1faaa51d-3f35-37ae-a214-c89694b6a800", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}, {"id": "212f38c5-48b6-3cf9-9273-771e48e3c6b9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2c1ef176-3114-32a1-b8e2-c77343049f6a", "product": {"name": "Linux"}, "product_version": "patch: 6.1.149"}, {"id": "69647852-06ce-359b-ad35-df20c226e9a2", "product": {"name": "Linux"}, "product_version": "patch: 6.6.103"}, {"id": "910f8e72-d7b7-34ab-988f-f292271e141b", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "95f87906-7062-3510-93e5-414f7f7a4bd7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3169edb8945c295cf89120fc6b2c35cfe3ad4c9e"}, {"id": "a1d6127e-ccce-3d43-b022-24b578b9e3a0", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7375f22495e7cd1c5b3b5af9dcc4f6dffe34ce49"}, {"id": "a7669e18-9cc5-3d34-a58f-2512e7c1df81", "product": {"name": "Linux"}, "product_version": "patch: 6.16.4"}, {"id": "adeb6468-d286-3b02-af70-c3e6c6f2cc9e", "product": {"name": "Linux"}, "product_version": "2.6.12"}, {"id": "bf653acd-fc7e-3956-a099-476445127f4e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <90b5193edb323fefbee0e4e5bc39ed89dcc37719"}, {"id": "d3e7561b-a995-3bc8-922a-95f7db4bd3a1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <042cf48ecf67f72c8b3846c7fac678f472712ff3"}, {"id": "d56595fa-4307-3083-a6ad-cc3408135d10", "product": {"name": "Linux"}, "product_version": "patch: 6.12.44"}], "enisaIdVendor": [{"id": "a2b75e92-d3b2-3ac6-abe8-36159bf3047b", "vendor": {"name": "Linux"}}], "isExploited": false}