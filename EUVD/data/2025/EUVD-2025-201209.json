{"id": "EUVD-2025-201209", "enisaUuid": "c94de7a4-6ca7-31d2-b45f-8e19423a61f1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvsock: Ignore signal/timeout on connect() if already established\n\nDuring connect(), acting on a signal/timeout by disconnecting an already\nestablished socket leads to several issues:\n\n1. connect() invoking vsock_transport_cancel_pkt() ->\n   virtio_transport_purge_skbs() may race with sendmsg() invoking\n   virtio_transport_get_credit(). This results in a permanently elevated\n   `vvs->bytes_unsent`. Which, in turn, confuses the SOCK_LINGER handling.\n\n2. connect() resetting a connected socket's state may race with socket\n   being placed in a sockmap. A disconnected socket remaining in a sockmap\n   breaks sockmap's assumptions. And gives rise to WARNs.\n\n3. connect() transitioning SS_CONNECTED -> SS_UNCONNECTED allows for a\n   transport change/drop after TCP_ESTABLISHED. Which poses a problem for\n   any simultaneous sendmsg() or connect() and may result in a\n   use-after-free/null-ptr-deref.\n\nDo not disconnect socket on signal/timeout. Keep the logic for unconnected\nsockets: they don't linger, can't be placed in a sockmap, are rejected by\nsendmsg().\n\n[1]: https://lore.kernel.org/netdev/e07fd95c-9a38-4eea-9638-133e38c2ec9b@rbox.co/\n[2]: https://lore.kernel.org/netdev/20250317-vsock-trans-signal-race-v4-0-fc8837f3f1d4@rbox.co/\n[3]: https://lore.kernel.org/netdev/60f1b7db-3099-4f6a-875e-af9f6ef194f6@rbox.co/", "datePublished": "2025-12-04T18:30:53", "dateUpdated": "2025-12-07T00:30:56", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3f71753935d648082a8279a97d30efe6b85be680", "https://git.kernel.org/stable/c/5998da5a8208ae9ad7838ba322bccb2bdcd95e81", "https://git.kernel.org/stable/c/f1c170cae285e4b8f61be043bb17addc3d0a14b5", "https://git.kernel.org/stable/c/ab6b19f690d89ae4709fba73a3c4a7911f495b7a", "https://git.kernel.org/stable/c/002541ef650b742a198e4be363881439bb9d86b4", "https://nvd.nist.gov/vuln/detail/CVE-2025-40248", "https://git.kernel.org/stable/c/da664101fb4a0de5cb70d2bae6a650df954df2af", "https://git.kernel.org/stable/c/67432915145848658149683101104e32f9fd6559", "https://git.kernel.org/stable/c/eeca93f06df89be5a36305b7b9dae1ed65550dfc"], "aliases": ["CVE-2025-40248"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "098363cb-3f93-36ad-8656-f9a3caf7f182", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "224b64ca-8b4f-3fab-a8d9-ae7bd5932685", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <5998da5a8208ae9ad7838ba322bccb2bdcd95e81"}, {"id": "2b0a343a-0265-3e96-92fe-ae8f3f8f58fa", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <ab6b19f690d89ae4709fba73a3c4a7911f495b7a"}, {"id": "3eb6eb6a-9efc-38ed-b88f-1c489609ec10", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "45f79388-f37b-35fd-85fb-d64dfa742110", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <eeca93f06df89be5a36305b7b9dae1ed65550dfc"}, {"id": "5d436153-95c7-3790-8938-1ef4d1d5e212", "product": {"name": "Linux"}, "product_version": "patch: 6.12.60"}, {"id": "8ddf2c48-ccca-318a-9318-04bc23e4724f", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "95a8d933-826c-3c29-a103-4d9a25bd69ea", "product": {"name": "Linux"}, "product_version": "3.9"}, {"id": "996aa3f3-9af9-378a-881a-679840730b62", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <3f71753935d648082a8279a97d30efe6b85be680"}, {"id": "a1eff3c7-2ef1-33e6-9749-1afa94457a9d", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <67432915145848658149683101104e32f9fd6559"}, {"id": "a3824667-aa29-349b-aaa1-a801c4590511", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "a6a53d0f-4904-3492-b95f-9d3dbcc3b600", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <f1c170cae285e4b8f61be043bb17addc3d0a14b5"}, {"id": "a876103e-a862-3d4c-bc9d-dbaf1bf5dedb", "product": {"name": "Linux"}, "product_version": "patch: 6.6.118"}, {"id": "b5551b1f-d67c-354b-bdb7-74534a02fe9c", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <da664101fb4a0de5cb70d2bae6a650df954df2af"}, {"id": "b84bafa9-6f07-3daf-8fbc-902e0e7e3c6c", "product": {"name": "Linux"}, "product_version": "patch: 5.4.302"}, {"id": "c976efde-5cbb-3d61-a0d8-101a8037a77d", "product": {"name": "Linux"}, "product_version": "d021c344051af91f42c5ba9fdedc176740cbd238 <002541ef650b742a198e4be363881439bb9d86b4"}, {"id": "cc59ef53-36f1-3106-a64f-5366b8297899", "product": {"name": "Linux"}, "product_version": "patch: 6.17.10"}, {"id": "dcdaf81d-22e7-371d-9935-a018748ecc39", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}], "enisaIdVendor": [{"id": "c4a319aa-b224-3ffb-9202-b7b4a200b0f1", "vendor": {"name": "Linux"}}], "isExploited": false}