{"id": "EUVD-2025-201583", "enisaUuid": "bf0ed13a-aaff-34b7-bac7-3611001f0ac1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/secretmem: fix use-after-free race in fault handler\n\nWhen a page fault occurs in a secret memory file created with\n`memfd_secret(2)`, the kernel will allocate a new folio for it, mark the\nunderlying page as not-present in the direct map, and add it to the file\nmapping.\n\nIf two tasks cause a fault in the same page concurrently, both could end\nup allocating a folio and removing the page from the direct map, but only\none would succeed in adding the folio to the file mapping.  The task that\nfailed undoes the effects of its attempt by (a) freeing the folio again\nand (b) putting the page back into the direct map.  However, by doing\nthese two operations in this order, the page becomes available to the\nallocator again before it is placed back in the direct mapping.\n\nIf another task attempts to allocate the page between (a) and (b), and the\nkernel tries to access it via the direct map, it would result in a\nsupervisor not-present page fault.\n\nFix the ordering to restore the direct map before the folio is freed.", "datePublished": "2025-12-07T00:30:56", "dateUpdated": "2025-12-07T00:30:56", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/bb1c19636aedae39360e6fdbcaef4f2bcff25785", "https://git.kernel.org/stable/c/1e4643d6628edf9c0047b1f8f5bc574665025acb", "https://git.kernel.org/stable/c/42d486d35a4143cc37fc72ee66edc99d942dd367", "https://git.kernel.org/stable/c/52f2d5cf33de9a8f5e72bbb0ed38282ae0bc4649", "https://git.kernel.org/stable/c/4444767e625da46009fc94a453fd1967b80ba047", "https://git.kernel.org/stable/c/6f86d0534fddfbd08687fa0f01479d4226bc3c3d", "https://nvd.nist.gov/vuln/detail/CVE-2025-40272"], "aliases": ["CVE-2025-40272"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "200dbc27-c748-3cd8-bcbf-8631a8bfdc56", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <1e4643d6628edf9c0047b1f8f5bc574665025acb"}, {"id": "21ff3856-aea0-379b-bd12-133852c3e351", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <6f86d0534fddfbd08687fa0f01479d4226bc3c3d"}, {"id": "2c8652f1-11a4-366a-a77a-fb70400af7aa", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "4f2dcbcc-d5f9-3d29-98f2-f5b15d440e3b", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <42d486d35a4143cc37fc72ee66edc99d942dd367"}, {"id": "50e05341-bccb-3def-95fe-9bda65f2a2cd", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "5a35edb0-42b9-399f-ab16-120ab1e51861", "product": {"name": "Linux"}, "product_version": "patch: 6.17.9"}, {"id": "6927915e-7088-3233-9cd1-03566d428494", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <52f2d5cf33de9a8f5e72bbb0ed38282ae0bc4649"}, {"id": "6d04dbb7-8149-351c-8715-5911d49f4ad2", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "72a37a82-fdd3-34d3-9759-bc9ee21fcb7b", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <4444767e625da46009fc94a453fd1967b80ba047"}, {"id": "798663ef-8587-3323-a1a4-f6bc1d15f1e7", "product": {"name": "Linux"}, "product_version": "5.14"}, {"id": "869802e6-7ef0-362e-9fe2-89d2061bf20a", "product": {"name": "Linux"}, "product_version": "1507f51255c9ff07d75909a84e7c0d7f3c4b2f49 <bb1c19636aedae39360e6fdbcaef4f2bcff25785"}, {"id": "e213adba-16e3-356b-b753-96a9f043d7d1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ea1db39c-9cd6-3242-b38c-b3d14b3e6233", "product": {"name": "Linux"}, "product_version": "patch: 6.12.59"}, {"id": "f8cf3b6b-ba5d-3da6-ad4b-74a1852059e1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}], "enisaIdVendor": [{"id": "dd855a97-e3c3-383c-a674-db5755cdc830", "vendor": {"name": "Linux"}}], "isExploited": false}