{"id": "EUVD-2025-124916", "enisaUuid": "ea13248e-8cc9-30c2-81d9-afa0101a23d9", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: detect invalid INLINE_DATA + EXTENTS flag combination\n\nsyzbot reported a BUG_ON in ext4_es_cache_extent() when opening a verity\nfile on a corrupted ext4 filesystem mounted without a journal.\n\nThe issue is that the filesystem has an inode with both the INLINE_DATA\nand EXTENTS flags set:\n\n    EXT4-fs error (device loop0): ext4_cache_extents:545: inode #15:\n    comm syz.0.17: corrupted extent tree: lblk 0 < prev 66\n\nInvestigation revealed that the inode has both flags set:\n    DEBUG: inode 15 - flag=1, i_inline_off=164, has_inline=1, extents_flag=1\n\nThis is an invalid combination since an inode should have either:\n- INLINE_DATA: data stored directly in the inode\n- EXTENTS: data stored in extent-mapped blocks\n\nHaving both flags causes ext4_has_inline_data() to return true, skipping\nextent tree validation in __ext4_iget(). The unvalidated out-of-order\nextents then trigger a BUG_ON in ext4_es_cache_extent() due to integer\nunderflow when calculating hole sizes.\n\nFix this by detecting this invalid flag combination early in ext4_iget()\nand rejecting the corrupted inode.", "datePublished": "2025-11-12T10:26:24", "dateUpdated": "2025-12-01T06:19:20", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/4954d297c91d292630ab43ba4d195dc371ce65d3", "https://git.kernel.org/stable/c/f061f7c331fc16250fc82aa68964f35821687217", "https://git.kernel.org/stable/c/2e9e10657b04152ed0d6ecae8d0c02a3405e28f5", "https://git.kernel.org/stable/c/1437c95ab2a28b138d4521653583729f61ccb48b", "https://git.kernel.org/stable/c/cb6039b68efa547b676a8a10fc4618d9d1865c23", "https://git.kernel.org/stable/c/de985264eef64be8a90595908f2e6a87946dad34", "https://git.kernel.org/stable/c/1f5ccd22ff482639133f2a0fe08f6d19d0e68717", "https://git.kernel.org/stable/c/1d3ad183943b38eec2acf72a0ae98e635dc8456b", "https://nvd.nist.gov/vuln/detail/CVE-2025-40167"], "aliases": ["CVE-2025-40167"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "012675d6-52e5-3f76-8e26-b0c893b92786", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <de985264eef64be8a90595908f2e6a87946dad34"}, {"id": "032ac2e0-0875-391f-b94e-18652f9bac0f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2e9e10657b04152ed0d6ecae8d0c02a3405e28f5"}, {"id": "06a632a2-7814-363f-81ca-a2784d9f9c03", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc2"}, {"id": "082a3913-254a-3571-b861-81a6dfc8e0a8", "product": {"name": "Linux"}, "product_version": "patch: 6.1.158"}, {"id": "0ae08a21-2d9c-3446-9412-bbd58b89ee3c", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "19c8a42a-d799-3eef-97c0-43532faddd50", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4954d297c91d292630ab43ba4d195dc371ce65d3"}, {"id": "511309b3-c501-36af-996a-0fad55f3dbcf", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f061f7c331fc16250fc82aa68964f35821687217"}, {"id": "5c5a8dad-0f91-3f8f-b59f-59bb31cc2318", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1437c95ab2a28b138d4521653583729f61ccb48b"}, {"id": "5ea60710-d1e6-3037-a344-6baaa7ff1604", "product": {"name": "Linux"}, "product_version": "patch: 6.17.5"}, {"id": "713f6580-6a73-3936-a85e-f061dcb08f83", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "7a875900-df7b-343b-a4a8-6a2d3ff429a7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1d3ad183943b38eec2acf72a0ae98e635dc8456b"}, {"id": "98454727-f9fb-380f-89d4-e7c50cad85e5", "product": {"name": "Linux"}, "product_version": "patch: 5.15.196"}, {"id": "9ddeb31b-3844-37d9-a816-59db890955cd", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1f5ccd22ff482639133f2a0fe08f6d19d0e68717"}, {"id": "a1a8ae0a-9fbf-33f5-94bb-9e292ef7b287", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cb6039b68efa547b676a8a10fc4618d9d1865c23"}, {"id": "afea61f3-1539-37bf-b066-4e3b66e66d3f", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "ed0fe13a-0503-3d3c-a864-67fbbf85abce", "product": {"name": "Linux"}, "product_version": "patch: 6.6.114"}, {"id": "fe1d0e4c-c53c-3aec-b19d-1302bf986014", "product": {"name": "Linux"}, "product_version": "patch: 6.12.55"}], "enisaIdVendor": [{"id": "4eb65c80-e88c-3efd-8010-f2cef879e1f0", "vendor": {"name": "Linux"}}], "isExploited": false}