{"id": "EUVD-2025-201625", "enisaUuid": "be93c724-4d2b-379e-8c8f-c6975b42460c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: fix potential cfid UAF in smb2_query_info_compound\n\nWhen smb2_query_info_compound() retries, a previously allocated cfid may\nhave been freed in the first attempt.\nBecause cfid wasn't reset on replay, later cleanup could act on a stale\npointer, leading to a potential use-after-free.\n\nReinitialize cfid to NULL under the replay label.\n\nExample trace (trimmed):\n\nrefcount_t: underflow; use-after-free.\nWARNING: CPU: 1 PID: 11224 at ../lib/refcount.c:28 refcount_warn_saturate+0x9c/0x110\n[...]\nRIP: 0010:refcount_warn_saturate+0x9c/0x110\n[...]\nCall Trace:\n <TASK>\n smb2_query_info_compound+0x29c/0x5c0 [cifs f90b72658819bd21c94769b6a652029a07a7172f]\n ? step_into+0x10d/0x690\n ? __legitimize_path+0x28/0x60\n smb2_queryfs+0x6a/0xf0 [cifs f90b72658819bd21c94769b6a652029a07a7172f]\n smb311_queryfs+0x12d/0x140 [cifs f90b72658819bd21c94769b6a652029a07a7172f]\n ? kmem_cache_alloc+0x18a/0x340\n ? getname_flags+0x46/0x1e0\n cifs_statfs+0x9f/0x2b0 [cifs f90b72658819bd21c94769b6a652029a07a7172f]\n statfs_by_dentry+0x67/0x90\n vfs_statfs+0x16/0xd0\n user_statfs+0x54/0xa0\n __do_sys_statfs+0x20/0x50\n do_syscall_64+0x58/0x80", "datePublished": "2025-12-08T03:31:01", "dateUpdated": "2025-12-08T03:31:01", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/939c4e33005e2a56ea8fcedddf0da92df864bd3b", "https://git.kernel.org/stable/c/327f89c21601ebb7889f8c97754b76f08ce95a0c", "https://git.kernel.org/stable/c/b556c278d43f4707a9073ca74d55581b4f279806", "https://git.kernel.org/stable/c/5c76f9961c170552c1d07c830b5e145475151600", "https://nvd.nist.gov/vuln/detail/CVE-2025-40320"], "aliases": ["CVE-2025-40320"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0c29af5d-769e-31fc-bb5d-37cbba55b7e2", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "2c1e2681-bb17-32b1-9af9-f300a19148bf", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "68ed1797-4d43-3cdc-abae-d5bd15d8ca51", "product": {"name": "Linux"}, "product_version": "patch: 6.12.58"}, {"id": "6d74d2bc-8f7f-3509-9302-02d67699eb1e", "product": {"name": "Linux"}, "product_version": "4f1fffa2376922f3d1d506e49c0fd445b023a28e <b556c278d43f4707a9073ca74d55581b4f279806"}, {"id": "77656458-cd1f-37c5-9ebb-4aa1643d223e", "product": {"name": "Linux"}, "product_version": "433042a91f9373241307725b52de573933ffedbf <939c4e33005e2a56ea8fcedddf0da92df864bd3b"}, {"id": "a98a3195-a924-32cc-99ac-839e47130a41", "product": {"name": "Linux"}, "product_version": "4f1fffa2376922f3d1d506e49c0fd445b023a28e <5c76f9961c170552c1d07c830b5e145475151600"}, {"id": "c34becd7-43e8-3196-b7ae-018a235c7eed", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d24326ec-cb15-39f3-adb7-a6fdc441e5f1", "product": {"name": "Linux"}, "product_version": "4f1fffa2376922f3d1d506e49c0fd445b023a28e <327f89c21601ebb7889f8c97754b76f08ce95a0c"}, {"id": "f04534fb-dfb3-30d1-9163-49a07d9dd533", "product": {"name": "Linux"}, "product_version": "patch: 6.17.8"}, {"id": "ff01aade-fdb0-3496-a4d2-b8e9d9f8d0ea", "product": {"name": "Linux"}, "product_version": "6.8"}], "enisaIdVendor": [{"id": "20487296-bc06-325d-a889-84fc315ba562", "vendor": {"name": "Linux"}}], "isExploited": false}