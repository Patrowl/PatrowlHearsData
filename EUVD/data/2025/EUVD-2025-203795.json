{"id": "EUVD-2025-203795", "enisaUuid": "d2c40761-3761-3126-bf16-c45b5ec69f09", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nlibceph: fix potential use-after-free in have_mon_and_osd_map()\n\nThe wait loop in __ceph_open_session() can race with the client\nreceiving a new monmap or osdmap shortly after the initial map is\nreceived.  Both ceph_monc_handle_map() and handle_one_map() install\na new map immediately after freeing the old one\n\n    kfree(monc->monmap);\n    monc->monmap = monmap;\n\n    ceph_osdmap_destroy(osdc->osdmap);\n    osdc->osdmap = newmap;\n\nunder client->monc.mutex and client->osdc.lock respectively, but\nbecause neither is taken in have_mon_and_osd_map() it's possible for\nclient->monc.monmap->epoch and client->osdc.osdmap->epoch arms in\n\n    client->monc.monmap && client->monc.monmap->epoch &&\n        client->osdc.osdmap && client->osdc.osdmap->epoch;\n\ncondition to dereference an already freed map.  This happens to be\nreproducible with generic/395 and generic/397 with KASAN enabled:\n\n    BUG: KASAN: slab-use-after-free in have_mon_and_osd_map+0x56/0x70\n    Read of size 4 at addr ffff88811012d810 by task mount.ceph/13305\n    CPU: 2 UID: 0 PID: 13305 Comm: mount.ceph Not tainted 6.14.0-rc2-build2+ #1266\n    ...\n    Call Trace:\n    <TASK>\n    have_mon_and_osd_map+0x56/0x70\n    ceph_open_session+0x182/0x290\n    ceph_get_tree+0x333/0x680\n    vfs_get_tree+0x49/0x180\n    do_new_mount+0x1a3/0x2d0\n    path_mount+0x6dd/0x730\n    do_mount+0x99/0xe0\n    __do_sys_mount+0x141/0x180\n    do_syscall_64+0x9f/0x100\n    entry_SYSCALL_64_after_hwframe+0x76/0x7e\n    </TASK>\n\n    Allocated by task 13305:\n    ceph_osdmap_alloc+0x16/0x130\n    ceph_osdc_init+0x27a/0x4c0\n    ceph_create_client+0x153/0x190\n    create_fs_client+0x50/0x2a0\n    ceph_get_tree+0xff/0x680\n    vfs_get_tree+0x49/0x180\n    do_new_mount+0x1a3/0x2d0\n    path_mount+0x6dd/0x730\n    do_mount+0x99/0xe0\n    __do_sys_mount+0x141/0x180\n    do_syscall_64+0x9f/0x100\n    entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\n    Freed by task 9475:\n    kfree+0x212/0x290\n    handle_one_map+0x23c/0x3b0\n    ceph_osdc_handle_map+0x3c9/0x590\n    mon_dispatch+0x655/0x6f0\n    ceph_con_process_message+0xc3/0xe0\n    ceph_con_v1_try_read+0x614/0x760\n    ceph_con_workfn+0x2de/0x650\n    process_one_work+0x486/0x7c0\n    process_scheduled_works+0x73/0x90\n    worker_thread+0x1c8/0x2a0\n    kthread+0x2ec/0x300\n    ret_from_fork+0x24/0x40\n    ret_from_fork_asm+0x1a/0x30\n\nRewrite the wait loop to check the above condition directly with\nclient->monc.mutex and client->osdc.lock taken as appropriate.  While\nat it, improve the timeout handling (previously mount_timeout could be\nexceeded in case wait_event_interruptible_timeout() slept more than\nonce) and access client->auth_err under client->monc.mutex to match\nhow it's set in finish_auth().\n\nmonmap_show() and osdmap_show() now take the respective lock before\naccessing the map as well.", "datePublished": "2025-12-16T18:31:33", "dateUpdated": "2025-12-16T18:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/bb4910c5fd436701faf367e1b5476a5a6d2aff1c", "https://git.kernel.org/stable/c/05ec43e9a9de67132dc8cd3b22afef001574947f", "https://git.kernel.org/stable/c/7c8ccdc1714d9fabecd26e1be7db1771061acc6e", "https://git.kernel.org/stable/c/183ad6e3b651e8fb0b66d6a2678f4b80bfbba092", "https://git.kernel.org/stable/c/e08021b3b56b2407f37b5fe47b654be80cc665fb", "https://git.kernel.org/stable/c/3fc43120b22a3d4f1fbeff56a35ce2105b6a5683", "https://git.kernel.org/stable/c/076381c261374c587700b3accf410bdd2dba334e", "https://nvd.nist.gov/vuln/detail/CVE-2025-68285"], "aliases": ["CVE-2025-68285"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0d493f0e-8487-3c1b-8db3-f21ad12aa97b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "1e09ab06-11e9-3da3-9d08-4c9f13efac35", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3fc43120b22a3d4f1fbeff56a35ce2105b6a5683"}, {"id": "2e8ceb2f-7974-38d1-a1ff-d172dfa1d1e8", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "41e244b1-7e52-3e25-8c94-9562e2f9cb32", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <183ad6e3b651e8fb0b66d6a2678f4b80bfbba092"}, {"id": "6813927b-e729-3b37-b02c-e069da0bf3de", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7c8ccdc1714d9fabecd26e1be7db1771061acc6e"}, {"id": "6d722cf0-bb15-3293-9a05-0a0247477785", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e08021b3b56b2407f37b5fe47b654be80cc665fb"}, {"id": "6f27ac17-533c-3cd6-b1d2-ada470b831ac", "product": {"name": "Linux"}, "product_version": "patch: 6.17.11"}, {"id": "856018cb-4f6d-37b8-8d50-c4820e177568", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "91b9e69c-26a4-353c-bb26-d66d2cbd23ec", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bb4910c5fd436701faf367e1b5476a5a6d2aff1c"}, {"id": "a98d3f03-d69b-3dfd-ac44-6c38cc44d3d5", "product": {"name": "Linux"}, "product_version": "patch: 6.6.119"}, {"id": "c1557550-d849-3088-8872-a223a4b4280b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <05ec43e9a9de67132dc8cd3b22afef001574947f"}, {"id": "c5867a00-add3-3f39-9e55-746886889a9d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <076381c261374c587700b3accf410bdd2dba334e"}, {"id": "e155bebf-c342-35eb-a24a-2c3698d50151", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "ff50f4b8-b57b-3ce4-ae64-1489f8e18e2a", "product": {"name": "Linux"}, "product_version": "patch: 6.12.61"}], "enisaIdVendor": [{"id": "3fc54120-3d4b-3fdb-8b56-23921dccf346", "vendor": {"name": "Linux"}}], "isExploited": false}