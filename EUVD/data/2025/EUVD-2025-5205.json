{"id": "EUVD-2025-5205", "enisaUuid": "5f3ba1c0-894e-365f-9389-006dc9fe1cc9", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntpm: Change to kvalloc() in eventlog/acpi.c\n\nThe following failure was reported on HPE ProLiant D320:\n\n[   10.693310][    T1] tpm_tis STM0925:00: 2.0 TPM (device-id 0x3, rev-id 0)\n[   10.848132][    T1] ------------[ cut here ]------------\n[   10.853559][    T1] WARNING: CPU: 59 PID: 1 at mm/page_alloc.c:4727 __alloc_pages_noprof+0x2ca/0x330\n[   10.862827][    T1] Modules linked in:\n[   10.866671][    T1] CPU: 59 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.12.0-lp155.2.g52785e2-default #1 openSUSE Tumbleweed (unreleased) 588cd98293a7c9eba9013378d807364c088c9375\n[   10.882741][    T1] Hardware name: HPE ProLiant DL320 Gen12/ProLiant DL320 Gen12, BIOS 1.20 10/28/2024\n[   10.892170][    T1] RIP: 0010:__alloc_pages_noprof+0x2ca/0x330\n[   10.898103][    T1] Code: 24 08 e9 4a fe ff ff e8 34 36 fa ff e9 88 fe ff ff 83 fe 0a 0f 86 b3 fd ff ff 80 3d 01 e7 ce 01 00 75 09 c6 05 f8 e6 ce 01 01 <0f> 0b 45 31 ff e9 e5 fe ff ff f7 c2 00 00 08 00 75 42 89 d9 80 e1\n[   10.917750][    T1] RSP: 0000:ffffb7cf40077980 EFLAGS: 00010246\n[   10.923777][    T1] RAX: 0000000000000000 RBX: 0000000000040cc0 RCX: 0000000000000000\n[   10.931727][    T1] RDX: 0000000000000000 RSI: 000000000000000c RDI: 0000000000040cc0\n\nThe above transcript shows that ACPI pointed a 16 MiB buffer for the log\nevents because RSI maps to the 'order' parameter of __alloc_pages_noprof().\nAddress the bug by moving from devm_kmalloc() to devm_add_action() and\nkvmalloc() and devm_add_action().", "datePublished": "2025-02-27T02:12:02", "dateUpdated": "2025-11-03T19:33:18", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2024-58005", "https://git.kernel.org/stable/c/422d7f4e8d817be467986589c7968d3ea402f7da", "https://git.kernel.org/stable/c/4c8bfe643bbd00b04ee8f9545ef33bf6a68c38db", "https://git.kernel.org/stable/c/50365a6304a57266e8f4d3078060743c3b7a1e0d", "https://git.kernel.org/stable/c/a3a860bc0fd6c07332e4911cf9a238d20de90173", "https://git.kernel.org/stable/c/0621d2599d6e02d05c85d6bbd58eaea2f15b3503", "https://git.kernel.org/stable/c/77779d1258a287f2c5c2c6aeae203e0996209c77", "https://git.kernel.org/stable/c/a676c0401de59548a5bc1b7aaf98f556ae8ea6db", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"], "aliases": ["CVE-2024-58005", "GHSA-j992-gmv8-p6vw"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "05f28ed8-2fb3-3a6c-8d54-613434187f8a", "product": {"name": "Linux"}, "product_version": "2.6.16"}, {"id": "24b8ed03-1486-3bf3-8780-0fe569d83cec", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <4c8bfe643bbd00b04ee8f9545ef33bf6a68c38db"}, {"id": "2d848aee-e4ef-39fb-9444-bcb1a68094d6", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <a676c0401de59548a5bc1b7aaf98f556ae8ea6db"}, {"id": "55ed8751-79dd-33a0-8b60-4675f80a84ed", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <422d7f4e8d817be467986589c7968d3ea402f7da"}, {"id": "5d517a8a-19bc-3d7a-bc8a-d4e5a728bc57", "product": {"name": "Linux"}, "product_version": "patch: 6.13.3"}, {"id": "75b7d1e7-3b8b-3517-94fc-fd05e648c734", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7656cf7b-ac68-3802-af8f-2c0fac90daec", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <a3a860bc0fd6c07332e4911cf9a238d20de90173"}, {"id": "84da44dc-ec7b-3193-823c-7c278bd22177", "product": {"name": "Linux"}, "product_version": "patch: 5.10.235"}, {"id": "9357e1cd-f0e4-387d-9e40-5b3573efda7f", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <0621d2599d6e02d05c85d6bbd58eaea2f15b3503"}, {"id": "a8883f87-d1dc-3961-a0f2-cfcf15bbffef", "product": {"name": "Linux"}, "product_version": "patch: 6.1.130"}, {"id": "b11800c2-a4a0-341d-8963-4b5eac90a0a9", "product": {"name": "Linux"}, "product_version": "patch: 5.15.179"}, {"id": "c2c56353-9da7-32d2-990a-24a4f9e9373e", "product": {"name": "Linux"}, "product_version": "patch: 6.12.14"}, {"id": "dfcd478f-b17b-323e-928c-c80fa14dc96d", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <50365a6304a57266e8f4d3078060743c3b7a1e0d"}, {"id": "e06cc026-7c14-3273-b706-5ed465f4ae01", "product": {"name": "Linux"}, "product_version": "patch: 6.6.78"}, {"id": "e2ba8bdd-86ba-37c7-a4be-21f1cbf7fc47", "product": {"name": "Linux"}, "product_version": "patch: 6.14"}, {"id": "f7837897-a39b-399f-8cce-88c689e1a729", "product": {"name": "Linux"}, "product_version": "55a82ab3181be039c6440d3f2f69260ad6fe2988 <77779d1258a287f2c5c2c6aeae203e0996209c77"}], "enisaIdVendor": [{"id": "5ad279f5-186a-3c63-abd4-ac74f09c90e2", "vendor": {"name": "Linux"}}], "isExploited": false}