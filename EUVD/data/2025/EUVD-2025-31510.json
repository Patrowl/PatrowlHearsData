{"id": "EUVD-2025-31510", "enisaUuid": "125fc3ea-6417-3c50-a8fc-438829ed843c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nopen_tree_attr: do not allow id-mapping changes without OPEN_TREE_CLONE\n\nAs described in commit 7a54947e727b ('Merge patch series \"fs: allow\nchanging idmappings\"'), open_tree_attr(2) was necessary in order to\nallow for a detached mount to be created and have its idmappings changed\nwithout the risk of any racing threads operating on it. For this reason,\nmount_setattr(2) still does not allow for id-mappings to be changed.\n\nHowever, there was a bug in commit 2462651ffa76 (\"fs: allow changing\nidmappings\") which allowed users to bypass this restriction by calling\nopen_tree_attr(2) *without* OPEN_TREE_CLONE.\n\ncan_idmap_mount() prevented this bug from allowing an attached\nmountpoint's id-mapping from being modified (thanks to an is_anon_ns()\ncheck), but this still allows for detached (but visible) mounts to have\ntheir be id-mapping changed. This risks the same UAF and locking issues\nas described in the merge commit, and was likely unintentional.", "datePublished": "2025-09-05T18:31:27", "dateUpdated": "2025-11-25T18:32:19", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/69dbdc711d9130136824e3830191a6afffa0a1f0", "https://git.kernel.org/stable/c/9308366f062129d52e0ee3f7a019f7dd41db33df", "https://nvd.nist.gov/vuln/detail/CVE-2025-39717"], "aliases": ["CVE-2025-39717"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "19b3d13f-4f4d-3145-a9ab-a1b99554ccd3", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "2c238642-a813-30a8-a1d1-19fa508dfd65", "product": {"name": "Linux"}, "product_version": "6.15"}, {"id": "57fbb556-5473-3c6d-8afe-5a25de9223af", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "76633265-a382-3483-b826-b5193fd5cfdb", "product": {"name": "Linux"}, "product_version": "2462651ffa76b87f9c2e4403ef6e6b89b703fb2f <69dbdc711d9130136824e3830191a6afffa0a1f0"}, {"id": "9453592c-ac50-3c7f-81f3-62ec9f6cf8b4", "product": {"name": "Linux"}, "product_version": "2462651ffa76b87f9c2e4403ef6e6b89b703fb2f <9308366f062129d52e0ee3f7a019f7dd41db33df"}, {"id": "dba5f282-022a-3a8a-a2ac-a835ccac521b", "product": {"name": "Linux"}, "product_version": "patch: 6.16.4"}], "enisaIdVendor": [{"id": "e08d4188-a908-35e0-a0e4-46d35ffe111a", "vendor": {"name": "Linux"}}], "isExploited": false}