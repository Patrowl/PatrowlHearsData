{"id": "EUVD-2025-26114", "enisaUuid": "90f6d534-8a21-3ce0-986b-b83e7b50adef", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: fix use-after-free in cifs_oplock_break\n\nA race condition can occur in cifs_oplock_break() leading to a\nuse-after-free of the cinode structure when unmounting:\n\n  cifs_oplock_break()\n    _cifsFileInfo_put(cfile)\n      cifsFileInfo_put_final()\n        cifs_sb_deactive()\n          [last ref, start releasing sb]\n            kill_sb()\n              kill_anon_super()\n                generic_shutdown_super()\n                  evict_inodes()\n                    dispose_list()\n                      evict()\n                        destroy_inode()\n                          call_rcu(&inode->i_rcu, i_callback)\n    spin_lock(&cinode->open_file_lock)  <- OK\n                            [later] i_callback()\n                              cifs_free_inode()\n                                kmem_cache_free(cinode)\n    spin_unlock(&cinode->open_file_lock)  <- UAF\n    cifs_done_oplock_break(cinode)       <- UAF\n\nThe issue occurs when umount has already released its reference to the\nsuperblock. When _cifsFileInfo_put() calls cifs_sb_deactive(), this\nreleases the last reference, triggering the immediate cleanup of all\ninodes under RCU. However, cifs_oplock_break() continues to access the\ncinode after this point, resulting in use-after-free.\n\nFix this by holding an extra reference to the superblock during the\nentire oplock break operation. This ensures that the superblock and\nits inodes remain valid until the oplock break completes.", "datePublished": "2025-08-16T12:30:32", "dateUpdated": "2025-11-03T18:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/4256a483fe58af66a46cbf3dc48ff26e580d3308", "https://git.kernel.org/stable/c/0a4eec84d4d2c4085d4ed8630fd74e4b39033c1b", "https://git.kernel.org/stable/c/2baaf5bbab2ac474c4f92c10fcb3310f824db995", "https://git.kernel.org/stable/c/09bce2138a30ef10d8821c8c3f73a4ab7a5726bc", "https://git.kernel.org/stable/c/da11bd4b697b393a207f19a2ed7d382a811a3ddc", "https://git.kernel.org/stable/c/705c79101ccf9edea5a00d761491a03ced314210", "https://nvd.nist.gov/vuln/detail/CVE-2025-38527", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38527"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "0dde32fc-94d5-37e1-95c5-300bf60f2d48", "product": {"name": "Linux"}, "product_version": "1ee4f2d7cdcd4508cc3cbe3b2622d7177b89da12"}, {"id": "10beec07-df9b-3d47-8835-01fd7ae6d96c", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <da11bd4b697b393a207f19a2ed7d382a811a3ddc"}, {"id": "1f67b06e-d686-301b-8121-7966db542d19", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <09bce2138a30ef10d8821c8c3f73a4ab7a5726bc"}, {"id": "26c7ec51-ecd2-3089-ad58-3d961dbd2b33", "product": {"name": "Linux"}, "product_version": "patch: 6.12.40"}, {"id": "2fcf6e82-097f-3435-b676-3f4112d25bd6", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <0a4eec84d4d2c4085d4ed8630fd74e4b39033c1b"}, {"id": "3f550482-e212-3edc-badc-9fcadaee26aa", "product": {"name": "Linux"}, "product_version": "8092ecc306d81186a64cda42411121f4d35aaff4"}, {"id": "62781d9f-3469-3d28-8de1-dbc6d53a689e", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <4256a483fe58af66a46cbf3dc48ff26e580d3308"}, {"id": "65301946-e9a2-38ca-a67a-25737e56583d", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "741eeae6-687f-3e1e-aaee-d57e4e96eeba", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "76c87fe0-7b61-3bcb-912b-4b1c4826d07f", "product": {"name": "Linux"}, "product_version": "patch: 6.15.8"}, {"id": "8cb3902c-0916-3766-bc18-2b428dd0980c", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "b2b4c383-4f75-344f-b5cb-3fafccefbf94", "product": {"name": "Linux"}, "product_version": "5.1"}, {"id": "bf27fa58-0625-3a90-9296-e230edb5a808", "product": {"name": "Linux"}, "product_version": "patch: 6.1.147"}, {"id": "c7300104-74e1-36a1-9a05-3c93fe187c2e", "product": {"name": "Linux"}, "product_version": "53fc31a4853e30d6e8f142b824f724da27ff3e40"}, {"id": "ced9b0fb-f427-39d9-8ce3-5d4fbdd75183", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <2baaf5bbab2ac474c4f92c10fcb3310f824db995"}, {"id": "d096a6ab-f670-331e-a8f7-5626d4dbc3c8", "product": {"name": "Linux"}, "product_version": "ebac4d0adf68f8962bd82fcf483936edd6ec095b"}, {"id": "f3e7c317-44ef-31e8-9d23-914448f19cfd", "product": {"name": "Linux"}, "product_version": "patch: 6.6.100"}, {"id": "fdff9946-f500-33b0-a6dd-e222d708b691", "product": {"name": "Linux"}, "product_version": "2429fcf06d3cb962693868ab0a927c9038f12a2d"}, {"id": "ff72a206-9ede-3304-a116-2b02b2a20615", "product": {"name": "Linux"}, "product_version": "b98749cac4a695f084a5ff076f4510b23e353ecd <705c79101ccf9edea5a00d761491a03ced314210"}], "enisaIdVendor": [{"id": "0c443e47-03ec-39d1-8e07-15eaf1b373c1", "vendor": {"name": "Linux"}}], "isExploited": false}