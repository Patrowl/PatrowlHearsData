{"id": "EUVD-2025-34593", "enisaUuid": "77b0bf7b-eaaa-3832-93b4-e7fbcbe75917", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: fs, fix UAF in flow counter release\n\nFix a kernel trace [1] caused by releasing an HWS action of a local flow\ncounter in mlx5_cmd_hws_delete_fte(), where the HWS action refcount and\nmutex were not initialized and the counter struct could already be freed\nwhen deleting the rule.\n\nFix it by adding the missing initializations and adding refcount for the\nlocal flow counter struct.\n\n[1] Kernel log:\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0x34/0x48\n  mlx5_fs_put_hws_action.part.0.cold+0x21/0x94 [mlx5_core]\n  mlx5_fc_put_hws_action+0x96/0xad [mlx5_core]\n  mlx5_fs_destroy_fs_actions+0x8b/0x152 [mlx5_core]\n  mlx5_cmd_hws_delete_fte+0x5a/0xa0 [mlx5_core]\n  del_hw_fte+0x1ce/0x260 [mlx5_core]\n  mlx5_del_flow_rules+0x12d/0x240 [mlx5_core]\n  ? ttwu_queue_wakelist+0xf4/0x110\n  mlx5_ib_destroy_flow+0x103/0x1b0 [mlx5_ib]\n  uverbs_free_flow+0x20/0x50 [ib_uverbs]\n  destroy_hw_idr_uobject+0x1b/0x50 [ib_uverbs]\n  uverbs_destroy_uobject+0x34/0x1a0 [ib_uverbs]\n  uobj_destroy+0x3c/0x80 [ib_uverbs]\n  ib_uverbs_run_method+0x23e/0x360 [ib_uverbs]\n  ? uverbs_finalize_object+0x60/0x60 [ib_uverbs]\n  ib_uverbs_cmd_verbs+0x14f/0x2c0 [ib_uverbs]\n  ? do_tty_write+0x1a9/0x270\n  ? file_tty_write.constprop.0+0x98/0xc0\n  ? new_sync_write+0xfc/0x190\n  ib_uverbs_ioctl+0xd7/0x160 [ib_uverbs]\n  __x64_sys_ioctl+0x87/0xc0\n  do_syscall_64+0x59/0x90", "datePublished": "2025-10-15T09:30:17", "dateUpdated": "2025-10-15T09:30:17", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3c77f6d244188c3fb11f6aec40bbfe884f1803b5", "https://git.kernel.org/stable/c/6043819e707cefb1c9e59d6e431dcfa735c4f975", "https://nvd.nist.gov/vuln/detail/CVE-2025-39979"], "aliases": ["CVE-2025-39979"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "2b2d250a-eca3-34e8-bf8f-895814d48bfd", "product": {"name": "Linux"}, "product_version": "b581f4266928d3b5d1bbe711e39623d9a1696091 <6043819e707cefb1c9e59d6e431dcfa735c4f975"}, {"id": "3513b49c-917d-3395-8b51-be5ca992b21a", "product": {"name": "Linux"}, "product_version": "b581f4266928d3b5d1bbe711e39623d9a1696091 <3c77f6d244188c3fb11f6aec40bbfe884f1803b5"}, {"id": "45e8e755-5e51-3ea9-be5e-68181710e8cd", "product": {"name": "Linux"}, "product_version": "6.14"}, {"id": "869f10b7-e292-39d1-8de6-25eb26e3c439", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "8cf7099b-aa64-3fdf-98f3-5359733d79b0", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c0ffbc5b-606a-39e8-98be-f821af536284", "product": {"name": "Linux"}, "product_version": "patch: 6.16.10"}], "enisaIdVendor": [{"id": "4733da84-b652-3bb9-9f21-a8760b5911d2", "vendor": {"name": "Linux"}}], "isExploited": false}