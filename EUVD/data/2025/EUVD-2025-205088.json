{"id": "EUVD-2025-205088", "enisaUuid": "7cf13510-b3a0-3c0b-b7a1-2ba87586c1e0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnbd: defer config unlock in nbd_genl_connect\n\nThere is one use-after-free warning when running NBD_CMD_CONNECT and\nNBD_CLEAR_SOCK:\n\nnbd_genl_connect\n  nbd_alloc_and_init_config // config_refs=1\n  nbd_start_device // config_refs=2\n  set NBD_RT_HAS_CONFIG_REF\t\t\topen nbd // config_refs=3\n  recv_work done // config_refs=2\n\t\t\t\t\t\tNBD_CLEAR_SOCK // config_refs=1\n\t\t\t\t\t\tclose nbd // config_refs=0\n  refcount_inc -> uaf\n\n------------[ cut here ]------------\nrefcount_t: addition on 0; use-after-free.\nWARNING: CPU: 24 PID: 1014 at lib/refcount.c:25 refcount_warn_saturate+0x12e/0x290\n nbd_genl_connect+0x16d0/0x1ab0\n genl_family_rcv_msg_doit+0x1f3/0x310\n genl_rcv_msg+0x44a/0x790\n\nThe issue can be easily reproduced by adding a small delay before\nrefcount_inc(&nbd->config_refs) in nbd_genl_connect():\n\n        mutex_unlock(&nbd->config_lock);\n        if (!ret) {\n                set_bit(NBD_RT_HAS_CONFIG_REF, &config->runtime_flags);\n+               printk(\"before sleep\\n\");\n+               mdelay(5 * 1000);\n+               printk(\"after sleep\\n\");\n                refcount_inc(&nbd->config_refs);\n                nbd_connect_reply(info, nbd->index);\n        }", "datePublished": "2025-12-24T12:30:29", "dateUpdated": "2025-12-24T12:30:29", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c9b99c948b4fb014812afe7b5ccf2db121d22e46", "https://git.kernel.org/stable/c/9a38306643874566d20f7aba7dff9e6f657b51a9", "https://git.kernel.org/stable/c/c9e805f6a35d1dd189a9345595a5c20e87611942", "https://git.kernel.org/stable/c/1649714b930f9ea6233ce0810ba885999da3b5d4", "https://nvd.nist.gov/vuln/detail/CVE-2025-68366"], "aliases": ["CVE-2025-68366"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "113832de-5d59-3685-976c-c201b1b313a0", "product": {"name": "Linux"}, "product_version": "patch: 6.18.2"}, {"id": "1e6806ac-099a-382f-9a0a-38cb782228c0", "product": {"name": "Linux"}, "product_version": "e46c7287b1c27683a8e30ca825fb98e2b97f1099 <1649714b930f9ea6233ce0810ba885999da3b5d4"}, {"id": "24a044d5-9dcc-3e5c-96f9-9cb2ea4b4d70", "product": {"name": "Linux"}, "product_version": "patch: 6.12.63"}, {"id": "251ef635-ca64-39a3-8d42-bd02617e4333", "product": {"name": "Linux"}, "product_version": "patch: 6.17.13"}, {"id": "4f508784-bf06-3392-87ec-9fbdc8d660f5", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5c85bf71-1116-3cf3-a976-54b97353a62b", "product": {"name": "Linux"}, "product_version": "e46c7287b1c27683a8e30ca825fb98e2b97f1099 <9a38306643874566d20f7aba7dff9e6f657b51a9"}, {"id": "8f469d74-0881-3c79-9b16-c10b54690cbe", "product": {"name": "Linux"}, "product_version": "e46c7287b1c27683a8e30ca825fb98e2b97f1099 <c9b99c948b4fb014812afe7b5ccf2db121d22e46"}, {"id": "95cf1aae-d97b-31f3-bb85-257730411057", "product": {"name": "Linux"}, "product_version": "e46c7287b1c27683a8e30ca825fb98e2b97f1099 <c9e805f6a35d1dd189a9345595a5c20e87611942"}, {"id": "9f4b4931-7cb7-30fb-b0d1-4d8c8c38d87e", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc1"}, {"id": "f507e8fc-73bd-3d66-b5b2-8a7d8be23acb", "product": {"name": "Linux"}, "product_version": "4.12"}], "enisaIdVendor": [{"id": "7477892c-d06e-3221-a214-8cf3aca99169", "vendor": {"name": "Linux"}}], "isExploited": false}