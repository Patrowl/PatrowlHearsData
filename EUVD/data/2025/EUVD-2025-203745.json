{"id": "EUVD-2025-203745", "enisaUuid": "ad31f5df-3fab-328f-a511-023487c2221b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: ipc: fix use-after-free in ipc_msg_send_request\n\nipc_msg_send_request() waits for a generic netlink reply using an\nipc_msg_table_entry on the stack. The generic netlink handler\n(handle_generic_event()/handle_response()) fills entry->response under\nipc_msg_table_lock, but ipc_msg_send_request() used to validate and free\nentry->response without holding the same lock.\n\nUnder high concurrency this allows a race where handle_response() is\ncopying data into entry->response while ipc_msg_send_request() has just\nfreed it, leading to a slab-use-after-free reported by KASAN in\nhandle_generic_event():\n\n  BUG: KASAN: slab-use-after-free in handle_generic_event+0x3c4/0x5f0 [ksmbd]\n  Write of size 12 at addr ffff888198ee6e20 by task pool/109349\n  ...\n  Freed by task:\n    kvfree\n    ipc_msg_send_request [ksmbd]\n    ksmbd_rpc_open -> ksmbd_session_rpc_open [ksmbd]\n\nFix by:\n- Taking ipc_msg_table_lock in ipc_msg_send_request() while validating\n  entry->response, freeing it when invalid, and removing the entry from\n  ipc_msg_table.\n- Returning the final entry->response pointer to the caller only after\n  the hash entry is removed under the lock.\n- Returning NULL in the error path, preserving the original API\n  semantics.\n\nThis makes all accesses to entry->response consistent with\nhandle_response(), which already updates and fills the response buffer\nunder ipc_msg_table_lock, and closes the race that allowed the UAF.", "datePublished": "2025-12-16T14:45:05", "dateUpdated": "2025-12-20T08:52:18", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68263", "https://git.kernel.org/stable/c/1fab1fa091f5aa97265648b53ea031deedd26235", "https://git.kernel.org/stable/c/5ac763713a1ef8f9a8bda1dbd81f0318d67baa4e", "https://git.kernel.org/stable/c/759c8c30cfa8706c518e56f67971b1f0932f4b9b", "https://git.kernel.org/stable/c/8229c6ca50cea701e25a7ee25f48441b582ec5fa"], "aliases": ["CVE-2025-68263", "GHSA-j5fg-gwpm-pjw5"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "01013974-8dee-3575-b48d-4f2772bccbb3", "product": {"name": "Linux"}, "product_version": "patch: 6.18.1"}, {"id": "0eb9d0b1-5d1f-3dc1-b39a-20b1c02d60a2", "product": {"name": "Linux"}, "product_version": "patch: 6.12.62"}, {"id": "18caac9d-2f01-3e2e-98c4-5c6dbf2e2a11", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1fab1fa091f5aa97265648b53ea031deedd26235"}, {"id": "2412e282-ff81-396f-accc-c842e50bf14f", "product": {"name": "Linux"}, "product_version": "0626e6641f6b467447c81dd7678a69c66f7746cf <1fab1fa091f5aa97265648b53ea031deedd26235"}, {"id": "2a2f160e-2e37-3a77-bc54-20613653a932", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "4fb4a706-a12a-3ea2-9ed2-eb72d6d3d9ba", "product": {"name": "Linux"}, "product_version": "0626e6641f6b467447c81dd7678a69c66f7746cf <8229c6ca50cea701e25a7ee25f48441b582ec5fa"}, {"id": "6816a39f-182f-331a-a084-93e9d2775c08", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8229c6ca50cea701e25a7ee25f48441b582ec5fa"}, {"id": "6926c40b-694d-3c9d-882d-9cafa021f19b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5ac763713a1ef8f9a8bda1dbd81f0318d67baa4e"}, {"id": "696e6b91-f3c6-3b4d-8709-1ec3af850b5e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <759c8c30cfa8706c518e56f67971b1f0932f4b9b"}, {"id": "9b702bd6-d3f8-3713-9984-0299c65a0bb6", "product": {"name": "Linux"}, "product_version": "patch: 6.17.12"}, {"id": "b4eb14d8-7c97-3091-bd29-f959a258b8b4", "product": {"name": "Linux"}, "product_version": "0626e6641f6b467447c81dd7678a69c66f7746cf <759c8c30cfa8706c518e56f67971b1f0932f4b9b"}, {"id": "ba3dea06-2728-3f9b-be88-ad0ccc6b86ab", "product": {"name": "Linux"}, "product_version": "0626e6641f6b467447c81dd7678a69c66f7746cf <5ac763713a1ef8f9a8bda1dbd81f0318d67baa4e"}, {"id": "e8a85607-8294-30ad-922e-0eaaa0f65243", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f034b11d-9533-3128-bcc7-05b3c8220133", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc1"}], "enisaIdVendor": [{"id": "8ec05b93-b506-3a64-87c3-db403d3bcd83", "vendor": {"name": "Linux"}}], "isExploited": false}