{"id": "EUVD-2025-5238", "enisaUuid": "8294b461-695a-37ea-9d9a-a0255536831e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nkernel: be more careful about dup_mmap() failures and uprobe registering\n\nIf a memory allocation fails during dup_mmap(), the maple tree can be left\nin an unsafe state for other iterators besides the exit path.  All the\nlocks are dropped before the exit_mmap() call (in mm/mmap.c), but the\nincomplete mm_struct can be reached through (at least) the rmap finding\nthe vmas which have a pointer back to the mm_struct.\n\nUp to this point, there have been no issues with being able to find an\nmm_struct that was only partially initialised.  Syzbot was able to make\nthe incomplete mm_struct fail with recent forking changes, so it has been\nproven unsafe to use the mm_struct that hasn't been initialised, as\nreferenced in the link below.\n\nAlthough 8ac662f5da19f (\"fork: avoid inappropriate uprobe access to\ninvalid mm\") fixed the uprobe access, it does not completely remove the\nrace.\n\nThis patch sets the MMF_OOM_SKIP to avoid the iteration of the vmas on the\noom side (even though this is extremely unlikely to be selected as an oom\nvictim in the race window), and sets MMF_UNSTABLE to avoid other potential\nusers from using a partially initialised mm_struct.\n\nWhen registering vmas for uprobe, skip the vmas in an mm that is marked\nunstable.  Modifying a vma in an unstable mm may cause issues if the mm\nisn't fully initialised.", "datePublished": "2025-02-27T03:34:01", "dateUpdated": "2025-10-23T18:31:07", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-21709", "https://git.kernel.org/stable/c/64c37e134b120fb462fb4a80694bfb8e7be77b14", "https://git.kernel.org/stable/c/da139948aeda677ac09cc0e7d837f8a314de7d55"], "aliases": ["CVE-2025-21709", "GHSA-vh2p-4gfm-v9v7"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "2253a9b2-f810-30e2-84d6-13fced49859e", "product": {"name": "Linux"}, "product_version": "d2406291483775ecddaee929231a39c70c08fda2 <da139948aeda677ac09cc0e7d837f8a314de7d55"}, {"id": "3578243c-9014-3ed7-8606-0a229fa98531", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "49d7d5f8-59f4-3c2a-aaf7-9fee8e97efeb", "product": {"name": "Linux"}, "product_version": "patch: 6.14"}, {"id": "93d89765-3b92-3764-b63f-84e867130fdf", "product": {"name": "Linux"}, "product_version": "d2406291483775ecddaee929231a39c70c08fda2 <64c37e134b120fb462fb4a80694bfb8e7be77b14"}, {"id": "c128c175-3003-3d40-af98-6a2361d8b117", "product": {"name": "Linux"}, "product_version": "6.8"}, {"id": "d1636d0d-da15-3cd2-8f78-242f6021e76b", "product": {"name": "Linux"}, "product_version": "patch: 6.13.2"}], "enisaIdVendor": [{"id": "3fe4c2f9-e208-3232-82e3-693a10b24df4", "vendor": {"name": "Linux"}}], "isExploited": false}