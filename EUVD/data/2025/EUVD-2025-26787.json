{"id": "EUVD-2025-26787", "enisaUuid": "3bfdbbb4-0d59-3e66-8ab6-0409b1a1e2dc", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ni2c: core: Fix double-free of fwnode in i2c_unregister_device()\n\nBefore commit df6d7277e552 (\"i2c: core: Do not dereference fwnode in struct\ndevice\"), i2c_unregister_device() only called fwnode_handle_put() on\nof_node-s in the form of calling of_node_put(client->dev.of_node).\n\nBut after this commit the i2c_client's fwnode now unconditionally gets\nfwnode_handle_put() on it.\n\nWhen the i2c_client has no primary (ACPI / OF) fwnode but it does have\na software fwnode, the software-node will be the primary node and\nfwnode_handle_put() will put() it.\n\nBut for the software fwnode device_remove_software_node() will also put()\nit leading to a double free:\n\n[   82.665598] ------------[ cut here ]------------\n[   82.665609] refcount_t: underflow; use-after-free.\n[   82.665808] WARNING: CPU: 3 PID: 1502 at lib/refcount.c:28 refcount_warn_saturate+0xba/0x11\n...\n[   82.666830] RIP: 0010:refcount_warn_saturate+0xba/0x110\n...\n[   82.666962]  <TASK>\n[   82.666971]  i2c_unregister_device+0x60/0x90\n\nFix this by not calling fwnode_handle_put() when the primary fwnode is\na software-node.", "datePublished": "2025-09-05T18:31:15", "dateUpdated": "2025-11-26T00:30:16", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/ffe02f7c4e36090154646612e67d331832f92037", "https://git.kernel.org/stable/c/1c24e5fc0c7096e00c202a6a3e0c342c1afb47c2", "https://nvd.nist.gov/vuln/detail/CVE-2025-38682"], "aliases": ["CVE-2025-38682"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2933715b-a6c4-3950-8fc1-e105623ce3b2", "product": {"name": "Linux"}, "product_version": "6.16"}, {"id": "4e568762-9df2-3493-a777-55f2833ab0f8", "product": {"name": "Linux"}, "product_version": "patch: 6.16.2"}, {"id": "5fff3201-c036-344f-afc5-82c421157c6f", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "7e99e66e-07f6-3175-a802-23189da1388a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "993e91c8-356f-3532-b5cc-7b806c7209ee", "product": {"name": "Linux"}, "product_version": "df6d7277e5525d6cce63127dd93ebec4c6354fa0 <ffe02f7c4e36090154646612e67d331832f92037"}, {"id": "b967153a-0270-359c-af2c-d401d1b5abb7", "product": {"name": "Linux"}, "product_version": "df6d7277e5525d6cce63127dd93ebec4c6354fa0 <1c24e5fc0c7096e00c202a6a3e0c342c1afb47c2"}, {"id": "ef407ba2-0c26-31e8-a07c-eba7f5421fc7", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}], "enisaIdVendor": [{"id": "b31d168b-b76f-3a1e-9be8-fb1343b4e825", "vendor": {"name": "Linux"}}], "isExploited": false}