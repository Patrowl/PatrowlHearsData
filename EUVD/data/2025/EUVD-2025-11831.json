{"id": "EUVD-2025-11831", "enisaUuid": "5cdae1d3-8b7b-3050-9665-c76c9ac620d7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix OOB read when checking dotdot dir\n\nMounting a corrupted filesystem with directory which contains '.' dir\nentry with rec_len == block size results in out-of-bounds read (later\non, when the corrupted directory is removed).\n\next4_empty_dir() assumes every ext4 directory contains at least '.'\nand '..' as directory entries in the first data block. It first loads\nthe '.' dir entry, performs sanity checks by calling ext4_check_dir_entry()\nand then uses its rec_len member to compute the location of '..' dir\nentry (in ext4_next_entry). It assumes the '..' dir entry fits into the\nsame data block.\n\nIf the rec_len of '.' is precisely one block (4KB), it slips through the\nsanity checks (it is considered the last directory entry in the data\nblock) and leaves \"struct ext4_dir_entry_2 *de\" point exactly past the\nmemory slot allocated to the data block. The following call to\next4_check_dir_entry() on new value of de then dereferences this pointer\nwhich results in out-of-bounds mem access.\n\nFix this by extending __ext4_check_dir_entry() to check for '.' dir\nentries that reach the end of data block. Make sure to ignore the phony\ndir entries for checksum (by checking name_len for non-zero).\n\nNote: This is reported by KASAN as use-after-free in case another\nstructure was recently freed from the slot past the bound, but it is\nreally an OOB read.\n\nThis issue was found by syzkaller tool.\n\nCall Trace:\n[   38.594108] BUG: KASAN: slab-use-after-free in __ext4_check_dir_entry+0x67e/0x710\n[   38.594649] Read of size 2 at addr ffff88802b41a004 by task syz-executor/5375\n[   38.595158]\n[   38.595288] CPU: 0 UID: 0 PID: 5375 Comm: syz-executor Not tainted 6.14.0-rc7 #1\n[   38.595298] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014\n[   38.595304] Call Trace:\n[   38.595308]  <TASK>\n[   38.595311]  dump_stack_lvl+0xa7/0xd0\n[   38.595325]  print_address_description.constprop.0+0x2c/0x3f0\n[   38.595339]  ? __ext4_check_dir_entry+0x67e/0x710\n[   38.595349]  print_report+0xaa/0x250\n[   38.595359]  ? __ext4_check_dir_entry+0x67e/0x710\n[   38.595368]  ? kasan_addr_to_slab+0x9/0x90\n[   38.595378]  kasan_report+0xab/0xe0\n[   38.595389]  ? __ext4_check_dir_entry+0x67e/0x710\n[   38.595400]  __ext4_check_dir_entry+0x67e/0x710\n[   38.595410]  ext4_empty_dir+0x465/0x990\n[   38.595421]  ? __pfx_ext4_empty_dir+0x10/0x10\n[   38.595432]  ext4_rmdir.part.0+0x29a/0xd10\n[   38.595441]  ? __dquot_initialize+0x2a7/0xbf0\n[   38.595455]  ? __pfx_ext4_rmdir.part.0+0x10/0x10\n[   38.595464]  ? __pfx___dquot_initialize+0x10/0x10\n[   38.595478]  ? down_write+0xdb/0x140\n[   38.595487]  ? __pfx_down_write+0x10/0x10\n[   38.595497]  ext4_rmdir+0xee/0x140\n[   38.595506]  vfs_rmdir+0x209/0x670\n[   38.595517]  ? lookup_one_qstr_excl+0x3b/0x190\n[   38.595529]  do_rmdir+0x363/0x3c0\n[   38.595537]  ? __pfx_do_rmdir+0x10/0x10\n[   38.595544]  ? strncpy_from_user+0x1ff/0x2e0\n[   38.595561]  __x64_sys_unlinkat+0xf0/0x130\n[   38.595570]  do_syscall_64+0x5b/0x180\n[   38.595583]  entry_SYSCALL_64_after_hwframe+0x76/0x7e", "datePublished": "2025-04-18T07:01:27", "dateUpdated": "2025-11-03T19:55:07", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e47f472a664d70a3d104a6c2a035cdff55a719b4", "https://git.kernel.org/stable/c/b7531a4f99c3887439d778afaf418d1a01a5f01b", "https://git.kernel.org/stable/c/89503e5eae64637d0fa2218912b54660effe7d93", "https://git.kernel.org/stable/c/52a5509ab19a5d3afe301165d9b5787bba34d842", "https://git.kernel.org/stable/c/b47584c556444cf7acb66b26a62cbc348eb92b78", "https://git.kernel.org/stable/c/ac28c5684c1cdab650a7e5065b19e91577d37a4b", "https://git.kernel.org/stable/c/53bc45da8d8da92ec07877f5922b130562eb4b00", "https://git.kernel.org/stable/c/d5e206778e96e8667d3bde695ad372c296dc9353", "https://nvd.nist.gov/vuln/detail/CVE-2025-37785", "https://git.kernel.org/stable/c/14da7dbecb430e35b5889da8dae7bef33173b351", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"], "aliases": ["CVE-2025-37785"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "09db6b60-0f9c-340e-a629-9a728e3b5adf", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <b47584c556444cf7acb66b26a62cbc348eb92b78"}, {"id": "112bf102-c58e-3a00-9b06-aae9a68ed984", "product": {"name": "Linux"}, "product_version": "2.6.19"}, {"id": "13ecd8b0-b2bf-39ba-9e46-ed0784db405a", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <ac28c5684c1cdab650a7e5065b19e91577d37a4b"}, {"id": "204d0b2f-4a01-3ce2-aa67-13e99929b5ce", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <14da7dbecb430e35b5889da8dae7bef33173b351"}, {"id": "2434c7da-b130-3cbc-a31b-83ff9dce9bb5", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <e47f472a664d70a3d104a6c2a035cdff55a719b4"}, {"id": "623c8581-49fc-34df-baec-f166c9497f5a", "product": {"name": "Linux"}, "product_version": "patch: 6.1.134"}, {"id": "647b1423-1455-307a-bec6-a7a8abd3ad06", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <d5e206778e96e8667d3bde695ad372c296dc9353"}, {"id": "6d930ead-f98f-3130-a572-679ecfabf3f2", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}, {"id": "8722fcec-fbf0-3450-872b-7007d2244d6e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.180"}, {"id": "8a95db55-67ef-310a-8f71-3d1694a4ee96", "product": {"name": "Linux"}, "product_version": "patch: 6.12.23"}, {"id": "977b65a4-8a45-3427-bb5d-707c9f04ca3d", "product": {"name": "Linux"}, "product_version": "patch: 5.4.293"}, {"id": "9c9d7b69-8816-3f82-bd80-0b9a96d432df", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "9d798db2-747f-35e2-9329-66d4556beb8d", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <52a5509ab19a5d3afe301165d9b5787bba34d842"}, {"id": "a1fb48e1-58ec-3e3a-89d3-9b11666353ed", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <b7531a4f99c3887439d778afaf418d1a01a5f01b"}, {"id": "b1f02be6-1486-3247-97a3-06dc1499bbb0", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "b553f066-c9a8-35ef-8563-caec9536481f", "product": {"name": "Linux"}, "product_version": "patch: 5.10.236"}, {"id": "e154d2d0-2ae4-37f4-9996-de4a20ec4cb5", "product": {"name": "Linux"}, "product_version": "patch: 6.6.87"}, {"id": "e33f4551-dbf6-3e65-af04-3d42e9dd3bc5", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <53bc45da8d8da92ec07877f5922b130562eb4b00"}, {"id": "e6fe1162-220d-38c1-9f3d-aa18381cc373", "product": {"name": "Linux"}, "product_version": "ac27a0ec112a089f1a5102bc8dffc79c8c815571 <89503e5eae64637d0fa2218912b54660effe7d93"}, {"id": "ef96d094-5fe2-379f-afd5-10b682d17c9e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f4e6abe7-3cc2-3a4d-a036-16e3ee7519e4", "product": {"name": "Linux"}, "product_version": "patch: 6.13.11"}], "enisaIdVendor": [{"id": "6def6ed1-7774-3e3b-9131-d16868da4c12", "vendor": {"name": "Linux"}}], "isExploited": false}