{"id": "EUVD-2025-124949", "enisaUuid": "02186247-0533-3171-9a3a-35dac9ee8f4a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm: fix NULL pointer dereference in __dm_suspend()\n\nThere is a race condition between dm device suspend and table load that\ncan lead to null pointer dereference. The issue occurs when suspend is\ninvoked before table load completes:\n\nBUG: kernel NULL pointer dereference, address: 0000000000000054\nOops: 0000 [#1] PREEMPT SMP PTI\nCPU: 6 PID: 6798 Comm: dmsetup Not tainted 6.6.0-g7e52f5f0ca9b #62\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.1-2.fc37 04/01/2014\nRIP: 0010:blk_mq_wait_quiesce_done+0x0/0x50\nCall Trace:\n  <TASK>\n  blk_mq_quiesce_queue+0x2c/0x50\n  dm_stop_queue+0xd/0x20\n  __dm_suspend+0x130/0x330\n  dm_suspend+0x11a/0x180\n  dev_suspend+0x27e/0x560\n  ctl_ioctl+0x4cf/0x850\n  dm_ctl_ioctl+0xd/0x20\n  vfs_ioctl+0x1d/0x50\n  __se_sys_ioctl+0x9b/0xc0\n  __x64_sys_ioctl+0x19/0x30\n  x64_sys_call+0x2c4a/0x4620\n  do_syscall_64+0x9e/0x1b0\n\nThe issue can be triggered as below:\n\nT1 \t\t\t\t\t\tT2\ndm_suspend\t\t\t\t\ttable_load\n__dm_suspend\t\t\t\t\tdm_setup_md_queue\n\t\t\t\t\t\tdm_mq_init_request_queue\n\t\t\t\t\t\tblk_mq_init_allocated_queue\n\t\t\t\t\t\t=> q->mq_ops = set->ops; (1)\ndm_stop_queue / dm_wait_for_completion\n=> q->tag_set NULL pointer!\t(2)\n\t\t\t\t\t\t=> q->tag_set = set; (3)\n\nFix this by checking if a valid table (map) exists before performing\nrequest-based suspend and waiting for target I/O. When map is NULL,\nskip these table-dependent suspend steps.\n\nEven when map is NULL, no I/O can reach any target because there is\nno table loaded; I/O submitted in this state will fail early in the\nDM layer. Skipping the table-dependent suspend logic in this case\nis safe and avoids NULL pointer dereferences.", "datePublished": "2025-11-12T10:23:22", "dateUpdated": "2025-12-01T06:18:40", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/9dc43ea6a20ff83fe9a5fe4be47ae0fbf2409b98", "https://git.kernel.org/stable/c/30f95b7eda5966b81cb221bd569c0f095a068cf6", "https://git.kernel.org/stable/c/a0e54bd8d7ea79127fe9920df3ae36f85e79ac7c", "https://git.kernel.org/stable/c/a802901b75e13cc306f1b7ab0f062135c8034e9e", "https://git.kernel.org/stable/c/846cafc4725ca727d94f9c4b5f789c1a7c8fb6fe", "https://git.kernel.org/stable/c/19ca4528666990be376ac3eb6fe667b03db5324d", "https://git.kernel.org/stable/c/331c2dd8ca8bad1a3ac10cce847ffb76158eece4", "https://git.kernel.org/stable/c/8d33a030c566e1f105cd5bf27f37940b6367f3be", "https://nvd.nist.gov/vuln/detail/CVE-2025-40134"], "aliases": ["CVE-2025-40134"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "05aa7c64-46e5-3ed5-8f65-7e996b72399f", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "0767c256-f6d4-3c36-abd2-5f6d94498d3c", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <9dc43ea6a20ff83fe9a5fe4be47ae0fbf2409b98"}, {"id": "08591e7b-56bd-35e3-bcc4-80e58901e419", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "1b2abec7-b4fe-346d-a240-f8007c4d2686", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <331c2dd8ca8bad1a3ac10cce847ffb76158eece4"}, {"id": "3ad0b4ee-644d-378c-9979-7175617bad6c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "538d3096-c08d-3861-ac92-8043b351f059", "product": {"name": "Linux"}, "product_version": "patch: 5.15.195"}, {"id": "5bcbc613-d9d0-34cc-83f6-69635bbe4bd0", "product": {"name": "Linux"}, "product_version": "5.0"}, {"id": "66713fed-f0b6-3c98-b94c-7feaf53edb4e", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <a0e54bd8d7ea79127fe9920df3ae36f85e79ac7c"}, {"id": "6a52e323-63d7-3a21-b4d3-cbd8e72846fa", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "70cb36fa-79e5-30dd-b25a-4e4bed5d7829", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <30f95b7eda5966b81cb221bd569c0f095a068cf6"}, {"id": "7834138f-baa6-3a7e-a5c2-0397d93cf7d4", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <8d33a030c566e1f105cd5bf27f37940b6367f3be"}, {"id": "8a4c53b2-2e77-3ccb-99fc-b71d0df17212", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <19ca4528666990be376ac3eb6fe667b03db5324d"}, {"id": "8c8c1211-70e6-3ad3-987f-baf7cfc57371", "product": {"name": "Linux"}, "product_version": "patch: 6.1.156"}, {"id": "95014376-4520-32d1-9412-8aa591149b6f", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <846cafc4725ca727d94f9c4b5f789c1a7c8fb6fe"}, {"id": "a97b86dc-d25f-3cb3-b207-762eff747c09", "product": {"name": "Linux"}, "product_version": "patch: 6.12.53"}, {"id": "b14b05f0-773d-3697-94fe-45c629e733d8", "product": {"name": "Linux"}, "product_version": "c4576aed8d85d808cd6443bda58393d525207d01 <a802901b75e13cc306f1b7ab0f062135c8034e9e"}, {"id": "c5b484e5-dfc5-3b41-870d-32541e3a423c", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "dd4b0b34-2bdd-3299-b863-eae4af69539d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "e50fa1b0-27ac-3303-8359-f2a83c0a6347", "product": {"name": "Linux"}, "product_version": "patch: 6.6.112"}], "enisaIdVendor": [{"id": "2ecc04f5-72e2-339e-9bce-92f6df33ac81", "vendor": {"name": "Linux"}}], "isExploited": false}