{"id": "EUVD-2025-15947", "enisaUuid": "abf394d4-e7c7-3201-9224-fecd209d58f3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: Fix slab-use-after-free in hdcp\n\nThe HDCP code in amdgpu_dm_hdcp.c copies pointers to amdgpu_dm_connector\nobjects without incrementing the kref reference counts. When using a\nUSB-C dock, and the dock is unplugged, the corresponding\namdgpu_dm_connector objects are freed, creating dangling pointers in the\nHDCP code. When the dock is plugged back, the dangling pointers are\ndereferenced, resulting in a slab-use-after-free:\n\n[   66.775837] BUG: KASAN: slab-use-after-free in event_property_validate+0x42f/0x6c0 [amdgpu]\n[   66.776171] Read of size 4 at addr ffff888127804120 by task kworker/0:1/10\n\n[   66.776179] CPU: 0 UID: 0 PID: 10 Comm: kworker/0:1 Not tainted 6.14.0-rc7-00180-g54505f727a38-dirty #233\n[   66.776183] Hardware name: HP HP Pavilion Aero Laptop 13-be0xxx/8916, BIOS F.17 12/18/2024\n[   66.776186] Workqueue: events event_property_validate [amdgpu]\n[   66.776494] Call Trace:\n[   66.776496]  <TASK>\n[   66.776497]  dump_stack_lvl+0x70/0xa0\n[   66.776504]  print_report+0x175/0x555\n[   66.776507]  ? __virt_addr_valid+0x243/0x450\n[   66.776510]  ? kasan_complete_mode_report_info+0x66/0x1c0\n[   66.776515]  kasan_report+0xeb/0x1c0\n[   66.776518]  ? event_property_validate+0x42f/0x6c0 [amdgpu]\n[   66.776819]  ? event_property_validate+0x42f/0x6c0 [amdgpu]\n[   66.777121]  __asan_report_load4_noabort+0x14/0x20\n[   66.777124]  event_property_validate+0x42f/0x6c0 [amdgpu]\n[   66.777342]  ? __lock_acquire+0x6b40/0x6b40\n[   66.777347]  ? enable_assr+0x250/0x250 [amdgpu]\n[   66.777571]  process_one_work+0x86b/0x1510\n[   66.777575]  ? pwq_dec_nr_in_flight+0xcf0/0xcf0\n[   66.777578]  ? assign_work+0x16b/0x280\n[   66.777580]  ? lock_is_held_type+0xa3/0x130\n[   66.777583]  worker_thread+0x5c0/0xfa0\n[   66.777587]  ? process_one_work+0x1510/0x1510\n[   66.777588]  kthread+0x3a2/0x840\n[   66.777591]  ? kthread_is_per_cpu+0xd0/0xd0\n[   66.777594]  ? trace_hardirqs_on+0x4f/0x60\n[   66.777597]  ? _raw_spin_unlock_irq+0x27/0x60\n[   66.777599]  ? calculate_sigpending+0x77/0xa0\n[   66.777602]  ? kthread_is_per_cpu+0xd0/0xd0\n[   66.777605]  ret_from_fork+0x40/0x90\n[   66.777607]  ? kthread_is_per_cpu+0xd0/0xd0\n[   66.777609]  ret_from_fork_asm+0x11/0x20\n[   66.777614]  </TASK>\n\n[   66.777643] Allocated by task 10:\n[   66.777646]  kasan_save_stack+0x39/0x60\n[   66.777649]  kasan_save_track+0x14/0x40\n[   66.777652]  kasan_save_alloc_info+0x37/0x50\n[   66.777655]  __kasan_kmalloc+0xbb/0xc0\n[   66.777658]  __kmalloc_cache_noprof+0x1c8/0x4b0\n[   66.777661]  dm_dp_add_mst_connector+0xdd/0x5c0 [amdgpu]\n[   66.777880]  drm_dp_mst_port_add_connector+0x47e/0x770 [drm_display_helper]\n[   66.777892]  drm_dp_send_link_address+0x1554/0x2bf0 [drm_display_helper]\n[   66.777901]  drm_dp_check_and_send_link_address+0x187/0x1f0 [drm_display_helper]\n[   66.777909]  drm_dp_mst_link_probe_work+0x2b8/0x410 [drm_display_helper]\n[   66.777917]  process_one_work+0x86b/0x1510\n[   66.777919]  worker_thread+0x5c0/0xfa0\n[   66.777922]  kthread+0x3a2/0x840\n[   66.777925]  ret_from_fork+0x40/0x90\n[   66.777927]  ret_from_fork_asm+0x11/0x20\n\n[   66.777932] Freed by task 1713:\n[   66.777935]  kasan_save_stack+0x39/0x60\n[   66.777938]  kasan_save_track+0x14/0x40\n[   66.777940]  kasan_save_free_info+0x3b/0x60\n[   66.777944]  __kasan_slab_free+0x52/0x70\n[   66.777946]  kfree+0x13f/0x4b0\n[   66.777949]  dm_dp_mst_connector_destroy+0xfa/0x150 [amdgpu]\n[   66.778179]  drm_connector_free+0x7d/0xb0\n[   66.778184]  drm_mode_object_put.part.0+0xee/0x160\n[   66.778188]  drm_mode_object_put+0x37/0x50\n[   66.778191]  drm_atomic_state_default_clear+0x220/0xd60\n[   66.778194]  __drm_atomic_state_free+0x16e/0x2a0\n[   66.778197]  drm_mode_atomic_ioctl+0x15ed/0x2ba0\n[   66.778200]  drm_ioctl_kernel+0x17a/0x310\n[   66.778203]  drm_ioctl+0x584/0xd10\n[   66.778206]  amdgpu_drm_ioctl+0xd2/0x1c0 [amdgpu]\n[   66.778375]  __x64_sys_ioctl+0x139/0x1a0\n[   66.778378]  x64_sys_call+0xee7/0xfb0\n[   66.778381] \n---truncated---", "datePublished": "2025-05-20T18:30:54", "dateUpdated": "2025-11-17T18:30:22", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-37903", "https://git.kernel.org/stable/c/3a782a83d130ceac6c98a87639ddd89640bff486", "https://git.kernel.org/stable/c/bbc66abcd297be67e3d835276e21e6fdc65205a6", "https://git.kernel.org/stable/c/be593d9d91c5a3a363d456b9aceb71029aeb3f1d", "https://git.kernel.org/stable/c/dd329f04dda35a66e0c9ed462ba91bd5f2c8be70", "https://git.kernel.org/stable/c/e25139c4aa5621f2db8e86688c33546cdd885e42", "https://lists.debian.org/debian-lts-announce/2025/08/msg00010.html"], "aliases": ["CVE-2025-37903", "GHSA-37f2-w5cv-983p"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0d8a27e3-8265-3406-93ed-618c5cbf5c39", "product": {"name": "Linux"}, "product_version": "5.5"}, {"id": "3ad04851-d8d8-37c4-b800-1674d4647ecb", "product": {"name": "Linux"}, "product_version": "da3fd7ac0bcf372cc57117bdfcd725cca7ef975a <dd329f04dda35a66e0c9ed462ba91bd5f2c8be70"}, {"id": "5a2fe6b9-f94d-3c68-b9e5-2130c20ca7ed", "product": {"name": "Linux"}, "product_version": "patch: 6.6.90"}, {"id": "602227ca-ecaa-3ac3-896b-941384b3ca30", "product": {"name": "Linux"}, "product_version": "da3fd7ac0bcf372cc57117bdfcd725cca7ef975a <e25139c4aa5621f2db8e86688c33546cdd885e42"}, {"id": "7a0ea227-d55f-3c81-a411-9a43aa664323", "product": {"name": "Linux"}, "product_version": "patch: 6.14.6"}, {"id": "81031b81-2bca-32a6-a257-233aaa70f9b6", "product": {"name": "Linux"}, "product_version": "patch: 6.12.28"}, {"id": "830fd676-d713-3618-9a5e-c01a714b3c2d", "product": {"name": "Linux"}, "product_version": "da3fd7ac0bcf372cc57117bdfcd725cca7ef975a <3a782a83d130ceac6c98a87639ddd89640bff486"}, {"id": "8b00821b-cb9d-310e-8551-7789e8b43c0f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "921c1c12-0fbb-317c-b418-f19d11ee834e", "product": {"name": "Linux"}, "product_version": "da3fd7ac0bcf372cc57117bdfcd725cca7ef975a <be593d9d91c5a3a363d456b9aceb71029aeb3f1d"}, {"id": "b3e697b4-13cb-31ec-90b4-9364a5a3de18", "product": {"name": "Linux"}, "product_version": "patch: 6.1.138"}, {"id": "cefab3e9-8087-30c3-bfaa-015fa902d5ff", "product": {"name": "Linux"}, "product_version": "da3fd7ac0bcf372cc57117bdfcd725cca7ef975a <bbc66abcd297be67e3d835276e21e6fdc65205a6"}, {"id": "f11447b2-d54d-3c26-b27b-923711175358", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}], "enisaIdVendor": [{"id": "41d66e06-1cb5-34d3-b619-c8c0dac9aff7", "vendor": {"name": "Linux"}}], "isExploited": false}