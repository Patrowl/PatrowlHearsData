{"id": "EUVD-2025-19840", "enisaUuid": "029a2811-1cb5-36ed-a1e2-fcfde06de2c1", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nVMCI: fix race between vmci_host_setup_notify and vmci_ctx_unset_notify\n\nDuring our test, it is found that a warning can be trigger in try_grab_folio\nas follow:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 0 PID: 1678 at mm/gup.c:147 try_grab_folio+0x106/0x130\n  Modules linked in:\n  CPU: 0 UID: 0 PID: 1678 Comm: syz.3.31 Not tainted 6.15.0-rc5 #163 PREEMPT(undef)\n  RIP: 0010:try_grab_folio+0x106/0x130\n  Call Trace:\n   <TASK>\n   follow_huge_pmd+0x240/0x8e0\n   follow_pmd_mask.constprop.0.isra.0+0x40b/0x5c0\n   follow_pud_mask.constprop.0.isra.0+0x14a/0x170\n   follow_page_mask+0x1c2/0x1f0\n   __get_user_pages+0x176/0x950\n   __gup_longterm_locked+0x15b/0x1060\n   ? gup_fast+0x120/0x1f0\n   gup_fast_fallback+0x17e/0x230\n   get_user_pages_fast+0x5f/0x80\n   vmci_host_unlocked_ioctl+0x21c/0xf80\n  RIP: 0033:0x54d2cd\n  ---[ end trace 0000000000000000 ]---\n\nDigging into the source, context->notify_page may init by get_user_pages_fast\nand can be seen in vmci_ctx_unset_notify which will try to put_page. However\nget_user_pages_fast is not finished here and lead to following\ntry_grab_folio warning. The race condition is shown as follow:\n\ncpu0\t\t\tcpu1\nvmci_host_do_set_notify\nvmci_host_setup_notify\nget_user_pages_fast(uva, 1, FOLL_WRITE, &context->notify_page);\nlockless_pages_from_mm\ngup_pgd_range\ngup_huge_pmd  // update &context->notify_page\n\t\t\tvmci_host_do_set_notify\n\t\t\tvmci_ctx_unset_notify\n\t\t\tnotify_page = context->notify_page;\n\t\t\tif (notify_page)\n\t\t\tput_page(notify_page);\t// page is freed\n__gup_longterm_locked\n__get_user_pages\nfollow_trans_huge_pmd\ntry_grab_folio // warn here\n\nTo slove this, use local variable page to make notify_page can be seen\nafter finish get_user_pages_fast.", "datePublished": "2025-07-03T09:30:33", "dateUpdated": "2025-12-16T18:31:28", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b4209e4b778e4e57d0636e1c9fc07a924dbc6043", "https://git.kernel.org/stable/c/58a90db70aa6616411e5f69d1982d9b1dd97d774", "https://git.kernel.org/stable/c/6e3af836805ed1d7a699f76ec798626198917aa4", "https://git.kernel.org/stable/c/00ddc7dad55b7bbb78df80d6e174d0c4764dea0c", "https://git.kernel.org/stable/c/75b5313c80c39a26d27cbb602f968a05576c36f9", "https://git.kernel.org/stable/c/1bd6406fb5f36c2bb1e96e27d4c3e9f4d09edde4", "https://git.kernel.org/stable/c/74095bbbb19ca74a0368d857603a2438c88ca86c", "https://git.kernel.org/stable/c/468aec888f838ce5174b96e0cb4396790d6f60ca", "https://nvd.nist.gov/vuln/detail/CVE-2025-38102", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38102"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "08c27de4-bdbe-302a-a8c2-26136d4ed3f4", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "26a7834d-191a-3d94-a08f-8d1e0d82b764", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <6e3af836805ed1d7a699f76ec798626198917aa4"}, {"id": "29ebb27e-32b6-392b-b07b-05d7252154c3", "product": {"name": "Linux"}, "product_version": "patch: 5.4.296"}, {"id": "2adec303-a4f8-3631-8822-641dcaec4b61", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}, {"id": "35d5bdad-3900-313f-a753-c1b05288ba20", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "3a18b3ab-14d3-30e9-9bc7-bf71f30875a6", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <00ddc7dad55b7bbb78df80d6e174d0c4764dea0c"}, {"id": "3dc46068-da37-3b70-b5df-4d28953a274a", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <75b5313c80c39a26d27cbb602f968a05576c36f9"}, {"id": "43579c85-48bd-32dd-af29-62f82413902a", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "4cbec6fb-2460-3d44-880d-5929f6be8210", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}, {"id": "6f5a5252-57f6-3400-bb83-336fb8254e9d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.240"}, {"id": "72845145-a395-3fda-aa02-3c738a38533c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8c42b7b6-514a-3540-8cc8-cd60bb09127c", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <58a90db70aa6616411e5f69d1982d9b1dd97d774"}, {"id": "9499bbb5-653d-3ebb-8af2-47a69186467d", "product": {"name": "Linux"}, "product_version": "4.0"}, {"id": "ae89fe2c-84c6-35dc-9a98-2e9887def1e9", "product": {"name": "Linux"}, "product_version": "patch: 6.6.94"}, {"id": "b194c18f-496f-3d92-93e6-2a90b583a922", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <b4209e4b778e4e57d0636e1c9fc07a924dbc6043"}, {"id": "b2284612-9be8-3f38-8158-91f65571a591", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <1bd6406fb5f36c2bb1e96e27d4c3e9f4d09edde4"}, {"id": "ce89282a-9920-3f00-945e-108dc9a2c947", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "dd97f065-f46e-3ec5-8ce5-a4e3a6f50d21", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <74095bbbb19ca74a0368d857603a2438c88ca86c"}, {"id": "f178cbd6-3d08-308c-9dda-af1a0ac6b471", "product": {"name": "Linux"}, "product_version": "a1d88436d53a75e950db15834b3d2f8c0c358fdc <468aec888f838ce5174b96e0cb4396790d6f60ca"}], "enisaIdVendor": [{"id": "d5e5dada-5b02-3c2b-9223-074199617e99", "vendor": {"name": "Linux"}}], "isExploited": false}