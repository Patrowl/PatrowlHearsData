{"id": "EUVD-2025-13151", "enisaUuid": "82ab2da6-4fa1-3486-b1c2-f66e81dab83b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: s390: Fix use-after-free of PCI resources with per-function hotplug\n\nOn s390 PCI functions may be hotplugged individually even when they\nbelong to a multi-function device. In particular on an SR-IOV device VFs\nmay be removed and later re-added.\n\nIn commit a50297cf8235 (\"s390/pci: separate zbus creation from\nscanning\") it was missed however that struct pci_bus and struct\nzpci_bus's resource list retained a reference to the PCI functions MMIO\nresources even though those resources are released and freed on\nhot-unplug. These stale resources may subsequently be claimed when the\nPCI function re-appears resulting in use-after-free.\n\nOne idea of fixing this use-after-free in s390 specific code that was\ninvestigated was to simply keep resources around from the moment a PCI\nfunction first appeared until the whole virtual PCI bus created for\na multi-function device disappears. The problem with this however is\nthat due to the requirement of artificial MMIO addreesses (address\ncookies) extra logic is then needed to keep the address cookies\ncompatible on re-plug. At the same time the MMIO resources semantically\nbelong to the PCI function so tying their lifecycle to the function\nseems more logical.\n\nInstead a simpler approach is to remove the resources of an individually\nhot-unplugged PCI function from the PCI bus's resource list while\nkeeping the resources of other PCI functions on the PCI bus untouched.\n\nThis is done by introducing pci_bus_remove_resource() to remove an\nindividual resource. Similarly the resource also needs to be removed\nfrom the struct zpci_bus's resource list. It turns out however, that\nthere is really no need to add the MMIO resources to the struct\nzpci_bus's resource list at all and instead we can simply use the\nzpci_bar_struct's resource pointer directly.", "datePublished": "2025-05-02T18:31:37", "dateUpdated": "2025-11-10T18:30:29", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53123", "https://git.kernel.org/stable/c/437bb839e36cc9f35adc6d2a2bf113b7a0fc9985", "https://git.kernel.org/stable/c/a2410d0c3d2d714ed968a135dfcbed6aa3ff7027", "https://git.kernel.org/stable/c/ab909509850b27fd39b8ba99e44cda39dbc3858c", "https://git.kernel.org/stable/c/b99ebf4b62774e690e73a551cf5fbf6f219bdd96"], "aliases": ["CVE-2023-53123", "GHSA-3m8v-mqfw-xp3g"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1f09e239-927e-3f21-ad9f-fecd38edb430", "product": {"name": "Linux"}, "product_version": "patch: 6.1.21"}, {"id": "3bb744de-e917-304a-b077-4ee82c5d9beb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "6d017850-cc9b-371c-85ea-038b75b6e465", "product": {"name": "Linux"}, "product_version": "a50297cf8235b062bcdeaa8b1dad58e69d3e1b43 <ab909509850b27fd39b8ba99e44cda39dbc3858c"}, {"id": "8272cffc-789b-36e2-affa-9e1dea154dc1", "product": {"name": "Linux"}, "product_version": "a50297cf8235b062bcdeaa8b1dad58e69d3e1b43 <437bb839e36cc9f35adc6d2a2bf113b7a0fc9985"}, {"id": "ada3de35-c8ef-326f-8b07-e8b74e76d2dc", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "efef027a-a052-3401-83ff-4d532a68815c", "product": {"name": "Linux"}, "product_version": "5.13"}, {"id": "f2929f80-998e-3042-a5a4-0b198a47ab19", "product": {"name": "Linux"}, "product_version": "a50297cf8235b062bcdeaa8b1dad58e69d3e1b43 <b99ebf4b62774e690e73a551cf5fbf6f219bdd96"}, {"id": "f82736da-fdff-380a-91ce-65e314409cd2", "product": {"name": "Linux"}, "product_version": "patch: 6.2.8"}, {"id": "fd332c09-92d7-388e-94f1-6240274638f4", "product": {"name": "Linux"}, "product_version": "a50297cf8235b062bcdeaa8b1dad58e69d3e1b43 <a2410d0c3d2d714ed968a135dfcbed6aa3ff7027"}, {"id": "ffbc4489-1421-3375-a244-9f45571e320c", "product": {"name": "Linux"}, "product_version": "patch: 5.15.104"}], "enisaIdVendor": [{"id": "9b7c8cea-ddba-35b0-b548-f714bf1f6577", "vendor": {"name": "Linux"}}], "isExploited": false}