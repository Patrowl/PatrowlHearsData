{"id": "EUVD-2025-205170", "enisaUuid": "4173f336-9e7c-35ec-9832-b2eb2b0ea20c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: gadget: Fix use-after-free during usb config switch\n\nIn the process of switching USB config from rndis to other config,\nif the hardware does not support the ->pullup callback, or the\nhardware encounters a low probability fault, both of them may cause\nthe ->pullup callback to fail, which will then cause a system panic\n(use after free).\n\nThe gadget drivers sometimes need to be unloaded regardless of the\nhardware's behavior.\n\nAnalysis as follows:\n=======================================================================\n(1) write /config/usb_gadget/g1/UDC \"none\"\n\ngether_disconnect+0x2c/0x1f8\nrndis_disable+0x4c/0x74\ncomposite_disconnect+0x74/0xb0\nconfigfs_composite_disconnect+0x60/0x7c\nusb_gadget_disconnect+0x70/0x124\nusb_gadget_unregister_driver+0xc8/0x1d8\ngadget_dev_desc_UDC_store+0xec/0x1e4\n\n(2) rm /config/usb_gadget/g1/configs/b.1/f1\n\nrndis_deregister+0x28/0x54\nrndis_free+0x44/0x7c\nusb_put_function+0x14/0x1c\nconfig_usb_cfg_unlink+0xc4/0xe0\nconfigfs_unlink+0x124/0x1c8\nvfs_unlink+0x114/0x1dc\n\n(3) rmdir /config/usb_gadget/g1/functions/rndis.gs4\n\npanic+0x1fc/0x3d0\ndo_page_fault+0xa8/0x46c\ndo_mem_abort+0x3c/0xac\nel1_sync_handler+0x40/0x78\n0xffffff801138f880\nrndis_close+0x28/0x34\neth_stop+0x74/0x110\ndev_close_many+0x48/0x194\nrollback_registered_many+0x118/0x814\nunregister_netdev+0x20/0x30\ngether_cleanup+0x1c/0x38\nrndis_attr_release+0xc/0x14\nkref_put+0x74/0xb8\nconfigfs_rmdir+0x314/0x374\n\nIf gadget->ops->pullup() return an error, function rndis_close() will be\ncalled, then it will causes a use-after-free problem.\n=======================================================================", "datePublished": "2025-12-24T12:30:26", "dateUpdated": "2025-12-24T12:30:26", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-50704", "https://git.kernel.org/stable/c/30e926aa835ac2e6ad05822e4cb75833feb0d99f", "https://git.kernel.org/stable/c/99a58ac42d9b6911834b0224b6782aea0c311346", "https://git.kernel.org/stable/c/afdc12887f2b2ecf20d065a7d81ad29824155083"], "aliases": ["CVE-2022-50704", "GHSA-mj7r-48h2-hmpx"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "14ce3fd2-d8cf-3dee-9053-7edde0242f9b", "product": {"name": "Linux"}, "product_version": "0a55187a1ec8c03d0619e7ce41d10fdc39cff036 <99a58ac42d9b6911834b0224b6782aea0c311346"}, {"id": "49c372f5-9c9f-3c56-a50f-354cd21393a1", "product": {"name": "Linux"}, "product_version": "0a55187a1ec8c03d0619e7ce41d10fdc39cff036 <30e926aa835ac2e6ad05822e4cb75833feb0d99f"}, {"id": "5bf66c9c-5442-3324-96fc-715c6e3f4c4e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5ebd450f-dcb8-36a4-8e09-5a9be49191b2", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "845633ab-744a-3d18-9498-a0c78f0cab0a", "product": {"name": "Linux"}, "product_version": "0a55187a1ec8c03d0619e7ce41d10fdc39cff036 <afdc12887f2b2ecf20d065a7d81ad29824155083"}, {"id": "91053943-6970-3e3f-bba8-5abb272ce6e3", "product": {"name": "Linux"}, "product_version": "patch: 6.1.2"}, {"id": "d8f3f47e-a25f-3bcb-a579-f852b0c6ded6", "product": {"name": "Linux"}, "product_version": "4.20"}, {"id": "e250b4a6-8c11-35c6-9dce-31fbfcbd75fa", "product": {"name": "Linux"}, "product_version": "patch: 6.0.16"}], "enisaIdVendor": [{"id": "ceeba071-d8f2-34fa-b3d7-d611efd0f19f", "vendor": {"name": "Linux"}}], "isExploited": false}