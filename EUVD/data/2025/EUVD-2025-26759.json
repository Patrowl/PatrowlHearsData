{"id": "EUVD-2025-26759", "enisaUuid": "37a6b805-faa1-3958-999f-dda26f3a6702", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ngfs2: Validate i_depth for exhash directories\n\nA fuzzer test introduced corruption that ends up with a depth of 0 in\ndir_e_read(), causing an undefined shift by 32 at:\n\n  index = hash >> (32 - dip->i_depth);\n\nAs calculated in an open-coded way in dir_make_exhash(), the minimum\ndepth for an exhash directory is ilog2(sdp->sd_hash_ptrs) and 0 is\ninvalid as sdp->sd_hash_ptrs is fixed as sdp->bsize / 16 at mount time.\n\nSo we can avoid the undefined behaviour by checking for depth values\nlower than the minimum in gfs2_dinode_in(). Values greater than the\nmaximum are already being checked for there.\n\nAlso switch the calculation in dir_make_exhash() to use ilog2() to\nclarify how the depth is calculated.\n\nTested with the syzkaller repro.c and xfstests '-g quick'.", "datePublished": "2025-09-05T18:31:16", "dateUpdated": "2025-11-26T00:30:16", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/53a0249d68a210c16e961b83adfa82f94ee0a53d", "https://git.kernel.org/stable/c/b5f46951e62377b6e406fadc18bc3c5bdf1632a7", "https://git.kernel.org/stable/c/9680c58675b82348ab84d387e4fa727f7587e1a0", "https://git.kernel.org/stable/c/557c024ca7250bb65ae60f16c02074106c2f197b", "https://nvd.nist.gov/vuln/detail/CVE-2025-38710"], "aliases": ["CVE-2025-38710"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "69bc9323-320b-34d4-88da-f50b6e09c3cb", "product": {"name": "Linux"}, "product_version": "patch: 6.15.11"}, {"id": "7b5f45e4-1116-386b-ab12-ca93bf514107", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b5f46951e62377b6e406fadc18bc3c5bdf1632a7"}, {"id": "8f40fea9-e2f4-3d88-8b58-7e5330d9fb92", "product": {"name": "Linux"}, "product_version": "patch: 6.12.43"}, {"id": "91883fb4-b414-3852-9ee1-dd75f28ace6f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <53a0249d68a210c16e961b83adfa82f94ee0a53d"}, {"id": "960e18b9-2bc0-3afb-b59c-b5065ce0bdb1", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}, {"id": "984a39fe-9554-3a1a-9d5b-c5b4e446d33b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <557c024ca7250bb65ae60f16c02074106c2f197b"}, {"id": "b8e1ec47-2512-329f-b491-bb04ce5469c2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9680c58675b82348ab84d387e4fa727f7587e1a0"}, {"id": "e0984195-f66a-308a-9503-3aeee96054a4", "product": {"name": "Linux"}, "product_version": "patch: 6.16.2"}, {"id": "fcbfcc92-3fdf-34e5-b1cd-b4edc2d5f3a6", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}], "enisaIdVendor": [{"id": "44bfb9ba-0c02-3697-b6de-92773f5d016c", "vendor": {"name": "Linux"}}], "isExploited": false}