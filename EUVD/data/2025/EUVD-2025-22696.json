{"id": "EUVD-2025-22696", "enisaUuid": "283efe6f-15b2-30e5-a5da-4f2b04ea7424", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd/raid1: Fix stack memory use after return in raid1_reshape\n\nIn the raid1_reshape function, newpool is\nallocated on the stack and assigned to conf->r1bio_pool.\nThis results in conf->r1bio_pool.wait.head pointing\nto a stack address.\nAccessing this address later can lead to a kernel panic.\n\nExample access path:\n\nraid1_reshape()\n{\n\t// newpool is on the stack\n\tmempool_t newpool, oldpool;\n\t// initialize newpool.wait.head to stack address\n\tmempool_init(&newpool, ...);\n\tconf->r1bio_pool = newpool;\n}\n\nraid1_read_request() or raid1_write_request()\n{\n\talloc_r1bio()\n\t{\n\t\tmempool_alloc()\n\t\t{\n\t\t\t// if pool->alloc fails\n\t\t\tremove_element()\n\t\t\t{\n\t\t\t\t--pool->curr_nr;\n\t\t\t}\n\t\t}\n\t}\n}\n\nmempool_free()\n{\n\tif (pool->curr_nr < pool->min_nr) {\n\t\t// pool->wait.head is a stack address\n\t\t// wake_up() will try to access this invalid address\n\t\t// which leads to a kernel panic\n\t\treturn;\n\t\twake_up(&pool->wait);\n\t}\n}\n\nFix:\nreinit conf->r1bio_pool.wait after assigning newpool.", "datePublished": "2025-07-25T18:30:39", "dateUpdated": "2025-12-23T00:30:30", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d8a6853d00fbaa810765c8ed2f452a5832273968", "https://git.kernel.org/stable/c/12b00ec99624f8da8c325f2dd6e807df26df0025", "https://git.kernel.org/stable/c/48da050b4f54ed639b66278d0ae6f4107b2c4e2d", "https://git.kernel.org/stable/c/5f35e48b76655e45522df338876dfef88dafcc71", "https://git.kernel.org/stable/c/df5894014a92ff0196dbc212a7764e97366fd2b7", "https://git.kernel.org/stable/c/776e6186dc9ecbdb8a1b706e989166c8a99bbf64", "https://git.kernel.org/stable/c/61fd5e93006cf82ec8ee5c115ab5cf4bbd104bdb", "https://git.kernel.org/stable/c/d67ed2ccd2d1dcfda9292c0ea8697a9d0f2f0d98", "https://nvd.nist.gov/vuln/detail/CVE-2025-38445", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38445"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "0b258766-7cbb-37eb-b816-228700f4dfb7", "product": {"name": "Linux"}, "product_version": "patch: 6.15.7"}, {"id": "189c94e0-bc5c-389f-9a87-df3584d24a4a", "product": {"name": "Linux"}, "product_version": "patch: 5.15.189"}, {"id": "22974b83-8867-37ad-9855-acf794f13866", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2cf375ef-b861-3d69-9a18-abe34dd15eb2", "product": {"name": "Linux"}, "product_version": "patch: 5.4.296"}, {"id": "3fafd9eb-80d1-3263-8b53-d0462430c59d", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc6"}, {"id": "48f6cdbf-ffdb-3d74-bb3f-75a4ff88175a", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <48da050b4f54ed639b66278d0ae6f4107b2c4e2d"}, {"id": "66ad93f4-b30a-3320-8745-e0f0cf479ebd", "product": {"name": "Linux"}, "product_version": "patch: 6.6.99"}, {"id": "782c476c-5d2c-319c-972e-2efa18e73c9f", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <d8a6853d00fbaa810765c8ed2f452a5832273968"}, {"id": "8182d788-4c40-3b99-9435-3da2a3df9fac", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <61fd5e93006cf82ec8ee5c115ab5cf4bbd104bdb"}, {"id": "8fc46053-9b47-3762-988f-185ba0e629ba", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <5f35e48b76655e45522df338876dfef88dafcc71"}, {"id": "a8b5e808-d108-3fab-9fa5-51818b88f194", "product": {"name": "Linux"}, "product_version": "patch: 5.10.240"}, {"id": "ac699b8a-0491-34f0-93ac-d8470a033d6c", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "adf57671-d2eb-3107-a7c0-4927b4d4ce56", "product": {"name": "Linux"}, "product_version": "patch: 6.12.39"}, {"id": "b90cca43-e74a-3747-b1f6-4b97dece7946", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <df5894014a92ff0196dbc212a7764e97366fd2b7"}, {"id": "bc3883ce-3d0d-3e0d-b869-04793312eedf", "product": {"name": "Linux"}, "product_version": "4.18"}, {"id": "bdfbbf53-3e9f-3b12-bcf7-f85e7292c4ef", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <d67ed2ccd2d1dcfda9292c0ea8697a9d0f2f0d98"}, {"id": "cea1dd22-9708-30de-a90b-59d053347e54", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <12b00ec99624f8da8c325f2dd6e807df26df0025"}, {"id": "d9aed70f-8765-3cf5-bdc6-4812dc507286", "product": {"name": "Linux"}, "product_version": "patch: 6.1.146"}, {"id": "ebc7e95b-7874-3c0d-96d0-837a32f8cac6", "product": {"name": "Linux"}, "product_version": "afeee514ce7f4cab605beedd03be71ebaf0c5fc8 <776e6186dc9ecbdb8a1b706e989166c8a99bbf64"}], "enisaIdVendor": [{"id": "c6209013-373b-3be9-9d00-96f6d826e017", "vendor": {"name": "Linux"}}], "isExploited": false}