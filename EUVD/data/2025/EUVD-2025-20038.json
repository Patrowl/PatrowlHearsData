{"id": "EUVD-2025-20038", "enisaUuid": "71d17579-7afb-37de-9867-2b916a41326c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on sit_bitmap_size\n\nw/ below testcase, resize will generate a corrupted image which\ncontains inconsistent metadata, so when mounting such image, it\nwill trigger kernel panic:\n\ntouch img\ntruncate -s $((512*1024*1024*1024)) img\nmkfs.f2fs -f img $((256*1024*1024))\nresize.f2fs -s -i img -t $((1024*1024*1024))\nmount img /mnt/f2fs\n\n------------[ cut here ]------------\nkernel BUG at fs/f2fs/segment.h:863!\nOops: invalid opcode: 0000 [#1] SMP PTI\nCPU: 11 UID: 0 PID: 3922 Comm: mount Not tainted 6.15.0-rc1+ #191 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\nRIP: 0010:f2fs_ra_meta_pages+0x47c/0x490\n\nCall Trace:\n f2fs_build_segment_manager+0x11c3/0x2600\n f2fs_fill_super+0xe97/0x2840\n mount_bdev+0xf4/0x140\n legacy_get_tree+0x2b/0x50\n vfs_get_tree+0x29/0xd0\n path_mount+0x487/0xaf0\n __x64_sys_mount+0x116/0x150\n do_syscall_64+0x82/0x190\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\nRIP: 0033:0x7fdbfde1bcfe\n\nThe reaseon is:\n\nsit_i->bitmap_size is 192, so size of sit bitmap is 192*8=1536, at maximum\nthere are 1536 sit blocks, however MAIN_SEGS is 261893, so that sit_blk_cnt\nis 4762, build_sit_entries() -> current_sit_addr() tries to access\nout-of-boundary in sit_bitmap at offset from [1536, 4762), once sit_bitmap\nand sit_bitmap_mirror is not the same, it will trigger f2fs_bug_on().\n\nLet's add sanity check in f2fs_sanity_check_ckpt() to avoid panic.", "datePublished": "2025-07-04T15:31:09", "dateUpdated": "2025-12-18T21:31:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/82f51bff393e4c12cf4de553120ca831cfa4ef19", "https://git.kernel.org/stable/c/38ef48a8afef8df646b6f6ae7abb872f18b533c1", "https://git.kernel.org/stable/c/ad862f71016ba38039df1c96ed55c0a4314cc183", "https://git.kernel.org/stable/c/79ef8a6c4ec53d327580fd7d2b522cf4f1d05b0c", "https://git.kernel.org/stable/c/ee1b421c469876544e297ec1090574bd76100247", "https://git.kernel.org/stable/c/3e5ac62a56a24f4d88ce8ffd7bc452428b235868", "https://git.kernel.org/stable/c/5db0d252c64e91ba1929c70112352e85dc5751e7", "https://nvd.nist.gov/vuln/detail/CVE-2025-38218", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38218"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "20541743-6d55-3545-bfed-1aa852a04dac", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <5db0d252c64e91ba1929c70112352e85dc5751e7"}, {"id": "20a2a7ee-9f2a-36ee-ac69-45fb5c1fdc1d", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}, {"id": "20f9ee27-74a2-3405-a96d-6b0636eddc82", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <38ef48a8afef8df646b6f6ae7abb872f18b533c1"}, {"id": "52fccbc5-3b70-32c7-ada8-19627f6a808a", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "69f204a9-595d-3ad0-a4dd-5200306f71e2", "product": {"name": "Linux"}, "product_version": "patch: 6.12.35"}, {"id": "6fc0611d-a83c-3c5f-a58a-8c71b0a91cff", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ee1b421c469876544e297ec1090574bd76100247"}, {"id": "76944656-b766-35fd-ba03-6e306b233595", "product": {"name": "Linux"}, "product_version": "patch: 6.15.4"}, {"id": "77fb6fe9-d866-3a45-94d7-ff0632f8dc68", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <82f51bff393e4c12cf4de553120ca831cfa4ef19"}, {"id": "78f13821-79e1-30fe-98b3-a6ce0cbe6ce7", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "79408f9e-ed2c-320e-9d1a-fb7ef20c7524", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "85e0d813-3ff7-35aa-927f-c43236458073", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3e5ac62a56a24f4d88ce8ffd7bc452428b235868"}, {"id": "875ec715-9bf9-31cd-88aa-9014f71b0f5b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ad862f71016ba38039df1c96ed55c0a4314cc183"}, {"id": "877ff60b-4f4a-3b1a-8239-f963e7ac2d48", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <38ef48a8afef8df646b6f6ae7abb872f18b533c1"}, {"id": "973cdb32-b36c-3d64-b480-797a86ebb68e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5db0d252c64e91ba1929c70112352e85dc5751e7"}, {"id": "9903bbab-1cd4-37d4-8b3f-283eb7530054", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <ee1b421c469876544e297ec1090574bd76100247"}, {"id": "a7848175-1258-342e-a3b3-e26cd4bce012", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <82f51bff393e4c12cf4de553120ca831cfa4ef19"}, {"id": "b9536f86-bf7c-3dab-976d-b3f81f7cc66e", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <79ef8a6c4ec53d327580fd7d2b522cf4f1d05b0c"}, {"id": "c14ece00-ba5f-3268-88e4-11b43b15394d", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <ad862f71016ba38039df1c96ed55c0a4314cc183"}, {"id": "c562560e-d6c9-3568-804b-361f1135f307", "product": {"name": "Linux"}, "product_version": "patch: 6.6.95"}, {"id": "cadebbd8-0f91-3d7d-b6a8-07abb7636df5", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "dcbd1867-7479-3efd-9b18-0876b3c2c708", "product": {"name": "Linux"}, "product_version": "patch: 5.10.239"}, {"id": "ed3b9672-efd9-3ba6-9f10-b606b400cddc", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}, {"id": "ef25382e-75d1-3676-9fe7-67d18df49c7e", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <3e5ac62a56a24f4d88ce8ffd7bc452428b235868"}, {"id": "fcc8b921-3561-3286-a423-0668fc126073", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <79ef8a6c4ec53d327580fd7d2b522cf4f1d05b0c"}], "enisaIdVendor": [{"id": "6f1f83d2-2db7-3fbc-aad3-d024a3769353", "vendor": {"name": "Linux"}}], "isExploited": false}