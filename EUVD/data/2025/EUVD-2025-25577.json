{"id": "EUVD-2025-25577", "enisaUuid": "b54efde8-fee1-30a2-8cf1-536fc43a33d4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: pnv_php: Clean up allocated IRQs on unplug\n\nWhen the root of a nested PCIe bridge configuration is unplugged, the\npnv_php driver leaked the allocated IRQ resources for the child bridges'\nhotplug event notifications, resulting in a panic.\n\nFix this by walking all child buses and deallocating all its IRQ resources\nbefore calling pci_hp_remove_devices().\n\nAlso modify the lifetime of the workqueue at struct pnv_php_slot::wq so\nthat it is only destroyed in pnv_php_free_slot(), instead of\npnv_php_disable_irq(). This is required since pnv_php_disable_irq() will\nnow be called by workers triggered by hot unplug interrupts, so the\nworkqueue needs to stay allocated.\n\nThe abridged kernel panic that occurs without this patch is as follows:\n\n  WARNING: CPU: 0 PID: 687 at kernel/irq/msi.c:292 msi_device_data_release+0x6c/0x9c\n  CPU: 0 UID: 0 PID: 687 Comm: bash Not tainted 6.14.0-rc5+ #2\n  Call Trace:\n   msi_device_data_release+0x34/0x9c (unreliable)\n   release_nodes+0x64/0x13c\n   devres_release_all+0xc0/0x140\n   device_del+0x2d4/0x46c\n   pci_destroy_dev+0x5c/0x194\n   pci_hp_remove_devices+0x90/0x128\n   pci_hp_remove_devices+0x44/0x128\n   pnv_php_disable_slot+0x54/0xd4\n   power_write_file+0xf8/0x18c\n   pci_slot_attr_store+0x40/0x5c\n   sysfs_kf_write+0x64/0x78\n   kernfs_fop_write_iter+0x1b0/0x290\n   vfs_write+0x3bc/0x50c\n   ksys_write+0x84/0x140\n   system_call_exception+0x124/0x230\n   system_call_vectored_common+0x15c/0x2ec\n\n[bhelgaas: tidy comments]", "datePublished": "2025-08-22T18:31:21", "dateUpdated": "2025-11-03T18:31:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/398170b7fd0e0db2f8096df5206c75e5ff41415a", "https://git.kernel.org/stable/c/32173edf3fe2d447e14e5e3b299387c6f9602a88", "https://git.kernel.org/stable/c/28aa3cfce12487614219e7667ec84424e1f43227", "https://git.kernel.org/stable/c/1773c19fa55e944cdd2634e2d9e552f87f2d38d5", "https://git.kernel.org/stable/c/bbd302c4b79df10197ffa7270ca3aa572eeca33c", "https://git.kernel.org/stable/c/4668619092554e1b95c9a5ac2941ca47ba6d548a", "https://git.kernel.org/stable/c/8c1ad4af160691e157d688ad9619ced2df556aac", "https://git.kernel.org/stable/c/912e200240b6f9758f0b126e64a61c9227f4ad37", "https://nvd.nist.gov/vuln/detail/CVE-2025-38624", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38624"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "12bb3da4-2141-32ad-ac6a-6f0bfc990607", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <398170b7fd0e0db2f8096df5206c75e5ff41415a"}, {"id": "168ad2b5-157d-3d99-8d2d-b3814652bdb1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bbd302c4b79df10197ffa7270ca3aa572eeca33c"}, {"id": "2a898c60-3d49-33e3-bc5b-15499a7557fa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <912e200240b6f9758f0b126e64a61c9227f4ad37"}, {"id": "3e1878f7-362d-3b4d-87e8-6ef65784d2e6", "product": {"name": "Linux"}, "product_version": "patch: 6.15.10"}, {"id": "555c9121-2e03-357f-8554-264f10afdb83", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8c1ad4af160691e157d688ad9619ced2df556aac"}, {"id": "60c0ea8f-082e-317a-bffb-411a0d81441b", "product": {"name": "Linux"}, "product_version": "patch: 6.6.102"}, {"id": "7e700bfe-8581-36b2-9ee5-49611947e2c9", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "82514bf9-556a-383d-ac20-792c99760429", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <28aa3cfce12487614219e7667ec84424e1f43227"}, {"id": "904adf1f-0fe0-385b-8041-d7a088130f27", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <32173edf3fe2d447e14e5e3b299387c6f9602a88"}, {"id": "9acc1953-e9ec-3034-b6e1-cdad363bba6e", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "a8b02709-e397-3e45-8e4f-47ec08c7c782", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4668619092554e1b95c9a5ac2941ca47ba6d548a"}, {"id": "ae8c1a00-fadc-3b5c-b4a3-38835ee37b5e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1773c19fa55e944cdd2634e2d9e552f87f2d38d5"}, {"id": "ce23f163-4795-3827-8251-1551f65a7050", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}, {"id": "d27f93e5-1bb3-3518-ad3b-8fa9c25e2447", "product": {"name": "Linux"}, "product_version": "patch: 6.16.1"}, {"id": "d55cdf85-363a-3f75-8e7b-c0b4f97fbaad", "product": {"name": "Linux"}, "product_version": "patch: 6.12.42"}, {"id": "f38e8d3f-3220-35b7-a4bc-beb54841c8df", "product": {"name": "Linux"}, "product_version": "patch: 6.1.148"}, {"id": "f8d7a624-ec07-3a1b-a1c7-321185e1b545", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}], "enisaIdVendor": [{"id": "01d8b9e9-d88b-3be3-9eed-546ee0311e93", "vendor": {"name": "Linux"}}], "isExploited": false}