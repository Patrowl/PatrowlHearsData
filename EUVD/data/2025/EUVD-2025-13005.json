{"id": "EUVD-2025-13005", "enisaUuid": "64a8e6a2-944d-3025-85a8-4081c1b4348d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64/mm: fix incorrect file_map_count for non-leaf pmd/pud\n\nThe page table check trigger BUG_ON() unexpectedly when collapse hugepage:\n\n ------------[ cut here ]------------\n kernel BUG at mm/page_table_check.c:82!\n Internal error: Oops - BUG: 00000000f2000800 [#1] SMP\n Dumping ftrace buffer:\n    (ftrace buffer empty)\n Modules linked in:\n CPU: 6 PID: 68 Comm: khugepaged Not tainted 6.1.0-rc3+ #750\n Hardware name: linux,dummy-virt (DT)\n pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n pc : page_table_check_clear.isra.0+0x258/0x3f0\n lr : page_table_check_clear.isra.0+0x240/0x3f0\n[...]\n Call trace:\n  page_table_check_clear.isra.0+0x258/0x3f0\n  __page_table_check_pmd_clear+0xbc/0x108\n  pmdp_collapse_flush+0xb0/0x160\n  collapse_huge_page+0xa08/0x1080\n  hpage_collapse_scan_pmd+0xf30/0x1590\n  khugepaged_scan_mm_slot.constprop.0+0x52c/0xac8\n  khugepaged+0x338/0x518\n  kthread+0x278/0x2f8\n  ret_from_fork+0x10/0x20\n[...]\n\nSince pmd_user_accessible_page() doesn't check if a pmd is leaf, it\ndecrease file_map_count for a non-leaf pmd comes from collapse_huge_page().\nand so trigger BUG_ON() unexpectedly.\n\nFix this problem by using pmd_leaf() insteal of pmd_present() in\npmd_user_accessible_page(). Moreover, use pud_leaf() for\npud_user_accessible_page() too.", "datePublished": "2025-05-01T15:31:46", "dateUpdated": "2025-11-07T21:31:16", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-49778", "https://git.kernel.org/stable/c/2d458046df634088611d44fd77f45465e833ef78", "https://git.kernel.org/stable/c/5b47348fc0b18a78c96f8474cc90b7525ad1bbfe"], "aliases": ["CVE-2022-49778", "GHSA-54j7-px5q-9wrr"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "61296d29-1151-3fdd-862b-768357d9101b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "72f9c36c-d440-3cbf-b9eb-df177a2ca5c3", "product": {"name": "Linux"}, "product_version": "5.19"}, {"id": "790f0998-3c65-32aa-b3ad-41c992234f1b", "product": {"name": "Linux"}, "product_version": "42b2547137f5c974bb1bfd657c869fe96b96d86f <5b47348fc0b18a78c96f8474cc90b7525ad1bbfe"}, {"id": "8bbfd7b6-e221-3179-b154-562d7ebe1da1", "product": {"name": "Linux"}, "product_version": "42b2547137f5c974bb1bfd657c869fe96b96d86f <2d458046df634088611d44fd77f45465e833ef78"}, {"id": "b19c6ad2-b5be-3554-80f2-44cd09e8de14", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "cb68eb92-7a07-3ace-a8dd-82dfea5ad394", "product": {"name": "Linux"}, "product_version": "patch: 6.0.10"}], "enisaIdVendor": [{"id": "c812e0f5-9e63-3261-8467-b2ca82b9f159", "vendor": {"name": "Linux"}}], "isExploited": false}