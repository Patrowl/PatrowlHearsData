{"id": "EUVD-2025-32305", "enisaUuid": "e7660888-4456-3d39-b020-fe57c81e31aa", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niavf: Fix use-after-free in free_netdev\n\nWe do netif_napi_add() for all allocated q_vectors[], but potentially\ndo netif_napi_del() for part of them, then kfree q_vectors and leave\ninvalid pointers at dev->napi_list.\n\nReproducer:\n\n  [root@host ~]# cat repro.sh\n  #!/bin/bash\n\n  pf_dbsf=\"0000:41:00.0\"\n  vf0_dbsf=\"0000:41:02.0\"\n  g_pids=()\n\n  function do_set_numvf()\n  {\n      echo 2 >/sys/bus/pci/devices/${pf_dbsf}/sriov_numvfs\n      sleep $((RANDOM%3+1))\n      echo 0 >/sys/bus/pci/devices/${pf_dbsf}/sriov_numvfs\n      sleep $((RANDOM%3+1))\n  }\n\n  function do_set_channel()\n  {\n      local nic=$(ls -1 --indicator-style=none /sys/bus/pci/devices/${vf0_dbsf}/net/)\n      [ -z \"$nic\" ] && { sleep $((RANDOM%3)) ; return 1; }\n      ifconfig $nic 192.168.18.5 netmask 255.255.255.0\n      ifconfig $nic up\n      ethtool -L $nic combined 1\n      ethtool -L $nic combined 4\n      sleep $((RANDOM%3))\n  }\n\n  function on_exit()\n  {\n      local pid\n      for pid in \"${g_pids[@]}\"; do\n          kill -0 \"$pid\" &>/dev/null && kill \"$pid\" &>/dev/null\n      done\n      g_pids=()\n  }\n\n  trap \"on_exit; exit\" EXIT\n\n  while :; do do_set_numvf ; done &\n  g_pids+=($!)\n  while :; do do_set_channel ; done &\n  g_pids+=($!)\n\n  wait\n\nResult:\n\n[ 4093.900222] ==================================================================\n[ 4093.900230] BUG: KASAN: use-after-free in free_netdev+0x308/0x390\n[ 4093.900232] Read of size 8 at addr ffff88b4dc145640 by task repro.sh/6699\n[ 4093.900233]\n[ 4093.900236] CPU: 10 PID: 6699 Comm: repro.sh Kdump: loaded Tainted: G           O     --------- -t - 4.18.0 #1\n[ 4093.900238] Hardware name: Powerleader PR2008AL/H12DSi-N6, BIOS 2.0 04/09/2021\n[ 4093.900239] Call Trace:\n[ 4093.900244]  dump_stack+0x71/0xab\n[ 4093.900249]  print_address_description+0x6b/0x290\n[ 4093.900251]  ? free_netdev+0x308/0x390\n[ 4093.900252]  kasan_report+0x14a/0x2b0\n[ 4093.900254]  free_netdev+0x308/0x390\n[ 4093.900261]  iavf_remove+0x825/0xd20 [iavf]\n[ 4093.900265]  pci_device_remove+0xa8/0x1f0\n[ 4093.900268]  device_release_driver_internal+0x1c6/0x460\n[ 4093.900271]  pci_stop_bus_device+0x101/0x150\n[ 4093.900273]  pci_stop_and_remove_bus_device+0xe/0x20\n[ 4093.900275]  pci_iov_remove_virtfn+0x187/0x420\n[ 4093.900277]  ? pci_iov_add_virtfn+0xe10/0xe10\n[ 4093.900278]  ? pci_get_subsys+0x90/0x90\n[ 4093.900280]  sriov_disable+0xed/0x3e0\n[ 4093.900282]  ? bus_find_device+0x12d/0x1a0\n[ 4093.900290]  i40e_free_vfs+0x754/0x1210 [i40e]\n[ 4093.900298]  ? i40e_reset_all_vfs+0x880/0x880 [i40e]\n[ 4093.900299]  ? pci_get_device+0x7c/0x90\n[ 4093.900300]  ? pci_get_subsys+0x90/0x90\n[ 4093.900306]  ? pci_vfs_assigned.part.7+0x144/0x210\n[ 4093.900309]  ? __mutex_lock_slowpath+0x10/0x10\n[ 4093.900315]  i40e_pci_sriov_configure+0x1fa/0x2e0 [i40e]\n[ 4093.900318]  sriov_numvfs_store+0x214/0x290\n[ 4093.900320]  ? sriov_totalvfs_show+0x30/0x30\n[ 4093.900321]  ? __mutex_lock_slowpath+0x10/0x10\n[ 4093.900323]  ? __check_object_size+0x15a/0x350\n[ 4093.900326]  kernfs_fop_write+0x280/0x3f0\n[ 4093.900329]  vfs_write+0x145/0x440\n[ 4093.900330]  ksys_write+0xab/0x160\n[ 4093.900332]  ? __ia32_sys_read+0xb0/0xb0\n[ 4093.900334]  ? fput_many+0x1a/0x120\n[ 4093.900335]  ? filp_close+0xf0/0x130\n[ 4093.900338]  do_syscall_64+0xa0/0x370\n[ 4093.900339]  ? page_fault+0x8/0x30\n[ 4093.900341]  entry_SYSCALL_64_after_hwframe+0x65/0xca\n[ 4093.900357] RIP: 0033:0x7f16ad4d22c0\n[ 4093.900359] Code: 73 01 c3 48 8b 0d d8 cb 2c 00 f7 d8 64 89 01 48 83 c8 ff c3 66 0f 1f 44 00 00 83 3d 89 24 2d 00 00 75 10 b8 01 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 31 c3 48 83 ec 08 e8 fe dd 01 00 48 89 04 24\n[ 4093.900360] RSP: 002b:00007ffd6491b7f8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001\n[ 4093.900362] RAX: ffffffffffffffda RBX: 0000000000000002 RCX: 00007f16ad4d22c0\n[ 4093.900363] RDX: 0000000000000002 RSI: 0000000001a41408 RDI: 0000000000000001\n[ 4093.900364] RBP: 0000000001a41408 R08: 00007f16ad7a1780 R09: 00007f16ae1f2700\n[ 4093.9003\n---truncated---", "datePublished": "2025-10-04T15:17:01", "dateUpdated": "2025-10-04T15:17:01", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53556", "https://git.kernel.org/stable/c/17046107ca15d7571551539d94e76aba2bf71fd3", "https://git.kernel.org/stable/c/345c44e18cc10cded85cb9134830e1684495c866", "https://git.kernel.org/stable/c/5f4fa1672d98fe99d2297b03add35346f1685d6b", "https://git.kernel.org/stable/c/8d781a9c53034813c3194b7d94409c7d24ac73eb", "https://git.kernel.org/stable/c/a4635f190f332304db4a49e827ece790b804b5db", "https://git.kernel.org/stable/c/ca12b98e04b5d1902ac08fe826d3500cb4b6e891"], "aliases": ["CVE-2023-53556", "GHSA-f95c-c99f-h2mq"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "027a4c6c-807e-3d31-97c1-0aa055e4a4ed", "product": {"name": "Linux"}, "product_version": "patch: 6.4.7"}, {"id": "0291a9fe-8c8a-393d-9688-3c466cd481aa", "product": {"name": "Linux"}, "product_version": "patch: 5.4.251"}, {"id": "02c063c1-5574-3a10-8e54-bd83cbf11c27", "product": {"name": "Linux"}, "product_version": "patch: 6.1.42"}, {"id": "073afc40-56f6-3e64-8bbd-c65ca0ff9311", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <17046107ca15d7571551539d94e76aba2bf71fd3"}, {"id": "16d3a4db-e943-3c6b-8a56-a2979866f71e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.123"}, {"id": "229d4d8f-1a14-3784-bedf-a366572b6c65", "product": {"name": "Linux"}, "product_version": "3.14"}, {"id": "56f072a2-1721-3618-bbcb-b378ba9c88ee", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "6e48f629-fd2f-3c64-afb8-f72b818ccd29", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <ca12b98e04b5d1902ac08fe826d3500cb4b6e891"}, {"id": "72496ca9-09d1-3e94-9a23-769fead7ce6d", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <5f4fa1672d98fe99d2297b03add35346f1685d6b"}, {"id": "7b6d5cfe-01e8-3807-9906-79274c8ac793", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "94f44e47-7331-34ef-9984-61deecb9b06f", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <a4635f190f332304db4a49e827ece790b804b5db"}, {"id": "aaf33db4-9a8e-3682-9e4e-452317307c77", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <8d781a9c53034813c3194b7d94409c7d24ac73eb"}, {"id": "d00fa880-50c3-3e14-adb5-47befac45670", "product": {"name": "Linux"}, "product_version": "5eae00c57f5e42bf201023471917da213c4946d6 <345c44e18cc10cded85cb9134830e1684495c866"}, {"id": "f3a1b16c-a7ff-3bc1-8223-055c2c569f3b", "product": {"name": "Linux"}, "product_version": "patch: 5.10.188"}], "enisaIdVendor": [{"id": "08132b0e-161e-30fc-89e3-757b18ab94b1", "vendor": {"name": "Linux"}}], "isExploited": false}