{"id": "EUVD-2025-34590", "enisaUuid": "0bf6aa19-8c36-33f5-a4e4-d20e193b4f42", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: hci_event: Fix UAF in hci_acl_create_conn_sync\n\nThis fixes the following UFA in hci_acl_create_conn_sync where a\nconnection still pending is command submission (conn->state == BT_OPEN)\nmaybe freed, also since this also can happen with the likes of\nhci_le_create_conn_sync fix it as well:\n\nBUG: KASAN: slab-use-after-free in hci_acl_create_conn_sync+0x5ef/0x790 net/bluetooth/hci_sync.c:6861\nWrite of size 2 at addr ffff88805ffcc038 by task kworker/u11:2/9541\n\nCPU: 1 UID: 0 PID: 9541 Comm: kworker/u11:2 Not tainted 6.16.0-rc7 #3 PREEMPT(full)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014\nWorkqueue: hci3 hci_cmd_sync_work\nCall Trace:\n <TASK>\n dump_stack_lvl+0x189/0x250 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:378 [inline]\n print_report+0xca/0x230 mm/kasan/report.c:480\n kasan_report+0x118/0x150 mm/kasan/report.c:593\n hci_acl_create_conn_sync+0x5ef/0x790 net/bluetooth/hci_sync.c:6861\n hci_cmd_sync_work+0x210/0x3a0 net/bluetooth/hci_sync.c:332\n process_one_work kernel/workqueue.c:3238 [inline]\n process_scheduled_works+0xae1/0x17b0 kernel/workqueue.c:3321\n worker_thread+0x8a0/0xda0 kernel/workqueue.c:3402\n kthread+0x70e/0x8a0 kernel/kthread.c:464\n ret_from_fork+0x3fc/0x770 arch/x86/kernel/process.c:148\n ret_from_fork_asm+0x1a/0x30 home/kwqcheii/source/fuzzing/kernel/kasan/linux-6.16-rc7/arch/x86/entry/entry_64.S:245\n </TASK>\n\nAllocated by task 123736:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n poison_kmalloc_redzone mm/kasan/common.c:377 [inline]\n __kasan_kmalloc+0x93/0xb0 mm/kasan/common.c:394\n kasan_kmalloc include/linux/kasan.h:260 [inline]\n __kmalloc_cache_noprof+0x230/0x3d0 mm/slub.c:4359\n kmalloc_noprof include/linux/slab.h:905 [inline]\n kzalloc_noprof include/linux/slab.h:1039 [inline]\n __hci_conn_add+0x233/0x1b30 net/bluetooth/hci_conn.c:939\n hci_conn_add_unset net/bluetooth/hci_conn.c:1051 [inline]\n hci_connect_acl+0x16c/0x4e0 net/bluetooth/hci_conn.c:1634\n pair_device+0x418/0xa70 net/bluetooth/mgmt.c:3556\n hci_mgmt_cmd+0x9c9/0xef0 net/bluetooth/hci_sock.c:1719\n hci_sock_sendmsg+0x6ca/0xef0 net/bluetooth/hci_sock.c:1839\n sock_sendmsg_nosec net/socket.c:712 [inline]\n __sock_sendmsg+0x219/0x270 net/socket.c:727\n sock_write_iter+0x258/0x330 net/socket.c:1131\n new_sync_write fs/read_write.c:593 [inline]\n vfs_write+0x54b/0xa90 fs/read_write.c:686\n ksys_write+0x145/0x250 fs/read_write.c:738\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nFreed by task 103680:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n kasan_save_free_info+0x46/0x50 mm/kasan/generic.c:576\n poison_slab_object mm/kasan/common.c:247 [inline]\n __kasan_slab_free+0x62/0x70 mm/kasan/common.c:264\n kasan_slab_free include/linux/kasan.h:233 [inline]\n slab_free_hook mm/slub.c:2381 [inline]\n slab_free mm/slub.c:4643 [inline]\n kfree+0x18e/0x440 mm/slub.c:4842\n device_release+0x9c/0x1c0\n kobject_cleanup lib/kobject.c:689 [inline]\n kobject_release lib/kobject.c:720 [inline]\n kref_put include/linux/kref.h:65 [inline]\n kobject_put+0x22b/0x480 lib/kobject.c:737\n hci_conn_cleanup net/bluetooth/hci_conn.c:175 [inline]\n hci_conn_del+0x8ff/0xcb0 net/bluetooth/hci_conn.c:1173\n hci_conn_complete_evt+0x3c7/0x1040 net/bluetooth/hci_event.c:3199\n hci_event_func net/bluetooth/hci_event.c:7477 [inline]\n hci_event_packet+0x7e0/0x1200 net/bluetooth/hci_event.c:7531\n hci_rx_work+0x46a/0xe80 net/bluetooth/hci_core.c:4070\n process_one_work kernel/workqueue.c:3238 [inline]\n process_scheduled_works+0xae1/0x17b0 kernel/workqueue.c:3321\n worker_thread+0x8a0/0xda0 kernel/workqueue.c:3402\n kthread+0x70e/0x8a0 kernel/kthread.c:464\n ret_from_fork+0x3fc/0x770 arch/x86/kernel/process.c:148\n ret_from_fork_asm+0x1a/0x30 home/kwqcheii/sour\n---truncated---", "datePublished": "2025-10-15T09:30:17", "dateUpdated": "2025-10-15T09:30:17", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/6243bda271a628c48875e3e473206e7f584892ce", "https://git.kernel.org/stable/c/bcce99f613163a43de24674b717e7a6c135fc879", "https://git.kernel.org/stable/c/484c7d571a3d1b3fd298fa691b660438c4548a53", "https://git.kernel.org/stable/c/a78fd4fc5694ecb3b97deb2ad9eaebd67b4d2b08", "https://git.kernel.org/stable/c/9e622804d57e2d08f0271200606bd1270f75126f", "https://nvd.nist.gov/vuln/detail/CVE-2025-39982"], "aliases": ["CVE-2025-39982"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "0d7aa8cc-b943-32a3-ab0a-a7adb660fd84", "product": {"name": "Linux"}, "product_version": "aef2aa4fa98e18ea5d9345bf777ee698c8598728 <484c7d571a3d1b3fd298fa691b660438c4548a53"}, {"id": "3ecfede4-5b48-34be-ad02-ad0f0dfd1827", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5582f805-b6d8-3d70-a80a-f4084a7c2ded", "product": {"name": "Linux"}, "product_version": "aef2aa4fa98e18ea5d9345bf777ee698c8598728 <6243bda271a628c48875e3e473206e7f584892ce"}, {"id": "6280c554-6886-3c55-98ee-89587a5d6595", "product": {"name": "Linux"}, "product_version": "aef2aa4fa98e18ea5d9345bf777ee698c8598728 <a78fd4fc5694ecb3b97deb2ad9eaebd67b4d2b08"}, {"id": "7d369f44-38c5-3e71-8004-2a93bbd0b76a", "product": {"name": "Linux"}, "product_version": "patch: 6.12.50"}, {"id": "bb6c1b61-cce3-3d22-9640-859e28867bb7", "product": {"name": "Linux"}, "product_version": "patch: 6.6.109"}, {"id": "c25ea965-f6d7-3892-a5bf-df8b884e550f", "product": {"name": "Linux"}, "product_version": "aef2aa4fa98e18ea5d9345bf777ee698c8598728 <9e622804d57e2d08f0271200606bd1270f75126f"}, {"id": "c4c9dd98-8f83-395b-a451-fd9be219e111", "product": {"name": "Linux"}, "product_version": "5.18"}, {"id": "c815377e-ec34-3de8-b992-32da09e127b6", "product": {"name": "Linux"}, "product_version": "aef2aa4fa98e18ea5d9345bf777ee698c8598728 <bcce99f613163a43de24674b717e7a6c135fc879"}, {"id": "d2d75172-1cf7-3cf6-940d-028d516d1668", "product": {"name": "Linux"}, "product_version": "patch: 6.16.10"}, {"id": "ef60f041-9068-361d-9bbf-9f8f8b47123e", "product": {"name": "Linux"}, "product_version": "patch: 6.1.155"}, {"id": "f0927fa8-1a58-39db-b6e8-29deca551ed1", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}], "enisaIdVendor": [{"id": "e6192225-2009-37ba-afe0-1815b24d5391", "vendor": {"name": "Linux"}}], "isExploited": false}