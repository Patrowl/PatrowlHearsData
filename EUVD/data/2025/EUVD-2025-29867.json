{"id": "EUVD-2025-29867", "enisaUuid": "540ce236-4ba0-30a4-9c11-74603f9869e8", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: cpumap: Fix memory leak in cpu_map_update_elem\n\nSyzkaller reported a memory leak as follows:\n\nBUG: memory leak\nunreferenced object 0xff110001198ef748 (size 192):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 32 bytes):\n    00 00 00 00 4a 19 00 00 80 ad e3 e4 fe ff c0 00  ....J...........\n    00 b2 d3 0c 01 00 11 ff 28 f5 8e 19 01 00 11 ff  ........(.......\n  backtrace:\n    [<ffffffffadd28087>] __cpu_map_entry_alloc+0xf7/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nBUG: memory leak\nunreferenced object 0xff110001198ef528 (size 192):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 32 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [<ffffffffadd281f0>] __cpu_map_entry_alloc+0x260/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nBUG: memory leak\nunreferenced object 0xff1100010fd93d68 (size 8):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 8 bytes):\n    00 00 00 00 00 00 00 00                          ........\n  backtrace:\n    [<ffffffffade5db3e>] kvmalloc_node+0x11e/0x170\n    [<ffffffffadd28280>] __cpu_map_entry_alloc+0x2f0/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nIn the cpu_map_update_elem flow, when kthread_stop is called before\ncalling the threadfn of rcpu->kthread, since the KTHREAD_SHOULD_STOP bit\nof kthread has been set by kthread_stop, the threadfn of rcpu->kthread\nwill never be executed, and rcpu->refcnt will never be 0, which will\nlead to the allocated rcpu, rcpu->queue and rcpu->queue->queue cannot be\nreleased.\n\nCalling kthread_stop before executing kthread's threadfn will return\n-EINTR. We can complete the release of memory resources in this state.", "datePublished": "2025-09-18T18:30:28", "dateUpdated": "2025-12-11T15:30:30", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53441", "https://git.kernel.org/stable/c/4369016497319a9635702da010d02af1ebb1849d", "https://git.kernel.org/stable/c/a957ac8e0b5ffb5797382a6adbafd005a5f72851", "https://git.kernel.org/stable/c/b11a9b4f28cb6ff69ef7e69809e5f7fffeac9030", "https://git.kernel.org/stable/c/d26299f50f5ea8f0aeb5d49e659c31f64233c816"], "aliases": ["CVE-2023-53441", "GHSA-67mx-9px6-mhwv"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "16c6e969-1ed9-353e-a751-6f9d1be66a55", "product": {"name": "Linux"}, "product_version": "4.15"}, {"id": "292803ab-b71c-3b37-97d3-b15e3dba0665", "product": {"name": "Linux"}, "product_version": "patch: 6.4.5"}, {"id": "48affdcd-9f1f-39e7-8804-1dc68332d0d8", "product": {"name": "Linux"}, "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <a957ac8e0b5ffb5797382a6adbafd005a5f72851"}, {"id": "6c6d93dc-bf6b-3914-99b7-70903dd194d0", "product": {"name": "Linux"}, "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <d26299f50f5ea8f0aeb5d49e659c31f64233c816"}, {"id": "936a91ac-6939-36fc-844a-8969193f5dc3", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ab551aaa-b506-3d8d-9baf-09465d005324", "product": {"name": "Linux"}, "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <4369016497319a9635702da010d02af1ebb1849d"}, {"id": "b7036e04-640a-3362-8fab-343514ad2b2d", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "ba44dfbf-5d82-3f7b-b76a-09309620f559", "product": {"name": "Linux"}, "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <b11a9b4f28cb6ff69ef7e69809e5f7fffeac9030"}, {"id": "d07ba437-7497-3ada-a5f1-c9a0b40a3d58", "product": {"name": "Linux"}, "product_version": "patch: 6.1.40"}, {"id": "f757c6b1-2c27-336f-abf7-8dad737a547e", "product": {"name": "Linux"}, "product_version": "patch: 5.15.121"}], "enisaIdVendor": [{"id": "4edbf129-3a0c-31fe-9686-92f7e4505f04", "vendor": {"name": "Linux"}}], "isExploited": false}