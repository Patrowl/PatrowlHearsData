{"id": "EUVD-2025-201199", "enisaUuid": "1c6db859-3b3f-3eae-b025-e0eb782b364e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: fix race condition in mptcp_schedule_work()\n\nsyzbot reported use-after-free in mptcp_schedule_work() [1]\n\nIssue here is that mptcp_schedule_work() schedules a work,\nthen gets a refcount on sk->sk_refcnt if the work was scheduled.\nThis refcount will be released by mptcp_worker().\n\n[A] if (schedule_work(...)) {\n[B]     sock_hold(sk);\n        return true;\n    }\n\nProblem is that mptcp_worker() can run immediately and complete before [B]\n\nWe need instead :\n\n    sock_hold(sk);\n    if (schedule_work(...))\n        return true;\n    sock_put(sk);\n\n[1]\nrefcount_t: addition on 0; use-after-free.\n WARNING: CPU: 1 PID: 29 at lib/refcount.c:25 refcount_warn_saturate+0xfa/0x1d0 lib/refcount.c:25\nCall Trace:\n <TASK>\n __refcount_add include/linux/refcount.h:-1 [inline]\n  __refcount_inc include/linux/refcount.h:366 [inline]\n  refcount_inc include/linux/refcount.h:383 [inline]\n  sock_hold include/net/sock.h:816 [inline]\n  mptcp_schedule_work+0x164/0x1a0 net/mptcp/protocol.c:943\n  mptcp_tout_timer+0x21/0xa0 net/mptcp/protocol.c:2316\n  call_timer_fn+0x17e/0x5f0 kernel/time/timer.c:1747\n  expire_timers kernel/time/timer.c:1798 [inline]\n  __run_timers kernel/time/timer.c:2372 [inline]\n  __run_timer_base+0x648/0x970 kernel/time/timer.c:2384\n  run_timer_base kernel/time/timer.c:2393 [inline]\n  run_timer_softirq+0xb7/0x180 kernel/time/timer.c:2403\n  handle_softirqs+0x22f/0x710 kernel/softirq.c:622\n  __do_softirq kernel/softirq.c:656 [inline]\n  run_ktimerd+0xcf/0x190 kernel/softirq.c:1138\n  smpboot_thread_fn+0x542/0xa60 kernel/smpboot.c:160\n  kthread+0x711/0x8a0 kernel/kthread.c:463\n  ret_from_fork+0x4bc/0x870 arch/x86/kernel/process.c:158\n  ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:245", "datePublished": "2025-12-04T18:30:53", "dateUpdated": "2025-12-07T00:30:56", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/8f9ba1a99a89feef9b5867c15a0141a97e893309", "https://git.kernel.org/stable/c/ac28dfddedf6f209190950fc71bcff65ec4ab47b", "https://git.kernel.org/stable/c/3fc7723ed01d1130d4bf7063c50e0af60ecccbb4", "https://git.kernel.org/stable/c/035bca3f017ee9dea3a5a756e77a6f7138cc6eea", "https://nvd.nist.gov/vuln/detail/CVE-2025-40258", "https://git.kernel.org/stable/c/f865e6595acf33083168db76921e66ace8bf0e5b", "https://git.kernel.org/stable/c/99908e2d601236842d705d5fd04fb349577316f5", "https://git.kernel.org/stable/c/db4f7968a75250ca6c4ed70d0a78beabb2dcee18"], "aliases": ["CVE-2025-40258"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0e5861ab-f551-3079-94e4-380de7a89819", "product": {"name": "Linux"}, "product_version": "patch: 6.12.60"}, {"id": "2086575d-be81-3eb5-b637-83c817d21258", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "296f1056-4aa6-3d72-805e-5efaad21aed4", "product": {"name": "Linux"}, "product_version": "patch: 6.17.10"}, {"id": "2dd0ef8a-6522-3ed3-b536-6061a679bcd6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2ede4b43-e29d-3515-8624-2c067343cd56", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "2f921f54-3b33-3204-884a-6b9e70319a04", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <3fc7723ed01d1130d4bf7063c50e0af60ecccbb4"}, {"id": "49a128e1-ff06-3e7c-bd4a-2908e07ef6e1", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <ac28dfddedf6f209190950fc71bcff65ec4ab47b"}, {"id": "4fe2d512-8d57-3f0a-8fe0-941cb6ad582a", "product": {"name": "Linux"}, "product_version": "patch: 6.6.118"}, {"id": "860a1499-de56-3e4c-9234-822c6787e369", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "9548480e-9927-3bb6-b6e6-25a5faa914c3", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <db4f7968a75250ca6c4ed70d0a78beabb2dcee18"}, {"id": "a783ea85-bb7d-34fa-a942-550292c10542", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <8f9ba1a99a89feef9b5867c15a0141a97e893309"}, {"id": "a81e0add-0ec8-3cfb-95e0-d41538395a25", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "be9dfdc4-2bf5-3f1a-baa5-39d559515fd2", "product": {"name": "Linux"}, "product_version": "5.7"}, {"id": "c94abaf4-9319-3762-bc7f-c1a4fc0bc301", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <99908e2d601236842d705d5fd04fb349577316f5"}, {"id": "d7d8436b-14d3-32ea-879a-21e5df57c84f", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <035bca3f017ee9dea3a5a756e77a6f7138cc6eea"}, {"id": "f8635f02-c4ee-394a-b1f8-ba1bc54d2455", "product": {"name": "Linux"}, "product_version": "3b1d6210a9577369103330b0d802b0bf74b65e7f <f865e6595acf33083168db76921e66ace8bf0e5b"}], "enisaIdVendor": [{"id": "15eeff53-6482-363b-a2e9-6d6bfd4cccc6", "vendor": {"name": "Linux"}}], "isExploited": false}