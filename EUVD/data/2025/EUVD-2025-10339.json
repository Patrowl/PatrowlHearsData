{"id": "EUVD-2025-10339", "enisaUuid": "b4bfcd63-31e3-35aa-ac4f-cb8b16bdfaab", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/hns: Fix soft lockup during bt pages loop\n\nDriver runs a for-loop when allocating bt pages and mapping them with\nbuffer pages. When a large buffer (e.g. MR over 100GB) is being allocated,\nit may require a considerable loop count. This will lead to soft lockup:\n\n        watchdog: BUG: soft lockup - CPU#27 stuck for 22s!\n        ...\n        Call trace:\n         hem_list_alloc_mid_bt+0x124/0x394 [hns_roce_hw_v2]\n         hns_roce_hem_list_request+0xf8/0x160 [hns_roce_hw_v2]\n         hns_roce_mtr_create+0x2e4/0x360 [hns_roce_hw_v2]\n         alloc_mr_pbl+0xd4/0x17c [hns_roce_hw_v2]\n         hns_roce_reg_user_mr+0xf8/0x190 [hns_roce_hw_v2]\n         ib_uverbs_reg_mr+0x118/0x290\n\n        watchdog: BUG: soft lockup - CPU#35 stuck for 23s!\n        ...\n        Call trace:\n         hns_roce_hem_list_find_mtt+0x7c/0xb0 [hns_roce_hw_v2]\n         mtr_map_bufs+0xc4/0x204 [hns_roce_hw_v2]\n         hns_roce_mtr_create+0x31c/0x3c4 [hns_roce_hw_v2]\n         alloc_mr_pbl+0xb0/0x160 [hns_roce_hw_v2]\n         hns_roce_reg_user_mr+0x108/0x1c0 [hns_roce_hw_v2]\n         ib_uverbs_reg_mr+0x120/0x2bc\n\nAdd a cond_resched() to fix soft lockup during these loops. In order not\nto affect the allocation performance of normal-size buffer, set the loop\ncount of a 100GB MR as the threshold to call cond_resched().", "datePublished": "2025-04-08T08:18:00", "dateUpdated": "2025-11-03T19:40:55", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-22010", "https://git.kernel.org/stable/c/13a52f6c9ff99f7d88f81da535cb4e85eade662b", "https://git.kernel.org/stable/c/25655580136de59ec89f09089dd28008ea440fc9", "https://git.kernel.org/stable/c/4104b0023ff66b5df900d23dbf38310893deca79", "https://git.kernel.org/stable/c/975355faba56c0751292ed15a90c3e2c7dc0aad6", "https://git.kernel.org/stable/c/9ab20fec7a1ce3057ad86afd27bfd08420b7cd11", "https://git.kernel.org/stable/c/461eb4ddede266df8f181f578732bb01742c3fd6", "https://git.kernel.org/stable/c/efe544462fc0b499725364f90bd0f8bbf16f861a", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"], "aliases": ["CVE-2025-22010", "GHSA-c2cr-w322-fppq"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1c8334b4-c2f7-3a74-b161-d6bfaf8a365b", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <975355faba56c0751292ed15a90c3e2c7dc0aad6"}, {"id": "1deac05e-4c28-30a7-84a1-f68621c38a74", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <4104b0023ff66b5df900d23dbf38310893deca79"}, {"id": "2d81597d-f3a0-3986-b5a4-7cf83a976ec4", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <13a52f6c9ff99f7d88f81da535cb4e85eade662b"}, {"id": "2f1fcab6-9608-3a51-8f4c-febe2e63c6a2", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <9ab20fec7a1ce3057ad86afd27bfd08420b7cd11"}, {"id": "343c7cb7-b18f-3506-a4d9-4e88f97c2909", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "38450a6c-ee4e-32ae-ba1e-21b2671d1533", "product": {"name": "Linux"}, "product_version": "patch: 6.1.132"}, {"id": "42e15f09-70ec-3947-841a-15c99cb47356", "product": {"name": "Linux"}, "product_version": "patch: 6.14"}, {"id": "95747f22-a41d-305e-b96f-516560de6afb", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <461eb4ddede266df8f181f578732bb01742c3fd6"}, {"id": "a0c3b0df-7f44-3dcf-a95c-c33ca943b804", "product": {"name": "Linux"}, "product_version": "patch: 6.13.9"}, {"id": "bfe82c8b-98a0-3eb5-96da-80747032cd74", "product": {"name": "Linux"}, "product_version": "patch: 5.15.180"}, {"id": "cbd1e348-7851-39eb-a9aa-050a017d9eea", "product": {"name": "Linux"}, "product_version": "patch: 6.12.21"}, {"id": "dc2323c7-7126-3eb4-a813-32526c0f355b", "product": {"name": "Linux"}, "product_version": "patch: 6.6.85"}, {"id": "e10b0595-d5a4-39d0-bb42-df70f361c4c2", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <efe544462fc0b499725364f90bd0f8bbf16f861a"}, {"id": "eb5269ff-0a7c-34d9-bdc0-5aa44227c0b4", "product": {"name": "Linux"}, "product_version": "5.3"}, {"id": "ef5dec41-cfe5-31cb-bfb6-777f29f4a122", "product": {"name": "Linux"}, "product_version": "38389eaa4db192648916464b60f6086d6bbaa6de <25655580136de59ec89f09089dd28008ea440fc9"}, {"id": "faead0a3-bce7-31b5-909c-84f4f25bd0b7", "product": {"name": "Linux"}, "product_version": "patch: 5.10.236"}], "enisaIdVendor": [{"id": "c00672a5-97a8-32ab-b435-3d80c380394e", "vendor": {"name": "Linux"}}], "isExploited": false}