{"id": "EUVD-2025-201226", "enisaUuid": "ffac4132-d6cf-3d14-9ac0-2cff5797d693", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: clear extent cache after moving/defragmenting extents\n\nThe extent map cache can become stale when extents are moved or\ndefragmented, causing subsequent operations to see outdated extent flags. \nThis triggers a BUG_ON in ocfs2_refcount_cal_cow_clusters().\n\nThe problem occurs when:\n1. copy_file_range() creates a reflinked extent with OCFS2_EXT_REFCOUNTED\n2. ioctl(FITRIM) triggers ocfs2_move_extents()\n3. __ocfs2_move_extents_range() reads and caches the extent (flags=0x2)\n4. ocfs2_move_extent()/ocfs2_defrag_extent() calls __ocfs2_move_extent()\n   which clears OCFS2_EXT_REFCOUNTED flag on disk (flags=0x0)\n5. The extent map cache is not invalidated after the move\n6. Later write() operations read stale cached flags (0x2) but disk has\n   updated flags (0x0), causing a mismatch\n7. BUG_ON(!(rec->e_flags & OCFS2_EXT_REFCOUNTED)) triggers\n\nFix by clearing the extent map cache after each extent move/defrag\noperation in __ocfs2_move_extents_range().  This ensures subsequent\noperations read fresh extent data from disk.", "datePublished": "2025-12-04T15:31:23", "dateUpdated": "2025-12-04T15:31:23", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/93166bc53c0e3587058327a4121daea34b4fecd5", "https://git.kernel.org/stable/c/a7ee72286efba1d407c6f15a0528e43593fb7007", "https://git.kernel.org/stable/c/93b1ab422f1966b71561158e1aedce4ec100f357", "https://git.kernel.org/stable/c/e92af7737a94a729225d2a5d180eaaa77fe0bbc1", "https://git.kernel.org/stable/c/aa6a21409dd6221bb268b56bb410e031c632ff9a", "https://git.kernel.org/stable/c/bb69928ed578f881e68d26aaf1a8f6e7faab3b44", "https://git.kernel.org/stable/c/a21750df2f6169af6e039a3bb4893d6c9564e48d", "https://git.kernel.org/stable/c/78a63493f8e352296dbc7cb7b3f4973105e8679e", "https://nvd.nist.gov/vuln/detail/CVE-2025-40233"], "aliases": ["CVE-2025-40233"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "032a2c68-2c1d-30fc-ad57-9f0b60171caa", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "05d0e57c-b783-3e0e-a340-6b291be8615f", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <a7ee72286efba1d407c6f15a0528e43593fb7007"}, {"id": "380fc06a-be38-3292-b42d-df4078c09796", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <93166bc53c0e3587058327a4121daea34b4fecd5"}, {"id": "3c742e19-755c-3b3d-a151-a424d66892d5", "product": {"name": "Linux"}, "product_version": "patch: 6.6.115"}, {"id": "471d5177-e34f-3f40-a673-b83a24503b0c", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <78a63493f8e352296dbc7cb7b3f4973105e8679e"}, {"id": "62fe1929-51c3-3865-8aaa-e8edb25be1b1", "product": {"name": "Linux"}, "product_version": "patch: 6.1.158"}, {"id": "853c6a1e-1ad5-3c90-97fe-d1e802081a9e", "product": {"name": "Linux"}, "product_version": "patch: 6.17.6"}, {"id": "93fad3c0-9813-3d05-8d95-3f9e708878a6", "product": {"name": "Linux"}, "product_version": "patch: 6.12.56"}, {"id": "954ce373-1cc3-3e5d-977d-cd57b6914ccc", "product": {"name": "Linux"}, "product_version": "patch: 5.15.196"}, {"id": "a6bbf453-8a5c-3efd-9d15-bb728944f83b", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <aa6a21409dd6221bb268b56bb410e031c632ff9a"}, {"id": "a9562993-7f41-3ba5-9cae-8a793c9842a7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "ab6f2341-5091-3892-96b9-53a9c6559db9", "product": {"name": "Linux"}, "product_version": "3.0"}, {"id": "b8245715-ba49-3b80-8b57-86c3f2e2419b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c1b8ea0a-840a-36e0-8363-5a654d4091a1", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "d54977e7-e3db-39ab-ad3a-d313e233bd04", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <bb69928ed578f881e68d26aaf1a8f6e7faab3b44"}, {"id": "e7931b29-7a99-347b-919b-44968df8f484", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <93b1ab422f1966b71561158e1aedce4ec100f357"}, {"id": "ea14beaa-e580-3c4c-b0d4-c32593d46c73", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <a21750df2f6169af6e039a3bb4893d6c9564e48d"}, {"id": "ff50d0d6-5147-3167-98d5-20d6b2a89fc2", "product": {"name": "Linux"}, "product_version": "53069d4e76954e2e63c1b3c501051c6fbcf7298c <e92af7737a94a729225d2a5d180eaaa77fe0bbc1"}], "enisaIdVendor": [{"id": "d544e3d2-df7c-300e-8cef-1039591c8670", "vendor": {"name": "Linux"}}], "isExploited": false}