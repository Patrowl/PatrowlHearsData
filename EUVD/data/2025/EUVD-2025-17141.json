{"id": "EUVD-2025-17141", "enisaUuid": "ea0b74fc-5b80-3be7-b644-10b4556b5cf4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsch_hfsc: Fix qlen accounting bug when using peek in hfsc_enqueue()\n\nWhen enqueuing the first packet to an HFSC class, hfsc_enqueue() calls the\nchild qdisc's peek() operation before incrementing sch->q.qlen and\nsch->qstats.backlog. If the child qdisc uses qdisc_peek_dequeued(), this may\ntrigger an immediate dequeue and potential packet drop. In such cases,\nqdisc_tree_reduce_backlog() is called, but the HFSC qdisc's qlen and backlog\nhave not yet been updated, leading to inconsistent queue accounting. This\ncan leave an empty HFSC class in the active list, causing further\nconsequences like use-after-free.\n\nThis patch fixes the bug by moving the increment of sch->q.qlen and\nsch->qstats.backlog before the call to the child qdisc's peek() operation.\nThis ensures that queue length and backlog are always accurate when packet\ndrops or dequeues are triggered during the peek.", "datePublished": "2025-06-06T15:30:49", "dateUpdated": "2025-12-16T21:30:50", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1034e3310752e8675e313f7271b348914008719a", "https://git.kernel.org/stable/c/f9f593e34d2fb67644372c8f7b033bdc622ad228", "https://git.kernel.org/stable/c/89c301e929a0db14ebd94b4d97764ce1d6981653", "https://git.kernel.org/stable/c/f1dde3eb17dc1b8bd07aed00004b1e05fc87a3d4", "https://git.kernel.org/stable/c/93c276942e75de0e5bc91576300d292e968f5a02", "https://git.kernel.org/stable/c/49b21795b8e5654a7df3d910a12e1060da4c04cf", "https://git.kernel.org/stable/c/3f3a22eebbc32b4fa8ce9c1d5f9db214b45b9335", "https://git.kernel.org/stable/c/3f981138109f63232a5fb7165938d4c945cc1b9d", "https://nvd.nist.gov/vuln/detail/CVE-2025-38000", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38000"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "14ea3491-3414-3f40-845c-e470d6b0d989", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <1034e3310752e8675e313f7271b348914008719a"}, {"id": "19b8d891-8774-3e24-b667-7f58f00e393a", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <3f981138109f63232a5fb7165938d4c945cc1b9d"}, {"id": "2853ae0c-d97d-3380-a0fa-e2b70f1340f6", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "438385c2-e984-393b-a36a-af096d15deb5", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <3f3a22eebbc32b4fa8ce9c1d5f9db214b45b9335"}, {"id": "4e60b127-117c-3b4c-8746-43f7e10a35eb", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "4ffb48fa-07ad-3169-963a-72039d29b471", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <49b21795b8e5654a7df3d910a12e1060da4c04cf"}, {"id": "55d9f739-37ef-375e-b799-eb8bda12199e", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <93c276942e75de0e5bc91576300d292e968f5a02"}, {"id": "69d3f467-8a16-3ece-8d1a-d6f44247b471", "product": {"name": "Linux"}, "product_version": "patch: 6.1.141"}, {"id": "97ba02c2-3860-36d3-8d20-0417b8ebc54f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.185"}, {"id": "9dd8110e-105f-370c-84c2-c2fb74056fd6", "product": {"name": "Linux"}, "product_version": "patch: 6.12.31"}, {"id": "a3eb5a04-9cbd-3507-b98e-3cb7accc0cc2", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <f1dde3eb17dc1b8bd07aed00004b1e05fc87a3d4"}, {"id": "c1749155-db16-3cfa-903c-9b65c3e31b06", "product": {"name": "Linux"}, "product_version": "patch: 6.14.9"}, {"id": "d347fe0f-6e1f-3c23-8366-3cb7be4f67ab", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <89c301e929a0db14ebd94b4d97764ce1d6981653"}, {"id": "ef3db439-e7c8-3a6f-9ef4-3c5712877f61", "product": {"name": "Linux"}, "product_version": "patch: 5.4.294"}, {"id": "f810e2de-e79e-3912-99b8-a86fb271608e", "product": {"name": "Linux"}, "product_version": "patch: 6.6.93"}, {"id": "fbc9d44b-3fac-30ac-a444-5e78b90e18cb", "product": {"name": "Linux"}, "product_version": "12d0ad3be9c3854e52ec74bb83bb6f43612827c7 <f9f593e34d2fb67644372c8f7b033bdc622ad228"}, {"id": "fc4f9e45-c132-3b9a-b230-a5725989e89a", "product": {"name": "Linux"}, "product_version": "patch: 5.10.238"}, {"id": "fd5714d7-2c76-3211-9589-98a82030d183", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "c1ac4364-8778-31ae-b0a4-c8ec66b594b6", "vendor": {"name": "Linux"}}], "isExploited": false}