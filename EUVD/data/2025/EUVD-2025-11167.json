{"id": "EUVD-2025-11167", "enisaUuid": "ecebafb7-8c29-368f-ae93-5bdbb66f3987", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix potential deadloop in prepare_compress_overwrite()\n\nJan Prusakowski reported a kernel hang issue as below:\n\nWhen running xfstests on linux-next kernel (6.14.0-rc3, 6.12) I\nencountered a problem in generic/475 test where fsstress process\ngets blocked in __f2fs_write_data_pages() and the test hangs.\nThe options I used are:\n\nMKFS_OPTIONS  -- -O compression -O extra_attr -O project_quota -O quota /dev/vdc\nMOUNT_OPTIONS -- -o acl,user_xattr -o discard,compress_extension=* /dev/vdc /vdc\n\nINFO: task kworker/u8:0:11 blocked for more than 122 seconds.\n      Not tainted 6.14.0-rc3-xfstests-lockdep #1\n\"echo 0 > /proc/sys/kernel/hung_task_timeout_secs\" disables this message.\ntask:kworker/u8:0    state:D stack:0     pid:11    tgid:11    ppid:2      task_flags:0x4208160 flags:0x00004000\nWorkqueue: writeback wb_workfn (flush-253:0)\nCall Trace:\n <TASK>\n __schedule+0x309/0x8e0\n schedule+0x3a/0x100\n schedule_preempt_disabled+0x15/0x30\n __mutex_lock+0x59a/0xdb0\n __f2fs_write_data_pages+0x3ac/0x400\n do_writepages+0xe8/0x290\n __writeback_single_inode+0x5c/0x360\n writeback_sb_inodes+0x22f/0x570\n wb_writeback+0xb0/0x410\n wb_do_writeback+0x47/0x2f0\n wb_workfn+0x5a/0x1c0\n process_one_work+0x223/0x5b0\n worker_thread+0x1d5/0x3c0\n kthread+0xfd/0x230\n ret_from_fork+0x31/0x50\n ret_from_fork_asm+0x1a/0x30\n </TASK>\n\nThe root cause is: once generic/475 starts toload error table to dm\ndevice, f2fs_prepare_compress_overwrite() will loop reading compressed\ncluster pages due to IO error, meanwhile it has held .writepages lock,\nit can block all other writeback tasks.\n\nLet's fix this issue w/ below changes:\n- add f2fs_handle_page_eio() in prepare_compress_overwrite() to\ndetect IO error.\n- detect cp_error earler in f2fs_read_multi_pages().", "datePublished": "2025-04-16T15:34:46", "dateUpdated": "2025-11-03T18:31:15", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-22127", "https://git.kernel.org/stable/c/3147ee567dd9004a49826ddeaf0a4b12865d4409", "https://git.kernel.org/stable/c/7215cf8ef54bdc9082dffac4662416d54961e258"], "aliases": ["CVE-2025-22127", "GHSA-gj5h-7fq5-56p5"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "22ef79a2-a95e-3eee-8e39-03c19ce076f6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "3a9b705f-56e8-3eb1-9d0f-5de8d1fa1952", "product": {"name": "Linux"}, "product_version": "4c8ff7095bef64fc47e996a938f7d57f9e077da3 <3147ee567dd9004a49826ddeaf0a4b12865d4409"}, {"id": "7a4619ee-8642-3e4e-8865-8cb17c9bae2a", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}, {"id": "ae30530a-cb4a-38f2-a8ea-d2457ed1f419", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "ca9a642d-3a34-30d0-963d-3be1f096a617", "product": {"name": "Linux"}, "product_version": "5.6"}, {"id": "f18106d6-0683-3171-8c80-db29959dfcb7", "product": {"name": "Linux"}, "product_version": "4c8ff7095bef64fc47e996a938f7d57f9e077da3 <7215cf8ef54bdc9082dffac4662416d54961e258"}], "enisaIdVendor": [{"id": "ff559a2c-ae53-3809-8d37-45f51e2a44f0", "vendor": {"name": "Linux"}}], "isExploited": false}