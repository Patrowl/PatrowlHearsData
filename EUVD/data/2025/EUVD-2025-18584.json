{"id": "EUVD-2025-18584", "enisaUuid": "33dd2398-22a9-392e-a9b9-98a777c93deb", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: endpoint: pci-epf-test: Fix double free that causes kernel to oops\n\nFix a kernel oops found while testing the stm32_pcie Endpoint driver\nwith handling of PERST# deassertion:\n\nDuring EP initialization, pci_epf_test_alloc_space() allocates all BARs,\nwhich are further freed if epc_set_bar() fails (for instance, due to no\nfree inbound window).\n\nHowever, when pci_epc_set_bar() fails, the error path:\n\n  pci_epc_set_bar() ->\n    pci_epf_free_space()\n\ndoes not clear the previous assignment to epf_test->reg[bar].\n\nThen, if the host reboots, the PERST# deassertion restarts the BAR\nallocation sequence with the same allocation failure (no free inbound\nwindow), creating a double free situation since epf_test->reg[bar] was\ndeallocated and is still non-NULL.\n\nThus, make sure that pci_epf_alloc_space() and pci_epf_free_space()\ninvocations are symmetric, and as such, set epf_test->reg[bar] to NULL\nwhen memory is freed.\n\n[kwilczynski: commit log]", "datePublished": "2025-06-18T12:30:33", "dateUpdated": "2025-11-14T18:31:22", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/fe2329eff5bee461ebcafadb6ca1df0cbf5945fd", "https://git.kernel.org/stable/c/8b83893d1f6c6061a7d58169ecdf9d5ee9f306ee", "https://git.kernel.org/stable/c/934e9d137d937706004c325fa1474f9e3f1ba10a", "https://nvd.nist.gov/vuln/detail/CVE-2025-38069"], "aliases": ["CVE-2025-38069"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "27e3df8d-c20f-3a74-96d0-df6e2ddde1cf", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fe2329eff5bee461ebcafadb6ca1df0cbf5945fd"}, {"id": "2b53ba76-631f-36f9-91a4-3b3381d18285", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <934e9d137d937706004c325fa1474f9e3f1ba10a"}, {"id": "2d9f76d8-5a2e-31d2-b3e5-47abc0d63b1d", "product": {"name": "Linux"}, "product_version": "patch: 6.12.31"}, {"id": "45069ab3-c19e-3ee5-9f18-9a8d8432d6b3", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "60c6d9ec-6198-38ea-9a5a-aa0683551e02", "product": {"name": "Linux"}, "product_version": "patch: 6.14.9"}, {"id": "cb10b40a-3117-3e2f-bf78-c30d0fa92de7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8b83893d1f6c6061a7d58169ecdf9d5ee9f306ee"}], "enisaIdVendor": [{"id": "76216527-ca91-3fb8-ab80-f90e182046ba", "vendor": {"name": "Linux"}}], "isExploited": false}