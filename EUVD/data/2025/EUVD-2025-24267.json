{"id": "EUVD-2025-24267", "enisaUuid": "426a3ce6-05b4-3258-bd63-6be2991aa4db", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nxfrm: interface: fix use-after-free after changing collect_md xfrm interface\n\ncollect_md property on xfrm interfaces can only be set on device creation,\nthus xfrmi_changelink() should fail when called on such interfaces.\n\nThe check to enforce this was done only in the case where the xi was\nreturned from xfrmi_locate() which doesn't look for the collect_md\ninterface, and thus the validation was never reached.\n\nCalling changelink would thus errornously place the special interface xi\nin the xfrmi_net->xfrmi hash, but since it also exists in the\nxfrmi_net->collect_md_xfrmi pointer it would lead to a double free when\nthe net namespace was taken down [1].\n\nChange the check to use the xi from netdev_priv which is available earlier\nin the function to prevent changes in xfrm collect_md interfaces.\n\n[1] resulting oops:\n[    8.516540] kernel BUG at net/core/dev.c:12029!\n[    8.516552] Oops: invalid opcode: 0000 [#1] SMP NOPTI\n[    8.516559] CPU: 0 UID: 0 PID: 12 Comm: kworker/u80:0 Not tainted 6.15.0-virtme #5 PREEMPT(voluntary)\n[    8.516565] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\n[    8.516569] Workqueue: netns cleanup_net\n[    8.516579] RIP: 0010:unregister_netdevice_many_notify+0x101/0xab0\n[    8.516590] Code: 90 0f 0b 90 48 8b b0 78 01 00 00 48 8b 90 80 01 00 00 48 89 56 08 48 89 32 4c 89 80 78 01 00 00 48 89 b8 80 01 00 00 eb ac 90 <0f> 0b 48 8b 45 00 4c 8d a0 88 fe ff ff 48 39 c5 74 5c 41 80 bc 24\n[    8.516593] RSP: 0018:ffffa93b8006bd30 EFLAGS: 00010206\n[    8.516598] RAX: ffff98fe4226e000 RBX: ffffa93b8006bd58 RCX: ffffa93b8006bc60\n[    8.516601] RDX: 0000000000000004 RSI: 0000000000000000 RDI: dead000000000122\n[    8.516603] RBP: ffffa93b8006bdd8 R08: dead000000000100 R09: ffff98fe4133c100\n[    8.516605] R10: 0000000000000000 R11: 00000000000003d2 R12: ffffa93b8006be00\n[    8.516608] R13: ffffffff96c1a510 R14: ffffffff96c1a510 R15: ffffa93b8006be00\n[    8.516615] FS:  0000000000000000(0000) GS:ffff98fee73b7000(0000) knlGS:0000000000000000\n[    8.516619] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[    8.516622] CR2: 00007fcd2abd0700 CR3: 000000003aa40000 CR4: 0000000000752ef0\n[    8.516625] PKRU: 55555554\n[    8.516627] Call Trace:\n[    8.516632]  <TASK>\n[    8.516635]  ? rtnl_is_locked+0x15/0x20\n[    8.516641]  ? unregister_netdevice_queue+0x29/0xf0\n[    8.516650]  ops_undo_list+0x1f2/0x220\n[    8.516659]  cleanup_net+0x1ad/0x2e0\n[    8.516664]  process_one_work+0x160/0x380\n[    8.516673]  worker_thread+0x2aa/0x3c0\n[    8.516679]  ? __pfx_worker_thread+0x10/0x10\n[    8.516686]  kthread+0xfb/0x200\n[    8.516690]  ? __pfx_kthread+0x10/0x10\n[    8.516693]  ? __pfx_kthread+0x10/0x10\n[    8.516697]  ret_from_fork+0x82/0xf0\n[    8.516705]  ? __pfx_kthread+0x10/0x10\n[    8.516709]  ret_from_fork_asm+0x1a/0x30\n[    8.516718]  </TASK>", "datePublished": "2025-08-12T18:31:25", "dateUpdated": "2025-11-03T18:31:33", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://git.kernel.org/stable/c/bfebdb85496e1da21d3cf05de099210915c3e706", "https://git.kernel.org/stable/c/5918c3f4800a3aef2173865e5903370f21e24f47", "https://git.kernel.org/stable/c/69a31f7a6a81f5ffd3812c442e09ff0be22960f1", "https://git.kernel.org/stable/c/a90b2a1aaacbcf0f91d7e4868ad6c51c5dee814b", "https://git.kernel.org/stable/c/a8d4748b954584ab7bd800f1a4e46d5b0eeb5ce4", "https://nvd.nist.gov/vuln/detail/CVE-2025-38500", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38500"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1f26de09-3aa5-31c1-ae7d-e49e0024eed3", "product": {"name": "Linux"}, "product_version": "abc340b38ba25cd6c7aa2c0bd9150d30738c82d0 <69a31f7a6a81f5ffd3812c442e09ff0be22960f1"}, {"id": "30719093-2ef8-38ea-81c3-e3a3dd248a06", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "312f9787-db68-30d3-b4f2-79d154d9d8bc", "product": {"name": "Linux"}, "product_version": "abc340b38ba25cd6c7aa2c0bd9150d30738c82d0 <bfebdb85496e1da21d3cf05de099210915c3e706"}, {"id": "484743c4-0307-321f-92b1-a3a1078012f8", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "5ed52cbc-69d6-3494-b9c0-15b5378acfa2", "product": {"name": "Linux"}, "product_version": "patch: 6.15.9"}, {"id": "a317f41e-10a6-3ddd-b7ac-d6948ed83195", "product": {"name": "Linux"}, "product_version": "abc340b38ba25cd6c7aa2c0bd9150d30738c82d0 <5918c3f4800a3aef2173865e5903370f21e24f47"}, {"id": "a6eeb4d9-54b2-3d01-8738-a67a1dfeb1b8", "product": {"name": "Linux"}, "product_version": "abc340b38ba25cd6c7aa2c0bd9150d30738c82d0 <a90b2a1aaacbcf0f91d7e4868ad6c51c5dee814b"}, {"id": "ae165072-22dc-38c7-a08e-757f347f5129", "product": {"name": "Linux"}, "product_version": "patch: 6.1.148"}, {"id": "dd709465-9225-3a0f-9f0c-9594dd945798", "product": {"name": "Linux"}, "product_version": "abc340b38ba25cd6c7aa2c0bd9150d30738c82d0 <a8d4748b954584ab7bd800f1a4e46d5b0eeb5ce4"}, {"id": "e52adad9-67c4-3140-8e5e-63c4a8fb1a92", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "eae46f12-3dce-3199-a41c-edd25b14b07a", "product": {"name": "Linux"}, "product_version": "patch: 6.6.101"}, {"id": "ec095af2-7909-3fdf-8172-52037ea6d515", "product": {"name": "Linux"}, "product_version": "patch: 6.12.41"}], "enisaIdVendor": [{"id": "07ed0d12-a84f-3842-ae32-1bd92b8ff066", "vendor": {"name": "Linux"}}], "isExploited": false}