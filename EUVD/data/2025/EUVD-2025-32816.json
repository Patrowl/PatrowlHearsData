{"id": "EUVD-2025-32816", "enisaUuid": "a044f0cd-89de-3743-aac4-32efa50c925e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: iscsi_tcp: Fix null-ptr-deref while calling getpeername()\n\nFix a NULL pointer crash that occurs when we are freeing the socket at the\nsame time we access it via sysfs.\n\nThe problem is that:\n\n 1. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() take\n    the frwd_lock and do sock_hold() then drop the frwd_lock. sock_hold()\n    does a get on the \"struct sock\".\n\n 2. iscsi_sw_tcp_release_conn() does sockfd_put() which does the last put\n    on the \"struct socket\" and that does __sock_release() which sets the\n    sock->ops to NULL.\n\n 3. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() then\n    call kernel_getpeername() which accesses the NULL sock->ops.\n\nAbove we do a get on the \"struct sock\", but we needed a get on the \"struct\nsocket\". Originally, we just held the frwd_lock the entire time but in\ncommit bcf3a2953d36 (\"scsi: iscsi: iscsi_tcp: Avoid holding spinlock while\ncalling getpeername()\") we switched to refcount based because the network\nlayer changed and started taking a mutex in that path, so we could no\nlonger hold the frwd_lock.\n\nInstead of trying to maintain multiple refcounts, this just has us use a\nmutex for accessing the socket in the interface code paths.", "datePublished": "2025-10-01T11:45:31", "dateUpdated": "2025-10-01T11:45:31", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-50459", "https://git.kernel.org/stable/c/0a0b861fce2657ba08ec356a74346b37ca4b2008", "https://git.kernel.org/stable/c/57569c37f0add1b6489e1a1563c71519daf732cf", "https://git.kernel.org/stable/c/884a788f065578bb640382279a83d1df433b13e6", "https://git.kernel.org/stable/c/897dbbc57d71e8a34ec1af8e573a142de457da38", "https://git.kernel.org/stable/c/a26b0658751bb0a3b28386fca715333b104d32a2"], "aliases": ["CVE-2022-50459", "GHSA-f7xj-99j9-66q2"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0d26dfa1-6a03-34cd-a678-5c544bec3544", "product": {"name": "Linux"}, "product_version": "patch: 6.0.3"}, {"id": "2d89ea97-d8d3-33b6-a454-2b5b85e1c259", "product": {"name": "Linux"}, "product_version": "5.9"}, {"id": "394c7bb1-be9a-339c-ab1f-b14e0d2e3230", "product": {"name": "Linux"}, "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <0a0b861fce2657ba08ec356a74346b37ca4b2008"}, {"id": "5a5be2cb-12bc-3074-840a-bb1540be6419", "product": {"name": "Linux"}, "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <897dbbc57d71e8a34ec1af8e573a142de457da38"}, {"id": "79d6bc43-b148-39ab-9a10-21b0d9e6f6e9", "product": {"name": "Linux"}, "product_version": "patch: 5.10.150"}, {"id": "8802f5ae-7a22-3116-921b-310ebde93b43", "product": {"name": "Linux"}, "product_version": "patch: 5.15.75"}, {"id": "929ec7c4-b8d8-3c3a-ac48-110300440af6", "product": {"name": "Linux"}, "product_version": "7d29e950766327f658cb92722b9445ac3b3ae023"}, {"id": "9457ff2d-d5e5-3dd3-8b57-2b97c94b461f", "product": {"name": "Linux"}, "product_version": "patch: 5.19.17"}, {"id": "aaf304ba-978a-3b07-900e-70751f97b070", "product": {"name": "Linux"}, "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <a26b0658751bb0a3b28386fca715333b104d32a2"}, {"id": "bc20e7c9-5132-384e-84c0-6262201bd847", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "c8fcb5db-db11-3d21-9c34-1bbca307dc4b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d6794a15-48e7-39f4-b9a4-2d389b66e80b", "product": {"name": "Linux"}, "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <57569c37f0add1b6489e1a1563c71519daf732cf"}, {"id": "ff92dbb7-0d3c-3530-a6bd-186901b1904a", "product": {"name": "Linux"}, "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <884a788f065578bb640382279a83d1df433b13e6"}], "enisaIdVendor": [{"id": "e01f7f7f-62ec-346d-8196-d3d32d1e650e", "vendor": {"name": "Linux"}}], "isExploited": false}