{"id": "EUVD-2025-124965", "enisaUuid": "cd13b2fc-68e9-3192-aadb-6772a1905108", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: pm80xx: Fix array-index-out-of-of-bounds on rmmod\n\nSince commit f7b705c238d1 (\"scsi: pm80xx: Set phy_attached to zero when\ndevice is gone\") UBSAN reports:\n\n  UBSAN: array-index-out-of-bounds in drivers/scsi/pm8001/pm8001_sas.c:786:17\n  index 28 is out of range for type 'pm8001_phy [16]'\n\non rmmod when using an expander.\n\nFor a direct attached device, attached_phy contains the local phy id.\nFor a device behind an expander, attached_phy contains the remote phy\nid, not the local phy id.\n\nI.e. while pm8001_ha will have pm8001_ha->chip->n_phy local phys, for a\ndevice behind an expander, attached_phy can be much larger than\npm8001_ha->chip->n_phy (depending on the amount of phys of the\nexpander).\n\nE.g. on my system pm8001_ha has 8 phys with phy ids 0-7.  One of the\nports has an expander connected.  The expander has 31 phys with phy ids\n0-30.\n\nThe pm8001_ha->phy array only contains the phys of the HBA.  It does not\ncontain the phys of the expander.  Thus, it is wrong to use attached_phy\nto index the pm8001_ha->phy array for a device behind an expander.\n\nThus, we can only clear phy_attached for devices that are directly\nattached.", "datePublished": "2025-11-12T10:23:18", "dateUpdated": "2025-12-01T06:18:22", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d94be0a6ae9ade706d4270e740bdb4f79953a7fc", "https://git.kernel.org/stable/c/45acbf154befedd9bc135f5e031fe7855d1e6493", "https://git.kernel.org/stable/c/eef5ef400893f8e3dbb09342583be0cdc716d566", "https://git.kernel.org/stable/c/9c671d4dbfbfb0d73cfdfb706afb36d9ad60a582", "https://git.kernel.org/stable/c/e62251954a128a2d0fcbc19e5fa39e08935bb628", "https://git.kernel.org/stable/c/9326a1541e1b7ed3efdbab72061b82cf01c6477a", "https://git.kernel.org/stable/c/83ced3c206c292458e47c7fac54223abc7141585", "https://git.kernel.org/stable/c/251be2f6037fb7ab399f68cd7428ff274133d693", "https://nvd.nist.gov/vuln/detail/CVE-2025-40118"], "aliases": ["CVE-2025-40118"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "0b3abe8c-217e-3508-a724-a3dae343c1e4", "product": {"name": "Linux"}, "product_version": "bc2140c8136200b4437e1abc0fb659968cb9baab <45acbf154befedd9bc135f5e031fe7855d1e6493"}, {"id": "0f476d28-16f9-3a42-8642-e412ccdab95c", "product": {"name": "Linux"}, "product_version": "f7b705c238d1483f0a766e2b20010f176e5c0fb7 <251be2f6037fb7ab399f68cd7428ff274133d693"}, {"id": "2cb31550-ddb6-3004-8337-6f5708cef7b0", "product": {"name": "Linux"}, "product_version": "0f9802f174227f553959422f844eeb9ba72467fe <9326a1541e1b7ed3efdbab72061b82cf01c6477a"}, {"id": "3b58bdcc-9804-368b-be09-12aa2815d373", "product": {"name": "Linux"}, "product_version": "1d8f9378cb4800c18e20d80ecd605b2b93e87a03 <eef5ef400893f8e3dbb09342583be0cdc716d566"}, {"id": "4926aa30-2d20-3cbe-b06d-56a297ead3da", "product": {"name": "Linux"}, "product_version": "patch: 6.12.53"}, {"id": "502fe9b9-f933-36e5-9b03-a84250f9b5eb", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "7c781c28-c2e2-30d3-92ac-033f268e8f60", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "84fdbf2a-4cdc-3811-91e1-b7d88720340e", "product": {"name": "Linux"}, "product_version": "f7b705c238d1483f0a766e2b20010f176e5c0fb7 <83ced3c206c292458e47c7fac54223abc7141585"}, {"id": "8f3e141a-2105-3337-a54a-0d6e61721a48", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "951060ab-8f04-38f2-b835-b93e63eef3f5", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "98fd5539-33e5-3ad2-b974-082070a13bd6", "product": {"name": "Linux"}, "product_version": "6.15"}, {"id": "a51a6718-b159-36ad-9d19-01cb3e664785", "product": {"name": "Linux"}, "product_version": "a862d24e1fc3ab1b5e5f20878d2898cea346d0ec <e62251954a128a2d0fcbc19e5fa39e08935bb628"}, {"id": "adce2e94-1a4e-3a37-a268-5552bdfcd843", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "bc6c7695-7d75-301c-b984-c171cab15808", "product": {"name": "Linux"}, "product_version": "patch: 5.15.195"}, {"id": "cc4b073e-b790-3828-bea9-f238725c6fc2", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "d0f350bf-52a6-305d-9109-903460e8d0ca", "product": {"name": "Linux"}, "product_version": "patch: 6.6.112"}, {"id": "e25e6de2-39b4-387f-86d5-5849fc960518", "product": {"name": "Linux"}, "product_version": "30e482dfb8f27d22f518695d4bcb5e7f4c6cb08a <9c671d4dbfbfb0d73cfdfb706afb36d9ad60a582"}, {"id": "e4f91402-b609-3e92-b5e7-1652c01eb7d9", "product": {"name": "Linux"}, "product_version": "05b512879eab41faa515b67fa3896d0005e97909 <d94be0a6ae9ade706d4270e740bdb4f79953a7fc"}, {"id": "fd230488-b84e-36ee-986a-8e71d576bf8b", "product": {"name": "Linux"}, "product_version": "722026c010fa75bcf9e2373aff1d7930a3d7e3cf"}, {"id": "ff383d33-aab1-3c8e-bb71-255a50bc1e39", "product": {"name": "Linux"}, "product_version": "patch: 6.1.156"}], "enisaIdVendor": [{"id": "2f447caa-64a4-35be-b78d-b1fa9ad4d2c3", "vendor": {"name": "Linux"}}], "isExploited": false}