{"id": "EUVD-2025-19780", "enisaUuid": "38bbbe60-e9e9-3eea-9b47-76bff9529ec7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: zone: fix to avoid inconsistence in between SIT and SSA\n\nw/ below testcase, it will cause inconsistence in between SIT and SSA.\n\ncreate_null_blk 512 2 1024 1024\nmkfs.f2fs -m /dev/nullb0\nmount /dev/nullb0 /mnt/f2fs/\ntouch /mnt/f2fs/file\nf2fs_io pinfile set /mnt/f2fs/file\nfallocate -l 4GiB /mnt/f2fs/file\n\nF2FS-fs (nullb0): Inconsistent segment (0) type [1, 0] in SSA and SIT\nCPU: 5 UID: 0 PID: 2398 Comm: fallocate Tainted: G           O       6.13.0-rc1 #84\nTainted: [O]=OOT_MODULE\nHardware name: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBox 12/01/2006\nCall Trace:\n <TASK>\n dump_stack_lvl+0xb3/0xd0\n dump_stack+0x14/0x20\n f2fs_handle_critical_error+0x18c/0x220 [f2fs]\n f2fs_stop_checkpoint+0x38/0x50 [f2fs]\n do_garbage_collect+0x674/0x6e0 [f2fs]\n f2fs_gc_range+0x12b/0x230 [f2fs]\n f2fs_allocate_pinning_section+0x5c/0x150 [f2fs]\n f2fs_expand_inode_data+0x1cc/0x3c0 [f2fs]\n f2fs_fallocate+0x3c3/0x410 [f2fs]\n vfs_fallocate+0x15f/0x4b0\n __x64_sys_fallocate+0x4a/0x80\n x64_sys_call+0x15e8/0x1b80\n do_syscall_64+0x68/0x130\n entry_SYSCALL_64_after_hwframe+0x67/0x6f\nRIP: 0033:0x7f9dba5197ca\nF2FS-fs (nullb0): Stopped filesystem due to reason: 4\n\nThe reason is f2fs_gc_range() may try to migrate block in curseg, however,\nits SSA block is not uptodate due to the last summary block data is still\nin cache of curseg.\n\nIn this patch, we add a condition in f2fs_gc_range() to check whether\nsection is opened or not, and skip block migration for opened section.", "datePublished": "2025-07-03T09:30:35", "dateUpdated": "2025-11-20T21:30:30", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/44a51592ac657d8e422585414d7ec17a5b50fb0e", "https://git.kernel.org/stable/c/8d9431b0d11a5030aa1ce477defee455b3821701", "https://git.kernel.org/stable/c/773704c1ef96a8b70d0d186ab725f50548de82c4", "https://nvd.nist.gov/vuln/detail/CVE-2025-38164"], "aliases": ["CVE-2025-38164"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "20b2c73d-6a69-365f-abcf-73da4aced0e7", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "331af8a7-8c49-3be0-9f63-96d1488dcf60", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "59470c0c-5859-30b2-a26c-9d7ff4574089", "product": {"name": "Linux"}, "product_version": "40d76c393cca83938b11eb7ca8983aa3cd0ed69b"}, {"id": "5f19ef40-e1f5-3d68-a2aa-b2828830d1b9", "product": {"name": "Linux"}, "product_version": "6.9"}, {"id": "7249220e-79bb-3112-aaec-96fe92809df9", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "92d53e92-2eb0-3573-be34-19f6419025a1", "product": {"name": "Linux"}, "product_version": "9703d69d9d153bb230711d0d577454552aeb13d4 <8d9431b0d11a5030aa1ce477defee455b3821701"}, {"id": "93d31b6f-e3a0-34ea-8a8d-c2a7f931ee9b", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "a4862150-c691-3678-b8f7-b73702923965", "product": {"name": "Linux"}, "product_version": "9703d69d9d153bb230711d0d577454552aeb13d4 <773704c1ef96a8b70d0d186ab725f50548de82c4"}, {"id": "ab137d85-6d32-364b-a1fd-81f4879d27dc", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "af4ced23-2524-3b1a-84bd-05c6d487eed6", "product": {"name": "Linux"}, "product_version": "9703d69d9d153bb230711d0d577454552aeb13d4 <44a51592ac657d8e422585414d7ec17a5b50fb0e"}], "enisaIdVendor": [{"id": "d45fc1b8-4aaf-3160-88a4-69348eb9ca28", "vendor": {"name": "Linux"}}], "isExploited": false}