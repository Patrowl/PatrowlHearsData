{"id": "EUVD-2025-28967", "enisaUuid": "86c7654b-0a93-3b15-8be3-be1f8f030c76", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrcu: Fix rcu_read_unlock() deadloop due to IRQ work\n\nDuring rcu_read_unlock_special(), if this happens during irq_exit(), we\ncan lockup if an IPI is issued. This is because the IPI itself triggers\nthe irq_exit() path causing a recursive lock up.\n\nThis is precisely what Xiongfeng found when invoking a BPF program on\nthe trace_tick_stop() tracepoint As shown in the trace below. Fix by\nmanaging the irq_work state correctly.\n\nirq_exit()\n  __irq_exit_rcu()\n    /* in_hardirq() returns false after this */\n    preempt_count_sub(HARDIRQ_OFFSET)\n    tick_irq_exit()\n      tick_nohz_irq_exit()\n\t    tick_nohz_stop_sched_tick()\n\t      trace_tick_stop()  /* a bpf prog is hooked on this trace point */\n\t\t   __bpf_trace_tick_stop()\n\t\t      bpf_trace_run2()\n\t\t\t    rcu_read_unlock_special()\n                              /* will send a IPI to itself */\n\t\t\t      irq_work_queue_on(&rdp->defer_qs_iw, rdp->cpu);\n\nA simple reproducer can also be obtained by doing the following in\ntick_irq_exit(). It will hang on boot without the patch:\n\n  static inline void tick_irq_exit(void)\n  {\n +\trcu_read_lock();\n +\tWRITE_ONCE(current->rcu_read_unlock_special.b.need_qs, true);\n +\trcu_read_unlock();\n +\n\n[neeraj: Apply Frederic's suggested fix for PREEMPT_RT]", "datePublished": "2025-09-11T18:35:51", "dateUpdated": "2025-11-25T21:32:04", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e7a375453cca2b8a0d2fa1b82b913f3fed7c0507", "https://git.kernel.org/stable/c/1cfa244f7198d325594e627574930b7b91df5bfe", "https://git.kernel.org/stable/c/ddebb2a7677673cf4438a04e1a48b8ed6b0c8e9a", "https://git.kernel.org/stable/c/56c5ef194f4509df63fc0f7a91ea5973ce479b1e", "https://git.kernel.org/stable/c/b41642c87716bbd09797b1e4ea7d904f06c39b7b", "https://nvd.nist.gov/vuln/detail/CVE-2025-39744"], "aliases": ["CVE-2025-39744"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "06b5dd13-7031-384b-8c61-20fba031f3d0", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b41642c87716bbd09797b1e4ea7d904f06c39b7b"}, {"id": "13713267-177b-3676-89ea-f6e7e2577b9f", "product": {"name": "Linux"}, "product_version": "patch: 6.16.2"}, {"id": "238f8e83-e093-3b10-b1b0-373077c064fa", "product": {"name": "Linux"}, "product_version": "patch: 6.15.11"}, {"id": "28fd56ef-ad6b-3917-ae35-608f99638705", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <56c5ef194f4509df63fc0f7a91ea5973ce479b1e"}, {"id": "49546a45-4f2b-3d3d-affa-bd20c107264d", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "5fbb93e9-8086-3642-a934-dd100a1a44db", "product": {"name": "Linux"}, "product_version": "patch: 6.6.103"}, {"id": "64592f3c-3912-3661-b6cf-1e1329c0bf9e", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}, {"id": "9d39dd23-e391-36af-a742-01582cf7fbf3", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1cfa244f7198d325594e627574930b7b91df5bfe"}, {"id": "ce6bea85-d6ac-3af7-b597-b029a065c11f", "product": {"name": "Linux"}, "product_version": "patch: 6.12.43"}, {"id": "d68efda0-573c-39d6-abd1-c26863d6e6ef", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e7a375453cca2b8a0d2fa1b82b913f3fed7c0507"}, {"id": "f8a111fb-0c66-332e-8cc1-b53ed47fc782", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ddebb2a7677673cf4438a04e1a48b8ed6b0c8e9a"}], "enisaIdVendor": [{"id": "82933d54-9d9e-33de-8d2c-88c70516be56", "vendor": {"name": "Linux"}}], "isExploited": false}