{"id": "EUVD-2025-203669", "enisaUuid": "b692f5d2-6e5c-3118-b0bc-7b928e98ba28", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: Fix proto fallback detection with BPF\n\nThe sockmap feature allows bpf syscall from userspace, or based\non bpf sockops, replacing the sk_prot of sockets during protocol stack\nprocessing with sockmap's custom read/write interfaces.\n'''\ntcp_rcv_state_process()\n  syn_recv_sock()/subflow_syn_recv_sock()\n    tcp_init_transfer(BPF_SOCK_OPS_PASSIVE_ESTABLISHED_CB)\n      bpf_skops_established       <== sockops\n        bpf_sock_map_update(sk)   <== call bpf helper\n          tcp_bpf_update_proto()  <== update sk_prot\n'''\n\nWhen the server has MPTCP enabled but the client sends a TCP SYN\nwithout MPTCP, subflow_syn_recv_sock() performs a fallback on the\nsubflow, replacing the subflow sk's sk_prot with the native sk_prot.\n'''\nsubflow_syn_recv_sock()\n  subflow_ulp_fallback()\n    subflow_drop_ctx()\n      mptcp_subflow_ops_undo_override()\n'''\n\nThen, this subflow can be normally used by sockmap, which replaces the\nnative sk_prot with sockmap's custom sk_prot. The issue occurs when the\nuser executes accept::mptcp_stream_accept::mptcp_fallback_tcp_ops().\nHere, it uses sk->sk_prot to compare with the native sk_prot, but this\nis incorrect when sockmap is used, as we may incorrectly set\nsk->sk_socket->ops.\n\nThis fix uses the more generic sk_family for the comparison instead.\n\nAdditionally, this also prevents a WARNING from occurring:\n\nresult from ./scripts/decode_stacktrace.sh:\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 337 at net/mptcp/protocol.c:68 mptcp_stream_accept \\\n(net/mptcp/protocol.c:4005)\nModules linked in:\n...\n\nPKRU: 55555554\nCall Trace:\n<TASK>\ndo_accept (net/socket.c:1989)\n__sys_accept4 (net/socket.c:2028 net/socket.c:2057)\n__x64_sys_accept (net/socket.c:2067)\nx64_sys_call (arch/x86/entry/syscall_64.c:41)\ndo_syscall_64 (arch/x86/entry/syscall_64.c:63 arch/x86/entry/syscall_64.c:94)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\nRIP: 0033:0x7f87ac92b83d\n\n---[ end trace 0000000000000000 ]---", "datePublished": "2025-12-16T15:30:46", "dateUpdated": "2025-12-16T15:30:46", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/92c4092fe012ecdfa5fb05d394f1c1d8f91ad81c", "https://git.kernel.org/stable/c/7ee8f015eb47907745e2070184a8ab1e442ac3c4", "https://git.kernel.org/stable/c/344974ea1a3ca30e4920687b0091bda4438cebdb", "https://git.kernel.org/stable/c/037cc50589643342d69185b663ecf9d26cce91e8", "https://git.kernel.org/stable/c/9b1980b6f23fa30bf12add19f37c7458625099eb", "https://git.kernel.org/stable/c/1a0d5c74af9b6ba9ffdf1172de5a1a6df5922a00", "https://git.kernel.org/stable/c/c77b3b79a92e3345aa1ee296180d1af4e7031f8f", "https://nvd.nist.gov/vuln/detail/CVE-2025-68227"], "aliases": ["CVE-2025-68227"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0100d125-eb3e-3aac-a609-ceb40b9876f2", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "03aaac69-d757-386f-83de-579e593e5911", "product": {"name": "Linux"}, "product_version": "5.7"}, {"id": "0b735f1c-6dd3-3d84-9d8a-c6a426c1688b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "26561b24-1c3b-31e5-b3c0-0072f4b832b4", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <344974ea1a3ca30e4920687b0091bda4438cebdb"}, {"id": "34d1dd5c-c880-3f1a-83fd-6a8b181fb1a7", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "44855fbb-aca1-3a86-9266-e1cc8fd6b4f6", "product": {"name": "Linux"}, "product_version": "patch: 6.12.60"}, {"id": "7a7f5a2a-27d0-387b-a7ef-a2fa6a468cea", "product": {"name": "Linux"}, "product_version": "patch: 6.6.118"}, {"id": "92396534-8dcf-3ba1-a20f-74d86e668db8", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <9b1980b6f23fa30bf12add19f37c7458625099eb"}, {"id": "969c1cce-5310-3fe1-bab0-39871a4c58bb", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <92c4092fe012ecdfa5fb05d394f1c1d8f91ad81c"}, {"id": "96bbf3a5-6daa-34d9-8f19-019e881cb6a1", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <7ee8f015eb47907745e2070184a8ab1e442ac3c4"}, {"id": "de8c3aff-c4b8-3caf-8cf3-8f46cae97e39", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <1a0d5c74af9b6ba9ffdf1172de5a1a6df5922a00"}, {"id": "e211b7b1-6d97-3ade-a9ba-d12fe2b5ee10", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <c77b3b79a92e3345aa1ee296180d1af4e7031f8f"}, {"id": "e3589ebd-adc6-312c-8472-ff1caaf1f701", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "e780dabc-1fd7-339d-bde9-729b452768b7", "product": {"name": "Linux"}, "product_version": "patch: 6.17.10"}, {"id": "ea03da00-a3e3-34ec-b810-4638a09dd2b0", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "f8658d02-e625-37b5-be60-b2a45b2d5a9c", "product": {"name": "Linux"}, "product_version": "0b4f33def7bbde1ce2fea05f116639270e7acdc7 <037cc50589643342d69185b663ecf9d26cce91e8"}], "enisaIdVendor": [{"id": "2e85c78d-f3b2-37d5-9f1b-1ca99094e73d", "vendor": {"name": "Linux"}}], "isExploited": false}