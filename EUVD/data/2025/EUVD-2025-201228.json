{"id": "EUVD-2025-201228", "enisaUuid": "6c8ff023-537a-3981-b88e-edbba2025f59", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvsock: fix lock inversion in vsock_assign_transport()\n\nSyzbot reported a potential lock inversion deadlock between\nvsock_register_mutex and sk_lock-AF_VSOCK when vsock_linger() is called.\n\nThe issue was introduced by commit 687aa0c5581b (\"vsock: Fix\ntransport_* TOCTOU\") which added vsock_register_mutex locking in\nvsock_assign_transport() around the transport->release() call, that can\ncall vsock_linger(). vsock_assign_transport() can be called with sk_lock\nheld. vsock_linger() calls sk_wait_event() that temporarily releases and\nre-acquires sk_lock. During this window, if another thread hold\nvsock_register_mutex while trying to acquire sk_lock, a circular\ndependency is created.\n\nFix this by releasing vsock_register_mutex before calling\ntransport->release() and vsock_deassign_transport(). This is safe\nbecause we don't need to hold vsock_register_mutex while releasing the\nold transport, and we ensure the new transport won't disappear by\nobtaining a module reference first via try_module_get().", "datePublished": "2025-12-04T15:31:22", "dateUpdated": "2025-12-04T15:31:22", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/ce4f856c64f0bc30e29302a0ce41f4295ca391c5", "https://git.kernel.org/stable/c/09bba278ccde25a14b6e5088a9e65a8717d0cccf", "https://git.kernel.org/stable/c/b44182c116778feaa05da52a426aeb9da1878dcf", "https://git.kernel.org/stable/c/42ed0784d11adebf748711e503af0eb9f1e6d81d", "https://git.kernel.org/stable/c/251caee792a21eb0b781aab91362b422c945e162", "https://git.kernel.org/stable/c/a2a4346eea8b4cb75037dbcb20b98cb454324f80", "https://git.kernel.org/stable/c/f7c877e7535260cc7a21484c994e8ce7e8cb6780", "https://nvd.nist.gov/vuln/detail/CVE-2025-40231"], "aliases": ["CVE-2025-40231"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "0d389e93-ed6b-3c57-9a34-0aba4df2d710", "product": {"name": "Linux"}, "product_version": "8667e8d0eb46bc54fdae30ba2f4786407d3d88eb <ce4f856c64f0bc30e29302a0ce41f4295ca391c5"}, {"id": "385905b8-1326-3e3b-b913-0f3a7f8085e5", "product": {"name": "Linux"}, "product_version": "9d24bb6780282b0255b9929abe5e8f98007e2c6e <42ed0784d11adebf748711e503af0eb9f1e6d81d"}, {"id": "4f1f6fe4-6412-383d-9790-417d38d77b54", "product": {"name": "Linux"}, "product_version": "36a439049b34cca0b3661276049b84a1f76cc21a <09bba278ccde25a14b6e5088a9e65a8717d0cccf"}, {"id": "5b9c4cb1-7bb9-3023-90c9-9a03c2d12c0b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.196"}, {"id": "681a5a2e-1bf0-3f71-ab26-d22e75eada16", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7862a310-0bac-3e66-b862-104e50c92e61", "product": {"name": "Linux"}, "product_version": "patch: 6.6.115"}, {"id": "9d8f6b69-861a-3cbf-a289-b3012b35d6a0", "product": {"name": "Linux"}, "product_version": "patch: 6.12.56"}, {"id": "9e927616-c90f-31b1-af61-0dd1b314a9a3", "product": {"name": "Linux"}, "product_version": "patch: 6.17.6"}, {"id": "a0a6b38a-5836-3521-b411-991366874f84", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "a2e3a73a-6502-3faa-afff-391999f12753", "product": {"name": "Linux"}, "product_version": "687aa0c5581b8d4aa87fd92973e4ee576b550cdf <a2a4346eea8b4cb75037dbcb20b98cb454324f80"}, {"id": "ac2fa2c6-10ea-3dcb-b67d-b5b16bc9dfb3", "product": {"name": "Linux"}, "product_version": "9ce53e744f18e73059d3124070e960f3aa9902bf <b44182c116778feaa05da52a426aeb9da1878dcf"}, {"id": "c398fff3-ca2a-3bb1-85a6-db93cb8ab6b4", "product": {"name": "Linux"}, "product_version": "patch: 6.1.158"}, {"id": "d1ba264f-b779-3886-9458-2446f9fb9639", "product": {"name": "Linux"}, "product_version": "ae2c712ba39c7007de63cb0c75b51ce1caaf1da5 <251caee792a21eb0b781aab91362b422c945e162"}, {"id": "d556f643-62ce-3b22-8395-e2673ffa013c", "product": {"name": "Linux"}, "product_version": "7b73bddf54777fb62d4d8c7729d0affe6df04477"}, {"id": "d5bf83a9-dc75-3f01-a08c-791d3b7849af", "product": {"name": "Linux"}, "product_version": "6.16"}, {"id": "de6ce0a6-72e5-3711-9af1-8b1645ff0d75", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "ffbf4ec9-86f0-37c5-bf2a-743c241d89d3", "product": {"name": "Linux"}, "product_version": "687aa0c5581b8d4aa87fd92973e4ee576b550cdf <f7c877e7535260cc7a21484c994e8ce7e8cb6780"}], "enisaIdVendor": [{"id": "a0569c82-cda8-30f6-82e3-a23150d88093", "vendor": {"name": "Linux"}}], "isExploited": false}