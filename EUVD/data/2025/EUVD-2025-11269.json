{"id": "EUVD-2025-11269", "enisaUuid": "91a6389d-8522-301c-a654-c86dbbfa74d3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnfsd: fix management of listener transports\n\nCurrently, when no active threads are running, a root user using nfsdctl\ncommand can try to remove a particular listener from the list of previously\nadded ones, then start the server by increasing the number of threads,\nit leads to the following problem:\n\n[  158.835354] refcount_t: addition on 0; use-after-free.\n[  158.835603] WARNING: CPU: 2 PID: 9145 at lib/refcount.c:25 refcount_warn_saturate+0x160/0x1a0\n[  158.836017] Modules linked in: rpcrdma rdma_cm iw_cm ib_cm ib_core nfsd auth_rpcgss nfs_acl lockd grace overlay isofs uinput snd_seq_dummy snd_hrtimer nft_fib_inet nft_fib_ipv4 nft_fib_ipv6 nft_fib nft_reject_inet nf_reject_ipv4 nf_reject_ipv6 nft_reject nft_ct nft_chain_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 rfkill ip_set nf_tables qrtr sunrpc vfat fat uvcvideo videobuf2_vmalloc videobuf2_memops uvc videobuf2_v4l2 videodev videobuf2_common snd_hda_codec_generic mc e1000e snd_hda_intel snd_intel_dspcfg snd_hda_codec snd_hda_core snd_hwdep snd_seq snd_seq_device snd_pcm snd_timer snd soundcore sg loop dm_multipath dm_mod nfnetlink vsock_loopback vmw_vsock_virtio_transport_common vmw_vsock_vmci_transport vmw_vmci vsock xfs libcrc32c crct10dif_ce ghash_ce vmwgfx sha2_ce sha256_arm64 sr_mod sha1_ce cdrom nvme drm_client_lib drm_ttm_helper ttm nvme_core drm_kms_helper nvme_auth drm fuse\n[  158.840093] CPU: 2 UID: 0 PID: 9145 Comm: nfsd Kdump: loaded Tainted: G    B   W          6.13.0-rc6+ #7\n[  158.840624] Tainted: [B]=BAD_PAGE, [W]=WARN\n[  158.840802] Hardware name: VMware, Inc. VMware20,1/VBSA, BIOS VMW201.00V.24006586.BA64.2406042154 06/04/2024\n[  158.841220] pstate: 61400005 (nZCv daif +PAN -UAO -TCO +DIT -SSBS BTYPE=--)\n[  158.841563] pc : refcount_warn_saturate+0x160/0x1a0\n[  158.841780] lr : refcount_warn_saturate+0x160/0x1a0\n[  158.842000] sp : ffff800089be7d80\n[  158.842147] x29: ffff800089be7d80 x28: ffff00008e68c148 x27: ffff00008e68c148\n[  158.842492] x26: ffff0002e3b5c000 x25: ffff600011cd1829 x24: ffff00008653c010\n[  158.842832] x23: ffff00008653c000 x22: 1fffe00011cd1829 x21: ffff00008653c028\n[  158.843175] x20: 0000000000000002 x19: ffff00008653c010 x18: 0000000000000000\n[  158.843505] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000\n[  158.843836] x14: 0000000000000000 x13: 0000000000000001 x12: ffff600050a26493\n[  158.844143] x11: 1fffe00050a26492 x10: ffff600050a26492 x9 : dfff800000000000\n[  158.844475] x8 : 00009fffaf5d9b6e x7 : ffff000285132493 x6 : 0000000000000001\n[  158.844823] x5 : ffff000285132490 x4 : ffff600050a26493 x3 : ffff8000805e72bc\n[  158.845174] x2 : 0000000000000000 x1 : 0000000000000000 x0 : ffff000098588000\n[  158.845528] Call trace:\n[  158.845658]  refcount_warn_saturate+0x160/0x1a0 (P)\n[  158.845894]  svc_recv+0x58c/0x680 [sunrpc]\n[  158.846183]  nfsd+0x1fc/0x348 [nfsd]\n[  158.846390]  kthread+0x274/0x2f8\n[  158.846546]  ret_from_fork+0x10/0x20\n[  158.846714] ---[ end trace 0000000000000000 ]---\n\nnfsd_nl_listener_set_doit() would manipulate the list of transports of\nserver's sv_permsocks and close the specified listener but the other\nlist of transports (server's sp_xprts list) would not be changed leading\nto the problem above.\n\nInstead, determined if the nfsdctl is trying to remove a listener, in\nwhich case, delete all the existing listener transports and re-create\nall-but-the-removed ones.", "datePublished": "2025-04-16T14:11:45", "dateUpdated": "2025-10-01T17:05:37", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-22024", "https://git.kernel.org/stable/c/052a34f093fb940a145493d1438e7abbfe507cdd", "https://git.kernel.org/stable/c/0f42df0ab2b11ea6b2884bdaf6dbc3be6dde7e82", "https://git.kernel.org/stable/c/a84c80515ca8a0cdf6d06f1b6ca721224b08453e", "https://git.kernel.org/stable/c/d093c90892607be505e801469d6674459e69ab89"], "aliases": ["CVE-2025-22024", "GHSA-6cvc-553h-v3j8"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "04bd1c05-b086-3dce-95dd-505c42ab3edb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0cf1e246-aae6-3c82-9bc4-958f4067b87d", "product": {"name": "Linux"}, "product_version": "16a471177496c8e04a9793812c187a2c1a2192fa <0f42df0ab2b11ea6b2884bdaf6dbc3be6dde7e82"}, {"id": "3a576dd8-4f93-32f7-95f1-7067c52a5bb2", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "403d1030-ab32-3784-802e-0149d1d6c1df", "product": {"name": "Linux"}, "product_version": "patch: 6.13.11"}, {"id": "578ecde1-d8c9-3686-8eee-e3820a5efb11", "product": {"name": "Linux"}, "product_version": "patch: 6.12.23"}, {"id": "71c1c2ab-4917-399a-aaa2-561c47ff329c", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "b65ed7c0-df2a-3a42-9573-3455413210a5", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}, {"id": "b8748ea4-8ab9-37f0-bc18-b2112b278d82", "product": {"name": "Linux"}, "product_version": "16a471177496c8e04a9793812c187a2c1a2192fa <d093c90892607be505e801469d6674459e69ab89"}, {"id": "cb867814-76f4-3879-9f04-eaa86005c49d", "product": {"name": "Linux"}, "product_version": "6.10"}, {"id": "cf227e32-6871-39ce-b97f-b73fec2bdc45", "product": {"name": "Linux"}, "product_version": "16a471177496c8e04a9793812c187a2c1a2192fa <052a34f093fb940a145493d1438e7abbfe507cdd"}, {"id": "d2309fd3-3e42-33eb-8ec7-0161d6b9abd6", "product": {"name": "Linux"}, "product_version": "16a471177496c8e04a9793812c187a2c1a2192fa <a84c80515ca8a0cdf6d06f1b6ca721224b08453e"}], "enisaIdVendor": [{"id": "850bcfaa-df39-36b1-9186-b4a9e8856b02", "vendor": {"name": "Linux"}}], "isExploited": false}