{"id": "EUVD-2025-201630", "enisaUuid": "99d2837e-1841-3194-9e20-21c2efbecf11", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: f_fs: Fix epfile null pointer access after ep enable.\n\nA race condition occurs when ffs_func_eps_enable() runs concurrently\nwith ffs_data_reset(). The ffs_data_clear() called in ffs_data_reset()\nsets ffs->epfiles to NULL before resetting ffs->eps_count to 0, leading\nto a NULL pointer dereference when accessing epfile->ep in\nffs_func_eps_enable() after successful usb_ep_enable().\n\nThe ffs->epfiles pointer is set to NULL in both ffs_data_clear() and\nffs_data_close() functions, and its modification is protected by the\nspinlock ffs->eps_lock. And the whole ffs_func_eps_enable() function\nis also protected by ffs->eps_lock.\n\nThus, add NULL pointer handling for ffs->epfiles in the\nffs_func_eps_enable() function to fix issues", "datePublished": "2025-12-08T03:31:01", "dateUpdated": "2025-12-08T03:31:01", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b00d2572c16e8e59e979960d3383c2ae9cebd195", "https://git.kernel.org/stable/c/1c0dbd240be3f87cac321b14e17979b7e9cb6a8f", "https://git.kernel.org/stable/c/9ec40fba7357df2d36f4c2e2f3b9b1a4fba0a272", "https://git.kernel.org/stable/c/c53e90563bc148e4e0ad09fe130ba2246d426ea6", "https://git.kernel.org/stable/c/fc1141a530dfc91f0ee19b7f422a2d24829584bc", "https://git.kernel.org/stable/c/d62b808d5c68a931ad0849a00a5e3be3dd7e0019", "https://git.kernel.org/stable/c/30880e9df27332403dd638a82c27921134b3630b", "https://git.kernel.org/stable/c/cfd6f1a7b42f62523c96d9703ef32b0dbc495ba4", "https://nvd.nist.gov/vuln/detail/CVE-2025-40315"], "aliases": ["CVE-2025-40315"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "047eb03a-fab2-3d35-973a-01f093506a2c", "product": {"name": "Linux"}, "product_version": "patch: 6.17.8"}, {"id": "09b2a60a-3b4e-31dc-9ec1-481b73882c21", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "0e6fb41f-dafe-3146-9315-41fd7fb64a7f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c53e90563bc148e4e0ad09fe130ba2246d426ea6"}, {"id": "4953b953-963d-3603-8e05-6197f7041c13", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "7e69ea21-6856-3958-ad39-da5368554390", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fc1141a530dfc91f0ee19b7f422a2d24829584bc"}, {"id": "7f420ee1-8294-3d63-902d-1a3ce0135ded", "product": {"name": "Linux"}, "product_version": "patch: 6.12.58"}, {"id": "8caf83c4-e1ec-39b8-8aa4-bb9a3b535381", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9ec40fba7357df2d36f4c2e2f3b9b1a4fba0a272"}, {"id": "92f59c61-0dba-361b-95e3-6c0c090f5dec", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1c0dbd240be3f87cac321b14e17979b7e9cb6a8f"}, {"id": "9427dc11-da3b-3baa-8842-6ffe7f55a113", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "9cf99ab6-034f-316c-a60c-dc8d2ce3cf92", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d62b808d5c68a931ad0849a00a5e3be3dd7e0019"}, {"id": "a6ea3531-b82e-355d-aeef-e44ddbd59f09", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "c112aaa3-6431-3d4a-808e-1570140699d2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b00d2572c16e8e59e979960d3383c2ae9cebd195"}, {"id": "d32eafc9-acce-31ae-8a16-c81be8d4693e", "product": {"name": "Linux"}, "product_version": "patch: 5.4.302"}, {"id": "e2ffab22-60dd-3097-87f3-1eed8be7c94c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <30880e9df27332403dd638a82c27921134b3630b"}, {"id": "f4b7fdb9-de54-32a5-97b5-20fe472f9515", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cfd6f1a7b42f62523c96d9703ef32b0dbc495ba4"}, {"id": "fd4f9cae-02a3-38a2-ab58-fde943959def", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}], "enisaIdVendor": [{"id": "9617ed1b-8d7e-3499-84c2-e5c2af26614f", "vendor": {"name": "Linux"}}], "isExploited": false}