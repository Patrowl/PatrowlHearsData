{"id": "EUVD-2025-35071", "enisaUuid": "c380174d-be00-3184-b171-bbe0780a2179", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/proc/task_mmu: check p->vec_buf for NULL\n\nWhen the PAGEMAP_SCAN ioctl is invoked with vec_len = 0 reaches\npagemap_scan_backout_range(), kernel panics with null-ptr-deref:\n\n[   44.936808] Oops: general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] SMP DEBUG_PAGEALLOC KASAN NOPTI\n[   44.937797] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]\n[   44.938391] CPU: 1 UID: 0 PID: 2480 Comm: reproducer Not tainted 6.17.0-rc6 #22 PREEMPT(none)\n[   44.939062] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014\n[   44.939935] RIP: 0010:pagemap_scan_thp_entry.isra.0+0x741/0xa80\n\n<snip registers, unreliable trace>\n\n[   44.946828] Call Trace:\n[   44.947030]  <TASK>\n[   44.949219]  pagemap_scan_pmd_entry+0xec/0xfa0\n[   44.952593]  walk_pmd_range.isra.0+0x302/0x910\n[   44.954069]  walk_pud_range.isra.0+0x419/0x790\n[   44.954427]  walk_p4d_range+0x41e/0x620\n[   44.954743]  walk_pgd_range+0x31e/0x630\n[   44.955057]  __walk_page_range+0x160/0x670\n[   44.956883]  walk_page_range_mm+0x408/0x980\n[   44.958677]  walk_page_range+0x66/0x90\n[   44.958984]  do_pagemap_scan+0x28d/0x9c0\n[   44.961833]  do_pagemap_cmd+0x59/0x80\n[   44.962484]  __x64_sys_ioctl+0x18d/0x210\n[   44.962804]  do_syscall_64+0x5b/0x290\n[   44.963111]  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nvec_len = 0 in pagemap_scan_init_bounce_buffer() means no buffers are\nallocated and p->vec_buf remains set to NULL.\n\nThis breaks an assumption made later in pagemap_scan_backout_range(), that\npage_region is always allocated for p->vec_buf_index.\n\nFix it by explicitly checking p->vec_buf for NULL before dereferencing.\n\nOther sites that might run into same deref-issue are already (directly or\ntransitively) protected by checking p->vec_buf.\n\nNote:\nFrom PAGEMAP_SCAN man page, it seems vec_len = 0 is valid when no output\nis requested and it's only the side effects caller is interested in,\nhence it passes check in pagemap_scan_get_args().\n\nThis issue was found by syzkaller.", "datePublished": "2025-10-20T18:30:33", "dateUpdated": "2025-10-20T18:30:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/ca988dcdc6683ecd9de5f525ce469588a9141c21", "https://git.kernel.org/stable/c/a2cb8818a3d915cd33a1e8b2babc1bb0c34862c3", "https://git.kernel.org/stable/c/28aa29986dde79e8466bc87569141291053833f5", "https://nvd.nist.gov/vuln/detail/CVE-2025-40009"], "aliases": ["CVE-2025-40009"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0f7aed62-060c-3248-99da-d2889cfccbf1", "product": {"name": "Linux"}, "product_version": "6.7"}, {"id": "4bb3cb4d-8c57-3f00-bd3e-1ca7a9cca6c0", "product": {"name": "Linux"}, "product_version": "52526ca7fdb905a768a93f8faa418e9b988fc34b <a2cb8818a3d915cd33a1e8b2babc1bb0c34862c3"}, {"id": "5c5a81a1-4df6-3954-979f-1bbafb276b04", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5eba7caa-2ba7-3626-ad6c-9476d8c7df7b", "product": {"name": "Linux"}, "product_version": "patch: 6.12.50"}, {"id": "66b90f4c-0793-3fc2-bbde-4a5c82d1c56d", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "76196999-5f2c-33cd-96bf-1965abadef81", "product": {"name": "Linux"}, "product_version": "52526ca7fdb905a768a93f8faa418e9b988fc34b <ca988dcdc6683ecd9de5f525ce469588a9141c21"}, {"id": "9485dc88-6120-37f4-b9a1-a9b9a34af8c2", "product": {"name": "Linux"}, "product_version": "patch: 6.16.10"}, {"id": "ac352fee-9942-3e55-a0be-7038388a2ba0", "product": {"name": "Linux"}, "product_version": "52526ca7fdb905a768a93f8faa418e9b988fc34b <28aa29986dde79e8466bc87569141291053833f5"}], "enisaIdVendor": [{"id": "439c3161-253c-322f-bab1-b3de2d172585", "vendor": {"name": "Linux"}}], "isExploited": false}