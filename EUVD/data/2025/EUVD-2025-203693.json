{"id": "EUVD-2025-203693", "enisaUuid": "1f7aca93-c984-3ad2-b209-e8c77dd32f72", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amdgpu: fix lock warning in amdgpu_userq_fence_driver_process\n\nFix a potential deadlock caused by inconsistent spinlock usage\nbetween interrupt and process contexts in the userq fence driver.\n\nThe issue occurs when amdgpu_userq_fence_driver_process() is called\nfrom both:\n- Interrupt context: gfx_v11_0_eop_irq() -> amdgpu_userq_fence_driver_process()\n- Process context: amdgpu_eviction_fence_suspend_worker() ->\n  amdgpu_userq_fence_driver_force_completion() -> amdgpu_userq_fence_driver_process()\n\nIn interrupt context, the spinlock was acquired without disabling\ninterrupts, leaving it in {IN-HARDIRQ-W} state. When the same lock\nis acquired in process context, the kernel detects inconsistent\nlocking since the process context acquisition would enable interrupts\nwhile holding a lock previously acquired in interrupt context.\n\nKernel log shows:\n[ 4039.310790] inconsistent {IN-HARDIRQ-W} -> {HARDIRQ-ON-W} usage.\n[ 4039.310804] kworker/7:2/409 [HC0[0]:SC0[0]:HE1:SE1] takes:\n[ 4039.310818] ffff9284e1bed000 (&fence_drv->fence_list_lock){?...}-{3:3},\n[ 4039.310993] {IN-HARDIRQ-W} state was registered at:\n[ 4039.311004]   lock_acquire+0xc6/0x300\n[ 4039.311018]   _raw_spin_lock+0x39/0x80\n[ 4039.311031]   amdgpu_userq_fence_driver_process.part.0+0x30/0x180 [amdgpu]\n[ 4039.311146]   amdgpu_userq_fence_driver_process+0x17/0x30 [amdgpu]\n[ 4039.311257]   gfx_v11_0_eop_irq+0x132/0x170 [amdgpu]\n\nFix by using spin_lock_irqsave()/spin_unlock_irqrestore() to properly\nmanage interrupt state regardless of calling context.\n\n(cherry picked from commit ded3ad780cf97a04927773c4600823b84f7f3cc2)", "datePublished": "2025-12-16T15:30:45", "dateUpdated": "2025-12-16T15:30:45", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1ad70a06d7e91c378b346a3718c81abb50a74b74", "https://git.kernel.org/stable/c/6623c5f9fd877868fba133b4ae4dab0052e82dad", "https://nvd.nist.gov/vuln/detail/CVE-2025-68203"], "aliases": ["CVE-2025-68203"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2af21b1e-e3e0-3686-a324-124a26323d80", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1ad70a06d7e91c378b346a3718c81abb50a74b74"}, {"id": "54de0874-b7ef-310e-8be8-dcd4b5e77a2a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6623c5f9fd877868fba133b4ae4dab0052e82dad"}, {"id": "5c4aab8c-b4e3-3811-9f36-221030866a3d", "product": {"name": "Linux"}, "product_version": "patch: 6.17.9"}, {"id": "ea217bc3-676b-328f-933f-134df2c81f66", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}], "enisaIdVendor": [{"id": "b781177e-51b9-3985-b9c1-562382135b9a", "vendor": {"name": "Linux"}}], "isExploited": false}