{"id": "EUVD-2025-201873", "enisaUuid": "d4acea75-133f-3882-af1c-414a78b4a1e2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/sched: Fix deadlock in drm_sched_entity_kill_jobs_cb\n\nThe Mesa issue referenced below pointed out a possible deadlock:\n\n[ 1231.611031]  Possible interrupt unsafe locking scenario:\n\n[ 1231.611033]        CPU0                    CPU1\n[ 1231.611034]        ----                    ----\n[ 1231.611035]   lock(&xa->xa_lock#17);\n[ 1231.611038]                                local_irq_disable();\n[ 1231.611039]                                lock(&fence->lock);\n[ 1231.611041]                                lock(&xa->xa_lock#17);\n[ 1231.611044]   <Interrupt>\n[ 1231.611045]     lock(&fence->lock);\n[ 1231.611047]\n                *** DEADLOCK ***\n\nIn this example, CPU0 would be any function accessing job->dependencies\nthrough the xa_* functions that don't disable interrupts (eg:\ndrm_sched_job_add_dependency(), drm_sched_entity_kill_jobs_cb()).\n\nCPU1 is executing drm_sched_entity_kill_jobs_cb() as a fence signalling\ncallback so in an interrupt context. It will deadlock when trying to\ngrab the xa_lock which is already held by CPU0.\n\nReplacing all xa_* usage by their xa_*_irq counterparts would fix\nthis issue, but Christian pointed out another issue: dma_fence_signal\ntakes fence.lock and so does dma_fence_add_callback.\n\n  dma_fence_signal() // locks f1.lock\n  -> drm_sched_entity_kill_jobs_cb()\n  -> foreach dependencies\n     -> dma_fence_add_callback() // locks f2.lock\n\nThis will deadlock if f1 and f2 share the same spinlock.\n\nTo fix both issues, the code iterating on dependencies and re-arming them\nis moved out to drm_sched_entity_kill_jobs_work().\n\n[phasta: commit message nits]", "datePublished": "2025-12-09T18:30:35", "dateUpdated": "2025-12-09T18:30:35", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/70150b9443dddf02157d821c68abf438f55a2e8e", "https://git.kernel.org/stable/c/0d63031ee4a57be0252cb9a4e09ae921c75cece9", "https://git.kernel.org/stable/c/3e8ada4fd838e3fd2cca94000dac054f3a347c01", "https://git.kernel.org/stable/c/487df8b698345dd5a91346335f05170ed5f29d4e", "https://nvd.nist.gov/vuln/detail/CVE-2025-40329"], "aliases": ["CVE-2025-40329"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0d528afa-db7c-3acb-9fbc-e9d658ca8e58", "product": {"name": "Linux"}, "product_version": "2fdb8a8f07c2f1353770a324fd19b8114e4329ac <70150b9443dddf02157d821c68abf438f55a2e8e"}, {"id": "1d6f4a26-1ebd-3082-8f85-f1a55d3d3f45", "product": {"name": "Linux"}, "product_version": "2fdb8a8f07c2f1353770a324fd19b8114e4329ac <3e8ada4fd838e3fd2cca94000dac054f3a347c01"}, {"id": "4ad8f6e5-3ff9-37c9-b5f1-82d099397a9e", "product": {"name": "Linux"}, "product_version": "2fdb8a8f07c2f1353770a324fd19b8114e4329ac <0d63031ee4a57be0252cb9a4e09ae921c75cece9"}, {"id": "57ac0967-894b-30ee-ac59-fd4d38ee8ec2", "product": {"name": "Linux"}, "product_version": "6.2"}, {"id": "66dbc896-905c-316b-851d-5151a04063f6", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "94843055-48cc-3c58-a01f-558870551565", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "a9ff89a4-6c3f-36e8-a200-cd00fdf4d283", "product": {"name": "Linux"}, "product_version": "patch: 6.17.8"}, {"id": "c817340d-3338-35fd-9c64-555e998bdfe4", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "cf17cf1d-9a37-306c-82f0-47429c379821", "product": {"name": "Linux"}, "product_version": "2fdb8a8f07c2f1353770a324fd19b8114e4329ac <487df8b698345dd5a91346335f05170ed5f29d4e"}, {"id": "e10d0984-c1b8-3462-9cda-1ce2526592fb", "product": {"name": "Linux"}, "product_version": "patch: 6.12.58"}], "enisaIdVendor": [{"id": "8b16b951-618c-3c76-884d-8a507952446d", "vendor": {"name": "Linux"}}], "isExploited": false}