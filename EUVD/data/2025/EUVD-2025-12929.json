{"id": "EUVD-2025-12929", "enisaUuid": "962c4303-b930-32d4-bb3f-1861525cd46a", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nriscv: fix reserved memory setup\n\nCurrently, RISC-V sets up reserved memory using the \"early\" copy of the\ndevice tree. As a result, when trying to get a reserved memory region\nusing of_reserved_mem_lookup(), the pointer to reserved memory regions\nis using the early, pre-virtual-memory address which causes a kernel\npanic when trying to use the buffer's name:\n\n Unable to handle kernel paging request at virtual address 00000000401c31ac\n Oops [#1]\n Modules linked in:\n CPU: 0 PID: 0 Comm: swapper Not tainted 6.0.0-rc1-00001-g0d9d6953d834 #1\n Hardware name: Microchip PolarFire-SoC Icicle Kit (DT)\n epc : string+0x4a/0xea\n  ra : vsnprintf+0x1e4/0x336\n epc : ffffffff80335ea0 ra : ffffffff80338936 sp : ffffffff81203be0\n  gp : ffffffff812e0a98 tp : ffffffff8120de40 t0 : 0000000000000000\n  t1 : ffffffff81203e28 t2 : 7265736572203a46 s0 : ffffffff81203c20\n  s1 : ffffffff81203e28 a0 : ffffffff81203d22 a1 : 0000000000000000\n  a2 : ffffffff81203d08 a3 : 0000000081203d21 a4 : ffffffffffffffff\n  a5 : 00000000401c31ac a6 : ffff0a00ffffff04 a7 : ffffffffffffffff\n  s2 : ffffffff81203d08 s3 : ffffffff81203d00 s4 : 0000000000000008\n  s5 : ffffffff000000ff s6 : 0000000000ffffff s7 : 00000000ffffff00\n  s8 : ffffffff80d9821a s9 : ffffffff81203d22 s10: 0000000000000002\n  s11: ffffffff80d9821c t3 : ffffffff812f3617 t4 : ffffffff812f3617\n  t5 : ffffffff812f3618 t6 : ffffffff81203d08\n status: 0000000200000100 badaddr: 00000000401c31ac cause: 000000000000000d\n [<ffffffff80338936>] vsnprintf+0x1e4/0x336\n [<ffffffff80055ae2>] vprintk_store+0xf6/0x344\n [<ffffffff80055d86>] vprintk_emit+0x56/0x192\n [<ffffffff80055ed8>] vprintk_default+0x16/0x1e\n [<ffffffff800563d2>] vprintk+0x72/0x80\n [<ffffffff806813b2>] _printk+0x36/0x50\n [<ffffffff8068af48>] print_reserved_mem+0x1c/0x24\n [<ffffffff808057ec>] paging_init+0x528/0x5bc\n [<ffffffff808031ae>] setup_arch+0xd0/0x592\n [<ffffffff8080070e>] start_kernel+0x82/0x73c\n\nearly_init_fdt_scan_reserved_mem() takes no arguments as it operates on\ninitial_boot_params, which is populated by early_init_dt_verify(). On\nRISC-V, early_init_dt_verify() is called twice. Once, directly, in\nsetup_arch() if CONFIG_BUILTIN_DTB is not enabled and once indirectly,\nvery early in the boot process, by parse_dtb() when it calls\nearly_init_dt_scan_nodes().\n\nThis first call uses dtb_early_va to set initial_boot_params, which is\nnot usable later in the boot process when\nearly_init_fdt_scan_reserved_mem() is called. On arm64 for example, the\ncorresponding call to early_init_dt_scan_nodes() uses fixmap addresses\nand doesn't suffer the same fate.\n\nMove early_init_fdt_scan_reserved_mem() further along the boot sequence,\nafter the direct call to early_init_dt_verify() in setup_arch() so that\nthe names use the correct virtual memory addresses. The above supposed\nthat CONFIG_BUILTIN_DTB was not set, but should work equally in the case\nwhere it is - unflatted_and_copy_device_tree() also updates\ninitial_boot_params.", "datePublished": "2025-05-01T15:31:49", "dateUpdated": "2025-11-10T21:30:28", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-49851", "https://git.kernel.org/stable/c/50e63dd8ed92045eb70a72d7ec725488320fb68b", "https://git.kernel.org/stable/c/518e49f0590de66555503aabe199ba8d3f2e24ac", "https://git.kernel.org/stable/c/93598deb101540c4f9e7de15099ea8255b965fc2", "https://git.kernel.org/stable/c/94ab8f88feb75e3b1486102c0c9c550f37d9d137"], "aliases": ["CVE-2022-49851", "GHSA-mx8w-x2cj-333g"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "381f3420-3c5c-3395-9604-3e71f12a8886", "product": {"name": "Linux"}, "product_version": "922b0375fc93fb1a20c5617e37c389c26bbccb70 <518e49f0590de66555503aabe199ba8d3f2e24ac"}, {"id": "409c3deb-fb93-32f8-8072-8357aaed3e58", "product": {"name": "Linux"}, "product_version": "922b0375fc93fb1a20c5617e37c389c26bbccb70 <93598deb101540c4f9e7de15099ea8255b965fc2"}, {"id": "657a66a3-5f49-36cb-b4ec-545da11bd154", "product": {"name": "Linux"}, "product_version": "patch: 6.0.9"}, {"id": "8daa19a3-dbbe-3b59-a5c8-5d767b4209a4", "product": {"name": "Linux"}, "product_version": "f18ed5bee7bb8a0e99e1c7e7d45e0e51d3497248"}, {"id": "912881cd-ec70-3bba-b345-752814a888d5", "product": {"name": "Linux"}, "product_version": "patch: 5.10.155"}, {"id": "9cf60a04-5de5-38d3-9195-61aaca375649", "product": {"name": "Linux"}, "product_version": "patch: 5.15.79"}, {"id": "9fb71bf7-8642-3bd1-8251-c09e6336a9c2", "product": {"name": "Linux"}, "product_version": "922b0375fc93fb1a20c5617e37c389c26bbccb70 <50e63dd8ed92045eb70a72d7ec725488320fb68b"}, {"id": "a387294c-34ca-32e5-9805-deae697c24e0", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ab9be9d6-6bd1-3de9-9b99-9399526d0239", "product": {"name": "Linux"}, "product_version": "922b0375fc93fb1a20c5617e37c389c26bbccb70 <94ab8f88feb75e3b1486102c0c9c550f37d9d137"}, {"id": "c9e05288-5d4e-33f5-b776-148525302432", "product": {"name": "Linux"}, "product_version": "patch: 6.1"}, {"id": "fb6f993a-96ee-3a41-9b92-df8a836d2311", "product": {"name": "Linux"}, "product_version": "5.4"}], "enisaIdVendor": [{"id": "1be2fe56-2441-3084-a89b-7b1120baa8c1", "vendor": {"name": "Linux"}}], "isExploited": false}