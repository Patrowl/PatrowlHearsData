{"id": "EUVD-2025-203793", "enisaUuid": "b5bd9bfc-435b-3834-ae97-544f17b41a45", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: dwc3: Fix race condition between concurrent dwc3_remove_requests() call paths\n\nThis patch addresses a race condition caused by unsynchronized\nexecution of multiple call paths invoking `dwc3_remove_requests()`,\nleading to premature freeing of USB requests and subsequent crashes.\n\nThree distinct execution paths interact with `dwc3_remove_requests()`:\nPath 1:\nTriggered via `dwc3_gadget_reset_interrupt()` during USB reset\nhandling. The call stack includes:\n- `dwc3_ep0_reset_state()`\n- `dwc3_ep0_stall_and_restart()`\n- `dwc3_ep0_out_start()`\n- `dwc3_remove_requests()`\n- `dwc3_gadget_del_and_unmap_request()`\n\nPath 2:\nAlso initiated from `dwc3_gadget_reset_interrupt()`, but through\n`dwc3_stop_active_transfers()`. The call stack includes:\n- `dwc3_stop_active_transfers()`\n- `dwc3_remove_requests()`\n- `dwc3_gadget_del_and_unmap_request()`\n\nPath 3:\nOccurs independently during `adb root` execution, which triggers\nUSB function unbind and bind operations. The sequence includes:\n- `gserial_disconnect()`\n- `usb_ep_disable()`\n- `dwc3_gadget_ep_disable()`\n- `dwc3_remove_requests()` with `-ESHUTDOWN` status\n\nPath 3 operates asynchronously and lacks synchronization with Paths\n1 and 2. When Path 3 completes, it disables endpoints and frees 'out'\nrequests. If Paths 1 or 2 are still processing these requests,\naccessing freed memory leads to a crash due to use-after-free conditions.\n\nTo fix this added check for request completion and skip processing\nif already completed and added the request status for ep0 while queue.", "datePublished": "2025-12-16T18:31:33", "dateUpdated": "2025-12-16T18:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/467add9db13219101f14b6cc5477998b4aaa5fe2", "https://git.kernel.org/stable/c/67192e8cb7f941b5bba91e4bb290683576ce1607", "https://git.kernel.org/stable/c/47de14d741cc4057046c9e2f33df1f7828254e6c", "https://git.kernel.org/stable/c/afc0e34f161ce61ad351303c46eb57bd44b8b090", "https://git.kernel.org/stable/c/7cfb62888eba292fa35cd9ddbd28ce595f60e139", "https://git.kernel.org/stable/c/fa5eaf701e576880070b60922200557ae4aa54e1", "https://git.kernel.org/stable/c/e4037689a366743c4233966f0e74bc455820d316", "https://nvd.nist.gov/vuln/detail/CVE-2025-68287"], "aliases": ["CVE-2025-68287"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0cd35b54-a4cd-31d4-9083-213b5620429a", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <67192e8cb7f941b5bba91e4bb290683576ce1607"}, {"id": "283aeb3e-1f8f-386a-9aae-9ed79e4a8a31", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <7cfb62888eba292fa35cd9ddbd28ce595f60e139"}, {"id": "2968f0eb-db92-3658-b4bb-a154f7f1d2d3", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <467add9db13219101f14b6cc5477998b4aaa5fe2"}, {"id": "358fe45e-19a3-3a81-8028-0182a9d2bc6b", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <fa5eaf701e576880070b60922200557ae4aa54e1"}, {"id": "3d46728b-c324-366d-a96e-ec8dbfefb977", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "4980e6f4-9f4f-3c97-b9c1-9d5fe986c83f", "product": {"name": "Linux"}, "product_version": "patch: 6.12.61"}, {"id": "4d0cd09c-a69a-3376-8f02-c297102243d1", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "60d1b5e0-5b7a-3989-8588-34d130b96dc9", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "647f6632-b7c8-3102-a717-78ba3bb63e9b", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <e4037689a366743c4233966f0e74bc455820d316"}, {"id": "67bf0806-d3bf-321d-8b08-9245edd8a355", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "713abfe2-72fe-348c-aa41-bd73c3227b7e", "product": {"name": "Linux"}, "product_version": "patch: 6.6.119"}, {"id": "7a3ce98c-d4ed-3458-bccb-74a895fdfc83", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "7eb50a49-48cf-3240-9458-e92e2b093ec5", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <47de14d741cc4057046c9e2f33df1f7828254e6c"}, {"id": "a60f8f0d-33f2-38ee-8cb1-f393dd1a9492", "product": {"name": "Linux"}, "product_version": "72246da40f3719af3bfd104a2365b32537c27d83 <afc0e34f161ce61ad351303c46eb57bd44b8b090"}, {"id": "b8dfd332-297b-3c6e-b9e4-3c15219564ec", "product": {"name": "Linux"}, "product_version": "patch: 6.17.11"}, {"id": "fc83ea21-6088-32db-9c7d-a743eeccbdce", "product": {"name": "Linux"}, "product_version": "3.2"}], "enisaIdVendor": [{"id": "3d58d4eb-21f0-38ae-9129-f11e9ebd8eee", "vendor": {"name": "Linux"}}], "isExploited": false}