{"id": "EUVD-2025-36442", "enisaUuid": "adfc7eaa-7f02-33d4-86af-227e4011e972", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on node footer for non inode dnode\n\nAs syzbot reported below:\n\n------------[ cut here ]------------\nkernel BUG at fs/f2fs/file.c:1243!\nOops: invalid opcode: 0000 [#1] SMP KASAN NOPTI\nCPU: 0 UID: 0 PID: 5354 Comm: syz.0.0 Not tainted 6.17.0-rc1-syzkaller-00211-g90d970cade8e #0 PREEMPT(full)\nRIP: 0010:f2fs_truncate_hole+0x69e/0x6c0 fs/f2fs/file.c:1243\nCall Trace:\n <TASK>\n f2fs_punch_hole+0x2db/0x330 fs/f2fs/file.c:1306\n f2fs_fallocate+0x546/0x990 fs/f2fs/file.c:2018\n vfs_fallocate+0x666/0x7e0 fs/open.c:342\n ksys_fallocate fs/open.c:366 [inline]\n __do_sys_fallocate fs/open.c:371 [inline]\n __se_sys_fallocate fs/open.c:369 [inline]\n __x64_sys_fallocate+0xc0/0x110 fs/open.c:369\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f1e65f8ebe9\n\nw/ a fuzzed image, f2fs may encounter panic due to it detects inconsistent\ntruncation range in direct node in f2fs_truncate_hole().\n\nThe root cause is: a non-inode dnode may has the same footer.ino and\nfooter.nid, so the dnode will be parsed as an inode, then ADDRS_PER_PAGE()\nmay return wrong blkaddr count which may be 923 typically, by chance,\ndn.ofs_in_node is equal to 923, then count can be calculated to 0 in below\nstatement, later it will trigger panic w/ f2fs_bug_on(, count == 0 || ...).\n\n\tcount = min(end_offset - dn.ofs_in_node, pg_end - pg_start);\n\nThis patch introduces a new node_type NODE_TYPE_NON_INODE, then allowing\npassing the new_type to sanity_check_node_footer in f2fs_get_node_folio()\nto detect corruption that a non-inode dnode has the same footer.ino and\nfooter.nid.\n\nScripts to reproduce:\nmkfs.f2fs -f /dev/vdb\nmount /dev/vdb /mnt/f2fs\ntouch /mnt/f2fs/foo\ntouch /mnt/f2fs/bar\ndd if=/dev/zero of=/mnt/f2fs/foo bs=1M count=8\numount /mnt/f2fs\ninject.f2fs --node --mb i_nid --nid 4 --idx 0 --val 5 /dev/vdb\nmount /dev/vdb /mnt/f2fs\nxfs_io /mnt/f2fs/foo -c \"fpunch 6984k 4k\"", "datePublished": "2025-10-28T09:32:31", "dateUpdated": "2025-12-20T08:51:47", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/186098f34b8a5d65eb828f952c8cc56272c60ea0", "https://git.kernel.org/stable/c/c18ecd99e0c707ef8f83cace861cbc3162f4fdf1", "https://nvd.nist.gov/vuln/detail/CVE-2025-40025"], "aliases": ["CVE-2025-40025"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "1075101c-c9f8-3a6c-a45a-0dbeef67d85e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c18ecd99e0c707ef8f83cace861cbc3162f4fdf1"}, {"id": "12a30e91-befd-3eaa-ac78-ffd579c5b19d", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <c18ecd99e0c707ef8f83cace861cbc3162f4fdf1"}, {"id": "2a6c299a-a2cf-374e-a394-90e0a9a24104", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <186098f34b8a5d65eb828f952c8cc56272c60ea0"}, {"id": "3a6d7e03-4652-3729-a5c6-35289c0172ee", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "4dd47cce-f324-3a2c-803f-5f36fe8b1a59", "product": {"name": "Linux"}, "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <186098f34b8a5d65eb828f952c8cc56272c60ea0"}, {"id": "8d15d3e2-8248-3e76-aa7a-45e5b37df0e4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "cf906578-1314-3bb9-a38a-74f4259845bc", "product": {"name": "Linux"}, "product_version": "patch: 6.17.2"}, {"id": "e04ce4fe-5dfc-3d80-9cca-9f207db1c6f1", "product": {"name": "Linux"}, "product_version": "3.8"}, {"id": "f04a82b9-80f6-3add-9d11-90b2b967bc85", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}], "enisaIdVendor": [{"id": "cc4fb3b4-d8ca-3149-b748-9103f255d14c", "vendor": {"name": "Linux"}}], "isExploited": false}