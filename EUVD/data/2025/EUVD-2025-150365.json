{"id": "EUVD-2025-150365", "enisaUuid": "072ce7cc-48e0-3116-a60c-753e414f489e", "description": "cups-filters contains backends, filters, and other software required to get the cups printing service working on operating systems other than macos. In cups-filters prior to 1.28.18, by crafting a PDF file with a large `MediaBox` value, an attacker can cause CUPS-Filter 1.x\u2019s `pdftoraster` tool to write beyond the bounds of an array. First, a PDF with a large `MediaBox` width value causes `header.cupsWidth` to become large.  Next, the calculation of `bytesPerLine = (header.cupsBitsPerPixel * header.cupsWidth + 7) / 8` overflows, resulting in a small value. Then, `lineBuf` is allocated with the small `bytesPerLine` size. Finally, `convertLineChunked` calls `writePixel8`, which attempts to write to `lineBuf` outside of its buffer size (out of bounds write). In libcupsfilters, the maintainers found the same `bytesPerLine` multiplication without overflow check, but the provided test case does not cause an overflow there, because the values are different. Commit 50d94ca0f2fa6177613c97c59791bde568631865 contains a patch, which is incorporated into cups-filters version 1.28.18.", "datePublished": "2025-11-12T22:04:03", "dateUpdated": "2025-11-13T16:56:18", "baseScore": 4.0, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "references": ["https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-893j-2wr2-wrh9", "https://github.com/OpenPrinting/cups-filters/commit/50d94ca0f2fa6177613c97c59791bde568631865", "https://github.com/OpenPrinting/cups-filters/blob/aea8d0db017e495b0204433ebdb0e86b4871094c/filter/pdftoraster.cxx#L1620", "https://github.com/OpenPrinting/cups-filters/blob/aea8d0db017e495b0204433ebdb0e86b4871094c/filter/pdftoraster.cxx#L1880", "https://github.com/OpenPrinting/libcupsfilters/blob/1dd86d835b27ed149b66aee1a4853d1db8a1f44c/cupsfilters/pdftoraster.cxx#L1790"], "aliases": ["CVE-2025-64503"], "assigner": "GitHub_M", "epss": 0.02, "enisaIdProduct": [{"id": "abf203a2-8a57-37f9-b0a8-ec0dd9b7ec89", "product": {"name": "cups-filters"}, "product_version": "libcupsfilters  2.0.0, < 2.1.2"}, {"id": "f2b4938c-116d-368d-8158-78088004e5b0", "product": {"name": "cups-filters"}, "product_version": "cups-filters < 1.28.18"}], "enisaIdVendor": [{"id": "51714f9d-1882-3bb0-9986-59d6bf690417", "vendor": {"name": "OpenPrinting"}}], "isExploited": false}