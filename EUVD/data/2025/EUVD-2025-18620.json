{"id": "EUVD-2025-18620", "enisaUuid": "4f5b9486-f801-350b-8cd6-a3ec353a39c2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmr: consolidate the ipmr_can_free_table() checks.\n\nGuoyu Yin reported a splat in the ipmr netns cleanup path:\n\nWARNING: CPU: 2 PID: 14564 at net/ipv4/ipmr.c:440 ipmr_free_table net/ipv4/ipmr.c:440 [inline]\nWARNING: CPU: 2 PID: 14564 at net/ipv4/ipmr.c:440 ipmr_rules_exit+0x135/0x1c0 net/ipv4/ipmr.c:361\nModules linked in:\nCPU: 2 UID: 0 PID: 14564 Comm: syz.4.838 Not tainted 6.14.0 #1\nHardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\nRIP: 0010:ipmr_free_table net/ipv4/ipmr.c:440 [inline]\nRIP: 0010:ipmr_rules_exit+0x135/0x1c0 net/ipv4/ipmr.c:361\nCode: ff df 48 c1 ea 03 80 3c 02 00 75 7d 48 c7 83 60 05 00 00 00 00 00 00 5b 5d 41 5c 41 5d 41 5e e9 71 67 7f 00 e8 4c 2d 8a fd 90 <0f> 0b 90 eb 93 e8 41 2d 8a fd 0f b6 2d 80 54 ea 01 31 ff 89 ee e8\nRSP: 0018:ffff888109547c58 EFLAGS: 00010293\nRAX: 0000000000000000 RBX: ffff888108c12dc0 RCX: ffffffff83e09868\nRDX: ffff8881022b3300 RSI: ffffffff83e098d4 RDI: 0000000000000005\nRBP: ffff888104288000 R08: 0000000000000000 R09: ffffed10211825c9\nR10: 0000000000000001 R11: ffff88801816c4a0 R12: 0000000000000001\nR13: ffff888108c13320 R14: ffff888108c12dc0 R15: fffffbfff0b74058\nFS:  00007f84f39316c0(0000) GS:ffff88811b100000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f84f3930f98 CR3: 0000000113b56000 CR4: 0000000000350ef0\nCall Trace:\n <TASK>\n ipmr_net_exit_batch+0x50/0x90 net/ipv4/ipmr.c:3160\n ops_exit_list+0x10c/0x160 net/core/net_namespace.c:177\n setup_net+0x47d/0x8e0 net/core/net_namespace.c:394\n copy_net_ns+0x25d/0x410 net/core/net_namespace.c:516\n create_new_namespaces+0x3f6/0xaf0 kernel/nsproxy.c:110\n unshare_nsproxy_namespaces+0xc3/0x180 kernel/nsproxy.c:228\n ksys_unshare+0x78d/0x9a0 kernel/fork.c:3342\n __do_sys_unshare kernel/fork.c:3413 [inline]\n __se_sys_unshare kernel/fork.c:3411 [inline]\n __x64_sys_unshare+0x31/0x40 kernel/fork.c:3411\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xa6/0x1a0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f84f532cc29\nCode: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007f84f3931038 EFLAGS: 00000246 ORIG_RAX: 0000000000000110\nRAX: ffffffffffffffda RBX: 00007f84f5615fa0 RCX: 00007f84f532cc29\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000040000400\nRBP: 00007f84f53fba18 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000\nR13: 0000000000000000 R14: 00007f84f5615fa0 R15: 00007fff51c5f328\n </TASK>\n\nThe running kernel has CONFIG_IP_MROUTE_MULTIPLE_TABLES disabled, and\nthe sanity check for such build is still too loose.\n\nAddress the issue consolidating the relevant sanity check in a single\nhelper regardless of the kernel configuration. Also share it between\nthe ipv4 and ipv6 code.", "datePublished": "2025-06-18T12:30:31", "dateUpdated": "2025-11-14T18:31:21", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1c518ae98302ab37786d5ba5d43e9ac6d6f894e3", "https://git.kernel.org/stable/c/c46286fdd6aa1d0e33c245bcffe9ff2428a777bd", "https://nvd.nist.gov/vuln/detail/CVE-2025-38032"], "aliases": ["CVE-2025-38032"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "27545674-01dd-3865-9147-a706b87139ce", "product": {"name": "Linux"}, "product_version": "50b94204446e1215af081fd713d7d566d9258e35 <1c518ae98302ab37786d5ba5d43e9ac6d6f894e3"}, {"id": "86387377-e533-39a7-8dde-7fb1a5300d53", "product": {"name": "Linux"}, "product_version": "patch: 6.14.9"}, {"id": "8ce76d1d-975c-3bc2-91c8-d768f29db22c", "product": {"name": "Linux"}, "product_version": "50b94204446e1215af081fd713d7d566d9258e35 <c46286fdd6aa1d0e33c245bcffe9ff2428a777bd"}, {"id": "be0c778e-193a-31f5-8f7b-040b1f21da36", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f4595cbc-3910-396b-bb85-5d071c8bb6e9", "product": {"name": "Linux"}, "product_version": "6.13"}, {"id": "f8d52fa0-e84e-35d8-ad78-0d9104975949", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}], "enisaIdVendor": [{"id": "a3cc90cf-e9b4-3725-82dd-0fe1dc789f8f", "vendor": {"name": "Linux"}}], "isExploited": false}