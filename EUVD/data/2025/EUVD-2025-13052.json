{"id": "EUVD-2025-13052", "enisaUuid": "c6b2754d-2b99-3408-af39-3eed9a991dbe", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/xe: Fix an out-of-bounds shift when invalidating TLB\n\nWhen the size of the range invalidated is larger than\nrounddown_pow_of_two(ULONG_MAX),\nThe function macro roundup_pow_of_two(length) will hit an out-of-bounds\nshift [1].\n\nUse a full TLB invalidation for such cases.\nv2:\n- Use a define for the range size limit over which we use a full\n  TLB invalidation. (Lucas)\n- Use a better calculation of the limit.\n\n[1]:\n[   39.202421] ------------[ cut here ]------------\n[   39.202657] UBSAN: shift-out-of-bounds in ./include/linux/log2.h:57:13\n[   39.202673] shift exponent 64 is too large for 64-bit type 'long unsigned int'\n[   39.202688] CPU: 8 UID: 0 PID: 3129 Comm: xe_exec_system_ Tainted: G     U             6.14.0+ #10\n[   39.202690] Tainted: [U]=USER\n[   39.202690] Hardware name: ASUS System Product Name/PRIME B560M-A AC, BIOS 2001 02/01/2023\n[   39.202691] Call Trace:\n[   39.202692]  <TASK>\n[   39.202695]  dump_stack_lvl+0x6e/0xa0\n[   39.202699]  ubsan_epilogue+0x5/0x30\n[   39.202701]  __ubsan_handle_shift_out_of_bounds.cold+0x61/0xe6\n[   39.202705]  xe_gt_tlb_invalidation_range.cold+0x1d/0x3a [xe]\n[   39.202800]  ? find_held_lock+0x2b/0x80\n[   39.202803]  ? mark_held_locks+0x40/0x70\n[   39.202806]  xe_svm_invalidate+0x459/0x700 [xe]\n[   39.202897]  drm_gpusvm_notifier_invalidate+0x4d/0x70 [drm_gpusvm]\n[   39.202900]  __mmu_notifier_release+0x1f5/0x270\n[   39.202905]  exit_mmap+0x40e/0x450\n[   39.202912]  __mmput+0x45/0x110\n[   39.202914]  exit_mm+0xc5/0x130\n[   39.202916]  do_exit+0x21c/0x500\n[   39.202918]  ? lockdep_hardirqs_on_prepare+0xdb/0x190\n[   39.202920]  do_group_exit+0x36/0xa0\n[   39.202922]  get_signal+0x8f8/0x900\n[   39.202926]  arch_do_signal_or_restart+0x35/0x100\n[   39.202930]  syscall_exit_to_user_mode+0x1fc/0x290\n[   39.202932]  do_syscall_64+0xa1/0x180\n[   39.202934]  ? do_user_addr_fault+0x59f/0x8a0\n[   39.202937]  ? lock_release+0xd2/0x2a0\n[   39.202939]  ? do_user_addr_fault+0x5a9/0x8a0\n[   39.202942]  ? trace_hardirqs_off+0x4b/0xc0\n[   39.202944]  ? clear_bhb_loop+0x25/0x80\n[   39.202946]  ? clear_bhb_loop+0x25/0x80\n[   39.202947]  ? clear_bhb_loop+0x25/0x80\n[   39.202950]  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n[   39.202952] RIP: 0033:0x7fa945e543e1\n[   39.202961] Code: Unable to access opcode bytes at 0x7fa945e543b7.\n[   39.202962] RSP: 002b:00007ffca8fb4170 EFLAGS: 00000293\n[   39.202963] RAX: 000000000000003d RBX: 0000000000000000 RCX: 00007fa945e543e3\n[   39.202964] RDX: 0000000000000000 RSI: 00007ffca8fb41ac RDI: 00000000ffffffff\n[   39.202964] RBP: 00007ffca8fb4190 R08: 0000000000000000 R09: 00007fa945f600a0\n[   39.202965] R10: 0000000000000000 R11: 0000000000000293 R12: 0000000000000000\n[   39.202966] R13: 00007fa9460dd310 R14: 00007ffca8fb41ac R15: 0000000000000000\n[   39.202970]  </TASK>\n[   39.202970] ---[ end trace ]---\n\n(cherry picked from commit b88f48f86500bc0b44b4f73ac66d500a40d320ad)", "datePublished": "2025-05-01T15:31:43", "dateUpdated": "2025-11-07T00:30:26", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-37761", "https://git.kernel.org/stable/c/28477f701b63922ff88e9fb13f5519c11cd48b86", "https://git.kernel.org/stable/c/7bcfeddb36b77f9fe3b010bb0b282b7618420bba", "https://git.kernel.org/stable/c/e4715858f87b78ce58cfa03bbe140321edbbaf20"], "aliases": ["CVE-2025-37761", "GHSA-mmv8-63hv-mhrh"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "097447a7-9cfe-3b23-af8b-421ee2fd9bb7", "product": {"name": "Linux"}, "product_version": "6.8"}, {"id": "2ca2cf97-d997-34c8-a1f8-d0d4524784f8", "product": {"name": "Linux"}, "product_version": "332dd0116c82a75df175a459fa69dda3f23491a7 <7bcfeddb36b77f9fe3b010bb0b282b7618420bba"}, {"id": "2eb7a451-d217-3bb2-9f05-a4f7de531f3a", "product": {"name": "Linux"}, "product_version": "332dd0116c82a75df175a459fa69dda3f23491a7 <28477f701b63922ff88e9fb13f5519c11cd48b86"}, {"id": "a5a0c8e3-a1e8-32fe-bbb6-b38ba86350f1", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc2"}, {"id": "c292f366-d3cb-3007-81b2-46c92381462d", "product": {"name": "Linux"}, "product_version": "332dd0116c82a75df175a459fa69dda3f23491a7 <e4715858f87b78ce58cfa03bbe140321edbbaf20"}, {"id": "c70731f9-4c98-3b49-af17-4e4487147046", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "ced1b76f-69f9-368a-8aa2-8143daef0763", "product": {"name": "Linux"}, "product_version": "patch: 6.14.4"}, {"id": "e5222b26-0cdd-30cc-bb73-f2a8c8f142e0", "product": {"name": "Linux"}, "product_version": "patch: 6.12.25"}], "enisaIdVendor": [{"id": "5d2be735-9397-3742-bd1f-e4420c56cbb5", "vendor": {"name": "Linux"}}], "isExploited": false}