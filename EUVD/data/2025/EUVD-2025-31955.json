{"id": "EUVD-2025-31955", "enisaUuid": "770c73fd-426a-313d-ab3e-904ef9c5f8f8", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niavf: Fix out-of-bounds when setting channels on remove\n\nIf we set channels greater during iavf_remove(), and waiting reset done\nwould be timeout, then returned with error but changed num_active_queues\ndirectly, that will lead to OOB like the following logs. Because the\nnum_active_queues is greater than tx/rx_rings[] allocated actually.\n\nReproducer:\n\n  [root@host ~]# cat repro.sh\n  #!/bin/bash\n\n  pf_dbsf=\"0000:41:00.0\"\n  vf0_dbsf=\"0000:41:02.0\"\n  g_pids=()\n\n  function do_set_numvf()\n  {\n      echo 2 >/sys/bus/pci/devices/${pf_dbsf}/sriov_numvfs\n      sleep $((RANDOM%3+1))\n      echo 0 >/sys/bus/pci/devices/${pf_dbsf}/sriov_numvfs\n      sleep $((RANDOM%3+1))\n  }\n\n  function do_set_channel()\n  {\n      local nic=$(ls -1 --indicator-style=none /sys/bus/pci/devices/${vf0_dbsf}/net/)\n      [ -z \"$nic\" ] && { sleep $((RANDOM%3)) ; return 1; }\n      ifconfig $nic 192.168.18.5 netmask 255.255.255.0\n      ifconfig $nic up\n      ethtool -L $nic combined 1\n      ethtool -L $nic combined 4\n      sleep $((RANDOM%3))\n  }\n\n  function on_exit()\n  {\n      local pid\n      for pid in \"${g_pids[@]}\"; do\n          kill -0 \"$pid\" &>/dev/null && kill \"$pid\" &>/dev/null\n      done\n      g_pids=()\n  }\n\n  trap \"on_exit; exit\" EXIT\n\n  while :; do do_set_numvf ; done &\n  g_pids+=($!)\n  while :; do do_set_channel ; done &\n  g_pids+=($!)\n\n  wait\n\nResult:\n\n[ 3506.152887] iavf 0000:41:02.0: Removing device\n[ 3510.400799] ==================================================================\n[ 3510.400820] BUG: KASAN: slab-out-of-bounds in iavf_free_all_tx_resources+0x156/0x160 [iavf]\n[ 3510.400823] Read of size 8 at addr ffff88b6f9311008 by task repro.sh/55536\n[ 3510.400823]\n[ 3510.400830] CPU: 101 PID: 55536 Comm: repro.sh Kdump: loaded Tainted: G           O     --------- -t - 4.18.0 #1\n[ 3510.400832] Hardware name: Powerleader PR2008AL/H12DSi-N6, BIOS 2.0 04/09/2021\n[ 3510.400835] Call Trace:\n[ 3510.400851]  dump_stack+0x71/0xab\n[ 3510.400860]  print_address_description+0x6b/0x290\n[ 3510.400865]  ? iavf_free_all_tx_resources+0x156/0x160 [iavf]\n[ 3510.400868]  kasan_report+0x14a/0x2b0\n[ 3510.400873]  iavf_free_all_tx_resources+0x156/0x160 [iavf]\n[ 3510.400880]  iavf_remove+0x2b6/0xc70 [iavf]\n[ 3510.400884]  ? iavf_free_all_rx_resources+0x160/0x160 [iavf]\n[ 3510.400891]  ? wait_woken+0x1d0/0x1d0\n[ 3510.400895]  ? notifier_call_chain+0xc1/0x130\n[ 3510.400903]  pci_device_remove+0xa8/0x1f0\n[ 3510.400910]  device_release_driver_internal+0x1c6/0x460\n[ 3510.400916]  pci_stop_bus_device+0x101/0x150\n[ 3510.400919]  pci_stop_and_remove_bus_device+0xe/0x20\n[ 3510.400924]  pci_iov_remove_virtfn+0x187/0x420\n[ 3510.400927]  ? pci_iov_add_virtfn+0xe10/0xe10\n[ 3510.400929]  ? pci_get_subsys+0x90/0x90\n[ 3510.400932]  sriov_disable+0xed/0x3e0\n[ 3510.400936]  ? bus_find_device+0x12d/0x1a0\n[ 3510.400953]  i40e_free_vfs+0x754/0x1210 [i40e]\n[ 3510.400966]  ? i40e_reset_all_vfs+0x880/0x880 [i40e]\n[ 3510.400968]  ? pci_get_device+0x7c/0x90\n[ 3510.400970]  ? pci_get_subsys+0x90/0x90\n[ 3510.400982]  ? pci_vfs_assigned.part.7+0x144/0x210\n[ 3510.400987]  ? __mutex_lock_slowpath+0x10/0x10\n[ 3510.400996]  i40e_pci_sriov_configure+0x1fa/0x2e0 [i40e]\n[ 3510.401001]  sriov_numvfs_store+0x214/0x290\n[ 3510.401005]  ? sriov_totalvfs_show+0x30/0x30\n[ 3510.401007]  ? __mutex_lock_slowpath+0x10/0x10\n[ 3510.401011]  ? __check_object_size+0x15a/0x350\n[ 3510.401018]  kernfs_fop_write+0x280/0x3f0\n[ 3510.401022]  vfs_write+0x145/0x440\n[ 3510.401025]  ksys_write+0xab/0x160\n[ 3510.401028]  ? __ia32_sys_read+0xb0/0xb0\n[ 3510.401031]  ? fput_many+0x1a/0x120\n[ 3510.401032]  ? filp_close+0xf0/0x130\n[ 3510.401038]  do_syscall_64+0xa0/0x370\n[ 3510.401041]  ? page_fault+0x8/0x30\n[ 3510.401043]  entry_SYSCALL_64_after_hwframe+0x65/0xca\n[ 3510.401073] RIP: 0033:0x7f3a9bb842c0\n[ 3510.401079] Code: 73 01 c3 48 8b 0d d8 cb 2c 00 f7 d8 64 89 01 48 83 c8 ff c3 66 0f 1f 44 00 00 83 3d 89 24 2d 00 00 75 10 b8 01 00 00 00 0f 05 <48> 3d \n---truncated---", "datePublished": "2025-10-07T15:21:19", "dateUpdated": "2025-10-07T15:21:19", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53659", "https://git.kernel.org/stable/c/0fb37ce6c01e17839e26d03222f0b44e6a3ed2b9", "https://git.kernel.org/stable/c/65ecebc9ac09427b2c65f271cd5e5bd536c3fe38", "https://git.kernel.org/stable/c/6e1d8f1332076a002e6d910d255aa5903d341c56", "https://git.kernel.org/stable/c/7c4bced3caa749ce468b0c5de711c98476b23a52", "https://git.kernel.org/stable/c/b92defe4e8ee86996c16417ad8c804cb4395fddd"], "aliases": ["CVE-2023-53659", "GHSA-h9wv-v64w-rmq6"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "186ca639-3a6a-30f0-aedc-37c51ec95c36", "product": {"name": "Linux"}, "product_version": "4e5e6b5d9d1334d3490326b6922a2daaf56a867f <7c4bced3caa749ce468b0c5de711c98476b23a52"}, {"id": "2b3f1e04-0682-34c1-b3df-874a592aed8c", "product": {"name": "Linux"}, "product_version": "patch: 6.4.7"}, {"id": "421056a3-6bd1-3259-bdb8-18407bce0e70", "product": {"name": "Linux"}, "product_version": "4e5e6b5d9d1334d3490326b6922a2daaf56a867f <6e1d8f1332076a002e6d910d255aa5903d341c56"}, {"id": "44841ad3-ebbf-3dcf-b372-5f1b9cc6af13", "product": {"name": "Linux"}, "product_version": "patch: 5.10.188"}, {"id": "5b018034-7285-3bce-8fae-a050b6c591d7", "product": {"name": "Linux"}, "product_version": "5.16"}, {"id": "62339249-99fa-33eb-a6a5-1e16d4d49745", "product": {"name": "Linux"}, "product_version": "4e5e6b5d9d1334d3490326b6922a2daaf56a867f <65ecebc9ac09427b2c65f271cd5e5bd536c3fe38"}, {"id": "857cf6e0-f312-367b-8288-6221b359c32e", "product": {"name": "Linux"}, "product_version": "1555d83ddbb7204ef60c58aee6ca3bbef2c5e99f <b92defe4e8ee86996c16417ad8c804cb4395fddd"}, {"id": "ac686d36-1f90-3628-9426-4e7c5907cc55", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "c9e60c59-df86-3a67-9df9-00510a3e3f29", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "df44d69e-bab0-3b15-a4e5-da1ec22d10ad", "product": {"name": "Linux"}, "product_version": "patch: 6.1.42"}, {"id": "e9bc98b4-d80b-3df2-977f-342019f79ca1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.123"}, {"id": "ee0aa797-ae6b-3628-9515-9bbfdd7413b9", "product": {"name": "Linux"}, "product_version": "68d4274034e618b7f190dc9fbfc4f3436a7430f4 <0fb37ce6c01e17839e26d03222f0b44e6a3ed2b9"}], "enisaIdVendor": [{"id": "b0423c83-263e-3d99-a8b4-cbf4e575c7b7", "vendor": {"name": "Linux"}}], "isExploited": false}