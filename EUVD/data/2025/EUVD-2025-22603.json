{"id": "EUVD-2025-22603", "enisaUuid": "1ca90416-ebed-361f-8f51-b31875fbab6d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnfs: Clean up /proc/net/rpc/nfs when nfs_fs_proc_net_init() fails.\n\nsyzbot reported a warning below [1] following a fault injection in\nnfs_fs_proc_net_init(). [0]\n\nWhen nfs_fs_proc_net_init() fails, /proc/net/rpc/nfs is not removed.\n\nLater, rpc_proc_exit() tries to remove /proc/net/rpc, and the warning\nis logged as the directory is not empty.\n\nLet's handle the error of nfs_fs_proc_net_init() properly.\n\n[0]:\nFAULT_INJECTION: forcing a failure.\nname failslab, interval 1, probability 0, space 0, times 0\nCPU: 1 UID: 0 PID: 6120 Comm: syz.2.27 Not tainted 6.16.0-rc1-syzkaller-00010-g2c4a1f3fe03e #0 PREEMPT(full)\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/07/2025\nCall Trace:\n <TASK>\n  dump_stack_lvl (lib/dump_stack.c:123)\n should_fail_ex (lib/fault-inject.c:73 lib/fault-inject.c:174)\n should_failslab (mm/failslab.c:46)\n kmem_cache_alloc_noprof (mm/slub.c:4178 mm/slub.c:4204)\n __proc_create (fs/proc/generic.c:427)\n proc_create_reg (fs/proc/generic.c:554)\n proc_create_net_data (fs/proc/proc_net.c:120)\n nfs_fs_proc_net_init (fs/nfs/client.c:1409)\n nfs_net_init (fs/nfs/inode.c:2600)\n ops_init (net/core/net_namespace.c:138)\n setup_net (net/core/net_namespace.c:443)\n copy_net_ns (net/core/net_namespace.c:576)\n create_new_namespaces (kernel/nsproxy.c:110)\n unshare_nsproxy_namespaces (kernel/nsproxy.c:218 (discriminator 4))\n ksys_unshare (kernel/fork.c:3123)\n __x64_sys_unshare (kernel/fork.c:3190)\n do_syscall_64 (arch/x86/entry/syscall_64.c:63 arch/x86/entry/syscall_64.c:94)\n entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n </TASK>\n\n[1]:\nremove_proc_entry: removing non-empty directory 'net/rpc', leaking at least 'nfs'\n WARNING: CPU: 1 PID: 6120 at fs/proc/generic.c:727 remove_proc_entry+0x45e/0x530 fs/proc/generic.c:727\nModules linked in:\nCPU: 1 UID: 0 PID: 6120 Comm: syz.2.27 Not tainted 6.16.0-rc1-syzkaller-00010-g2c4a1f3fe03e #0 PREEMPT(full)\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/07/2025\n RIP: 0010:remove_proc_entry+0x45e/0x530 fs/proc/generic.c:727\nCode: 3c 02 00 0f 85 85 00 00 00 48 8b 93 d8 00 00 00 4d 89 f0 4c 89 e9 48 c7 c6 40 ba a2 8b 48 c7 c7 60 b9 a2 8b e8 33 81 1d ff 90 <0f> 0b 90 90 e9 5f fe ff ff e8 04 69 5e ff 90 48 b8 00 00 00 00 00\nRSP: 0018:ffffc90003637b08 EFLAGS: 00010282\nRAX: 0000000000000000 RBX: ffff88805f534140 RCX: ffffffff817a92c8\nRDX: ffff88807da99e00 RSI: ffffffff817a92d5 RDI: 0000000000000001\nRBP: ffff888033431ac0 R08: 0000000000000001 R09: 0000000000000000\nR10: 0000000000000001 R11: 0000000000000001 R12: ffff888033431a00\nR13: ffff888033431ae4 R14: ffff888033184724 R15: dffffc0000000000\nFS:  0000555580328500(0000) GS:ffff888124a62000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f71733743e0 CR3: 000000007f618000 CR4: 00000000003526f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n  sunrpc_exit_net+0x46/0x90 net/sunrpc/sunrpc_syms.c:76\n  ops_exit_list net/core/net_namespace.c:200 [inline]\n  ops_undo_list+0x2eb/0xab0 net/core/net_namespace.c:253\n  setup_net+0x2e1/0x510 net/core/net_namespace.c:457\n  copy_net_ns+0x2a6/0x5f0 net/core/net_namespace.c:574\n  create_new_namespaces+0x3ea/0xa90 kernel/nsproxy.c:110\n  unshare_nsproxy_namespaces+0xc0/0x1f0 kernel/nsproxy.c:218\n  ksys_unshare+0x45b/0xa40 kernel/fork.c:3121\n  __do_sys_unshare kernel/fork.c:3192 [inline]\n  __se_sys_unshare kernel/fork.c:3190 [inline]\n  __x64_sys_unshare+0x31/0x40 kernel/fork.c:3190\n  do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n  do_syscall_64+0xcd/0x490 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7fa1a6b8e929\nCode: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c\n---truncated---", "datePublished": "2025-07-25T15:30:53", "dateUpdated": "2025-12-23T21:30:21", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/8785701fd7cd52ae74c0d2b35b82568df74e9dbb", "https://git.kernel.org/stable/c/412534a1fb76958b88dca48360c6f3ad4f3390f4", "https://git.kernel.org/stable/c/b92397ce96743e4cc090207e2df2a856cb4cef08", "https://git.kernel.org/stable/c/7701c245ff1ac1a126bf431e72b24547519046ff", "https://git.kernel.org/stable/c/d0877c479f44fe475f4c8c02c88ce9ad43e90298", "https://git.kernel.org/stable/c/3c94212b57bedec3a386ef3da1ef00602f5c3d1d", "https://git.kernel.org/stable/c/6acf340f8c1d296bcf535986175f5d0d6f2aab09", "https://git.kernel.org/stable/c/e8d6f3ab59468e230f3253efe5cb63efa35289f7", "https://nvd.nist.gov/vuln/detail/CVE-2025-38400", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38400"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "0e9189d9-7392-36ed-80a5-b96b4184b1b1", "product": {"name": "Linux"}, "product_version": "6.9"}, {"id": "1453ba21-d909-3dab-8b25-4b0dba08c97f", "product": {"name": "Linux"}, "product_version": "d47151b79e3220e72ae323b8b8e9d6da20dc884e <3c94212b57bedec3a386ef3da1ef00602f5c3d1d"}, {"id": "26c23930-8f90-32f6-a7ec-df8d30834011", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "2eee314c-0956-3c78-9e6c-b4bf0f03472f", "product": {"name": "Linux"}, "product_version": "53a0365c9f9f66e1a981bf9188d8716d682e0739 <d0877c479f44fe475f4c8c02c88ce9ad43e90298"}, {"id": "4889759b-b4a9-3d1a-bd0b-b804632b6e4e", "product": {"name": "Linux"}, "product_version": "31dd0cda5aa0547de447aaf184812f85ccc34044 <8785701fd7cd52ae74c0d2b35b82568df74e9dbb"}, {"id": "522fc1cc-17c3-3f6e-9529-acf52675130f", "product": {"name": "Linux"}, "product_version": "9dd86e9d34b1078dcd647220e96a205028bf4e6f <7701c245ff1ac1a126bf431e72b24547519046ff"}, {"id": "657027b1-dd9c-3c46-86ef-2c288906aae3", "product": {"name": "Linux"}, "product_version": "patch: 6.6.97"}, {"id": "6f235f54-2006-3d38-8f01-4294bcf2ad58", "product": {"name": "Linux"}, "product_version": "patch: 6.12.37"}, {"id": "7157c137-218a-39cd-bb32-131297e11334", "product": {"name": "Linux"}, "product_version": "patch: 5.15.187"}, {"id": "760ffd44-0e44-3f11-81fc-496f03885c2e", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc5"}, {"id": "7d071a1b-8611-33f2-96e9-760f2c074a23", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "855e2a9d-da0d-3848-9f62-fd458f9d3cc9", "product": {"name": "Linux"}, "product_version": "d47151b79e3220e72ae323b8b8e9d6da20dc884e <e8d6f3ab59468e230f3253efe5cb63efa35289f7"}, {"id": "8cbab47d-e5db-3d50-8042-b5d739b3bc71", "product": {"name": "Linux"}, "product_version": "patch: 6.15.6"}, {"id": "95aa0380-e9c8-3b3e-8fe3-aff0e13d5b16", "product": {"name": "Linux"}, "product_version": "patch: 6.1.144"}, {"id": "95c35a15-1cad-35ea-b898-929749c0a21c", "product": {"name": "Linux"}, "product_version": "d47151b79e3220e72ae323b8b8e9d6da20dc884e <6acf340f8c1d296bcf535986175f5d0d6f2aab09"}, {"id": "a9452912-11c0-3aa2-abfb-8cf421fed410", "product": {"name": "Linux"}, "product_version": "patch: 5.4.296"}, {"id": "c5fa70fd-9b89-3373-abd2-9606874cecb0", "product": {"name": "Linux"}, "product_version": "e05194baae299f2148ab5f6bab659c6ce8d1f6d3"}, {"id": "c8b85b6b-798b-3cbf-921d-eb24bca1b020", "product": {"name": "Linux"}, "product_version": "patch: 5.10.240"}, {"id": "cd092297-eaa8-38e2-a9b9-109ea2c4d66c", "product": {"name": "Linux"}, "product_version": "6eef21eb7a165601882dad0419a630e32d2d7a2c <412534a1fb76958b88dca48360c6f3ad4f3390f4"}, {"id": "ce6ebcf1-52d7-39ed-a881-918ec7b9be9f", "product": {"name": "Linux"}, "product_version": "0bbd429260821dfb81478749837d3e6377949ac6 <b92397ce96743e4cc090207e2df2a856cb4cef08"}], "enisaIdVendor": [{"id": "e3c00c48-9364-3403-ba45-c41e8765e113", "vendor": {"name": "Linux"}}], "isExploited": false}