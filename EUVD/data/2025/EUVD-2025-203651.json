{"id": "EUVD-2025-203651", "enisaUuid": "ffaa5b9b-6aa9-3e90-a0d7-1649f1536b57", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: netpoll: fix incorrect refcount handling causing incorrect cleanup\n\ncommit efa95b01da18 (\"netpoll: fix use after free\") incorrectly\nignored the refcount and prematurely set dev->npinfo to NULL during\nnetpoll cleanup, leading to improper behavior and memory leaks.\n\nScenario causing lack of proper cleanup:\n\n1) A netpoll is associated with a NIC (e.g., eth0) and netdev->npinfo is\n   allocated, and refcnt = 1\n   - Keep in mind that npinfo is shared among all netpoll instances. In\n     this case, there is just one.\n\n2) Another netpoll is also associated with the same NIC and\n   npinfo->refcnt += 1.\n   - Now dev->npinfo->refcnt = 2;\n   - There is just one npinfo associated to the netdev.\n\n3) When the first netpolls goes to clean up:\n   - The first cleanup succeeds and clears np->dev->npinfo, ignoring\n     refcnt.\n     - It basically calls `RCU_INIT_POINTER(np->dev->npinfo, NULL);`\n   - Set dev->npinfo = NULL, without proper cleanup\n   - No ->ndo_netpoll_cleanup() is either called\n\n4) Now the second target tries to clean up\n   - The second cleanup fails because np->dev->npinfo is already NULL.\n     * In this case, ops->ndo_netpoll_cleanup() was never called, and\n       the skb pool is not cleaned as well (for the second netpoll\n       instance)\n  - This leaks npinfo and skbpool skbs, which is clearly reported by\n    kmemleak.\n\nRevert commit efa95b01da18 (\"netpoll: fix use after free\") and adds\nclarifying comments emphasizing that npinfo cleanup should only happen\nonce the refcount reaches zero, ensuring stable and correct netpoll\nbehavior.", "datePublished": "2025-12-16T15:30:47", "dateUpdated": "2025-12-16T15:30:47", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/8e6a50edad11e3e1426e4c29e7aa6201f3468ac2", "https://git.kernel.org/stable/c/9b0bb18b4b9dc017c1825a2c5e763615e34a1593", "https://git.kernel.org/stable/c/890472d6fbf062e6de7fdd56642cb305ab79d669", "https://git.kernel.org/stable/c/4afd4ebbad52aa146838ec23082ba393e426a2bb", "https://git.kernel.org/stable/c/c645693180a98606c430825223d2029315d85e9d", "https://git.kernel.org/stable/c/c79a6d9da29219616b118a3adce9a14cd30f9bd0", "https://git.kernel.org/stable/c/9a51b5ccd1c79afec1c03a4e1e6688da52597556", "https://git.kernel.org/stable/c/49c8d2c1f94cc2f4d1a108530d7ba52614b874c2", "https://nvd.nist.gov/vuln/detail/CVE-2025-68245"], "aliases": ["CVE-2025-68245"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "28d874b8-05b3-31d9-8d30-8bc1e52933c0", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <49c8d2c1f94cc2f4d1a108530d7ba52614b874c2"}, {"id": "2fdc8375-2d87-30d2-9893-ea8cb0aabfd5", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <4afd4ebbad52aa146838ec23082ba393e426a2bb"}, {"id": "441adaba-4687-34c7-bef6-92f8ecc82292", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <c79a6d9da29219616b118a3adce9a14cd30f9bd0"}, {"id": "727fdfd3-c83d-3176-80af-d9c3a2c1aff8", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "7942e58f-7fdf-3e42-ad8e-39b6c599eb4c", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <9a51b5ccd1c79afec1c03a4e1e6688da52597556"}, {"id": "7d1a0c59-7949-354f-860b-70bec22b818c", "product": {"name": "Linux"}, "product_version": "3.17"}, {"id": "7f5f2e68-3526-33b5-ac2d-48d0ca2809d2", "product": {"name": "Linux"}, "product_version": "patch: 6.12.59"}, {"id": "80ae1b8f-a117-3efd-b712-a899e90b6639", "product": {"name": "Linux"}, "product_version": "patch: 6.17.9"}, {"id": "83646c5f-e357-30d2-9c8b-6b6b58656cba", "product": {"name": "Linux"}, "product_version": "patch: 5.4.302"}, {"id": "85b2cbc1-bd91-352f-a920-e8a88116bfa7", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "8ca2a4b1-329e-3b03-adfe-3aa27ab70701", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <9b0bb18b4b9dc017c1825a2c5e763615e34a1593"}, {"id": "936b015d-13cf-3dd3-a3d7-91183fd744b5", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <890472d6fbf062e6de7fdd56642cb305ab79d669"}, {"id": "962970de-bb43-3a4b-a8f1-83a01e04f18f", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "964ed0f9-0f1a-32fb-918b-a8e90bacb2ee", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <8e6a50edad11e3e1426e4c29e7aa6201f3468ac2"}, {"id": "a1066358-12cf-3897-a729-26ca6d914d7a", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "a81b0da5-919b-326d-ae04-bec728f12225", "product": {"name": "Linux"}, "product_version": "efa95b01da18ad22af62f6d99a3243f3be8fd264 <c645693180a98606c430825223d2029315d85e9d"}, {"id": "cc36d2c4-adb3-3c8f-b621-29d75a17fc6f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f7a2edcc-dfc0-302c-b473-33a4d7aa0f37", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}], "enisaIdVendor": [{"id": "2ec9cd34-f764-3ebf-9247-ab91c543f120", "vendor": {"name": "Linux"}}], "isExploited": false}