{"id": "EUVD-2025-32369", "enisaUuid": "9a254c0a-3fc8-3ef1-b0e4-e423b47df4c5", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nntb_netdev: Use dev_kfree_skb_any() in interrupt context\n\nTX/RX callback handlers (ntb_netdev_tx_handler(),\nntb_netdev_rx_handler()) can be called in interrupt\ncontext via the DMA framework when the respective\nDMA operations have completed. As such, any calls\nby these routines to free skb's, should use the\ninterrupt context safe dev_kfree_skb_any() function.\n\nPreviously, these callback handlers would call the\ninterrupt unsafe version of dev_kfree_skb(). This has\nnot presented an issue on Intel IOAT DMA engines as\nthat driver utilizes tasklets rather than a hard\ninterrupt handler, like the AMD PTDMA DMA driver.\nOn AMD systems, a kernel WARNING message is\nencountered, which is being issued from\nskb_release_head_state() due to in_hardirq()\nbeing true.\n\nBesides the user visible WARNING from the kernel,\nthe other symptom of this bug was that TCP/IP performance\nacross the ntb_netdev interface was very poor, i.e.\napproximately an order of magnitude below what was\nexpected. With the repair to use dev_kfree_skb_any(),\nkernel WARNINGs from skb_release_head_state() ceased\nand TCP/IP performance, as measured by iperf, was on\npar with expected results, approximately 20 Gb/s on\nAMD Milan based server. Note that this performance\nis comparable with Intel based servers.", "datePublished": "2025-10-04T15:16:36", "dateUpdated": "2025-10-04T15:16:36", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-50476", "https://git.kernel.org/stable/c/07e28a8f450217db679802ebd4de0915556ce846", "https://git.kernel.org/stable/c/13286ad1c7c49c606fdcba4cf66f953a1a16c1ca", "https://git.kernel.org/stable/c/14d245da57a11e80277ab455aa9b6dcc5ed38a19", "https://git.kernel.org/stable/c/21296a52caa6a6bad6debdfe40ad81d4f1a27e69", "https://git.kernel.org/stable/c/5f7d78b2b12a9d561f48fa00bab29b40f4616dad", "https://git.kernel.org/stable/c/8b78493968ed3cef0326183ed059c55e42f24d5b", "https://git.kernel.org/stable/c/a6b9e09403102bdf8402dae734800e4916c7ea58", "https://git.kernel.org/stable/c/d4460c82177899751975180c268f352893302221", "https://git.kernel.org/stable/c/dd860b39aa7c7b82e6c99b6fdb99d4610ce49d67"], "aliases": ["CVE-2022-50476", "GHSA-gh9q-398w-69gx"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "098edb92-340c-3021-9103-f7dffe4a80bc", "product": {"name": "Linux"}, "product_version": "patch: 6.1.2"}, {"id": "0ed32766-2c5c-3ec1-aa50-0b92898ac059", "product": {"name": "Linux"}, "product_version": "patch: 4.14.303"}, {"id": "14fa1662-764a-3759-bd7e-7b8fcfb5341b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "175cd48d-6b5f-3c68-a6b8-ef04a6b0f739", "product": {"name": "Linux"}, "product_version": "patch: 5.4.229"}, {"id": "37a018ae-6fb8-391b-8569-78a6ed9a8bbf", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <d4460c82177899751975180c268f352893302221"}, {"id": "3861d9e4-ad62-3025-979f-9b1d0b4deaf2", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <21296a52caa6a6bad6debdfe40ad81d4f1a27e69"}, {"id": "435092d9-52cf-34e6-98b6-1a584c338079", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <13286ad1c7c49c606fdcba4cf66f953a1a16c1ca"}, {"id": "49fa999e-ea2b-36e6-a983-114041815f77", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <8b78493968ed3cef0326183ed059c55e42f24d5b"}, {"id": "56060d45-2a80-3a24-b5f9-198fc2fa8901", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <a6b9e09403102bdf8402dae734800e4916c7ea58"}, {"id": "855b8544-d5c7-3e5d-8b65-b7fe48fcab77", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <07e28a8f450217db679802ebd4de0915556ce846"}, {"id": "88d3f24a-c397-3a63-b24d-909136f35a1e", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <5f7d78b2b12a9d561f48fa00bab29b40f4616dad"}, {"id": "91746aa0-5e6b-3b61-a909-d0af9b575a83", "product": {"name": "Linux"}, "product_version": "patch: 5.10.163"}, {"id": "aa15c5fc-167f-365d-b417-55bdb0fe7b4e", "product": {"name": "Linux"}, "product_version": "patch: 4.9.337"}, {"id": "b2b4d0c1-35a9-3a99-986a-025a451630d2", "product": {"name": "Linux"}, "product_version": "patch: 4.19.270"}, {"id": "b375a8d5-e8b2-3e15-81b7-b1fa7cf876f7", "product": {"name": "Linux"}, "product_version": "3.9"}, {"id": "b910ad5e-6a20-3312-a52f-78407f2c4365", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <14d245da57a11e80277ab455aa9b6dcc5ed38a19"}, {"id": "d10138b3-5d1e-3f08-b8fa-28815020f989", "product": {"name": "Linux"}, "product_version": "patch: 5.15.86"}, {"id": "e56468be-4fce-311b-b6f8-29352ae2f296", "product": {"name": "Linux"}, "product_version": "patch: 6.2"}, {"id": "f0ea2153-c54d-30bb-b646-1ca002af4494", "product": {"name": "Linux"}, "product_version": "548c237c0a9972df5d1afaca38aa733ee577128d <dd860b39aa7c7b82e6c99b6fdb99d4610ce49d67"}, {"id": "fa0230e5-dbad-3e64-b2f6-4ad86b9be6c6", "product": {"name": "Linux"}, "product_version": "patch: 6.0.16"}], "enisaIdVendor": [{"id": "3c16e011-f336-37e7-881f-ddd5a2e84a65", "vendor": {"name": "Linux"}}], "isExploited": false}