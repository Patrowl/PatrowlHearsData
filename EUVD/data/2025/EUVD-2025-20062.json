{"id": "EUVD-2025-20062", "enisaUuid": "0d6999e2-1da8-3cca-88b1-f11fbaf70535", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\njffs2: check that raw node were preallocated before writing summary\n\nSyzkaller detected a kernel bug in jffs2_link_node_ref, caused by fault\ninjection in jffs2_prealloc_raw_node_refs. jffs2_sum_write_sumnode doesn't\ncheck return value of jffs2_prealloc_raw_node_refs and simply lets any\nerror propagate into jffs2_sum_write_data, which eventually calls\njffs2_link_node_ref in order to link the summary to an expectedly allocated\nnode.\n\nkernel BUG at fs/jffs2/nodelist.c:592!\ninvalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI\nCPU: 1 PID: 31277 Comm: syz-executor.7 Not tainted 6.1.128-syzkaller-00139-ge10f83ca10a1 #0\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.12.0-1 04/01/2014\nRIP: 0010:jffs2_link_node_ref+0x570/0x690 fs/jffs2/nodelist.c:592\nCall Trace:\n <TASK>\n jffs2_sum_write_data fs/jffs2/summary.c:841 [inline]\n jffs2_sum_write_sumnode+0xd1a/0x1da0 fs/jffs2/summary.c:874\n jffs2_do_reserve_space+0xa18/0xd60 fs/jffs2/nodemgmt.c:388\n jffs2_reserve_space+0x55f/0xaa0 fs/jffs2/nodemgmt.c:197\n jffs2_write_inode_range+0x246/0xb50 fs/jffs2/write.c:362\n jffs2_write_end+0x726/0x15d0 fs/jffs2/file.c:301\n generic_perform_write+0x314/0x5d0 mm/filemap.c:3856\n __generic_file_write_iter+0x2ae/0x4d0 mm/filemap.c:3973\n generic_file_write_iter+0xe3/0x350 mm/filemap.c:4005\n call_write_iter include/linux/fs.h:2265 [inline]\n do_iter_readv_writev+0x20f/0x3c0 fs/read_write.c:735\n do_iter_write+0x186/0x710 fs/read_write.c:861\n vfs_iter_write+0x70/0xa0 fs/read_write.c:902\n iter_file_splice_write+0x73b/0xc90 fs/splice.c:685\n do_splice_from fs/splice.c:763 [inline]\n direct_splice_actor+0x10c/0x170 fs/splice.c:950\n splice_direct_to_actor+0x337/0xa10 fs/splice.c:896\n do_splice_direct+0x1a9/0x280 fs/splice.c:1002\n do_sendfile+0xb13/0x12c0 fs/read_write.c:1255\n __do_sys_sendfile64 fs/read_write.c:1323 [inline]\n __se_sys_sendfile64 fs/read_write.c:1309 [inline]\n __x64_sys_sendfile64+0x1cf/0x210 fs/read_write.c:1309\n do_syscall_x64 arch/x86/entry/common.c:51 [inline]\n do_syscall_64+0x35/0x80 arch/x86/entry/common.c:81\n entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n\nFix this issue by checking return value of jffs2_prealloc_raw_node_refs\nbefore calling jffs2_sum_write_data.\n\nFound by Linux Verification Center (linuxtesting.org) with Syzkaller.", "datePublished": "2025-07-04T15:31:09", "dateUpdated": "2025-12-18T21:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/337f80f3d546e131c7aa90b61d8cde051ae858c7", "https://git.kernel.org/stable/c/8ce46dc5b10b0b6f67663202a4921b0e11ad7367", "https://git.kernel.org/stable/c/4adee34098a6ee86a54bf3ec885eab620c126a6b", "https://git.kernel.org/stable/c/c0edcdb4fc106d69a2d1a0ce4868193511c389f3", "https://git.kernel.org/stable/c/3f46644a5131a4793fc95c32a7d0a769745b06e7", "https://git.kernel.org/stable/c/da12ef7e19048dc5714032c2db587a215852b200", "https://git.kernel.org/stable/c/346cfb9d19ea7feb6fb57917b21c4797fb444dab", "https://git.kernel.org/stable/c/ec9e6f22bce433b260ea226de127ec68042849b0", "https://nvd.nist.gov/vuln/detail/CVE-2025-38194", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38194"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "045e5095-1a7f-3f58-b2bc-ebb169f308c6", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <337f80f3d546e131c7aa90b61d8cde051ae858c7"}, {"id": "0771c67a-8783-3a0e-a839-86e0ba523d92", "product": {"name": "Linux"}, "product_version": "2.6.18"}, {"id": "08573bcf-45f1-3904-a1fe-bed30f205ed2", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <8ce46dc5b10b0b6f67663202a4921b0e11ad7367"}, {"id": "08fc029e-83d9-372a-b9da-0041e3be791f", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <ec9e6f22bce433b260ea226de127ec68042849b0"}, {"id": "24e2c18c-c659-3927-933d-451b92b5fe93", "product": {"name": "Linux"}, "product_version": "patch: 6.12.35"}, {"id": "2be4d4d0-3d0d-3693-9c59-e6c33af2deae", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "35e8ba4c-4c5d-346d-bccf-fa8c52e50028", "product": {"name": "Linux"}, "product_version": "patch: 5.10.239"}, {"id": "39e9e95b-21a3-38a7-b61a-c25d9e010708", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}, {"id": "4838b223-c11b-3138-bc7f-98a9db4d8e8d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}, {"id": "55ea1355-72c6-3c97-b6cd-26fe2d086b1c", "product": {"name": "Linux"}, "product_version": "patch: 6.15.4"}, {"id": "63df20c8-7fbe-3e63-95c2-d8dea6cce3a0", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <da12ef7e19048dc5714032c2db587a215852b200"}, {"id": "667d009b-551e-31fc-8082-1afbc79bc185", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <3f46644a5131a4793fc95c32a7d0a769745b06e7"}, {"id": "6fd5f3e8-1b73-32e8-9fcf-52fb49b234b2", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "809d6db3-fe7e-33ef-8d38-62727bd354a6", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <346cfb9d19ea7feb6fb57917b21c4797fb444dab"}, {"id": "8b028a71-9fd0-3a7d-b6f5-70b0508cf7b5", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <c0edcdb4fc106d69a2d1a0ce4868193511c389f3"}, {"id": "aeebba83-8542-390e-9f79-edd4bb59a6a6", "product": {"name": "Linux"}, "product_version": "2f785402f39b96a077b6e62bf26164bfb8e0c980 <4adee34098a6ee86a54bf3ec885eab620c126a6b"}, {"id": "b523f4f4-3dac-3738-be37-4d179f7feda3", "product": {"name": "Linux"}, "product_version": "patch: 5.4.295"}, {"id": "c3ffd87c-17c9-36f5-9fee-be7051971475", "product": {"name": "Linux"}, "product_version": "patch: 6.6.95"}, {"id": "d5b63bfc-3cdf-3fa1-8187-078faad0f0e8", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}], "enisaIdVendor": [{"id": "6111bf38-23f3-38f3-bd43-75f67413e08c", "vendor": {"name": "Linux"}}], "isExploited": false}