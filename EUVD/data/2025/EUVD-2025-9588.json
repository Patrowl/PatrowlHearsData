{"id": "EUVD-2025-9588", "enisaUuid": "30e6a37c-fbb3-335c-9c4e-ab8f525d0f38", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nproc: fix UAF in proc_get_inode()\n\nFix race between rmmod and /proc/XXX's inode instantiation.\n\nThe bug is that pde->proc_ops don't belong to /proc, it belongs to a\nmodule, therefore dereferencing it after /proc entry has been registered\nis a bug unless use_pde/unuse_pde() pair has been used.\n\nuse_pde/unuse_pde can be avoided (2 atomic ops!) because pde->proc_ops\nnever changes so information necessary for inode instantiation can be\nsaved _before_ proc_register() in PDE itself and used later, avoiding\npde->proc_ops->...  dereference.\n\n      rmmod                         lookup\nsys_delete_module\n                         proc_lookup_de\n\t\t\t   pde_get(de);\n\t\t\t   proc_get_inode(dir->i_sb, de);\n  mod->exit()\n    proc_remove\n      remove_proc_subtree\n       proc_entry_rundown(de);\n  free_module(mod);\n\n                               if (S_ISREG(inode->i_mode))\n\t                         if (de->proc_ops->proc_read_iter)\n                           --> As module is already freed, will trigger UAF\n\nBUG: unable to handle page fault for address: fffffbfff80a702b\nPGD 817fc4067 P4D 817fc4067 PUD 817fc0067 PMD 102ef4067 PTE 0\nOops: Oops: 0000 [#1] PREEMPT SMP KASAN PTI\nCPU: 26 UID: 0 PID: 2667 Comm: ls Tainted: G\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996)\nRIP: 0010:proc_get_inode+0x302/0x6e0\nRSP: 0018:ffff88811c837998 EFLAGS: 00010a06\nRAX: dffffc0000000000 RBX: ffffffffc0538140 RCX: 0000000000000007\nRDX: 1ffffffff80a702b RSI: 0000000000000001 RDI: ffffffffc0538158\nRBP: ffff8881299a6000 R08: 0000000067bbe1e5 R09: 1ffff11023906f20\nR10: ffffffffb560ca07 R11: ffffffffb2b43a58 R12: ffff888105bb78f0\nR13: ffff888100518048 R14: ffff8881299a6004 R15: 0000000000000001\nFS:  00007f95b9686840(0000) GS:ffff8883af100000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: fffffbfff80a702b CR3: 0000000117dd2000 CR4: 00000000000006f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n proc_lookup_de+0x11f/0x2e0\n __lookup_slow+0x188/0x350\n walk_component+0x2ab/0x4f0\n path_lookupat+0x120/0x660\n filename_lookup+0x1ce/0x560\n vfs_statx+0xac/0x150\n __do_sys_newstat+0x96/0x110\n do_syscall_64+0x5f/0x170\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\n[adobriyan@gmail.com: don't do 2 atomic ops on the common path]", "datePublished": "2025-04-03T07:19:03", "dateUpdated": "2025-11-03T19:40:42", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-21999", "https://git.kernel.org/stable/c/63b53198aff2e4e6c5866a4ff73c7891f958ffa4", "https://git.kernel.org/stable/c/64dc7c68e040251d9ec6e989acb69f8f6ae4a10b", "https://git.kernel.org/stable/c/654b33ada4ab5e926cd9c570196fefa7bec7c1df", "https://git.kernel.org/stable/c/966f331403dc3ed04ff64eaf3930cf1267965e53", "https://git.kernel.org/stable/c/ede3e8ac90ae106f0b29cd759aadebc1568f1308", "https://git.kernel.org/stable/c/eda279586e571b05dff44d48e05f8977ad05855d", "https://git.kernel.org/stable/c/4b0b8445b6fd41e6f62ac90547a0ea9d348de3fa", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"], "aliases": ["CVE-2025-21999", "GHSA-vmv5-h8c6-426p"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "081da7fc-1716-32be-afb1-48ba4237bf4f", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <4b0b8445b6fd41e6f62ac90547a0ea9d348de3fa"}, {"id": "0cba237c-cdf9-3b15-b333-d6bc42dc54a6", "product": {"name": "Linux"}, "product_version": "patch: 6.14"}, {"id": "164d8f2b-4476-33fd-81d7-9f4166ce92af", "product": {"name": "Linux"}, "product_version": "patch: 6.6.85"}, {"id": "1cd03b1d-da79-35e1-9a55-227893a6f265", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <966f331403dc3ed04ff64eaf3930cf1267965e53"}, {"id": "1cee91e9-b7a5-35b9-9dd0-b2faf616b9e8", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <63b53198aff2e4e6c5866a4ff73c7891f958ffa4"}, {"id": "1cfa0da2-8ba6-3a1d-babe-5839448d764b", "product": {"name": "Linux"}, "product_version": "patch: 6.12.21"}, {"id": "2ee70861-e126-312d-a439-7a87289f88a9", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <966f331403dc3ed04ff64eaf3930cf1267965e53"}, {"id": "312233a6-4924-39ab-acc4-8c4320c22e48", "product": {"name": "Linux"}, "product_version": "5.6"}, {"id": "49d0d212-c548-3dfe-bd50-09e9f1150d7c", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <ede3e8ac90ae106f0b29cd759aadebc1568f1308"}, {"id": "4fb6c489-58d6-3f8b-85f4-fea568e2cc04", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <654b33ada4ab5e926cd9c570196fefa7bec7c1df"}, {"id": "5131e799-a26c-33d6-825b-ef9dd989229c", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <64dc7c68e040251d9ec6e989acb69f8f6ae4a10b"}, {"id": "5885092c-c513-36b4-9759-e09a54952b93", "product": {"name": "Linux"}, "product_version": "patch: 6.1.132"}, {"id": "66505d01-2474-327e-b863-f11e82884612", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <ede3e8ac90ae106f0b29cd759aadebc1568f1308"}, {"id": "6ff48ca3-3a46-36be-872d-2391228f7488", "product": {"name": "Linux"}, "product_version": "patch: 5.10.236"}, {"id": "91c18bf7-bbd4-331f-b834-074465c86e87", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <4b0b8445b6fd41e6f62ac90547a0ea9d348de3fa"}, {"id": "91dc76b0-a49d-3fe7-ad71-975eb2c872ed", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <63b53198aff2e4e6c5866a4ff73c7891f958ffa4"}, {"id": "b0da9998-f369-333b-9dd5-0d6ed3046469", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d3730259-76a1-3238-ab31-1338cf7050d4", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <eda279586e571b05dff44d48e05f8977ad05855d"}, {"id": "d95fe443-67f9-3ce4-9d92-a3cfcc2f054e", "product": {"name": "Linux"}, "product_version": "2.6.23"}, {"id": "dd8f8bdf-0209-3d5d-89ec-49ccb4f07f98", "product": {"name": "Linux"}, "product_version": "97a32539b9568bb653683349e5a76d02ff3c3e2c <64dc7c68e040251d9ec6e989acb69f8f6ae4a10b"}, {"id": "e4b7e848-30c8-3e18-850e-d719d67de35d", "product": {"name": "Linux"}, "product_version": "patch: 6.13.9"}, {"id": "eec25af0-98b1-344c-b93c-aac88c56edb3", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <654b33ada4ab5e926cd9c570196fefa7bec7c1df"}, {"id": "f0898b6e-ae0d-301d-9d34-f5a441246c6c", "product": {"name": "Linux"}, "product_version": "778f3dd5a13c9e1642e0b2efea4b769387a70afa <eda279586e571b05dff44d48e05f8977ad05855d"}, {"id": "fc4f3a77-e4b0-358e-97ce-b3151b2bed26", "product": {"name": "Linux"}, "product_version": "patch: 5.15.180"}], "enisaIdVendor": [{"id": "5e95135e-fb71-3b4a-ac34-a6b7184ce17b", "vendor": {"name": "Linux"}}], "isExploited": false}