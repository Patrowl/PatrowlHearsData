{"id": "EUVD-2025-203776", "enisaUuid": "03a414de-6b3d-3ac2-94e1-2a6d81fa15e9", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: hci_core: lookup hci_conn on RX path on protocol side\n\nThe hdev lock/lookup/unlock/use pattern in the packet RX path doesn't\nensure hci_conn* is not concurrently modified/deleted. This locking\nappears to be leftover from before conn_hash started using RCU\ncommit bf4c63252490b (\"Bluetooth: convert conn hash to RCU\")\nand not clear if it had purpose since then.\n\nCurrently, there are code paths that delete hci_conn* from elsewhere\nthan the ordered hdev->workqueue where the RX work runs in. E.g.\ncommit 5af1f84ed13a (\"Bluetooth: hci_sync: Fix UAF on hci_abort_conn_sync\")\nintroduced some of these, and there probably were a few others before\nit.  It's better to do the locking so that even if these run\nconcurrently no UAF is possible.\n\nMove the lookup of hci_conn and associated socket-specific conn to\nprotocol recv handlers, and do them within a single critical section\nto cover hci_conn* usage and lookup.\n\nsyzkaller has reported a crash that appears to be this issue:\n\n    [Task hdev->workqueue]          [Task 2]\n                                    hci_disconnect_all_sync\n    l2cap_recv_acldata(hcon)\n                                      hci_conn_get(hcon)\n                                      hci_abort_conn_sync(hcon)\n                                        hci_dev_lock\n      hci_dev_lock\n                                        hci_conn_del(hcon)\n      v-------------------------------- hci_dev_unlock\n                                      hci_conn_put(hcon)\n      conn = hcon->l2cap_data (UAF)", "datePublished": "2025-12-16T18:31:34", "dateUpdated": "2025-12-16T18:31:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/ec74cdf77310c43b01b83ee898a9bd4b4b0b8e93", "https://git.kernel.org/stable/c/79a2d4678ba90bdba577dc3af88cc900d6dcd5ee", "https://nvd.nist.gov/vuln/detail/CVE-2025-68304"], "aliases": ["CVE-2025-68304"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "20b870f5-7e9d-3fcf-b69a-98777440b376", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "283c917a-0815-3401-a3d1-6a798115b3e8", "product": {"name": "Linux"}, "product_version": "6.6"}, {"id": "80164b00-6b5f-33ef-8a13-22d73dc8f18f", "product": {"name": "Linux"}, "product_version": "5af1f84ed13a416297ab9ced7537f4d5ae7f329a <ec74cdf77310c43b01b83ee898a9bd4b4b0b8e93"}, {"id": "a8bd0f71-c439-30f2-a4dd-8ac8b8c1958f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "b95cffd6-f9f6-3f22-bde2-46b86490ba1a", "product": {"name": "Linux"}, "product_version": "4d3ca4a9aaf0aa798a6be372dc0fc3a29e37dd57"}, {"id": "c6dc3923-a5e8-38b5-8d61-f09bdcd6a49d", "product": {"name": "Linux"}, "product_version": "patch: 6.17.11"}, {"id": "cfbf9897-999a-31b4-a185-52a1fe9041f7", "product": {"name": "Linux"}, "product_version": "80265dd1d944c3f33e52375b5dbe654980bd2688"}, {"id": "d1634d94-451a-3708-9dcf-7a2e1b07e8e2", "product": {"name": "Linux"}, "product_version": "5af1f84ed13a416297ab9ced7537f4d5ae7f329a <79a2d4678ba90bdba577dc3af88cc900d6dcd5ee"}, {"id": "dc1b44cd-a518-3db6-98a8-2f4f132c534d", "product": {"name": "Linux"}, "product_version": "cd55c13bbb3d093ae601aa97e588ed4c1390ebb1"}], "enisaIdVendor": [{"id": "df343dee-1274-3137-9e5a-bdf7a3e4e3f9", "vendor": {"name": "Linux"}}], "isExploited": false}