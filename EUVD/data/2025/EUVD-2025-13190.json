{"id": "EUVD-2025-13190", "enisaUuid": "8551f554-b4de-36c9-91b8-41f931e002e7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niavf: fix hang on reboot with ice\n\nWhen a system with E810 with existing VFs gets rebooted the following\nhang may be observed.\n\n Pid 1 is hung in iavf_remove(), part of a network driver:\n PID: 1        TASK: ffff965400e5a340  CPU: 24   COMMAND: \"systemd-shutdow\"\n  #0 [ffffaad04005fa50] __schedule at ffffffff8b3239cb\n  #1 [ffffaad04005fae8] schedule at ffffffff8b323e2d\n  #2 [ffffaad04005fb00] schedule_hrtimeout_range_clock at ffffffff8b32cebc\n  #3 [ffffaad04005fb80] usleep_range_state at ffffffff8b32c930\n  #4 [ffffaad04005fbb0] iavf_remove at ffffffffc12b9b4c [iavf]\n  #5 [ffffaad04005fbf0] pci_device_remove at ffffffff8add7513\n  #6 [ffffaad04005fc10] device_release_driver_internal at ffffffff8af08baa\n  #7 [ffffaad04005fc40] pci_stop_bus_device at ffffffff8adcc5fc\n  #8 [ffffaad04005fc60] pci_stop_and_remove_bus_device at ffffffff8adcc81e\n  #9 [ffffaad04005fc70] pci_iov_remove_virtfn at ffffffff8adf9429\n #10 [ffffaad04005fca8] sriov_disable at ffffffff8adf98e4\n #11 [ffffaad04005fcc8] ice_free_vfs at ffffffffc04bb2c8 [ice]\n #12 [ffffaad04005fd10] ice_remove at ffffffffc04778fe [ice]\n #13 [ffffaad04005fd38] ice_shutdown at ffffffffc0477946 [ice]\n #14 [ffffaad04005fd50] pci_device_shutdown at ffffffff8add58f1\n #15 [ffffaad04005fd70] device_shutdown at ffffffff8af05386\n #16 [ffffaad04005fd98] kernel_restart at ffffffff8a92a870\n #17 [ffffaad04005fda8] __do_sys_reboot at ffffffff8a92abd6\n #18 [ffffaad04005fee0] do_syscall_64 at ffffffff8b317159\n #19 [ffffaad04005ff08] __context_tracking_enter at ffffffff8b31b6fc\n #20 [ffffaad04005ff18] syscall_exit_to_user_mode at ffffffff8b31b50d\n #21 [ffffaad04005ff28] do_syscall_64 at ffffffff8b317169\n #22 [ffffaad04005ff50] entry_SYSCALL_64_after_hwframe at ffffffff8b40009b\n     RIP: 00007f1baa5c13d7  RSP: 00007fffbcc55a98  RFLAGS: 00000202\n     RAX: ffffffffffffffda  RBX: 0000000000000000  RCX: 00007f1baa5c13d7\n     RDX: 0000000001234567  RSI: 0000000028121969  RDI: 00000000fee1dead\n     RBP: 00007fffbcc55ca0   R8: 0000000000000000   R9: 00007fffbcc54e90\n     R10: 00007fffbcc55050  R11: 0000000000000202  R12: 0000000000000005\n     R13: 0000000000000000  R14: 00007fffbcc55af0  R15: 0000000000000000\n     ORIG_RAX: 00000000000000a9  CS: 0033  SS: 002b\n\nDuring reboot all drivers PM shutdown callbacks are invoked.\nIn iavf_shutdown() the adapter state is changed to __IAVF_REMOVE.\nIn ice_shutdown() the call chain above is executed, which at some point\ncalls iavf_remove(). However iavf_remove() expects the VF to be in one\nof the states __IAVF_RUNNING, __IAVF_DOWN or __IAVF_INIT_FAILED. If\nthat's not the case it sleeps forever.\nSo if iavf_shutdown() gets invoked before iavf_remove() the system will\nhang indefinitely because the adapter is already in state __IAVF_REMOVE.\n\nFix this by returning from iavf_remove() if the state is __IAVF_REMOVE,\nas we already went through iavf_shutdown().", "datePublished": "2025-05-02T18:31:34", "dateUpdated": "2025-11-07T03:30:24", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53064", "https://git.kernel.org/stable/c/4e264be98b88a6d6f476c11087fe865696e8bef5", "https://git.kernel.org/stable/c/502b898235f06130750c91512c86dd0e9efe28e6", "https://git.kernel.org/stable/c/7a29799fc141ba9e6cf921fc8e958e3398ad1a4f", "https://git.kernel.org/stable/c/f752ace58867de3c063512b21e0f1694fc27f043"], "aliases": ["CVE-2023-53064", "GHSA-r63h-x8mm-m3m7"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2b11f703-477e-3876-8ce9-04d2190751bf", "product": {"name": "Linux"}, "product_version": "patch: 6.2.9"}, {"id": "56d3af5a-3562-3b3d-a3c5-59bff9fa2a3a", "product": {"name": "Linux"}, "product_version": "85aa76066fef64de8a48d0da6b4071ceac455a94 <7a29799fc141ba9e6cf921fc8e958e3398ad1a4f"}, {"id": "8541c506-ffd9-3a85-b049-e6e22d6c6796", "product": {"name": "Linux"}, "product_version": "974578017fc1fdd06cea8afb9dfa32602e8529ed <502b898235f06130750c91512c86dd0e9efe28e6"}, {"id": "90f5c836-c198-3a5b-9af8-5862bae2bc6a", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "ce672256-fa3a-339d-92b3-a2559c932b6d", "product": {"name": "Linux"}, "product_version": "974578017fc1fdd06cea8afb9dfa32602e8529ed <f752ace58867de3c063512b21e0f1694fc27f043"}, {"id": "cf2d8043-7e1f-31bd-9c23-90d65831d45d", "product": {"name": "Linux"}, "product_version": "patch: 6.1.22"}, {"id": "d7a19bf5-b409-3295-93c2-3555671dc79e", "product": {"name": "Linux"}, "product_version": "5.17"}, {"id": "db45e73d-b516-38a6-8bbb-09a5040b7393", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e3d7da7e-01ec-347c-b9b0-2e144a7fd7bd", "product": {"name": "Linux"}, "product_version": "patch: 5.15.105"}, {"id": "e4c90423-3774-3ad4-9e25-020f182d8871", "product": {"name": "Linux"}, "product_version": "974578017fc1fdd06cea8afb9dfa32602e8529ed <4e264be98b88a6d6f476c11087fe865696e8bef5"}], "enisaIdVendor": [{"id": "245cecef-beb4-3c36-8db1-6db573c29b94", "vendor": {"name": "Linux"}}], "isExploited": false}