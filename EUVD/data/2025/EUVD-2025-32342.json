{"id": "EUVD-2025-32342", "enisaUuid": "e93c3897-1351-3d5c-a33e-3d3cef8772db", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblk-crypto: make blk_crypto_evict_key() more robust\n\nIf blk_crypto_evict_key() sees that the key is still in-use (due to a\nbug) or that ->keyslot_evict failed, it currently just returns while\nleaving the key linked into the keyslot management structures.\n\nHowever, blk_crypto_evict_key() is only called in contexts such as inode\neviction where failure is not an option.  So actually the caller\nproceeds with freeing the blk_crypto_key regardless of the return value\nof blk_crypto_evict_key().\n\nThese two assumptions don't match, and the result is that there can be a\nuse-after-free in blk_crypto_reprogram_all_keys() after one of these\nerrors occurs.  (Note, these errors *shouldn't* happen; we're just\ntalking about what happens if they do anyway.)\n\nFix this by making blk_crypto_evict_key() unlink the key from the\nkeyslot management structures even on failure.\n\nAlso improve some comments.", "datePublished": "2025-10-04T15:16:47", "dateUpdated": "2025-10-04T15:16:47", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53536", "https://git.kernel.org/stable/c/5bb4005fb667c6e2188fa87950f8d5faf2994410", "https://git.kernel.org/stable/c/5c62852942667c613de0458fc797c5b8c36112b5", "https://git.kernel.org/stable/c/5c7cb94452901a93e90c2230632e2c12a681bc92", "https://git.kernel.org/stable/c/64ef787bb1588475163069c2e62fdd8f6c27b1f6", "https://git.kernel.org/stable/c/701a8220762ff90615dc91d3543f789391b63298", "https://git.kernel.org/stable/c/809a5be62e92a444a3c3d7b9f438019d0b322f55"], "aliases": ["CVE-2023-53536", "GHSA-f2cg-q42r-r6f6"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "1e7899ed-533f-3527-b02a-61d19fa6cab1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.111"}, {"id": "49409ea3-5358-37a9-ad56-a1515beffdbd", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <701a8220762ff90615dc91d3543f789391b63298"}, {"id": "5bad524b-7d67-3682-8098-483fe7fd3f1d", "product": {"name": "Linux"}, "product_version": "patch: 5.10.180"}, {"id": "803d488b-3bf9-3ed1-aab1-71cb662fed88", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <64ef787bb1588475163069c2e62fdd8f6c27b1f6"}, {"id": "842950d1-1106-3e3c-9b20-e61e9d79ea6d", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <809a5be62e92a444a3c3d7b9f438019d0b322f55"}, {"id": "91da080c-60f1-35a0-98dd-9a390b8cf5cc", "product": {"name": "Linux"}, "product_version": "patch: 6.2.15"}, {"id": "94e881af-da4e-371d-8747-22cf41729e6e", "product": {"name": "Linux"}, "product_version": "patch: 6.1.28"}, {"id": "969a4cca-37fc-30c6-adf3-c6804eaa18d8", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "aa373a8c-1779-3b6b-af0d-76cc7ee99856", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "bc21ff15-8f09-3961-a2ff-6819ee420555", "product": {"name": "Linux"}, "product_version": "patch: 6.3.2"}, {"id": "bde554f8-753a-34c1-85ea-ecc655e1b3fa", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <5bb4005fb667c6e2188fa87950f8d5faf2994410"}, {"id": "c72179f0-9109-3a48-99b1-e69b09e35574", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "d702afaf-4d9d-3361-8f4d-7c7c977bc852", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <5c62852942667c613de0458fc797c5b8c36112b5"}, {"id": "df28802b-6a0f-3f1d-a902-317e766b8db8", "product": {"name": "Linux"}, "product_version": "1b2628397058ebce7277480960b29c788138de90 <5c7cb94452901a93e90c2230632e2c12a681bc92"}], "enisaIdVendor": [{"id": "1ff9ba7b-e535-3bd7-b5ef-502962ae75db", "vendor": {"name": "Linux"}}], "isExploited": false}