{"id": "EUVD-2025-22677", "enisaUuid": "4766e08a-3ca7-39a3-8384-807abee90eb7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntipc: Fix use-after-free in tipc_conn_close().\n\nsyzbot reported a null-ptr-deref in tipc_conn_close() during netns\ndismantle. [0]\n\ntipc_topsrv_stop() iterates tipc_net(net)->topsrv->conn_idr and calls\ntipc_conn_close() for each tipc_conn.\n\nThe problem is that tipc_conn_close() is called after releasing the\nIDR lock.\n\nAt the same time, there might be tipc_conn_recv_work() running and it\ncould call tipc_conn_close() for the same tipc_conn and release its\nlast ->kref.\n\nOnce we release the IDR lock in tipc_topsrv_stop(), there is no\nguarantee that the tipc_conn is alive.\n\nLet's hold the ref before releasing the lock and put the ref after\ntipc_conn_close() in tipc_topsrv_stop().\n\n[0]:\nBUG: KASAN: use-after-free in tipc_conn_close+0x122/0x140 net/tipc/topsrv.c:165\nRead of size 8 at addr ffff888099305a08 by task kworker/u4:3/435\n\nCPU: 0 PID: 435 Comm: kworker/u4:3 Not tainted 4.19.204-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\nWorkqueue: netns cleanup_net\nCall Trace:\n __dump_stack lib/dump_stack.c:77 [inline]\n dump_stack+0x1fc/0x2ef lib/dump_stack.c:118\n print_address_description.cold+0x54/0x219 mm/kasan/report.c:256\n kasan_report_error.cold+0x8a/0x1b9 mm/kasan/report.c:354\n kasan_report mm/kasan/report.c:412 [inline]\n __asan_report_load8_noabort+0x88/0x90 mm/kasan/report.c:433\n tipc_conn_close+0x122/0x140 net/tipc/topsrv.c:165\n tipc_topsrv_stop net/tipc/topsrv.c:701 [inline]\n tipc_topsrv_exit_net+0x27b/0x5c0 net/tipc/topsrv.c:722\n ops_exit_list+0xa5/0x150 net/core/net_namespace.c:153\n cleanup_net+0x3b4/0x8b0 net/core/net_namespace.c:553\n process_one_work+0x864/0x1570 kernel/workqueue.c:2153\n worker_thread+0x64c/0x1130 kernel/workqueue.c:2296\n kthread+0x33f/0x460 kernel/kthread.c:259\n ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415\n\nAllocated by task 23:\n kmem_cache_alloc_trace+0x12f/0x380 mm/slab.c:3625\n kmalloc include/linux/slab.h:515 [inline]\n kzalloc include/linux/slab.h:709 [inline]\n tipc_conn_alloc+0x43/0x4f0 net/tipc/topsrv.c:192\n tipc_topsrv_accept+0x1b5/0x280 net/tipc/topsrv.c:470\n process_one_work+0x864/0x1570 kernel/workqueue.c:2153\n worker_thread+0x64c/0x1130 kernel/workqueue.c:2296\n kthread+0x33f/0x460 kernel/kthread.c:259\n ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415\n\nFreed by task 23:\n __cache_free mm/slab.c:3503 [inline]\n kfree+0xcc/0x210 mm/slab.c:3822\n tipc_conn_kref_release net/tipc/topsrv.c:150 [inline]\n kref_put include/linux/kref.h:70 [inline]\n conn_put+0x2cd/0x3a0 net/tipc/topsrv.c:155\n process_one_work+0x864/0x1570 kernel/workqueue.c:2153\n worker_thread+0x64c/0x1130 kernel/workqueue.c:2296\n kthread+0x33f/0x460 kernel/kthread.c:259\n ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415\n\nThe buggy address belongs to the object at ffff888099305a00\n which belongs to the cache kmalloc-512 of size 512\nThe buggy address is located 8 bytes inside of\n 512-byte region [ffff888099305a00, ffff888099305c00)\nThe buggy address belongs to the page:\npage:ffffea000264c140 count:1 mapcount:0 mapping:ffff88813bff0940 index:0x0\nflags: 0xfff00000000100(slab)\nraw: 00fff00000000100 ffffea00028b6b88 ffffea0002cd2b08 ffff88813bff0940\nraw: 0000000000000000 ffff888099305000 0000000100000006 0000000000000000\npage dumped because: kasan: bad access detected\n\nMemory state around the buggy address:\n ffff888099305900: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n ffff888099305980: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n>ffff888099305a00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n                      ^\n ffff888099305a80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n ffff888099305b00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb", "datePublished": "2025-07-25T18:30:40", "dateUpdated": "2025-12-22T21:30:29", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/03dcdd2558e1e55bf843822fe4363dcb48743f2b", "https://git.kernel.org/stable/c/15a6f4971e2f157d57e09ea748d1fbc714277aa4", "https://git.kernel.org/stable/c/dab8ded2e5ff41012a6ff400b44dbe76ccf3592a", "https://git.kernel.org/stable/c/1dbf7cd2454a28b1da700085b99346b5445aeabb", "https://git.kernel.org/stable/c/be4b8392da7978294f2f368799d29dd509fb6c4d", "https://git.kernel.org/stable/c/50aa2d121bc2cfe2d825f8a331ea75dfaaab6a50", "https://git.kernel.org/stable/c/3b89e17b2fd64012682bed158d9eb3d2e96dec42", "https://git.kernel.org/stable/c/667eeab4999e981c96b447a4df5f20bdf5c26f13", "https://nvd.nist.gov/vuln/detail/CVE-2025-38464", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38464"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "197cdd59-7118-3389-a736-fb98b77bbc59", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <dab8ded2e5ff41012a6ff400b44dbe76ccf3592a"}, {"id": "1eed3d62-3ff0-34a4-aee6-4c96f68a5017", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <03dcdd2558e1e55bf843822fe4363dcb48743f2b"}, {"id": "20784b0d-20f8-305f-a349-5de475e08ee4", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2440f9b5-a72d-3c0a-bc55-00e6ecbb47d7", "product": {"name": "Linux"}, "product_version": "patch: 5.10.240"}, {"id": "2593c261-6ee7-341f-afa3-dbd48c4108d3", "product": {"name": "Linux"}, "product_version": "patch: 6.12.39"}, {"id": "301a96b1-4100-3df9-bf9a-82e5978fe19d", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <1dbf7cd2454a28b1da700085b99346b5445aeabb"}, {"id": "3b9acbaa-cfc1-3a24-9d16-a83c0ac49c7e", "product": {"name": "Linux"}, "product_version": "patch: 6.6.99"}, {"id": "3bcf62ec-7157-3e85-9b3c-1a4bb495fda0", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <3b89e17b2fd64012682bed158d9eb3d2e96dec42"}, {"id": "45481b37-bbe9-393e-b670-9da38bc457fc", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc6"}, {"id": "6d054d72-60f9-3998-a26b-39d182866a43", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <50aa2d121bc2cfe2d825f8a331ea75dfaaab6a50"}, {"id": "83df03f3-8ffd-3bed-a209-27a241309ede", "product": {"name": "Linux"}, "product_version": "3.11"}, {"id": "864024e8-782e-35d0-b00a-6d379a499796", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "9a325dc6-6d82-3223-a21a-8091f3c22cd1", "product": {"name": "Linux"}, "product_version": "patch: 5.4.296"}, {"id": "a6d494ea-f24b-3940-8edd-ff7ee55f8841", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <15a6f4971e2f157d57e09ea748d1fbc714277aa4"}, {"id": "b760e080-b2de-3e52-9345-70ba6ce3a3b1", "product": {"name": "Linux"}, "product_version": "patch: 6.1.146"}, {"id": "b7f8bea9-1600-3a38-987c-31b00afd4b30", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <be4b8392da7978294f2f368799d29dd509fb6c4d"}, {"id": "cb8f032f-bbff-3641-9c5a-a21ffb26381e", "product": {"name": "Linux"}, "product_version": "patch: 6.15.7"}, {"id": "e3282775-ca65-31d1-bd89-1697d1f33410", "product": {"name": "Linux"}, "product_version": "patch: 5.15.189"}, {"id": "e8ded94f-786c-341e-bcf0-9e501310a5c1", "product": {"name": "Linux"}, "product_version": "c5fa7b3cf3cb22e4ac60485fc2dc187fe012910f <667eeab4999e981c96b447a4df5f20bdf5c26f13"}], "enisaIdVendor": [{"id": "cc1d683c-bb4b-3096-b853-ab6f31109a8c", "vendor": {"name": "Linux"}}], "isExploited": false}