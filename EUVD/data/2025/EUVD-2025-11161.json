{"id": "EUVD-2025-11161", "enisaUuid": "79ebcdb3-02d8-3fb5-81d4-4f432a0ad66c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: quota: fix to avoid warning in dquot_writeback_dquots()\n\nF2FS-fs (dm-59): checkpoint=enable has some unwritten data.\n\n------------[ cut here ]------------\nWARNING: CPU: 6 PID: 8013 at fs/quota/dquot.c:691 dquot_writeback_dquots+0x2fc/0x308\npc : dquot_writeback_dquots+0x2fc/0x308\nlr : f2fs_quota_sync+0xcc/0x1c4\nCall trace:\ndquot_writeback_dquots+0x2fc/0x308\nf2fs_quota_sync+0xcc/0x1c4\nf2fs_write_checkpoint+0x3d4/0x9b0\nf2fs_issue_checkpoint+0x1bc/0x2c0\nf2fs_sync_fs+0x54/0x150\nf2fs_do_sync_file+0x2f8/0x814\n__f2fs_ioctl+0x1960/0x3244\nf2fs_ioctl+0x54/0xe0\n__arm64_sys_ioctl+0xa8/0xe4\ninvoke_syscall+0x58/0x114\n\ncheckpoint and f2fs_remount may race as below, resulting triggering warning\nin dquot_writeback_dquots().\n\natomic write                                    remount\n                                                - do_remount\n                                                 - down_write(&sb->s_umount);\n                                                  - f2fs_remount\n- ioctl\n - f2fs_do_sync_file\n  - f2fs_sync_fs\n   - f2fs_write_checkpoint\n    - block_operations\n     - locked = down_read_trylock(&sbi->sb->s_umount)\n       : fail to lock due to the write lock was held by remount\n                                                 - up_write(&sb->s_umount);\n     - f2fs_quota_sync\n      - dquot_writeback_dquots\n       - WARN_ON_ONCE(!rwsem_is_locked(&sb->s_umount))\n       : trigger warning because s_umount lock was unlocked by remount\n\nIf checkpoint comes from mount/umount/remount/freeze/quotactl, caller of\ncheckpoint has already held s_umount lock, calling dquot_writeback_dquots()\nin the context should be safe.\n\nSo let's record task to sbi->umount_lock_holder, so that checkpoint can\nknow whether the lock has held in the context or not by checking current\nw/ it.\n\nIn addition, in order to not misrepresent caller of checkpoint, we should\nnot allow to trigger async checkpoint for those callers: mount/umount/remount/\nfreeze/quotactl.", "datePublished": "2025-04-16T15:34:46", "dateUpdated": "2025-11-04T18:31:31", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-23132", "https://git.kernel.org/stable/c/d7acf0a6c87aa282c86a36dbaa2f92fda88c5884", "https://git.kernel.org/stable/c/eb85c2410d6f581e957cd03a644ff6ddbe592af9"], "aliases": ["CVE-2025-23132", "GHSA-v4w6-p754-7g2j"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "6cf4b352-3ef8-3f14-950b-29715690a7eb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7aff2630-db98-3dfe-b034-85d64dadb3ae", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "7d3b900e-9b34-3942-929f-bd3f2b43eab4", "product": {"name": "Linux"}, "product_version": "4.20"}, {"id": "87867daa-18b4-3d1c-9686-2295bf73003e", "product": {"name": "Linux"}, "product_version": "af033b2aa8a874fd5737fafe90d159136527b5b4 <d7acf0a6c87aa282c86a36dbaa2f92fda88c5884"}, {"id": "a5c4e869-d0e7-3a6a-bb1c-ac8304702959", "product": {"name": "Linux"}, "product_version": "af033b2aa8a874fd5737fafe90d159136527b5b4 <eb85c2410d6f581e957cd03a644ff6ddbe592af9"}, {"id": "e2ddcbfc-17ad-3551-8c9a-5b541d64bc2c", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}], "enisaIdVendor": [{"id": "961ea5ce-22ad-3045-9435-449f8a0f169d", "vendor": {"name": "Linux"}}], "isExploited": false}