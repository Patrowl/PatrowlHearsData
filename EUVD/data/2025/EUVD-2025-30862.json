{"id": "EUVD-2025-30862", "enisaUuid": "fea5b620-3610-3ae2-9199-364ec4bd93ae", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: idxd: Remove improper idxd_free\n\nThe call to idxd_free() introduces a duplicate put_device() leading to a\nreference count underflow:\nrefcount_t: underflow; use-after-free.\nWARNING: CPU: 15 PID: 4428 at lib/refcount.c:28 refcount_warn_saturate+0xbe/0x110\n...\nCall Trace:\n <TASK>\n  idxd_remove+0xe4/0x120 [idxd]\n  pci_device_remove+0x3f/0xb0\n  device_release_driver_internal+0x197/0x200\n  driver_detach+0x48/0x90\n  bus_remove_driver+0x74/0xf0\n  pci_unregister_driver+0x2e/0xb0\n  idxd_exit_module+0x34/0x7a0 [idxd]\n  __do_sys_delete_module.constprop.0+0x183/0x280\n  do_syscall_64+0x54/0xd70\n  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nThe idxd_unregister_devices() which is invoked at the very beginning of\nidxd_remove(), already takes care of the necessary put_device() through the\nfollowing call path:\nidxd_unregister_devices() -> device_unregister() -> put_device()\n\nIn addition, when CONFIG_DEBUG_KOBJECT_RELEASE is enabled, put_device() may\ntrigger asynchronous cleanup via schedule_delayed_work(). If idxd_free() is\ncalled immediately after, it can result in a use-after-free.\n\nRemove the improper idxd_free() to avoid both the refcount underflow and\npotential memory corruption during module unload.", "datePublished": "2025-09-23T06:30:27", "dateUpdated": "2025-12-12T21:31:32", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-39871", "https://git.kernel.org/stable/c/0e95ee7f532b21206fe3f1c4054002b0d21e3b9c", "https://git.kernel.org/stable/c/da4fbc1488a4cec6748da685181ee4449a878dac", "https://git.kernel.org/stable/c/dd7a7e43269711d757fc260b0bbdf7138f75de11", "https://git.kernel.org/stable/c/f41c538881eec4dcf5961a242097d447f848cda6"], "aliases": ["CVE-2025-39871", "GHSA-frjr-mhww-g3pw"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0ed050ba-42fb-3fd2-8420-b377be3d3c67", "product": {"name": "Linux"}, "product_version": "68ac5a01f635b3791196fd1c39bc48497252c36f"}, {"id": "1e567004-75b2-383e-9d74-ea022fa117ee", "product": {"name": "Linux"}, "product_version": "d5449ff1b04dfe9ed8e455769aa01e4c2ccf6805 <f41c538881eec4dcf5961a242097d447f848cda6"}, {"id": "2c7858df-625c-36c4-b2c6-72929b3aa243", "product": {"name": "Linux"}, "product_version": "patch: 6.12.48"}, {"id": "3eca7b40-ae38-3967-b58c-3829a42cd036", "product": {"name": "Linux"}, "product_version": "2b7a961cea0e5b65afda911f76d14fec5c98d024"}, {"id": "5f53557e-b82a-3040-a400-5be529f33ade", "product": {"name": "Linux"}, "product_version": "d5449ff1b04dfe9ed8e455769aa01e4c2ccf6805 <da4fbc1488a4cec6748da685181ee4449a878dac"}, {"id": "6bd82f32-9bca-357a-b5b0-48a99d64f006", "product": {"name": "Linux"}, "product_version": "patch: 6.6.107"}, {"id": "706b9169-43a1-3d0f-8a30-80decff70ffb", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc6"}, {"id": "a17e1262-409d-340d-b45f-6a225a86f40b", "product": {"name": "Linux"}, "product_version": "21f9f5cd9a0c75084d4369ba0b8c4f695c41dea7 <dd7a7e43269711d757fc260b0bbdf7138f75de11"}, {"id": "a53f82af-3b22-3306-8df4-234d45137d36", "product": {"name": "Linux"}, "product_version": "patch: 6.16.8"}, {"id": "b7f3d46c-0862-3e67-b634-703887b24eed", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "d8880a37-dcf9-3e4c-b5e0-9a4c3d77c7f3", "product": {"name": "Linux"}, "product_version": "6.15"}, {"id": "e9de9f6c-1473-3074-ac8e-ffb411832c44", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f7f6aa07-0c0e-3459-8385-89ff6861da5a", "product": {"name": "Linux"}, "product_version": "d2d05fd0fc95c4defed6f7b87550e20e8baa1d97 <0e95ee7f532b21206fe3f1c4054002b0d21e3b9c"}], "enisaIdVendor": [{"id": "b562f084-5ad5-313f-b91f-66179abf0edd", "vendor": {"name": "Linux"}}], "isExploited": false}