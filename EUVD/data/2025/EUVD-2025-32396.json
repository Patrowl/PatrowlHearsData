{"id": "EUVD-2025-32396", "enisaUuid": "091a3508-8458-3ed0-a2c2-d7522dcc1f86", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nocteontx2-pf: Fix use-after-free bugs in otx2_sync_tstamp()\n\nThe original code relies on cancel_delayed_work() in otx2_ptp_destroy(),\nwhich does not ensure that the delayed work item synctstamp_work has fully\ncompleted if it was already running. This leads to use-after-free scenarios\nwhere otx2_ptp is deallocated by otx2_ptp_destroy(), while synctstamp_work\nremains active and attempts to dereference otx2_ptp in otx2_sync_tstamp().\nFurthermore, the synctstamp_work is cyclic, the likelihood of triggering\nthe bug is nonnegligible.\n\nA typical race condition is illustrated below:\n\nCPU 0 (cleanup)           | CPU 1 (delayed work callback)\notx2_remove()             |\n  otx2_ptp_destroy()      | otx2_sync_tstamp()\n    cancel_delayed_work() |\n    kfree(ptp)            |\n                          |   ptp = container_of(...); //UAF\n                          |   ptp-> //UAF\n\nThis is confirmed by a KASAN report:\n\nBUG: KASAN: slab-use-after-free in __run_timer_base.part.0+0x7d7/0x8c0\nWrite of size 8 at addr ffff88800aa09a18 by task bash/136\n...\nCall Trace:\n <IRQ>\n dump_stack_lvl+0x55/0x70\n print_report+0xcf/0x610\n ? __run_timer_base.part.0+0x7d7/0x8c0\n kasan_report+0xb8/0xf0\n ? __run_timer_base.part.0+0x7d7/0x8c0\n __run_timer_base.part.0+0x7d7/0x8c0\n ? __pfx___run_timer_base.part.0+0x10/0x10\n ? __pfx_read_tsc+0x10/0x10\n ? ktime_get+0x60/0x140\n ? lapic_next_event+0x11/0x20\n ? clockevents_program_event+0x1d4/0x2a0\n run_timer_softirq+0xd1/0x190\n handle_softirqs+0x16a/0x550\n irq_exit_rcu+0xaf/0xe0\n sysvec_apic_timer_interrupt+0x70/0x80\n </IRQ>\n...\nAllocated by task 1:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n __kasan_kmalloc+0x7f/0x90\n otx2_ptp_init+0xb1/0x860\n otx2_probe+0x4eb/0xc30\n local_pci_probe+0xdc/0x190\n pci_device_probe+0x2fe/0x470\n really_probe+0x1ca/0x5c0\n __driver_probe_device+0x248/0x310\n driver_probe_device+0x44/0x120\n __driver_attach+0xd2/0x310\n bus_for_each_dev+0xed/0x170\n bus_add_driver+0x208/0x500\n driver_register+0x132/0x460\n do_one_initcall+0x89/0x300\n kernel_init_freeable+0x40d/0x720\n kernel_init+0x1a/0x150\n ret_from_fork+0x10c/0x1a0\n ret_from_fork_asm+0x1a/0x30\n\nFreed by task 136:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n kasan_save_free_info+0x3a/0x60\n __kasan_slab_free+0x3f/0x50\n kfree+0x137/0x370\n otx2_ptp_destroy+0x38/0x80\n otx2_remove+0x10d/0x4c0\n pci_device_remove+0xa6/0x1d0\n device_release_driver_internal+0xf8/0x210\n pci_stop_bus_device+0x105/0x150\n pci_stop_and_remove_bus_device_locked+0x15/0x30\n remove_store+0xcc/0xe0\n kernfs_fop_write_iter+0x2c3/0x440\n vfs_write+0x871/0xd70\n ksys_write+0xee/0x1c0\n do_syscall_64+0xac/0x280\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n...\n\nReplace cancel_delayed_work() with cancel_delayed_work_sync() to ensure\nthat the delayed work item is properly canceled before the otx2_ptp is\ndeallocated.\n\nThis bug was initially identified through static analysis. To reproduce\nand test it, I simulated the OcteonTX2 PCI device in QEMU and introduced\nartificial delays within the otx2_sync_tstamp() function to increase the\nlikelihood of triggering the bug.", "datePublished": "2025-10-04T07:31:06", "dateUpdated": "2025-10-04T07:31:06", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-39944", "https://git.kernel.org/stable/c/2786879aebf363806a13d41e8d5f99202ddd23d9", "https://git.kernel.org/stable/c/5ca20bb7b4bde72110c3ae78423cbfdd0157aa36", "https://git.kernel.org/stable/c/d2cfefa14ce8137b17f99683f968bebf134b6a48", "https://git.kernel.org/stable/c/f8b4687151021db61841af983f1cb7be6915d4ef", "https://git.kernel.org/stable/c/ff27e23b311fed4d25e3852e27ba693416d4c7b3"], "aliases": ["CVE-2025-39944", "GHSA-63mr-vmpc-c5r9"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "052b1b43-2eee-3da4-8daf-e063083ee8d6", "product": {"name": "Linux"}, "product_version": "6.1"}, {"id": "05450721-cf57-3268-b01e-43b6748c9eba", "product": {"name": "Linux"}, "product_version": "2958d17a898416c6193431676f6130b68a2cb9fc <2786879aebf363806a13d41e8d5f99202ddd23d9"}, {"id": "07f7b1fe-d450-3d7e-b591-ebbeac280291", "product": {"name": "Linux"}, "product_version": "2958d17a898416c6193431676f6130b68a2cb9fc <f8b4687151021db61841af983f1cb7be6915d4ef"}, {"id": "16a9c48b-52f0-326a-bad5-6e14c74bb0c1", "product": {"name": "Linux"}, "product_version": "2958d17a898416c6193431676f6130b68a2cb9fc <d2cfefa14ce8137b17f99683f968bebf134b6a48"}, {"id": "19c06384-4ccb-321f-ac95-e31a3790e6c5", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "227b6475-f9f6-38bb-84a0-20f1d5a223a7", "product": {"name": "Linux"}, "product_version": "2958d17a898416c6193431676f6130b68a2cb9fc <5ca20bb7b4bde72110c3ae78423cbfdd0157aa36"}, {"id": "25d2074c-e659-336e-a3dd-f8f14828f2f7", "product": {"name": "Linux"}, "product_version": "patch: 6.16.9"}, {"id": "33be3a6b-e7d6-3551-9e74-a522dd49c8ff", "product": {"name": "Linux"}, "product_version": "patch: 6.12.49"}, {"id": "6f97cc43-d167-35f7-8f0f-2321c171e26f", "product": {"name": "Linux"}, "product_version": "patch: 6.1.154"}, {"id": "c3b2b401-f2c9-3a9b-a7f8-6cbad0f99e1b", "product": {"name": "Linux"}, "product_version": "patch: 6.6.108"}, {"id": "de2c848a-9bce-35b2-838e-d10fb27005a2", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f3430d53-ce2f-3e2d-a82d-f07b7293bf65", "product": {"name": "Linux"}, "product_version": "2958d17a898416c6193431676f6130b68a2cb9fc <ff27e23b311fed4d25e3852e27ba693416d4c7b3"}], "enisaIdVendor": [{"id": "a40c7425-2d08-3f80-8c2b-79a15189e4f3", "vendor": {"name": "Linux"}}], "isExploited": false}