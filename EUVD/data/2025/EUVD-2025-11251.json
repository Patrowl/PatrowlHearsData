{"id": "EUVD-2025-11251", "enisaUuid": "e7e832ef-41df-3ff2-a77f-7ef45a886e18", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing: Fix use-after-free in print_graph_function_flags during tracer switching\n\nKairui reported a UAF issue in print_graph_function_flags() during\nftrace stress testing [1]. This issue can be reproduced if puting a\n'mdelay(10)' after 'mutex_unlock(&trace_types_lock)' in s_start(),\nand executing the following script:\n\n  $ echo function_graph > current_tracer\n  $ cat trace > /dev/null &\n  $ sleep 5  # Ensure the 'cat' reaches the 'mdelay(10)' point\n  $ echo timerlat > current_tracer\n\nThe root cause lies in the two calls to print_graph_function_flags\nwithin print_trace_line during each s_show():\n\n  * One through 'iter->trace->print_line()';\n  * Another through 'event->funcs->trace()', which is hidden in\n    print_trace_fmt() before print_trace_line returns.\n\nTracer switching only updates the former, while the latter continues\nto use the print_line function of the old tracer, which in the script\nabove is print_graph_function_flags.\n\nMoreover, when switching from the 'function_graph' tracer to the\n'timerlat' tracer, s_start only calls graph_trace_close of the\n'function_graph' tracer to free 'iter->private', but does not set\nit to NULL. This provides an opportunity for 'event->funcs->trace()'\nto use an invalid 'iter->private'.\n\nTo fix this issue, set 'iter->private' to NULL immediately after\nfreeing it in graph_trace_close(), ensuring that an invalid pointer\nis not passed to other tracers. Additionally, clean up the unnecessary\n'iter->private = NULL' during each 'cat trace' when using wakeup and\nirqsoff tracers.\n\n [1] https://lore.kernel.org/all/20231112150030.84609-1-ryncsn@gmail.com/", "datePublished": "2025-04-16T14:11:53", "dateUpdated": "2025-11-03T19:41:18", "baseScore": 7.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-22035", "https://git.kernel.org/stable/c/099ef3385800828b74933a96c117574637c3fb3a", "https://git.kernel.org/stable/c/42561fe62c3628ea3bc9623f64f047605e98857f", "https://git.kernel.org/stable/c/70be951bc01e4a0e10d443f3510bb17426f257fb", "https://git.kernel.org/stable/c/7f81f27b1093e4895e87b74143c59c055c3b1906", "https://git.kernel.org/stable/c/81a85b12132c8ffe98f5ddbdc185481790aeaa1b", "https://git.kernel.org/stable/c/a2cce54c1748216535dda02e185d07a084be837e", "https://git.kernel.org/stable/c/c85efe6e13743cac6ba4ccf144cb91f44c86231a", "https://git.kernel.org/stable/c/de7b309139f862a44379ecd96e93c9133c69f813", "https://git.kernel.org/stable/c/f14752d66056d0c7bffe5092130409417d3baa70", "https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html", "https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html"], "aliases": ["CVE-2025-22035", "GHSA-jrxv-vv4v-jrrh"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "00d920d5-8a46-3760-9f5a-60c507bc0c89", "product": {"name": "Linux"}, "product_version": "patch: 6.1.134"}, {"id": "07971303-087b-351e-8b92-b7ea3ad97329", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}, {"id": "0e15ecfb-9bc5-3847-8943-246e95c10e9d", "product": {"name": "Linux"}, "product_version": "d6b35c9a8d51032ed9890431da3ae39fe76c1ae3"}, {"id": "198662af-d82d-3071-b864-57fab4b22477", "product": {"name": "Linux"}, "product_version": "eecb91b9f98d6427d4af5fdb8f108f52572a39e7 <099ef3385800828b74933a96c117574637c3fb3a"}, {"id": "32d0e187-7e2b-3398-b0f9-15aa5a284619", "product": {"name": "Linux"}, "product_version": "eecb91b9f98d6427d4af5fdb8f108f52572a39e7 <7f81f27b1093e4895e87b74143c59c055c3b1906"}, {"id": "355f8759-697d-3c07-8747-e61ccd10ed1a", "product": {"name": "Linux"}, "product_version": "b8205dfed68183dc1470e83863c5ded6d7fa30a9 <de7b309139f862a44379ecd96e93c9133c69f813"}, {"id": "3f70ed8e-2fe1-38bb-9837-13b6208b814d", "product": {"name": "Linux"}, "product_version": "eecb91b9f98d6427d4af5fdb8f108f52572a39e7 <f14752d66056d0c7bffe5092130409417d3baa70"}, {"id": "466d1472-871b-363a-b0d9-d12b90803a23", "product": {"name": "Linux"}, "product_version": "patch: 5.10.236"}, {"id": "4c19bf23-677b-3547-9853-0712d172a408", "product": {"name": "Linux"}, "product_version": "patch: 5.15.180"}, {"id": "5766407c-5b43-3b65-80d5-090eda065a60", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7c81efc1-2483-3606-9e50-fefe1c299a43", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "7e0e608e-08a0-380e-b199-389b19f2d797", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "92bf251a-aac6-35d9-b6e0-51e2495e4650", "product": {"name": "Linux"}, "product_version": "2cb0c037c927db4ec928cc927488e52aa359786e <a2cce54c1748216535dda02e185d07a084be837e"}, {"id": "93dbf13b-388c-3b7a-90d9-55e8a9c72de7", "product": {"name": "Linux"}, "product_version": "patch: 6.12.23"}, {"id": "95ae2654-bef7-3d1b-9548-8f505e2f74a7", "product": {"name": "Linux"}, "product_version": "eecb91b9f98d6427d4af5fdb8f108f52572a39e7 <c85efe6e13743cac6ba4ccf144cb91f44c86231a"}, {"id": "99ef6db1-1bec-3983-9cc4-7a5f6e1fb577", "product": {"name": "Linux"}, "product_version": "6.5"}, {"id": "a487749e-08b1-3af9-80b6-45f43d8e4a79", "product": {"name": "Linux"}, "product_version": "05319d707732c728eb721ac616a50e7978eb499a <42561fe62c3628ea3bc9623f64f047605e98857f"}, {"id": "aa0e65fa-affb-3211-a00e-78bf66b9557b", "product": {"name": "Linux"}, "product_version": "eecb91b9f98d6427d4af5fdb8f108f52572a39e7 <70be951bc01e4a0e10d443f3510bb17426f257fb"}, {"id": "ab212678-2e98-3962-8625-8625d76a313e", "product": {"name": "Linux"}, "product_version": "patch: 5.4.292"}, {"id": "ad80274e-09f1-33c5-a0d5-8d822ef5e7e7", "product": {"name": "Linux"}, "product_version": "5d433eda76b66ab271f5924b26ddfec063eeb454"}, {"id": "b58ad7d9-1c38-37b7-8dc3-77371d2ae3a6", "product": {"name": "Linux"}, "product_version": "patch: 6.6.87"}, {"id": "e45b4b46-28b5-31d9-80e1-afef01964809", "product": {"name": "Linux"}, "product_version": "ce6e2b14bc094866d9173db6935da2d752f06d8b <81a85b12132c8ffe98f5ddbdc185481790aeaa1b"}, {"id": "faec25d1-c272-32fd-b287-a512dd71c44c", "product": {"name": "Linux"}, "product_version": "patch: 6.13.11"}, {"id": "ff3ecf4d-d914-3a55-aeb5-b9568d433327", "product": {"name": "Linux"}, "product_version": "2242640e9bd94e706acf75c60a2ab1d0e150e0fb"}], "enisaIdVendor": [{"id": "5b481b4f-ba0e-3f8a-8eb7-1324fb7b664e", "vendor": {"name": "Linux"}}], "isExploited": false}