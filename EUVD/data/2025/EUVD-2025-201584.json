{"id": "EUVD-2025-201584", "enisaUuid": "2499fd87-5469-3fc6-8854-b1aed56704bd", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/proc: fix uaf in proc_readdir_de()\n\nPde is erased from subdir rbtree through rb_erase(), but not set the node\nto EMPTY, which may result in uaf access.  We should use RB_CLEAR_NODE()\nset the erased node to EMPTY, then pde_subdir_next() will return NULL to\navoid uaf access.\n\nWe found an uaf issue while using stress-ng testing, need to run testcase\ngetdent and tun in the same time.  The steps of the issue is as follows:\n\n1) use getdent to traverse dir /proc/pid/net/dev_snmp6/, and current\n   pde is tun3;\n\n2) in the [time windows] unregister netdevice tun3 and tun2, and erase\n   them from rbtree.  erase tun3 first, and then erase tun2.  the\n   pde(tun2) will be released to slab;\n\n3) continue to getdent process, then pde_subdir_next() will return\n   pde(tun2) which is released, it will case uaf access.\n\nCPU 0                                      |    CPU 1\n-------------------------------------------------------------------------\ntraverse dir /proc/pid/net/dev_snmp6/      |   unregister_netdevice(tun->dev)   //tun3 tun2\nsys_getdents64()                           |\n  iterate_dir()                            |\n    proc_readdir()                         |\n      proc_readdir_de()                    |     snmp6_unregister_dev()\n        pde_get(de);                       |       proc_remove()\n        read_unlock(&proc_subdir_lock);    |         remove_proc_subtree()\n                                           |           write_lock(&proc_subdir_lock);\n        [time window]                      |           rb_erase(&root->subdir_node, &parent->subdir);\n                                           |           write_unlock(&proc_subdir_lock);\n        read_lock(&proc_subdir_lock);      |\n        next = pde_subdir_next(de);        |\n        pde_put(de);                       |\n        de = next;    //UAF                |\n\nrbtree of dev_snmp6\n                        |\n                    pde(tun3)\n                     /    \\\n                  NULL  pde(tun2)", "datePublished": "2025-12-07T00:30:56", "dateUpdated": "2025-12-07T00:30:56", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1d1596d68a6f11d28f677eedf6cf5b17dbfeb491", "https://git.kernel.org/stable/c/c81d0385500446efe48c305bbb83d47f2ae23a50", "https://git.kernel.org/stable/c/4cba73c4c89219beef7685a47374bf88b1022369", "https://git.kernel.org/stable/c/6f2482745e510ae1dacc9b090194b9c5f918d774", "https://git.kernel.org/stable/c/67272c11f379d9aa5e0f6b16286b9d89b3f76046", "https://git.kernel.org/stable/c/623bb26127fb581a741e880e1e1a47d79aecb6f8", "https://git.kernel.org/stable/c/03de7ff197a3d0e17d0d5c58fdac99a63cba8110", "https://git.kernel.org/stable/c/895b4c0c79b092d732544011c3cecaf7322c36a1", "https://nvd.nist.gov/vuln/detail/CVE-2025-40271"], "aliases": ["CVE-2025-40271"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0e2516ba-ebf5-33a7-8ffa-f0cb7b1c6110", "product": {"name": "Linux"}, "product_version": "patch: 5.4.302"}, {"id": "1d13c84a-a30f-3e75-8333-161fe36b7632", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c81d0385500446efe48c305bbb83d47f2ae23a50"}, {"id": "235b9249-a5d7-3ec6-b104-61bdacf68f57", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "2ea57d44-6aa5-3961-8eb0-de2400a7e5ed", "product": {"name": "Linux"}, "product_version": "patch: 6.12.59"}, {"id": "33bf3ede-0f88-333d-9d64-7c3d6c714a1c", "product": {"name": "Linux"}, "product_version": "patch: 6.17.9"}, {"id": "38b1b3bf-7137-38f3-9949-ca657cde9126", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <03de7ff197a3d0e17d0d5c58fdac99a63cba8110"}, {"id": "7aef8ce5-c2f4-363e-a12a-60238fc764a4", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "7c041597-d059-35e1-b72b-4033c69ebe2c", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "879eb231-0cc5-3add-b5e1-95b496c25750", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <67272c11f379d9aa5e0f6b16286b9d89b3f76046"}, {"id": "8e986ec9-6f72-30b6-b3d0-64b14004c598", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "983f2f84-4a25-3ae6-9758-c3146f06e135", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <623bb26127fb581a741e880e1e1a47d79aecb6f8"}, {"id": "b5c35409-57d7-3a7a-b516-f92a86dba2f8", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1d1596d68a6f11d28f677eedf6cf5b17dbfeb491"}, {"id": "b94722e4-5da0-3f2e-a668-01e90b4c50e5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4cba73c4c89219beef7685a47374bf88b1022369"}, {"id": "bf440408-4022-32eb-9677-6ca2f3954e9f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6f2482745e510ae1dacc9b090194b9c5f918d774"}, {"id": "de943b32-f0b6-3d64-8a96-e583ca4bc949", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "f1585716-8984-3b3b-9c60-12da1e448626", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <895b4c0c79b092d732544011c3cecaf7322c36a1"}], "enisaIdVendor": [{"id": "80c51934-c56d-3e5e-a241-34f99e3837ba", "vendor": {"name": "Linux"}}], "isExploited": false}