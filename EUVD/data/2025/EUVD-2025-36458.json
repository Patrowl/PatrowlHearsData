{"id": "EUVD-2025-36458", "enisaUuid": "48f373cd-7e06-3153-a76a-448084572ec2", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npps: fix warning in pps_register_cdev when register device fail\n\nSimilar to previous commit 2a934fdb01db (\"media: v4l2-dev: fix error\nhandling in __video_register_device()\"), the release hook should be set\nbefore device_register(). Otherwise, when device_register() return error\nand put_device() try to callback the release function, the below warning\nmay happen.\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 1 PID: 4760 at drivers/base/core.c:2567 device_release+0x1bd/0x240 drivers/base/core.c:2567\n  Modules linked in:\n  CPU: 1 UID: 0 PID: 4760 Comm: syz.4.914 Not tainted 6.17.0-rc3+ #1 NONE\n  RIP: 0010:device_release+0x1bd/0x240 drivers/base/core.c:2567\n  Call Trace:\n   <TASK>\n   kobject_cleanup+0x136/0x410 lib/kobject.c:689\n   kobject_release lib/kobject.c:720 [inline]\n   kref_put include/linux/kref.h:65 [inline]\n   kobject_put+0xe9/0x130 lib/kobject.c:737\n   put_device+0x24/0x30 drivers/base/core.c:3797\n   pps_register_cdev+0x2da/0x370 drivers/pps/pps.c:402\n   pps_register_source+0x2f6/0x480 drivers/pps/kapi.c:108\n   pps_tty_open+0x190/0x310 drivers/pps/clients/pps-ldisc.c:57\n   tty_ldisc_open+0xa7/0x120 drivers/tty/tty_ldisc.c:432\n   tty_set_ldisc+0x333/0x780 drivers/tty/tty_ldisc.c:563\n   tiocsetd drivers/tty/tty_io.c:2429 [inline]\n   tty_ioctl+0x5d1/0x1700 drivers/tty/tty_io.c:2728\n   vfs_ioctl fs/ioctl.c:51 [inline]\n   __do_sys_ioctl fs/ioctl.c:598 [inline]\n   __se_sys_ioctl fs/ioctl.c:584 [inline]\n   __x64_sys_ioctl+0x194/0x210 fs/ioctl.c:584\n   do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n   do_syscall_64+0x5f/0x2a0 arch/x86/entry/syscall_64.c:94\n   entry_SYSCALL_64_after_hwframe+0x76/0x7e\n   </TASK>\n\nBefore commit c79a39dc8d06 (\"pps: Fix a use-after-free\"),\npps_register_cdev() call device_create() to create pps->dev, which will\ninit dev->release to device_create_release(). Now the comment is outdated,\njust remove it.\n\nThanks for the reminder from Calvin Owens, 'kfree_pps' should be removed\nin pps_register_source() to avoid a double free in the failure case.", "datePublished": "2025-10-28T11:48:38", "dateUpdated": "2025-12-01T06:17:24", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/125527db41805693208ee1aacd7f3ffe6a3a489c", "https://git.kernel.org/stable/c/4cbd7450a22c5ee4842fc4175ad06c0c82ea53a8", "https://git.kernel.org/stable/c/cf71834a0cfc394c72d62fd6dbb470ee13cf8f5e", "https://git.kernel.org/stable/c/f01fa3588e0b3cb1540f56d2c6bd99e5b3810234", "https://git.kernel.org/stable/c/0f97564a1fb62f34b3b498e2f12caffbe99c004a", "https://git.kernel.org/stable/c/b0531cdba5029f897da5156815e3bdafe1e9b88d", "https://nvd.nist.gov/vuln/detail/CVE-2025-40070", "https://git.kernel.org/stable/c/38c7bb10aae5118dd48fa7a82f7bf93839bcc320", "https://git.kernel.org/stable/c/2a194707ca27a3b0523023fa8b446e5ec922dc51"], "aliases": ["CVE-2025-40070"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "0083ac1a-3608-3968-95b6-dd009c395638", "product": {"name": "Linux"}, "product_version": "785c78ed0d39d1717cca3ef931d3e51337b5e90e"}, {"id": "0418dce9-494d-3fb4-ac21-403f88f62556", "product": {"name": "Linux"}, "product_version": "c79a39dc8d060b9e64e8b0fa9d245d44befeefbe <0f97564a1fb62f34b3b498e2f12caffbe99c004a"}, {"id": "0850f796-f869-3570-aacb-ae31b913bb3b", "product": {"name": "Linux"}, "product_version": "7e5ee3281dc09014367f5112b6d566ba36ea2d49 <f01fa3588e0b3cb1540f56d2c6bd99e5b3810234"}, {"id": "0a4dcaf4-8b83-3fcb-9b31-14624ad3fe47", "product": {"name": "Linux"}, "product_version": "cd3bbcb6b3a7caa5ce67de76723b6d8531fb7f64 <cf71834a0cfc394c72d62fd6dbb470ee13cf8f5e"}, {"id": "0c776a84-eeee-38a9-8202-a1c576d9a0e3", "product": {"name": "Linux"}, "product_version": "patch: 6.12.53"}, {"id": "0ca09ab0-640a-311c-a226-09c5c123197c", "product": {"name": "Linux"}, "product_version": "1a7735ab2cb9747518a7416fb5929e85442dec62 <2a194707ca27a3b0523023fa8b446e5ec922dc51"}, {"id": "13b18e2c-338b-3684-919c-34b23d2c1961", "product": {"name": "Linux"}, "product_version": "patch: 5.4.301"}, {"id": "21daa5b2-d5f7-3598-8497-07a4c7c846fb", "product": {"name": "Linux"}, "product_version": "6.14"}, {"id": "477c6d2a-2814-32f1-9651-89a545b110bc", "product": {"name": "Linux"}, "product_version": "85241f7de216f8298f6e48540ea13d7dcd100870"}, {"id": "57daef5f-302f-3bd0-bc5f-f698d3ebbbb1", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "595030aa-209c-3c15-9281-f6688f0b3327", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "5a161dbd-a3b2-34d1-9714-180e9411ed51", "product": {"name": "Linux"}, "product_version": "patch: 5.10.246"}, {"id": "685e3772-f00b-3079-9352-e2470ec42712", "product": {"name": "Linux"}, "product_version": "785c78ed0d39d1717cca3ef931d3e51337b5e90e <38c7bb10aae5118dd48fa7a82f7bf93839bcc320"}, {"id": "6d4f3ada-ac07-3e27-ba94-8319c58b9d63", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "6de2411b-dcad-34a0-8015-df9d9afb72d1", "product": {"name": "Linux"}, "product_version": "patch: 5.15.195"}, {"id": "99c78664-1843-3fd0-a5bd-c86cd2909dca", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "9df29241-259c-31e9-9de7-e8b9bbc1d809", "product": {"name": "Linux"}, "product_version": "c4041b6b0a7a3def8cf3f3d6120ff337bc4c40f7 <125527db41805693208ee1aacd7f3ffe6a3a489c"}, {"id": "af9add16-b388-35a0-a330-08c8f26446b1", "product": {"name": "Linux"}, "product_version": "c79a39dc8d060b9e64e8b0fa9d245d44befeefbe <b0531cdba5029f897da5156815e3bdafe1e9b88d"}, {"id": "c4a10801-c144-302b-b690-5d8fff67133d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.112"}, {"id": "d1508141-7b49-33cc-a1e7-a71ea0c31943", "product": {"name": "Linux"}, "product_version": "patch: 6.1.156"}, {"id": "e7594791-d932-3ccd-b9c3-7cd9072b6bd2", "product": {"name": "Linux"}, "product_version": "1a7735ab2cb9747518a7416fb5929e85442dec62"}, {"id": "f957814b-648c-3db0-933e-0f43c43e0f55", "product": {"name": "Linux"}, "product_version": "91932db1d96b2952299ce30c1c693d834d10ace6 <4cbd7450a22c5ee4842fc4175ad06c0c82ea53a8"}], "enisaIdVendor": [{"id": "96178ee8-e418-3657-ad1e-b301183e5f89", "vendor": {"name": "Linux"}}], "isExploited": false}