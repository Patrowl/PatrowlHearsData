{"id": "EUVD-2025-34591", "enisaUuid": "6dfae816-a60e-35f9-abd4-771bd796d49d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: MGMT: Fix possible UAFs\n\nThis attemps to fix possible UAFs caused by struct mgmt_pending being\nfreed while still being processed like in the following trace, in order\nto fix mgmt_pending_valid is introduce and use to check if the\nmgmt_pending hasn't been removed from the pending list, on the complete\ncallbacks it is used to check and in addtion remove the cmd from the list\nwhile holding mgmt_pending_lock to avoid TOCTOU problems since if the cmd\nis left on the list it can still be accessed and freed.\n\nBUG: KASAN: slab-use-after-free in mgmt_add_adv_patterns_monitor_sync+0x35/0x50 net/bluetooth/mgmt.c:5223\nRead of size 8 at addr ffff8880709d4dc0 by task kworker/u11:0/55\n\nCPU: 0 UID: 0 PID: 55 Comm: kworker/u11:0 Not tainted 6.16.4 #2 PREEMPT(full)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014\nWorkqueue: hci0 hci_cmd_sync_work\nCall Trace:\n <TASK>\n dump_stack_lvl+0x189/0x250 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:378 [inline]\n print_report+0xca/0x240 mm/kasan/report.c:482\n kasan_report+0x118/0x150 mm/kasan/report.c:595\n mgmt_add_adv_patterns_monitor_sync+0x35/0x50 net/bluetooth/mgmt.c:5223\n hci_cmd_sync_work+0x210/0x3a0 net/bluetooth/hci_sync.c:332\n process_one_work kernel/workqueue.c:3238 [inline]\n process_scheduled_works+0xade/0x17b0 kernel/workqueue.c:3321\n worker_thread+0x8a0/0xda0 kernel/workqueue.c:3402\n kthread+0x711/0x8a0 kernel/kthread.c:464\n ret_from_fork+0x3fc/0x770 arch/x86/kernel/process.c:148\n ret_from_fork_asm+0x1a/0x30 home/kwqcheii/source/fuzzing/kernel/kasan/linux-6.16.4/arch/x86/entry/entry_64.S:245\n </TASK>\n\nAllocated by task 12210:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n poison_kmalloc_redzone mm/kasan/common.c:377 [inline]\n __kasan_kmalloc+0x93/0xb0 mm/kasan/common.c:394\n kasan_kmalloc include/linux/kasan.h:260 [inline]\n __kmalloc_cache_noprof+0x230/0x3d0 mm/slub.c:4364\n kmalloc_noprof include/linux/slab.h:905 [inline]\n kzalloc_noprof include/linux/slab.h:1039 [inline]\n mgmt_pending_new+0x65/0x1e0 net/bluetooth/mgmt_util.c:269\n mgmt_pending_add+0x35/0x140 net/bluetooth/mgmt_util.c:296\n __add_adv_patterns_monitor+0x130/0x200 net/bluetooth/mgmt.c:5247\n add_adv_patterns_monitor+0x214/0x360 net/bluetooth/mgmt.c:5364\n hci_mgmt_cmd+0x9c9/0xef0 net/bluetooth/hci_sock.c:1719\n hci_sock_sendmsg+0x6ca/0xef0 net/bluetooth/hci_sock.c:1839\n sock_sendmsg_nosec net/socket.c:714 [inline]\n __sock_sendmsg+0x219/0x270 net/socket.c:729\n sock_write_iter+0x258/0x330 net/socket.c:1133\n new_sync_write fs/read_write.c:593 [inline]\n vfs_write+0x5c9/0xb30 fs/read_write.c:686\n ksys_write+0x145/0x250 fs/read_write.c:738\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nFreed by task 12221:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3e/0x80 mm/kasan/common.c:68\n kasan_save_free_info+0x46/0x50 mm/kasan/generic.c:576\n poison_slab_object mm/kasan/common.c:247 [inline]\n __kasan_slab_free+0x62/0x70 mm/kasan/common.c:264\n kasan_slab_free include/linux/kasan.h:233 [inline]\n slab_free_hook mm/slub.c:2381 [inline]\n slab_free mm/slub.c:4648 [inline]\n kfree+0x18e/0x440 mm/slub.c:4847\n mgmt_pending_free net/bluetooth/mgmt_util.c:311 [inline]\n mgmt_pending_foreach+0x30d/0x380 net/bluetooth/mgmt_util.c:257\n __mgmt_power_off+0x169/0x350 net/bluetooth/mgmt.c:9444\n hci_dev_close_sync+0x754/0x1330 net/bluetooth/hci_sync.c:5290\n hci_dev_do_close net/bluetooth/hci_core.c:501 [inline]\n hci_dev_close+0x108/0x200 net/bluetooth/hci_core.c:526\n sock_do_ioctl+0xd9/0x300 net/socket.c:1192\n sock_ioctl+0x576/0x790 net/socket.c:1313\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:907 [inline]\n __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xf\n---truncated---", "datePublished": "2025-10-15T09:30:17", "dateUpdated": "2025-11-24T12:30:27", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/87a1f16f07c6c43771754075e08f45b41d237421", "https://git.kernel.org/stable/c/302a1f674c00dd5581ab8e493ef44767c5101aab", "https://nvd.nist.gov/vuln/detail/CVE-2025-39981", "https://git.kernel.org/stable/c/d71b98f253b079cbadc83266383f26fe7e9e103b"], "aliases": ["CVE-2025-39981"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "44151dc2-66d9-3bbf-811d-4e45b8bf1245", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5634996b-3685-3514-ad15-ffc26800010c", "product": {"name": "Linux"}, "product_version": "patch: 6.12.59"}, {"id": "6e022cde-7224-3bfb-bad3-4cdf89cb1f81", "product": {"name": "Linux"}, "product_version": "cf75ad8b41d2aa06f98f365d42a3ae8b059daddd <d71b98f253b079cbadc83266383f26fe7e9e103b"}, {"id": "70339bb5-95b3-3cde-b152-7849640c1244", "product": {"name": "Linux"}, "product_version": "5.17"}, {"id": "758f6cc4-9b29-3761-8ad3-af5d1902cc18", "product": {"name": "Linux"}, "product_version": "cf75ad8b41d2aa06f98f365d42a3ae8b059daddd <302a1f674c00dd5581ab8e493ef44767c5101aab"}, {"id": "7f3774ef-ec85-366e-beeb-b0be704934f0", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "c11f27c8-3b47-3248-ad4c-73edf59636f9", "product": {"name": "Linux"}, "product_version": "patch: 6.16.10"}, {"id": "d4be985e-d78b-3320-b58a-e698a23be5dd", "product": {"name": "Linux"}, "product_version": "cf75ad8b41d2aa06f98f365d42a3ae8b059daddd <87a1f16f07c6c43771754075e08f45b41d237421"}], "enisaIdVendor": [{"id": "2114d216-9200-32e4-98a1-cb6c167c2ccd", "vendor": {"name": "Linux"}}], "isExploited": false}