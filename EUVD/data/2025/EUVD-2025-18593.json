{"id": "EUVD-2025-18593", "enisaUuid": "634c8b8a-54e0-37d2-9d64-ab11a25d8e2f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: copy_verifier_state() should copy 'loop_entry' field\n\nThe bpf_verifier_state.loop_entry state should be copied by\ncopy_verifier_state(). Otherwise, .loop_entry values from unrelated\nstates would poison env->cur_state.\n\nAdditionally, env->stack should not contain any states with\n.loop_entry != NULL. The states in env->stack are yet to be verified,\nwhile .loop_entry is set for states that reached an equivalent state.\nThis means that env->cur_state->loop_entry should always be NULL after\npop_stack().\n\nSee the selftest in the next commit for an example of the program that\nis not safe yet is accepted by verifier w/o this fix.\n\nThis change has some verification performance impact for selftests:\n\nFile                                Program                       Insns (A)  Insns (B)  Insns   (DIFF)  States (A)  States (B)  States (DIFF)\n----------------------------------  ----------------------------  ---------  ---------  --------------  ----------  ----------  -------------\narena_htab.bpf.o                    arena_htab_llvm                     717        426  -291 (-40.59%)          57          37  -20 (-35.09%)\narena_htab_asm.bpf.o                arena_htab_asm                      597        445  -152 (-25.46%)          47          37  -10 (-21.28%)\narena_list.bpf.o                    arena_list_del                      309        279    -30 (-9.71%)          23          14   -9 (-39.13%)\niters.bpf.o                         iter_subprog_check_stacksafe        155        141    -14 (-9.03%)          15          14    -1 (-6.67%)\niters.bpf.o                         iter_subprog_iters                 1094       1003    -91 (-8.32%)          88          83    -5 (-5.68%)\niters.bpf.o                         loop_state_deps2                    479        725  +246 (+51.36%)          46          63  +17 (+36.96%)\nkmem_cache_iter.bpf.o               open_coded_iter                      63         59     -4 (-6.35%)           7           6   -1 (-14.29%)\nverifier_bits_iter.bpf.o            max_words                            92         84     -8 (-8.70%)           8           7   -1 (-12.50%)\nverifier_iterating_callbacks.bpf.o  cond_break2                         113        107     -6 (-5.31%)          12          12    +0 (+0.00%)\n\nAnd significant negative impact for sched_ext:\n\nFile               Program                 Insns (A)  Insns (B)  Insns         (DIFF)  States (A)  States (B)  States      (DIFF)\n-----------------  ----------------------  ---------  ---------  --------------------  ----------  ----------  ------------------\nbpf.bpf.o          lavd_init                    7039      14723      +7684 (+109.16%)         490        1139     +649 (+132.45%)\nbpf.bpf.o          layered_dispatch            11485      10548         -937 (-8.16%)         848         762       -86 (-10.14%)\nbpf.bpf.o          layered_dump                 7422    1000001  +992579 (+13373.47%)         681       31178  +30497 (+4478.27%)\nbpf.bpf.o          layered_enqueue             16854      71127     +54273 (+322.02%)        1611        6450    +4839 (+300.37%)\nbpf.bpf.o          p2dq_dispatch                 665        791        +126 (+18.95%)          68          78       +10 (+14.71%)\nbpf.bpf.o          p2dq_init                    2343       2980        +637 (+27.19%)         201         237       +36 (+17.91%)\nbpf.bpf.o          refresh_layer_cpumasks      16487     674760   +658273 (+3992.68%)        1770       65370  +63600 (+3593.22%)\nbpf.bpf.o          rusty_select_cpu             1937      40872    +38935 (+2010.07%)         177        3210   +3033 (+1713.56%)\nscx_central.bpf.o  central_dispatch              636       2687      +2051 (+322.48%)          63         227     +164 (+260.32%)\nscx_nest.bpf.o     nest_init                     636        815        +179 (+28.14%)          60          73       +13 (+21.67%)\nscx_qmap.bpf.o     qmap_dispatch      \n---truncated---", "datePublished": "2025-06-18T12:30:33", "dateUpdated": "2025-11-14T18:31:22", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/46ba5757a7a4714e7d3f68cfe118208822cb3d78", "https://git.kernel.org/stable/c/8b4afd89fa75f738a80ca849126fd3cad77bcbf1", "https://git.kernel.org/stable/c/bbbc02b7445ebfda13e4847f4f1413c6480a85a9", "https://nvd.nist.gov/vuln/detail/CVE-2025-38060"], "aliases": ["CVE-2025-38060"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "0cfc5246-105b-39e2-ba42-eb90eb3245ee", "product": {"name": "Linux"}, "product_version": "patch: 6.12.31"}, {"id": "1fdd6805-fe56-3d61-a17b-832bbbdf6a6f", "product": {"name": "Linux"}, "product_version": "c8f6d285825f61d619c4c2509bfd75eb366db900"}, {"id": "57b21f55-9510-3f6d-a02e-87607da18768", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "67c18ffe-0b90-3425-a121-f265ecb8ad52", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bbbc02b7445ebfda13e4847f4f1413c6480a85a9"}, {"id": "69770e80-2682-3944-9d73-e089d01fa707", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8b4afd89fa75f738a80ca849126fd3cad77bcbf1"}, {"id": "ac279cf7-b211-3e58-8096-86a5036592e2", "product": {"name": "Linux"}, "product_version": "2a0992829ea3864939d917a5c7b48be6629c6217 <46ba5757a7a4714e7d3f68cfe118208822cb3d78"}, {"id": "ac8f2f5f-1ac2-35c7-b596-326755b24e06", "product": {"name": "Linux"}, "product_version": "2a0992829ea3864939d917a5c7b48be6629c6217 <8b4afd89fa75f738a80ca849126fd3cad77bcbf1"}, {"id": "ba538d5c-97c2-37f3-ab26-47f22c39e4bd", "product": {"name": "Linux"}, "product_version": "2a0992829ea3864939d917a5c7b48be6629c6217 <bbbc02b7445ebfda13e4847f4f1413c6480a85a9"}, {"id": "c021ea38-19cf-3115-b75d-7f5bfb5414cf", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <46ba5757a7a4714e7d3f68cfe118208822cb3d78"}, {"id": "c0641a73-c5e2-3fcf-8a2f-a6361204e38d", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c47940ca-8da9-3fd7-848f-d82b0a7b59b2", "product": {"name": "Linux"}, "product_version": "6.7"}, {"id": "e13983ea-f179-3d3b-8c70-bc40e9a13386", "product": {"name": "Linux"}, "product_version": "patch: 6.14.9"}], "enisaIdVendor": [{"id": "ab714b2b-8c51-3ab1-ad25-07df3722500c", "vendor": {"name": "Linux"}}], "isExploited": false}