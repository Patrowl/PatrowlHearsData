{"id": "EUVD-2025-203798", "enisaUuid": "e1531454-ef81-3ba2-bdff-98362b16675b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: udc: fix use-after-free in usb_gadget_state_work\n\nA race condition during gadget teardown can lead to a use-after-free\nin usb_gadget_state_work(), as reported by KASAN:\n\n  BUG: KASAN: invalid-access in sysfs_notify+0x2c/0xd0\n  Workqueue: events usb_gadget_state_work\n\nThe fundamental race occurs because a concurrent event (e.g., an\ninterrupt) can call usb_gadget_set_state() and schedule gadget->work\nat any time during the cleanup process in usb_del_gadget().\n\nCommit 399a45e5237c (\"usb: gadget: core: flush gadget workqueue after\ndevice removal\") attempted to fix this by moving flush_work() to after\ndevice_del(). However, this does not fully solve the race, as a new\nwork item can still be scheduled *after* flush_work() completes but\nbefore the gadget's memory is freed, leading to the same use-after-free.\n\nThis patch fixes the race condition robustly by introducing a 'teardown'\nflag and a 'state_lock' spinlock to the usb_gadget struct. The flag is\nset during cleanup in usb_del_gadget() *before* calling flush_work() to\nprevent any new work from being scheduled once cleanup has commenced.\nThe scheduling site, usb_gadget_set_state(), now checks this flag under\nthe lock before queueing the work, thus safely closing the race window.", "datePublished": "2025-12-16T18:31:32", "dateUpdated": "2025-12-16T18:31:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c12a0c3ef815ddd67e47f9c819f9fe822fed5467", "https://git.kernel.org/stable/c/f02a412c0a18f02f0f91b0a3d9788315a721b7fd", "https://git.kernel.org/stable/c/10014310193cf6736c1aeb4105c5f4a0818d0c65", "https://git.kernel.org/stable/c/3b32caa73d135eea8fb9cabb45e9fc64c5a3ecb9", "https://git.kernel.org/stable/c/baeb66fbd4201d1c4325074e78b1f557dff89b5b", "https://nvd.nist.gov/vuln/detail/CVE-2025-68282"], "aliases": ["CVE-2025-68282"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "04386ed9-e899-31be-a51a-d25ed0396597", "product": {"name": "Linux"}, "product_version": "patch: 6.6.119"}, {"id": "3d2e119c-766a-3f8c-8f4c-cadf6871e7d1", "product": {"name": "Linux"}, "product_version": "5702f75375aa9ecf8ad3431aef3fe6ce8c8dbd15 <c12a0c3ef815ddd67e47f9c819f9fe822fed5467"}, {"id": "40e41b54-434c-3494-962b-a352d72a863a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "4ba62592-a066-3b6b-8721-d97061051f33", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "57cdbf33-abae-3f21-90b0-2aa5aefd0eb1", "product": {"name": "Linux"}, "product_version": "5702f75375aa9ecf8ad3431aef3fe6ce8c8dbd15 <baeb66fbd4201d1c4325074e78b1f557dff89b5b"}, {"id": "729896f0-725b-344e-88c9-2995a5a65cf5", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "88bf1cb2-132d-3776-881b-f4220b9a409c", "product": {"name": "Linux"}, "product_version": "5702f75375aa9ecf8ad3431aef3fe6ce8c8dbd15 <3b32caa73d135eea8fb9cabb45e9fc64c5a3ecb9"}, {"id": "91fbba7c-dfd2-3170-98fd-c0abee3963dc", "product": {"name": "Linux"}, "product_version": "5702f75375aa9ecf8ad3431aef3fe6ce8c8dbd15 <10014310193cf6736c1aeb4105c5f4a0818d0c65"}, {"id": "a64d6c24-387b-3f4e-8c20-d9c3b3060cd4", "product": {"name": "Linux"}, "product_version": "patch: 6.12.61"}, {"id": "ab885af1-d9ec-347e-a636-9e0232d7b272", "product": {"name": "Linux"}, "product_version": "3.12"}, {"id": "b0315603-3f2d-3409-929f-956474fdc6e5", "product": {"name": "Linux"}, "product_version": "patch: 6.17.11"}, {"id": "c5014a57-f517-3b02-80e0-4ed8f06caa72", "product": {"name": "Linux"}, "product_version": "5702f75375aa9ecf8ad3431aef3fe6ce8c8dbd15 <f02a412c0a18f02f0f91b0a3d9788315a721b7fd"}], "enisaIdVendor": [{"id": "aa6e3f41-9b61-3fc3-92d2-40fbaf416411", "vendor": {"name": "Linux"}}], "isExploited": false}