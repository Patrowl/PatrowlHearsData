{"id": "EUVD-2025-25579", "enisaUuid": "1c9f0465-b16b-316a-9337-cbfa390ec3be", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: drop UFO packets in udp_rcv_segment()\n\nWhen sending a packet with virtio_net_hdr to tun device, if the gso_type\nin virtio_net_hdr is SKB_GSO_UDP and the gso_size is less than udphdr\nsize, below crash may happen.\n\n  ------------[ cut here ]------------\n  kernel BUG at net/core/skbuff.c:4572!\n  Oops: invalid opcode: 0000 [#1] SMP NOPTI\n  CPU: 0 UID: 0 PID: 62 Comm: mytest Not tainted 6.16.0-rc7 #203 PREEMPT(voluntary)\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\n  RIP: 0010:skb_pull_rcsum+0x8e/0xa0\n  Code: 00 00 5b c3 cc cc cc cc 8b 93 88 00 00 00 f7 da e8 37 44 38 00 f7 d8 89 83 88 00 00 00 48 8b 83 c8 00 00 00 5b c3 cc cc cc cc <0f> 0b 0f 0b 66 66 2e 0f 1f 84 00 000\n  RSP: 0018:ffffc900001fba38 EFLAGS: 00000297\n  RAX: 0000000000000004 RBX: ffff8880040c1000 RCX: ffffc900001fb948\n  RDX: ffff888003e6d700 RSI: 0000000000000008 RDI: ffff88800411a062\n  RBP: ffff8880040c1000 R08: 0000000000000000 R09: 0000000000000001\n  R10: ffff888003606c00 R11: 0000000000000001 R12: 0000000000000000\n  R13: ffff888004060900 R14: ffff888004050000 R15: ffff888004060900\n  FS:  000000002406d3c0(0000) GS:ffff888084a19000(0000) knlGS:0000000000000000\n  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n  CR2: 0000000020000040 CR3: 0000000004007000 CR4: 00000000000006f0\n  Call Trace:\n   <TASK>\n   udp_queue_rcv_one_skb+0x176/0x4b0 net/ipv4/udp.c:2445\n   udp_queue_rcv_skb+0x155/0x1f0 net/ipv4/udp.c:2475\n   udp_unicast_rcv_skb+0x71/0x90 net/ipv4/udp.c:2626\n   __udp4_lib_rcv+0x433/0xb00 net/ipv4/udp.c:2690\n   ip_protocol_deliver_rcu+0xa6/0x160 net/ipv4/ip_input.c:205\n   ip_local_deliver_finish+0x72/0x90 net/ipv4/ip_input.c:233\n   ip_sublist_rcv_finish+0x5f/0x70 net/ipv4/ip_input.c:579\n   ip_sublist_rcv+0x122/0x1b0 net/ipv4/ip_input.c:636\n   ip_list_rcv+0xf7/0x130 net/ipv4/ip_input.c:670\n   __netif_receive_skb_list_core+0x21d/0x240 net/core/dev.c:6067\n   netif_receive_skb_list_internal+0x186/0x2b0 net/core/dev.c:6210\n   napi_complete_done+0x78/0x180 net/core/dev.c:6580\n   tun_get_user+0xa63/0x1120 drivers/net/tun.c:1909\n   tun_chr_write_iter+0x65/0xb0 drivers/net/tun.c:1984\n   vfs_write+0x300/0x420 fs/read_write.c:593\n   ksys_write+0x60/0xd0 fs/read_write.c:686\n   do_syscall_64+0x50/0x1c0 arch/x86/entry/syscall_64.c:63\n   </TASK>\n\nTo trigger gso segment in udp_queue_rcv_skb(), we should also set option\nUDP_ENCAP_ESPINUDP to enable udp_sk(sk)->encap_rcv. When the encap_rcv\nhook return 1 in udp_queue_rcv_one_skb(), udp_csum_pull_header() will try\nto pull udphdr, but the skb size has been segmented to gso size, which\nleads to this crash.\n\nPrevious commit cf329aa42b66 (\"udp: cope with UDP GRO packet misdirection\")\nintroduces segmentation in UDP receive path only for GRO, which was never\nintended to be used for UFO, so drop UFO packets in udp_rcv_segment().", "datePublished": "2025-08-22T18:31:21", "dateUpdated": "2025-11-03T18:31:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/791f32c5eab33ca3a153f8f6f763aa0df1ddc320", "https://git.kernel.org/stable/c/0d45954034f8edd6d4052e0190d3d6335c37e4de", "https://git.kernel.org/stable/c/c0ec2e47f1e92d69b42b17a4a1e543256778393e", "https://git.kernel.org/stable/c/fc45b3f9599b657d4a64bcf423d2a977b3e13a49", "https://git.kernel.org/stable/c/0c639c6479ec4480372901a5fc566f7588cf5522", "https://git.kernel.org/stable/c/d46e51f1c78b9ab9323610feb14238d06d46d519", "https://git.kernel.org/stable/c/72f97d3cb791e26492236b2be7fd70d2c6222555", "https://git.kernel.org/stable/c/df6ad849d59256dcc0e2234844ef9f0daf885f5c", "https://git.kernel.org/stable/c/4c1022220b1b6fea802175e80444923a3bbf93a5", "https://nvd.nist.gov/vuln/detail/CVE-2025-38622", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38622"], "assigner": "Linux", "epss": 0.06, "enisaIdProduct": [{"id": "09e1edcb-a46a-3728-9fb1-294ba2d20bde", "product": {"name": "Linux"}, "product_version": "5.0"}, {"id": "126a3d37-f6a4-328e-852c-009b2d8eafc6", "product": {"name": "Linux"}, "product_version": "patch: 6.12.42"}, {"id": "1e5ec6b9-baf7-37dc-ae03-e85f549fa24c", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <c0ec2e47f1e92d69b42b17a4a1e543256778393e"}, {"id": "24ddc6b7-393b-31e7-814e-ff2cde34dac5", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "2b761958-9cd5-324b-a90c-11ff0954e2dd", "product": {"name": "Linux"}, "product_version": "patch: 6.6.102"}, {"id": "316d4a8d-58f3-3441-836b-61b3f93350b5", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <df6ad849d59256dcc0e2234844ef9f0daf885f5c"}, {"id": "39a9a8c9-beba-353a-b06f-b38b115c16a6", "product": {"name": "Linux"}, "product_version": "patch: 6.1.148"}, {"id": "6de64c8a-de89-3af4-959f-a092ab43a1ce", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}, {"id": "6e255aae-5853-3394-9369-88a00a57efde", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc1"}, {"id": "6ed85b46-4cb9-35e6-ab66-9a8f015e8aa0", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <d46e51f1c78b9ab9323610feb14238d06d46d519"}, {"id": "70071bc7-ae25-3b77-a2de-b0dfeb510ed6", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <0d45954034f8edd6d4052e0190d3d6335c37e4de"}, {"id": "7e97eddd-ab69-3f67-b44c-2ec1d02b89d7", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8169fd07-1960-3ddf-a509-9ced7ea685b3", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "8438f78e-38ec-3b7b-90c2-5b12c5213370", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <fc45b3f9599b657d4a64bcf423d2a977b3e13a49"}, {"id": "8839cf0c-6e04-34ca-be99-16633597988b", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <72f97d3cb791e26492236b2be7fd70d2c6222555"}, {"id": "a58fb12d-7892-3fc8-a62b-9c480cb8c83b", "product": {"name": "Linux"}, "product_version": "patch: 6.15.10"}, {"id": "ab8318d9-fcae-3f5d-b7cb-6338e4b73313", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <4c1022220b1b6fea802175e80444923a3bbf93a5"}, {"id": "c3a6f9f7-78c7-3d13-92bd-be9861571e7d", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <0c639c6479ec4480372901a5fc566f7588cf5522"}, {"id": "cd20dde6-4635-3d1e-b556-7c44c42bd94f", "product": {"name": "Linux"}, "product_version": "patch: 6.16.1"}, {"id": "e20ea5b7-8744-3b83-aa3b-52415a62487c", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "feecf4be-84a8-3b1d-8af9-c4f25bde4980", "product": {"name": "Linux"}, "product_version": "cf329aa42b6659204fee865bbce0ea20462552eb <791f32c5eab33ca3a153f8f6f763aa0df1ddc320"}], "enisaIdVendor": [{"id": "8b0a04a4-4114-3861-90a9-3041786f1690", "vendor": {"name": "Linux"}}], "isExploited": false}