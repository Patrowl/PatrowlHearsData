{"id": "EUVD-2025-34592", "enisaUuid": "792f65b1-7e2c-358c-85b9-8ee58f7c0cef", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnexthop: Forbid FDB status change while nexthop is in a group\n\nThe kernel forbids the creation of non-FDB nexthop groups with FDB\nnexthops:\n\n # ip nexthop add id 1 via 192.0.2.1 fdb\n # ip nexthop add id 2 group 1\n Error: Non FDB nexthop group cannot have fdb nexthops.\n\nAnd vice versa:\n\n # ip nexthop add id 3 via 192.0.2.2 dev dummy1\n # ip nexthop add id 4 group 3 fdb\n Error: FDB nexthop group can only have fdb nexthops.\n\nHowever, as long as no routes are pointing to a non-FDB nexthop group,\nthe kernel allows changing the type of a nexthop from FDB to non-FDB and\nvice versa:\n\n # ip nexthop add id 5 via 192.0.2.2 dev dummy1\n # ip nexthop add id 6 group 5\n # ip nexthop replace id 5 via 192.0.2.2 fdb\n # echo $?\n 0\n\nThis configuration is invalid and can result in a NPD [1] since FDB\nnexthops are not associated with a nexthop device:\n\n # ip route add 198.51.100.1/32 nhid 6\n # ping 198.51.100.1\n\nFix by preventing nexthop FDB status change while the nexthop is in a\ngroup:\n\n # ip nexthop add id 7 via 192.0.2.2 dev dummy1\n # ip nexthop add id 8 group 7\n # ip nexthop replace id 7 via 192.0.2.2 fdb\n Error: Cannot change nexthop FDB status while in a group.\n\n[1]\nBUG: kernel NULL pointer dereference, address: 00000000000003c0\n[...]\nOops: Oops: 0000 [#1] SMP\nCPU: 6 UID: 0 PID: 367 Comm: ping Not tainted 6.17.0-rc6-virtme-gb65678cacc03 #1 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.17.0-4.fc41 04/01/2014\nRIP: 0010:fib_lookup_good_nhc+0x1e/0x80\n[...]\nCall Trace:\n <TASK>\n fib_table_lookup+0x541/0x650\n ip_route_output_key_hash_rcu+0x2ea/0x970\n ip_route_output_key_hash+0x55/0x80\n __ip4_datagram_connect+0x250/0x330\n udp_connect+0x2b/0x60\n __sys_connect+0x9c/0xd0\n __x64_sys_connect+0x18/0x20\n do_syscall_64+0xa4/0x2a0\n entry_SYSCALL_64_after_hwframe+0x4b/0x53", "datePublished": "2025-10-15T09:30:17", "dateUpdated": "2025-10-15T09:30:17", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/e1e87ac0daacd51f522ecd1645cd76b5809303ed", "https://git.kernel.org/stable/c/0e7bfe7a268ccbd7859730c529161cafbf44637c", "https://git.kernel.org/stable/c/ec428fff792b7bd15b248dafca2e654b666b1304", "https://git.kernel.org/stable/c/24046d31f6f92220852d393d510b6062843e3fbd", "https://git.kernel.org/stable/c/f0e49fd13afe9dea7a09a1c9537fd00cea22badb", "https://git.kernel.org/stable/c/8dd4aa0122885f710930de135af2adc4ccc3238f", "https://git.kernel.org/stable/c/390b3a300d7872cef9588f003b204398be69ce08", "https://nvd.nist.gov/vuln/detail/CVE-2025-39980"], "aliases": ["CVE-2025-39980"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "0647a11b-b802-3bd5-b2e2-aec14fdcbef6", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <e1e87ac0daacd51f522ecd1645cd76b5809303ed"}, {"id": "09d1b44e-d864-33dd-8448-73075ae64764", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <0e7bfe7a268ccbd7859730c529161cafbf44637c"}, {"id": "1f266c91-1a32-3a1e-b170-6d46327df167", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <f0e49fd13afe9dea7a09a1c9537fd00cea22badb"}, {"id": "2b68329e-b36a-36eb-ae01-667cfd895f9f", "product": {"name": "Linux"}, "product_version": "patch: 6.1.155"}, {"id": "3b0f217d-db6e-3b9a-8209-505514a15357", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <390b3a300d7872cef9588f003b204398be69ce08"}, {"id": "493fd88f-c59e-3424-aa0d-2b1a41f12e23", "product": {"name": "Linux"}, "product_version": "patch: 6.12.50"}, {"id": "4d06308f-a3da-3d80-9540-6683fd381b22", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "54ca8aa6-5991-3edf-9cd0-9eb9a13a1de0", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <8dd4aa0122885f710930de135af2adc4ccc3238f"}, {"id": "71c47124-a4d0-3d25-bd61-377f530d18a6", "product": {"name": "Linux"}, "product_version": "patch: 5.10.245"}, {"id": "945b8d71-6ee3-33ef-920d-99d684be9ed8", "product": {"name": "Linux"}, "product_version": "patch: 6.6.109"}, {"id": "95be3b43-5ad9-3c10-83cf-18014374c9d2", "product": {"name": "Linux"}, "product_version": "patch: 6.16.10"}, {"id": "a6039274-b746-3295-a360-29452ab63ca2", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <24046d31f6f92220852d393d510b6062843e3fbd"}, {"id": "a9a6b111-6664-342a-a807-f0ec882d54e9", "product": {"name": "Linux"}, "product_version": "38428d68719c454d269cb03b776d8a4b0ad66111 <ec428fff792b7bd15b248dafca2e654b666b1304"}, {"id": "c8b4bd7f-1092-3c52-8dac-6c417c512a77", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "d3e35261-2d81-3b67-be78-2bddc437f267", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "e12b1217-ce47-337f-b6bd-3fead0293e50", "product": {"name": "Linux"}, "product_version": "patch: 5.15.194"}], "enisaIdVendor": [{"id": "8ea87323-0014-3e68-a591-4b24f17656e6", "vendor": {"name": "Linux"}}], "isExploited": false}