{"id": "EUVD-2025-201631", "enisaUuid": "e34b8612-cf6c-3059-8a3b-22cad5f000db", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: cdns3: gadget: Use-after-free during failed initialization and exit of cdnsp gadget\n\nIn the __cdnsp_gadget_init() and cdnsp_gadget_exit() functions, the gadget\nstructure (pdev->gadget) was freed before its endpoints.\nThe endpoints are linked via the ep_list in the gadget structure.\nFreeing the gadget first leaves dangling pointers in the endpoint list.\nWhen the endpoints are subsequently freed, this results in a use-after-free.\n\nFix:\nBy separating the usb_del_gadget_udc() operation into distinct \"del\" and\n\"put\" steps, cdnsp_gadget_free_endpoints() can be executed prior to the\nfinal release of the gadget structure with usb_put_gadget().\n\nA patch similar to bb9c74a5bd14(\"usb: dwc3: gadget: Free gadget structure\n only after freeing endpoints\").", "datePublished": "2025-12-08T00:46:40", "dateUpdated": "2025-12-20T08:52:04", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/0cf9a50af91fbdac3849f8d950e883a3eaa3ecea", "https://git.kernel.org/stable/c/37158ce6ba964b62d1e3eebd11f03c6900a52dd1", "https://git.kernel.org/stable/c/ea37884097a0931abb8e11e40eacfb25e9fdb5e9", "https://git.kernel.org/stable/c/9c52f01429c377a2d32cafc977465f37b5384f77", "https://git.kernel.org/stable/c/fdf573c517627a96f5040f988e9b21267806be5c", "https://git.kernel.org/stable/c/87c5ff5615dc0a37167e8faf3adeeddc6f1344a3", "https://nvd.nist.gov/vuln/detail/CVE-2025-40314"], "aliases": ["CVE-2025-40314"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "00b381b1-bb92-387f-9eef-8da42ebf4d89", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9c52f01429c377a2d32cafc977465f37b5384f77"}, {"id": "03a83c98-6c05-3aef-a4d2-83815895316c", "product": {"name": "Linux"}, "product_version": "patch: 6.12.58"}, {"id": "24b3ad8e-ad47-31c5-815d-f24c99327b87", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <fdf573c517627a96f5040f988e9b21267806be5c"}, {"id": "274bb088-e3e7-3688-a7b4-fa09938e5da5", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "37fc9b9b-a81c-3998-843b-15dee7abb7aa", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fdf573c517627a96f5040f988e9b21267806be5c"}, {"id": "4457534f-8490-3de7-814c-01af4aacfc54", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "44c5a081-b095-3080-9860-d215f7177bbf", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <37158ce6ba964b62d1e3eebd11f03c6900a52dd1"}, {"id": "49f3603f-addb-3f86-91b4-8a29144543bb", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "5e27cb9d-2ce8-3c0d-ac77-85e00e67a965", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <87c5ff5615dc0a37167e8faf3adeeddc6f1344a3"}, {"id": "6228584d-e45d-3ff3-a8cd-00a781ca5582", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0cf9a50af91fbdac3849f8d950e883a3eaa3ecea"}, {"id": "ad03a7a2-6033-3ac8-a34e-3a59c9bd2090", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "b9457196-673e-38d7-9274-616b7b2d4de4", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <0cf9a50af91fbdac3849f8d950e883a3eaa3ecea"}, {"id": "be241f59-d1ef-3f75-b7e3-d5d8bb6ba265", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ea37884097a0931abb8e11e40eacfb25e9fdb5e9"}, {"id": "c114e51a-a8cb-3712-82ef-77d701ef4f87", "product": {"name": "Linux"}, "product_version": "patch: 6.17.8"}, {"id": "c3035663-f598-36c4-8658-1da843ba3c35", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <ea37884097a0931abb8e11e40eacfb25e9fdb5e9"}, {"id": "cc74cb83-3a8c-38e6-9333-d7d07627d4b9", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <37158ce6ba964b62d1e3eebd11f03c6900a52dd1"}, {"id": "e84612f6-9ec6-350d-90f6-35de353c182c", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <9c52f01429c377a2d32cafc977465f37b5384f77"}, {"id": "ecda823a-ba03-3956-88bf-d8b2f2f4276a", "product": {"name": "Linux"}, "product_version": "5.3"}, {"id": "f3190c2a-1a06-3952-911f-c52788cdc899", "product": {"name": "Linux"}, "product_version": "8bc1901ca7b07d864fca11461b3875b31f949765 <87c5ff5615dc0a37167e8faf3adeeddc6f1344a3"}, {"id": "f36fa749-bd61-30c5-beac-bd396e69f82a", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}], "enisaIdVendor": [{"id": "ad0d1dc5-2019-34ce-8018-2352563ade9e", "vendor": {"name": "Linux"}}], "isExploited": false}