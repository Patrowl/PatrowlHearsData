{"id": "EUVD-2025-20816", "enisaUuid": "14aaddc0-0914-3448-8618-ebc0bc78435f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\natm: Release atm_dev_mutex after removing procfs in atm_dev_deregister().\n\nsyzbot reported a warning below during atm_dev_register(). [0]\n\nBefore creating a new device and procfs/sysfs for it, atm_dev_register()\nlooks up a duplicated device by __atm_dev_lookup().  These operations are\ndone under atm_dev_mutex.\n\nHowever, when removing a device in atm_dev_deregister(), it releases the\nmutex just after removing the device from the list that __atm_dev_lookup()\niterates over.\n\nSo, there will be a small race window where the device does not exist on\nthe device list but procfs/sysfs are still not removed, triggering the\nsplat.\n\nLet's hold the mutex until procfs/sysfs are removed in\natm_dev_deregister().\n\n[0]:\nproc_dir_entry 'atm/atmtcp:0' already registered\nWARNING: CPU: 0 PID: 5919 at fs/proc/generic.c:377 proc_register+0x455/0x5f0 fs/proc/generic.c:377\nModules linked in:\nCPU: 0 UID: 0 PID: 5919 Comm: syz-executor284 Not tainted 6.16.0-rc2-syzkaller-00047-g52da431bf03b #0 PREEMPT(full)\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/07/2025\nRIP: 0010:proc_register+0x455/0x5f0 fs/proc/generic.c:377\nCode: 48 89 f9 48 c1 e9 03 80 3c 01 00 0f 85 a2 01 00 00 48 8b 44 24 10 48 c7 c7 20 c0 c2 8b 48 8b b0 d8 00 00 00 e8 0c 02 1c ff 90 <0f> 0b 90 90 48 c7 c7 80 f2 82 8e e8 0b de 23 09 48 8b 4c 24 28 48\nRSP: 0018:ffffc9000466fa30 EFLAGS: 00010282\nRAX: 0000000000000000 RBX: 0000000000000000 RCX: ffffffff817ae248\nRDX: ffff888026280000 RSI: ffffffff817ae255 RDI: 0000000000000001\nRBP: ffff8880232bed48 R08: 0000000000000001 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000001 R12: ffff888076ed2140\nR13: dffffc0000000000 R14: ffff888078a61340 R15: ffffed100edda444\nFS:  00007f38b3b0c6c0(0000) GS:ffff888124753000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f38b3bdf953 CR3: 0000000076d58000 CR4: 00000000003526f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n proc_create_data+0xbe/0x110 fs/proc/generic.c:585\n atm_proc_dev_register+0x112/0x1e0 net/atm/proc.c:361\n atm_dev_register+0x46d/0x890 net/atm/resources.c:113\n atmtcp_create+0x77/0x210 drivers/atm/atmtcp.c:369\n atmtcp_attach drivers/atm/atmtcp.c:403 [inline]\n atmtcp_ioctl+0x2f9/0xd60 drivers/atm/atmtcp.c:464\n do_vcc_ioctl+0x12c/0x930 net/atm/ioctl.c:159\n sock_do_ioctl+0x115/0x280 net/socket.c:1190\n sock_ioctl+0x227/0x6b0 net/socket.c:1311\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:907 [inline]\n __se_sys_ioctl fs/ioctl.c:893 [inline]\n __x64_sys_ioctl+0x18b/0x210 fs/ioctl.c:893\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xcd/0x4c0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f38b3b74459\nCode: 28 00 00 00 75 05 48 83 c4 28 c3 e8 51 18 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b0 ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007f38b3b0c198 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\nRAX: ffffffffffffffda RBX: 00007f38b3bfe318 RCX: 00007f38b3b74459\nRDX: 0000000000000000 RSI: 0000000000006180 RDI: 0000000000000005\nRBP: 00007f38b3bfe310 R08: 65732f636f72702f R09: 65732f636f72702f\nR10: 65732f636f72702f R11: 0000000000000246 R12: 00007f38b3bcb0ac\nR13: 00007f38b3b0c1a0 R14: 0000200000000200 R15: 00007f38b3bcb03b\n </TASK>", "datePublished": "2025-07-09T12:31:34", "dateUpdated": "2025-12-18T18:30:28", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b2e40fcfe1575faaa548f87614006d3fe44c779e", "https://git.kernel.org/stable/c/cabed6ba92a9a8c09da02a3f20e32ecd80989896", "https://git.kernel.org/stable/c/ae539d963a17443ec54cba8a767e4ffa318264f4", "https://git.kernel.org/stable/c/6922f1a048c090f10704bbef4a3a1e81932d2e0a", "https://git.kernel.org/stable/c/a433791aeaea6e84df709e0b9584b9bbe040cd1c", "https://git.kernel.org/stable/c/26248d5d68c865b888d632162abbf8130645622c", "https://git.kernel.org/stable/c/2a8dcee649d12f69713f2589171a1caf6d4fa439", "https://git.kernel.org/stable/c/4bb1bb438134d9ee6b97cc07289dd7c569092eec", "https://nvd.nist.gov/vuln/detail/CVE-2025-38245", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38245"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0239f6a0-e85f-339a-bccf-1ff9f7a8d4eb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "07161fd4-fccd-3750-a0d6-c85e53d1f345", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <a433791aeaea6e84df709e0b9584b9bbe040cd1c"}, {"id": "090c45ee-9814-3a86-bbab-165a7374d040", "product": {"name": "Linux"}, "product_version": "patch: 6.12.36"}, {"id": "19dde74d-564d-385e-8033-23efc1a70983", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <cabed6ba92a9a8c09da02a3f20e32ecd80989896"}, {"id": "2d10dedc-332c-3373-a233-ae803926da00", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <2a8dcee649d12f69713f2589171a1caf6d4fa439"}, {"id": "40fc8054-0de6-3c31-83fc-154d4cecf8d6", "product": {"name": "Linux"}, "product_version": "patch: 6.6.96"}, {"id": "76b99e8a-cd1e-3136-bca3-79a1279c1b93", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "76bee7f1-efbf-30a1-aa98-10c49c85639f", "product": {"name": "Linux"}, "product_version": "patch: 5.15.187"}, {"id": "80e0cf55-9ab7-302b-8f66-208216e2bda1", "product": {"name": "Linux"}, "product_version": "patch: 5.4.296"}, {"id": "838c5c11-73ef-3f16-94ee-9580045e6789", "product": {"name": "Linux"}, "product_version": "patch: 5.10.240"}, {"id": "8767e1ab-029a-3074-a9e1-996ee2d2e8fa", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <6922f1a048c090f10704bbef4a3a1e81932d2e0a"}, {"id": "89c91c60-9b9c-3e34-af92-8edfcb729c78", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <4bb1bb438134d9ee6b97cc07289dd7c569092eec"}, {"id": "b534d16a-7acd-3fe8-89ee-dffdae88bd66", "product": {"name": "Linux"}, "product_version": "2.6.15"}, {"id": "b57c1565-d82b-3273-b2e9-ec991e3ad463", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <ae539d963a17443ec54cba8a767e4ffa318264f4"}, {"id": "c1f0e732-1236-30f3-9e40-6b84ff5a1dd4", "product": {"name": "Linux"}, "product_version": "patch: 6.15.5"}, {"id": "cf355571-9877-360b-a7bd-68cd9265c006", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc4"}, {"id": "df7a4810-24fd-389d-a129-a733619785d6", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <b2e40fcfe1575faaa548f87614006d3fe44c779e"}, {"id": "e93f37ed-6ceb-31c6-ab13-0ba29db61a31", "product": {"name": "Linux"}, "product_version": "patch: 6.1.143"}, {"id": "eaaf6166-6135-351c-a9a6-6605df1517cc", "product": {"name": "Linux"}, "product_version": "64bf69ddff7637b7ed7acf9b2a823cc0ee519439 <26248d5d68c865b888d632162abbf8130645622c"}], "enisaIdVendor": [{"id": "7b89589a-127a-305b-8e90-40efb003a893", "vendor": {"name": "Linux"}}], "isExploited": false}