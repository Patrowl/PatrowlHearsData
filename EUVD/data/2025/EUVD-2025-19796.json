{"id": "EUVD-2025-19796", "enisaUuid": "a767b21b-71e1-3872-9822-7372649440e6", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncalipso: Don't call calipso functions for AF_INET sk.\n\nsyzkaller reported a null-ptr-deref in txopt_get(). [0]\n\nThe offset 0x70 was of struct ipv6_txoptions in struct ipv6_pinfo,\nso struct ipv6_pinfo was NULL there.\n\nHowever, this never happens for IPv6 sockets as inet_sk(sk)->pinet6\nis always set in inet6_create(), meaning the socket was not IPv6 one.\n\nThe root cause is missing validation in netlbl_conn_setattr().\n\nnetlbl_conn_setattr() switches branches based on struct\nsockaddr.sa_family, which is passed from userspace.  However,\nnetlbl_conn_setattr() does not check if the address family matches\nthe socket.\n\nThe syzkaller must have called connect() for an IPv6 address on\nan IPv4 socket.\n\nWe have a proper validation in tcp_v[46]_connect(), but\nsecurity_socket_connect() is called in the earlier stage.\n\nLet's copy the validation to netlbl_conn_setattr().\n\n[0]:\nOops: general protection fault, probably for non-canonical address 0xdffffc000000000e: 0000 [#1] PREEMPT SMP KASAN NOPTI\nKASAN: null-ptr-deref in range [0x0000000000000070-0x0000000000000077]\nCPU: 2 UID: 0 PID: 12928 Comm: syz.9.1677 Not tainted 6.12.0 #1\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\nRIP: 0010:txopt_get include/net/ipv6.h:390 [inline]\nRIP: 0010:\nCode: 02 00 00 49 8b ac 24 f8 02 00 00 e8 84 69 2a fd e8 ff 00 16 fd 48 8d 7d 70 48 b8 00 00 00 00 00 fc ff df 48 89 fa 48 c1 ea 03 <80> 3c 02 00 0f 85 53 02 00 00 48 8b 6d 70 48 85 ed 0f 84 ab 01 00\nRSP: 0018:ffff88811b8afc48 EFLAGS: 00010212\nRAX: dffffc0000000000 RBX: 1ffff11023715f8a RCX: ffffffff841ab00c\nRDX: 000000000000000e RSI: ffffc90007d9e000 RDI: 0000000000000070\nRBP: 0000000000000000 R08: ffffed1023715f9d R09: ffffed1023715f9e\nR10: ffffed1023715f9d R11: 0000000000000003 R12: ffff888123075f00\nR13: ffff88810245bd80 R14: ffff888113646780 R15: ffff888100578a80\nFS:  00007f9019bd7640(0000) GS:ffff8882d2d00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f901b927bac CR3: 0000000104788003 CR4: 0000000000770ef0\nPKRU: 80000000\nCall Trace:\n <TASK>\n calipso_sock_setattr+0x56/0x80 net/netlabel/netlabel_calipso.c:557\n netlbl_conn_setattr+0x10c/0x280 net/netlabel/netlabel_kapi.c:1177\n selinux_netlbl_socket_connect_helper+0xd3/0x1b0 security/selinux/netlabel.c:569\n selinux_netlbl_socket_connect_locked security/selinux/netlabel.c:597 [inline]\n selinux_netlbl_socket_connect+0xb6/0x100 security/selinux/netlabel.c:615\n selinux_socket_connect+0x5f/0x80 security/selinux/hooks.c:4931\n security_socket_connect+0x50/0xa0 security/security.c:4598\n __sys_connect_file+0xa4/0x190 net/socket.c:2067\n __sys_connect+0x12c/0x170 net/socket.c:2088\n __do_sys_connect net/socket.c:2098 [inline]\n __se_sys_connect net/socket.c:2095 [inline]\n __x64_sys_connect+0x73/0xb0 net/socket.c:2095\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xaa/0x1b0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f901b61a12d\nCode: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007f9019bd6fa8 EFLAGS: 00000246 ORIG_RAX: 000000000000002a\nRAX: ffffffffffffffda RBX: 00007f901b925fa0 RCX: 00007f901b61a12d\nRDX: 000000000000001c RSI: 0000200000000140 RDI: 0000000000000003\nRBP: 00007f901b701505 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000\nR13: 0000000000000000 R14: 00007f901b5b62a0 R15: 00007f9019bb7000\n </TASK>\nModules linked in:", "datePublished": "2025-07-03T09:30:34", "dateUpdated": "2025-12-18T21:31:33", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/fc2da88411470480b8b7e9177e930cedd893cf56", "https://git.kernel.org/stable/c/0c813dbc851dbf418fdc6dc883fd0592d6c555cd", "https://git.kernel.org/stable/c/26ce90f1ce60b0ff587de8d6aec399aa55cab28e", "https://git.kernel.org/stable/c/c32ebe33626335a536dbbdd09571c06dd9bc1729", "https://git.kernel.org/stable/c/946bfdfcb76ac2bac5b8526447035885ff41c598", "https://git.kernel.org/stable/c/dd8928897594931d6912ef2f7a43e110b4958d3d", "https://git.kernel.org/stable/c/e2ec310c7a50271843c585e27ef14e48c66ce649", "https://git.kernel.org/stable/c/6e9f2df1c550ead7cecb3e450af1105735020c92", "https://nvd.nist.gov/vuln/detail/CVE-2025-38147", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38147"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "00f88ebc-a170-30c7-9154-95f71bd1e846", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <c32ebe33626335a536dbbdd09571c06dd9bc1729"}, {"id": "0bd24bfc-5d6a-3899-b127-7ec9f913fbc2", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <946bfdfcb76ac2bac5b8526447035885ff41c598"}, {"id": "1726f076-dac7-3b5f-9af2-9294f245367e", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "45519a8d-b9ad-36bf-9f83-545722ee2b6a", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <6e9f2df1c550ead7cecb3e450af1105735020c92"}, {"id": "5d925a1e-44ec-3691-a215-877ec72d7a93", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <0c813dbc851dbf418fdc6dc883fd0592d6c555cd"}, {"id": "74689759-facb-3555-a4e5-2c208ed47b32", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "77077998-a5a5-3c26-b9fc-edd5d05e05b8", "product": {"name": "Linux"}, "product_version": "patch: 6.6.94"}, {"id": "7a031003-644b-3fa1-b931-6541f323c917", "product": {"name": "Linux"}, "product_version": "patch: 5.10.239"}, {"id": "7c017f82-9af2-30ca-856c-12447a5996ca", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}, {"id": "85ffa0fd-46be-37aa-a35f-d05df8d8cccb", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <e2ec310c7a50271843c585e27ef14e48c66ce649"}, {"id": "8ce19090-48a8-3857-8faa-b86167d13e95", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <fc2da88411470480b8b7e9177e930cedd893cf56"}, {"id": "a228a897-6259-3ccd-a8d2-965ac1d96ce8", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "a54b2447-554c-309d-a529-e78cf5f008b8", "product": {"name": "Linux"}, "product_version": "patch: 5.4.295"}, {"id": "a7396ab3-b5fc-3a16-a028-c6b3d20ecf8c", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <dd8928897594931d6912ef2f7a43e110b4958d3d"}, {"id": "baf751a8-2b7f-3fb3-a964-84e7815d611e", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "cefcb0b0-50c3-3037-b02c-149c295d8dc0", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "d3de117b-f70d-3ef4-9274-e65b7bc8eee9", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}, {"id": "d8d727d4-b146-3cba-9349-17a06223e20c", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "fc6e57fd-3aee-3c47-9886-e5ad3fdb684a", "product": {"name": "Linux"}, "product_version": "ceba1832b1b2da0149c51de62a847c00bca1677a <26ce90f1ce60b0ff587de8d6aec399aa55cab28e"}], "enisaIdVendor": [{"id": "78c74ca9-f428-3000-a902-f44c74951491", "vendor": {"name": "Linux"}}], "isExploited": false}