{"id": "EUVD-2025-11164", "enisaUuid": "b419491d-b198-3f62-9f1f-8eafadea7f7e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to avoid panic once fallocation fails for pinfile\n\nsyzbot reports a f2fs bug as below:\n\n------------[ cut here ]------------\nkernel BUG at fs/f2fs/segment.c:2746!\nCPU: 0 UID: 0 PID: 5323 Comm: syz.0.0 Not tainted 6.13.0-rc2-syzkaller-00018-g7cb1b4663150 #0\nRIP: 0010:get_new_segment fs/f2fs/segment.c:2746 [inline]\nRIP: 0010:new_curseg+0x1f52/0x1f70 fs/f2fs/segment.c:2876\nCall Trace:\n <TASK>\n __allocate_new_segment+0x1ce/0x940 fs/f2fs/segment.c:3210\n f2fs_allocate_new_section fs/f2fs/segment.c:3224 [inline]\n f2fs_allocate_pinning_section+0xfa/0x4e0 fs/f2fs/segment.c:3238\n f2fs_expand_inode_data+0x696/0xca0 fs/f2fs/file.c:1830\n f2fs_fallocate+0x537/0xa10 fs/f2fs/file.c:1940\n vfs_fallocate+0x569/0x6e0 fs/open.c:327\n do_vfs_ioctl+0x258c/0x2e40 fs/ioctl.c:885\n __do_sys_ioctl fs/ioctl.c:904 [inline]\n __se_sys_ioctl+0x80/0x170 fs/ioctl.c:892\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nConcurrent pinfile allocation may run out of free section, result in\npanic in get_new_segment(), let's expand pin_sem lock coverage to\ninclude f2fs_gc(), so that we can make sure to reclaim enough free\nspace for following allocation.\n\nIn addition, do below changes to enhance error path handling:\n- call f2fs_bug_on() only in non-pinfile allocation path in\nget_new_segment().\n- call reset_curseg_fields() to reset all fields of curseg in\nnew_curseg()", "datePublished": "2025-04-16T15:34:46", "dateUpdated": "2025-11-04T18:31:31", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-23130", "https://git.kernel.org/stable/c/48ea8b200414ac69ea96f4c231f5c7ef1fbeffef", "https://git.kernel.org/stable/c/9392862608d081a8346a3b841f862d732fce954b", "https://git.kernel.org/stable/c/2dda0930fb79b847b4bfceb737577d0f6bc24d7d"], "aliases": ["CVE-2025-23130", "GHSA-qj48-g5ch-7g59"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0a67e8c4-13d5-329d-8dea-154a4f88cf4b", "product": {"name": "Linux"}, "product_version": "patch: 6.15-rc1"}, {"id": "29f151bf-4d75-3a36-bd3d-d38f209a618c", "product": {"name": "Linux"}, "product_version": "patch: 6.14.2"}, {"id": "3b39a4a1-2516-38e3-bf25-c6b730fbda08", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "585e5ca6-59f2-3760-80f8-bdc46e303b19", "product": {"name": "Linux"}, "product_version": "5.5"}, {"id": "882075fa-b29f-361b-979f-1355befa5e0a", "product": {"name": "Linux"}, "product_version": "patch: 6.12.57"}, {"id": "ad8bd9c7-1985-338a-aa1f-d045788003dd", "product": {"name": "Linux"}, "product_version": "f5a53edcf01eae21dc3ef1845515229e8459e5cc <2dda0930fb79b847b4bfceb737577d0f6bc24d7d"}, {"id": "adeb6f9a-46b7-3dc6-a324-8da540d37a1b", "product": {"name": "Linux"}, "product_version": "f5a53edcf01eae21dc3ef1845515229e8459e5cc <48ea8b200414ac69ea96f4c231f5c7ef1fbeffef"}, {"id": "c7985056-1b26-36fb-bab5-bc42a030b040", "product": {"name": "Linux"}, "product_version": "patch: 6.15"}, {"id": "f6b251e9-a204-35e2-9520-1e3ae50e396c", "product": {"name": "Linux"}, "product_version": "f5a53edcf01eae21dc3ef1845515229e8459e5cc <9392862608d081a8346a3b841f862d732fce954b"}], "enisaIdVendor": [{"id": "96a91bee-d25e-3688-91e8-25f988e632ca", "vendor": {"name": "Linux"}}], "isExploited": false}