{"id": "EUVD-2025-36446", "enisaUuid": "6488968b-5bb7-3064-96ae-ba114110a6df", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: fix slab-out-of-bounds read in hfsplus_uni2asc()\n\nBUG: KASAN: slab-out-of-bounds in hfsplus_uni2asc+0xa71/0xb90 fs/hfsplus/unicode.c:186\nRead of size 2 at addr ffff8880289ef218 by task syz.6.248/14290\n\nCPU: 0 UID: 0 PID: 14290 Comm: syz.6.248 Not tainted 6.16.4 #1 PREEMPT(full)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:94 [inline]\n dump_stack_lvl+0x116/0x1b0 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:378 [inline]\n print_report+0xca/0x5f0 mm/kasan/report.c:482\n kasan_report+0xca/0x100 mm/kasan/report.c:595\n hfsplus_uni2asc+0xa71/0xb90 fs/hfsplus/unicode.c:186\n hfsplus_listxattr+0x5b6/0xbd0 fs/hfsplus/xattr.c:738\n vfs_listxattr+0xbe/0x140 fs/xattr.c:493\n listxattr+0xee/0x190 fs/xattr.c:924\n filename_listxattr fs/xattr.c:958 [inline]\n path_listxattrat+0x143/0x360 fs/xattr.c:988\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xcb/0x4c0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7fe0e9fae16d\nCode: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007fe0eae67f98 EFLAGS: 00000246 ORIG_RAX: 00000000000000c3\nRAX: ffffffffffffffda RBX: 00007fe0ea205fa0 RCX: 00007fe0e9fae16d\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000200000000000\nRBP: 00007fe0ea0480f0 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000\nR13: 00007fe0ea206038 R14: 00007fe0ea205fa0 R15: 00007fe0eae48000\n </TASK>\n\nAllocated by task 14290:\n kasan_save_stack+0x24/0x50 mm/kasan/common.c:47\n kasan_save_track+0x14/0x30 mm/kasan/common.c:68\n poison_kmalloc_redzone mm/kasan/common.c:377 [inline]\n __kasan_kmalloc+0xaa/0xb0 mm/kasan/common.c:394\n kasan_kmalloc include/linux/kasan.h:260 [inline]\n __do_kmalloc_node mm/slub.c:4333 [inline]\n __kmalloc_noprof+0x219/0x540 mm/slub.c:4345\n kmalloc_noprof include/linux/slab.h:909 [inline]\n hfsplus_find_init+0x95/0x1f0 fs/hfsplus/bfind.c:21\n hfsplus_listxattr+0x331/0xbd0 fs/hfsplus/xattr.c:697\n vfs_listxattr+0xbe/0x140 fs/xattr.c:493\n listxattr+0xee/0x190 fs/xattr.c:924\n filename_listxattr fs/xattr.c:958 [inline]\n path_listxattrat+0x143/0x360 fs/xattr.c:988\n do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]\n do_syscall_64+0xcb/0x4c0 arch/x86/entry/syscall_64.c:94\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nWhen hfsplus_uni2asc is called from hfsplus_listxattr,\nit actually passes in a struct hfsplus_attr_unistr*.\nThe size of the corresponding structure is different from that of hfsplus_unistr,\nso the previous fix (94458781aee6) is insufficient.\nThe pointer on the unicode buffer is still going beyond the allocated memory.\n\nThis patch introduces two warpper functions hfsplus_uni2asc_xattr_str and\nhfsplus_uni2asc_str to process two unicode buffers,\nstruct hfsplus_attr_unistr* and struct hfsplus_unistr* respectively.\nWhen ustrlen value is bigger than the allocated memory size,\nthe ustrlen value is limited to an safe size.", "datePublished": "2025-10-28T11:48:45", "dateUpdated": "2025-12-01T06:17:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/857aefc70d4ae3b9bf1ae67434d27d0f79f80c9e", "https://git.kernel.org/stable/c/bea3e1d4467bcf292c8e54f080353d556d355e26", "https://nvd.nist.gov/vuln/detail/CVE-2025-40082"], "aliases": ["CVE-2025-40082"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0a602b2f-3995-37df-bdfe-913dc1b070fa", "product": {"name": "Linux"}, "product_version": "94458781aee6045bd3d0ad4b80b02886b9e2219b <bea3e1d4467bcf292c8e54f080353d556d355e26"}, {"id": "2945427a-a504-3764-89b0-8c7c2454cc7e", "product": {"name": "Linux"}, "product_version": "6f93694bcbc2c2ab3e01cd8fba2f296faf34e6b9"}, {"id": "2d6210b8-518c-3179-b8f8-6ab5588f053c", "product": {"name": "Linux"}, "product_version": "291bb5d931c6f3cd7227b913302a17be21cf53b0"}, {"id": "40d0625f-129c-3096-b938-16cdd62b41e5", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "44c330f8-57e7-3d05-98a6-1df73e612f26", "product": {"name": "Linux"}, "product_version": "ccf0ad56a779e6704c0b27f555dec847f50c7557"}, {"id": "5cfd16b0-946d-3155-a9cb-fe9b5e758d5f", "product": {"name": "Linux"}, "product_version": "94458781aee6045bd3d0ad4b80b02886b9e2219b <857aefc70d4ae3b9bf1ae67434d27d0f79f80c9e"}, {"id": "63a41250-4dca-34b5-b25e-c262713c9257", "product": {"name": "Linux"}, "product_version": "f7534cbfac0a9ffa4fa17cacc6e8b6446dae24ee"}, {"id": "6b258c89-9ada-37c3-9489-8ba300acd188", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "75bcc102-a2eb-30c8-bf9f-f8fc333c58be", "product": {"name": "Linux"}, "product_version": "13604b1d7e7b125fb428cddbec6b8d92baad25d5"}, {"id": "a51a0eac-31fe-3bd1-94a8-6668450f1cdb", "product": {"name": "Linux"}, "product_version": "6.17"}, {"id": "b3c3a9b2-a8ab-3fe2-949e-ac001bf990ed", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "d21a1bf6-8689-3eec-9843-ff54c06691d9", "product": {"name": "Linux"}, "product_version": "1ca69007e52a73bd8b84b988b61b319816ca8b01"}, {"id": "daa2efb3-2eff-3e77-9787-87fbea5a34c0", "product": {"name": "Linux"}, "product_version": "73f7da507d787b489761a0fa280716f84fa32b2f"}, {"id": "ea676b77-4562-34e1-bda0-10fb3a20d10c", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "fd6a02d7-5fd9-3b91-9572-690a71b95fe4", "product": {"name": "Linux"}, "product_version": "76a4c6636a69d69409aa253b049b1be717a539c5"}], "enisaIdVendor": [{"id": "510d92da-eb24-3d94-ba62-ec0a27c26d39", "vendor": {"name": "Linux"}}], "isExploited": false}