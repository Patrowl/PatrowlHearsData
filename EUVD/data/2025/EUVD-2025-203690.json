{"id": "EUVD-2025-203690", "enisaUuid": "487d1006-c974-3067-9985-607a2c634272", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nft_ct: add seqadj extension for natted connections\n\nSequence adjustment may be required for FTP traffic with PASV/EPSV modes.\ndue to need to re-write packet payload (IP, port) on the ftp control\nconnection. This can require changes to the TCP length and expected\nseq / ack_seq.\n\nThe easiest way to reproduce this issue is with PASV mode.\nExample ruleset:\ntable inet ftp_nat {\n        ct helper ftp_helper {\n                type \"ftp\" protocol tcp\n                l3proto inet\n        }\n\n        chain prerouting {\n                type filter hook prerouting priority 0; policy accept;\n                tcp dport 21 ct state new ct helper set \"ftp_helper\"\n        }\n}\ntable ip nat {\n        chain prerouting {\n                type nat hook prerouting priority -100; policy accept;\n                tcp dport 21 dnat ip prefix to ip daddr map {\n\t\t\t192.168.100.1 : 192.168.13.2/32 }\n        }\n\n        chain postrouting {\n                type nat hook postrouting priority 100 ; policy accept;\n                tcp sport 21 snat ip prefix to ip saddr map {\n\t\t\t192.168.13.2 : 192.168.100.1/32 }\n        }\n}\n\nNote that the ftp helper gets assigned *after* the dnat setup.\n\nThe inverse (nat after helper assign) is handled by an existing\ncheck in nf_nat_setup_info() and will not show the problem.\n\nTopoloy:\n\n +-------------------+     +----------------------------------+\n | FTP: 192.168.13.2 | <-> | NAT: 192.168.13.3, 192.168.100.1 |\n +-------------------+     +----------------------------------+\n                                      |\n                         +-----------------------+\n                         | Client: 192.168.100.2 |\n                         +-----------------------+\n\nftp nat changes do not work as expected in this case:\nConnected to 192.168.100.1.\n[..]\nftp> epsv\nEPSV/EPRT on IPv4 off.\nftp> ls\n227 Entering passive mode (192,168,100,1,209,129).\n421 Service not available, remote server has closed connection.\n\nKernel logs:\nMissing nfct_seqadj_ext_add() setup call\nWARNING: CPU: 1 PID: 0 at net/netfilter/nf_conntrack_seqadj.c:41\n[..]\n __nf_nat_mangle_tcp_packet+0x100/0x160 [nf_nat]\n nf_nat_ftp+0x142/0x280 [nf_nat_ftp]\n help+0x4d1/0x880 [nf_conntrack_ftp]\n nf_confirm+0x122/0x2e0 [nf_conntrack]\n nf_hook_slow+0x3c/0xb0\n ..\n\nFix this by adding the required extension when a conntrack helper is assigned\nto a connection that has a nat binding.", "datePublished": "2025-12-16T15:30:45", "dateUpdated": "2025-12-16T15:30:45", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/2b52d89cbbb0dbe3e948d8d9a91e704316dccfe6", "https://git.kernel.org/stable/c/90918e3b6404c2a37837b8f11692471b4c512de2", "https://nvd.nist.gov/vuln/detail/CVE-2025-68206"], "aliases": ["CVE-2025-68206"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "03ca578f-37a3-30a5-9f87-ea86413ccd5a", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1b5344af-981b-381a-a12b-ef6bda510238", "product": {"name": "Linux"}, "product_version": "4.12"}, {"id": "23190a3d-6d17-3b8c-b3df-2adc27ea33b9", "product": {"name": "Linux"}, "product_version": "1a64edf54f55d7956cf5a0d95898bc1f84f9b818 <90918e3b6404c2a37837b8f11692471b4c512de2"}, {"id": "2fef1ebd-3633-3b18-b0a5-6d7af6af51c2", "product": {"name": "Linux"}, "product_version": "patch: 6.17.9"}, {"id": "9558f51a-fbc3-30e6-8ed0-0d1413e7aa28", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "c31c1696-baf7-3014-9333-6fb942020846", "product": {"name": "Linux"}, "product_version": "1a64edf54f55d7956cf5a0d95898bc1f84f9b818 <2b52d89cbbb0dbe3e948d8d9a91e704316dccfe6"}], "enisaIdVendor": [{"id": "76a9cf02-b04f-3e96-a63d-f4e5dd8ec412", "vendor": {"name": "Linux"}}], "isExploited": false}