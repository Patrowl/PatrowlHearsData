{"id": "EUVD-2025-32741", "enisaUuid": "ad6265d3-a2dd-3c21-808d-cdcaa789e398", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring: fix fget leak when fs don't support nowait buffered read\n\nHeming reported a BUG when using io_uring doing link-cp on ocfs2. [1]\n\nDo the following steps can reproduce this BUG:\nmount -t ocfs2 /dev/vdc /mnt/ocfs2\ncp testfile /mnt/ocfs2/\n./link-cp /mnt/ocfs2/testfile /mnt/ocfs2/testfile.1\numount /mnt/ocfs2\n\nThen umount will fail, and it outputs:\numount: /mnt/ocfs2: target is busy.\n\nWhile tracing umount, it blames mnt_get_count() not return as expected.\nDo a deep investigation for fget()/fput() on related code flow, I've\nfinally found that fget() leaks since ocfs2 doesn't support nowait\nbuffered read.\n\nio_issue_sqe\n|-io_assign_file  // do fget() first\n  |-io_read\n  |-io_iter_do_read\n    |-ocfs2_file_read_iter  // return -EOPNOTSUPP\n  |-kiocb_done\n    |-io_rw_done\n      |-__io_complete_rw_common  // set REQ_F_REISSUE\n    |-io_resubmit_prep\n      |-io_req_prep_async  // override req->file, leak happens\n\nThis was introduced by commit a196c78b5443 in v5.18. Fix it by don't\nre-assign req->file if it has already been assigned.\n\n[1] https://lore.kernel.org/ocfs2-devel/ab580a75-91c8-d68a-3455-40361be1bfa8@linux.alibaba.com/T/#t", "datePublished": "2025-10-01T11:46:00", "dateUpdated": "2025-10-01T11:46:00", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53511", "https://git.kernel.org/stable/c/10fb2e16ee6ffaf1716b9e90d007e6b300bfa457", "https://git.kernel.org/stable/c/54aa7f2330b82884f4a1afce0220add6e8312f8b", "https://git.kernel.org/stable/c/75a499fc9d66a32271e2b3e4ca71156e8ad3b484"], "aliases": ["CVE-2023-53511", "GHSA-m97q-c3xf-55xf"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "01dab6fb-c6a2-316b-b1d5-8e056bc1c814", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0ba78d4d-632b-3513-8deb-0b839979cd00", "product": {"name": "Linux"}, "product_version": "a196c78b5443fc61af2c0490213b9d125482cbd1 <75a499fc9d66a32271e2b3e4ca71156e8ad3b484"}, {"id": "3b1e297d-0fbf-3848-a90f-a99ffda822e0", "product": {"name": "Linux"}, "product_version": "a196c78b5443fc61af2c0490213b9d125482cbd1 <10fb2e16ee6ffaf1716b9e90d007e6b300bfa457"}, {"id": "4bf79e74-49a9-32ab-b21a-7d827761a3a9", "product": {"name": "Linux"}, "product_version": "5.18"}, {"id": "68b26717-e845-31f2-bfa4-8a28c80d54a5", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "6dbd78da-93cb-3649-85df-ea63e36c4cc6", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "7b739d60-295c-35fd-bc95-c12ca1c903da", "product": {"name": "Linux"}, "product_version": "cef27a7d36026bd3c86f4fdfb4611ebbe2814af4"}, {"id": "9f118f4f-67d5-373c-b0b7-d553c021255b", "product": {"name": "Linux"}, "product_version": "a196c78b5443fc61af2c0490213b9d125482cbd1 <54aa7f2330b82884f4a1afce0220add6e8312f8b"}, {"id": "c5c21deb-e0fd-3883-93fb-1c0a1c04f436", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}], "enisaIdVendor": [{"id": "0fac157d-ff8f-3dae-a347-fa8aabc3eb31", "vendor": {"name": "Linux"}}], "isExploited": false}