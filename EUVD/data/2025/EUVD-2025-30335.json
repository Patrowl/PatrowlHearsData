{"id": "EUVD-2025-30335", "enisaUuid": "02b01678-4c38-34fa-9948-caaea3b16f00", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntee: fix NULL pointer dereference in tee_shm_put\n\ntee_shm_put have NULL pointer dereference:\n\n__optee_disable_shm_cache -->\n\tshm = reg_pair_to_ptr(...);//shm maybe return NULL\n        tee_shm_free(shm); -->\n\t\ttee_shm_put(shm);//crash\n\nAdd check in tee_shm_put to fix it.\n\npanic log:\nUnable to handle kernel paging request at virtual address 0000000000100cca\nMem abort info:\nESR = 0x0000000096000004\nEC = 0x25: DABT (current EL), IL = 32 bits\nSET = 0, FnV = 0\nEA = 0, S1PTW = 0\nFSC = 0x04: level 0 translation fault\nData abort info:\nISV = 0, ISS = 0x00000004, ISS2 = 0x00000000\nCM = 0, WnR = 0, TnD = 0, TagAccess = 0\nGCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0\nuser pgtable: 4k pages, 48-bit VAs, pgdp=0000002049d07000\n[0000000000100cca] pgd=0000000000000000, p4d=0000000000000000\nInternal error: Oops: 0000000096000004 [#1] SMP\nCPU: 2 PID: 14442 Comm: systemd-sleep Tainted: P OE ------- ----\n6.6.0-39-generic #38\nSource Version: 938b255f6cb8817c95b0dd5c8c2944acfce94b07\nHardware name: greatwall GW-001Y1A-FTH, BIOS Great Wall BIOS V3.0\n10/26/2022\npstate: 80000005 (Nzcv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : tee_shm_put+0x24/0x188\nlr : tee_shm_free+0x14/0x28\nsp : ffff001f98f9faf0\nx29: ffff001f98f9faf0 x28: ffff0020df543cc0 x27: 0000000000000000\nx26: ffff001f811344a0 x25: ffff8000818dac00 x24: ffff800082d8d048\nx23: ffff001f850fcd18 x22: 0000000000000001 x21: ffff001f98f9fb88\nx20: ffff001f83e76218 x19: ffff001f83e761e0 x18: 000000000000ffff\nx17: 303a30303a303030 x16: 0000000000000000 x15: 0000000000000003\nx14: 0000000000000001 x13: 0000000000000000 x12: 0101010101010101\nx11: 0000000000000001 x10: 0000000000000001 x9 : ffff800080e08d0c\nx8 : ffff001f98f9fb88 x7 : 0000000000000000 x6 : 0000000000000000\nx5 : 0000000000000000 x4 : 0000000000000000 x3 : 0000000000000000\nx2 : ffff001f83e761e0 x1 : 00000000ffff001f x0 : 0000000000100cca\nCall trace:\ntee_shm_put+0x24/0x188\ntee_shm_free+0x14/0x28\n__optee_disable_shm_cache+0xa8/0x108\noptee_shutdown+0x28/0x38\nplatform_shutdown+0x28/0x40\ndevice_shutdown+0x144/0x2b0\nkernel_power_off+0x3c/0x80\nhibernate+0x35c/0x388\nstate_store+0x64/0x80\nkobj_attr_store+0x14/0x28\nsysfs_kf_write+0x48/0x60\nkernfs_fop_write_iter+0x128/0x1c0\nvfs_write+0x270/0x370\nksys_write+0x6c/0x100\n__arm64_sys_write+0x20/0x30\ninvoke_syscall+0x4c/0x120\nel0_svc_common.constprop.0+0x44/0xf0\ndo_el0_svc+0x24/0x38\nel0_svc+0x24/0x88\nel0t_64_sync_handler+0x134/0x150\nel0t_64_sync+0x14c/0x15", "datePublished": "2025-09-22T21:30:18", "dateUpdated": "2025-11-03T18:31:42", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/f266188603c34e6e234fb0dfc3185f0ba98d71b7", "https://git.kernel.org/stable/c/4377eac565c297fdfccd2f8e9bf94ee84ff6172f", "https://git.kernel.org/stable/c/25e315bc8ad363bd1194e49062f183ad4011957e", "https://git.kernel.org/stable/c/add1ecc8f3ad8df22e3599c5c88d7907cc2a3079", "https://git.kernel.org/stable/c/963fca19fe34c496e04f7dd133b807b76a5434ca", "https://git.kernel.org/stable/c/5e07a4235bb85d9ef664411e4ff4ac34783c18ff", "https://git.kernel.org/stable/c/e4a718a3a47e89805c3be9d46a84de1949a98d5d", "https://nvd.nist.gov/vuln/detail/CVE-2025-39865", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-39865"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "1579daea-9f21-37ce-ba05-95e5902a9a47", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc5"}, {"id": "1bb3706d-08a4-33cf-a7f5-a58e5dd2aaab", "product": {"name": "Linux"}, "product_version": "patch: 5.10.243"}, {"id": "1f2c64b8-d6ca-34e2-a8f7-81c38c56f962", "product": {"name": "Linux"}, "product_version": "patch: 6.1.151"}, {"id": "488204b4-fd5b-3233-920b-c74e4f90e243", "product": {"name": "Linux"}, "product_version": "patch: 6.12.46"}, {"id": "4e17c0be-1829-31a7-be2a-bfb535d457e3", "product": {"name": "Linux"}, "product_version": "b4a661b4212b8fac8853ec3b68e4a909dccc88a1"}, {"id": "5441c213-4391-3164-9582-29d6a2bbe5a3", "product": {"name": "Linux"}, "product_version": "dfd0743f1d9ea76931510ed150334d571fbab49d <5e07a4235bb85d9ef664411e4ff4ac34783c18ff"}, {"id": "6012f1af-6ad6-33f7-a3d7-638f8dbfbe91", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "629eabf9-e57f-3f5a-be7c-b11e03e5ab00", "product": {"name": "Linux"}, "product_version": "940e68e57ab69248fabba5889e615305789db8a7"}, {"id": "6640a36d-54c9-3d4c-bb75-b11b7bbd1a19", "product": {"name": "Linux"}, "product_version": "dfd0743f1d9ea76931510ed150334d571fbab49d <963fca19fe34c496e04f7dd133b807b76a5434ca"}, {"id": "6dd85b40-80de-3e46-8d4b-75b74ebf05ce", "product": {"name": "Linux"}, "product_version": "patch: 5.15.192"}, {"id": "72805d30-e546-30d8-b284-23e46a88ad38", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "78715cd2-6f71-34e7-bfa2-c5b6011ac05b", "product": {"name": "Linux"}, "product_version": "5.16"}, {"id": "7a4df17d-d9e9-3e5e-95ab-6e36fef35526", "product": {"name": "Linux"}, "product_version": "patch: 6.6.105"}, {"id": "8b241868-e5f8-334c-8906-af9398ed04ca", "product": {"name": "Linux"}, "product_version": "patch: 6.16.6"}, {"id": "9e795b40-1374-3f64-bc02-1c023bc8a975", "product": {"name": "Linux"}, "product_version": "dfd0743f1d9ea76931510ed150334d571fbab49d <25e315bc8ad363bd1194e49062f183ad4011957e"}, {"id": "a92eb109-6e29-3307-88e2-6a54b5ea304c", "product": {"name": "Linux"}, "product_version": "3d556a28bbfe34a80b014db49908b0f1bcb1ae80"}, {"id": "ae4581f3-f593-318d-b677-4359209d7c42", "product": {"name": "Linux"}, "product_version": "c05d8f66ec3470e5212c4d08c46d6cb5738d600d <f266188603c34e6e234fb0dfc3185f0ba98d71b7"}, {"id": "b92e751d-3fbc-37b9-a5a0-b87e49f7b890", "product": {"name": "Linux"}, "product_version": "492eb7afe858d60408b2da09adc78540c4d16543 <4377eac565c297fdfccd2f8e9bf94ee84ff6172f"}, {"id": "dcb79950-88a1-38e0-b44c-0dbd5ec0f044", "product": {"name": "Linux"}, "product_version": "dfd0743f1d9ea76931510ed150334d571fbab49d <e4a718a3a47e89805c3be9d46a84de1949a98d5d"}, {"id": "e1b3db03-2cc9-36ff-817e-3692f8ca5b47", "product": {"name": "Linux"}, "product_version": "dfd0743f1d9ea76931510ed150334d571fbab49d <add1ecc8f3ad8df22e3599c5c88d7907cc2a3079"}], "enisaIdVendor": [{"id": "cf47cd36-57c1-37c5-b53f-48c73d583129", "vendor": {"name": "Linux"}}], "isExploited": false}