{"id": "EUVD-2025-29869", "enisaUuid": "8ffe8c48-f67e-35ae-90db-211fdcff2b11", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI/ASPM: Disable ASPM on MFD function removal to avoid use-after-free\n\nStruct pcie_link_state->downstream is a pointer to the pci_dev of function\n0.  Previously we retained that pointer when removing function 0, and\nsubsequent ASPM policy changes dereferenced it, resulting in a\nuse-after-free warning from KASAN, e.g.:\n\n  # echo 1 > /sys/bus/pci/devices/0000:03:00.0/remove\n  # echo powersave > /sys/module/pcie_aspm/parameters/policy\n\n  BUG: KASAN: slab-use-after-free in pcie_config_aspm_link+0x42d/0x500\n  Call Trace:\n   kasan_report+0xae/0xe0\n   pcie_config_aspm_link+0x42d/0x500\n   pcie_aspm_set_policy+0x8e/0x1a0\n   param_attr_store+0x162/0x2c0\n   module_attr_store+0x3e/0x80\n\nPCIe spec r6.0, sec 7.5.3.7, recommends that software program the same ASPM\nControl value in all functions of multi-function devices.\n\nDisable ASPM and free the pcie_link_state when any child function is\nremoved so we can discard the dangling pcie_link_state->downstream pointer\nand maintain the same ASPM Control configuration for all functions.\n\n[bhelgaas: commit log and comment]", "datePublished": "2025-09-18T18:30:28", "dateUpdated": "2025-12-12T21:31:32", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-53446", "https://git.kernel.org/stable/c/4203722d51afe3d239e03f15cc73efdf023a7103", "https://git.kernel.org/stable/c/456d8aa37d0f56fc9e985e812496e861dcd6f2f2", "https://git.kernel.org/stable/c/666e7f9d60cee23077ea3e6331f6f8a19f7ea03f", "https://git.kernel.org/stable/c/7aecdd47910c51707696e8b0e045b9f88bd4230f", "https://git.kernel.org/stable/c/7badf4d6f49a358a01ab072bbff88d3ee886c33b", "https://git.kernel.org/stable/c/9856c0de49052174ab474113f4ba40c02aaee086", "https://git.kernel.org/stable/c/d51d2eeae4ce54d542909c4d9d07bf371a78592c"], "aliases": ["CVE-2023-53446", "GHSA-62j3-36wr-4gw5"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1c4f969d-3a21-399e-8a09-14cfc35b1bdd", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <7badf4d6f49a358a01ab072bbff88d3ee886c33b"}, {"id": "245ffa60-944a-3561-84a6-8d960392908f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2f392420-eae6-3deb-98f5-e87754cbefd3", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <4203722d51afe3d239e03f15cc73efdf023a7103"}, {"id": "342290dd-6cc2-3ae9-91d2-65d26612883a", "product": {"name": "Linux"}, "product_version": "patch: 5.10.188"}, {"id": "5091c2ff-c3c2-3e87-9040-94781b41d164", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "6c706ee8-ba0e-30c3-aaa8-7da6f3cb251e", "product": {"name": "Linux"}, "product_version": "patch: 6.3.13"}, {"id": "78ad4848-552e-3587-90ad-df4ff89e0602", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <666e7f9d60cee23077ea3e6331f6f8a19f7ea03f"}, {"id": "8991ac2c-c8eb-3d0e-bc63-d102ed401888", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <d51d2eeae4ce54d542909c4d9d07bf371a78592c"}, {"id": "9d2e1bcd-2cff-3326-8235-d77aadf5b272", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <456d8aa37d0f56fc9e985e812496e861dcd6f2f2"}, {"id": "a5201045-2a3d-3f4c-98c3-507847d8efe1", "product": {"name": "Linux"}, "product_version": "patch: 6.4.4"}, {"id": "be2960ed-54a0-3eb7-b5c7-8ac62c6aab09", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <9856c0de49052174ab474113f4ba40c02aaee086"}, {"id": "d797e342-118a-38ae-a5c0-0990d85840f7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.251"}, {"id": "dae4aad9-9821-3a40-a04d-542956490993", "product": {"name": "Linux"}, "product_version": "patch: 5.15.121"}, {"id": "e57491f9-ea3f-3aa9-81cb-5e8f860c2bb2", "product": {"name": "Linux"}, "product_version": "b5a0a9b59c8185aebcd9a717e2e6258b58c72c06 <7aecdd47910c51707696e8b0e045b9f88bd4230f"}, {"id": "e5b68554-25ee-3635-abfd-7d63b1a73166", "product": {"name": "Linux"}, "product_version": "patch: 6.1.39"}, {"id": "f2350b2a-16d2-311e-83a6-532269f736c2", "product": {"name": "Linux"}, "product_version": "4.11"}], "enisaIdVendor": [{"id": "e7f05744-af7f-3839-b3c2-a1ecc29074e3", "vendor": {"name": "Linux"}}], "isExploited": false}