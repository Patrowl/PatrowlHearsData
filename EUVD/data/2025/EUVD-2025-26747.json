{"id": "EUVD-2025-26747", "enisaUuid": "6df18fa5-09ca-3dde-9791-23999aa2122f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhabanalabs: fix UAF in export_dmabuf()\n\nAs soon as we'd inserted a file reference into descriptor table, another\nthread could close it.  That's fine for the case when all we are doing is\nreturning that descriptor to userland (it's a race, but it's a userland\nrace and there's nothing the kernel can do about it).  However, if we\nfollow fd_install() with any kind of access to objects that would be\ndestroyed on close (be it the struct file itself or anything destroyed\nby its ->release()), we have a UAF.\n\ndma_buf_fd() is a combination of reserving a descriptor and fd_install().\nhabanalabs export_dmabuf() calls it and then proceeds to access the\nobjects destroyed on close.  In particular, it grabs an extra reference to\nanother struct file that will be dropped as part of ->release() for ours;\nthat \"will be\" is actually \"might have already been\".\n\nFix that by reserving descriptor before anything else and do fd_install()\nonly when everything had been set up.  As a side benefit, we no longer\nhave the failure exit with file already created, but reference to\nunderlying file (as well as ->dmabuf_export_cnt, etc.) not grabbed yet;\nunlike dma_buf_fd(), fd_install() can't fail.", "datePublished": "2025-09-05T18:31:17", "dateUpdated": "2025-11-26T00:30:16", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c07886761fd6251db6938d4e747002e3d150d231", "https://git.kernel.org/stable/c/40deceb38f9db759772d1c289c28fd2a543f57fc", "https://git.kernel.org/stable/c/55c232d7e0241f1d5120b595e7a9de24c75ed3d8", "https://git.kernel.org/stable/c/33927f3d0ecdcff06326d6e4edb6166aed42811c", "https://nvd.nist.gov/vuln/detail/CVE-2025-38722"], "aliases": ["CVE-2025-38722"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "3a2f09e5-b890-3499-8de8-8e33d8113876", "product": {"name": "Linux"}, "product_version": "db1a8dd916aac986871f6b873a3aefad906f383a <33927f3d0ecdcff06326d6e4edb6166aed42811c"}, {"id": "49c6e631-7eb5-3b42-afe8-0ba1c501be4e", "product": {"name": "Linux"}, "product_version": "db1a8dd916aac986871f6b873a3aefad906f383a <55c232d7e0241f1d5120b595e7a9de24c75ed3d8"}, {"id": "5747e448-5249-3a0a-adca-dbb141d5b97b", "product": {"name": "Linux"}, "product_version": "patch: 6.16.2"}, {"id": "85a66632-5283-3478-a7b9-2c13838aac91", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "8a17a5ed-356d-3fbc-ae49-5b79c29e3c57", "product": {"name": "Linux"}, "product_version": "db1a8dd916aac986871f6b873a3aefad906f383a <c07886761fd6251db6938d4e747002e3d150d231"}, {"id": "c4297482-1291-39e0-bcd6-10dedc310f70", "product": {"name": "Linux"}, "product_version": "5.16"}, {"id": "ce4bcef3-c172-3f55-9ede-157cd9c28a2e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d7439c44-5042-3359-bf9d-894fd30eabab", "product": {"name": "Linux"}, "product_version": "patch: 6.12.43"}, {"id": "d9c22add-5848-3892-96fa-b568ed30103f", "product": {"name": "Linux"}, "product_version": "patch: 6.15.11"}, {"id": "df8537f8-398c-36c0-b8e2-1779eff81d65", "product": {"name": "Linux"}, "product_version": "patch: 6.17-rc2"}, {"id": "e8fba366-86b6-3dac-8a3e-cfcb35be79f3", "product": {"name": "Linux"}, "product_version": "db1a8dd916aac986871f6b873a3aefad906f383a <40deceb38f9db759772d1c289c28fd2a543f57fc"}], "enisaIdVendor": [{"id": "b022cfb1-c245-3f8a-b1f1-2d370d2904d8", "vendor": {"name": "Linux"}}], "isExploited": false}