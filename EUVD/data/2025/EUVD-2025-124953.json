{"id": "EUVD-2025-124953", "enisaUuid": "a510ee37-c9ff-30b9-b2f9-202fa6d7d0fc", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ufs: core: Fix data race in CPU latency PM QoS request handling\n\nThe cpu_latency_qos_add/remove/update_request interfaces lack internal\nsynchronization by design, requiring the caller to ensure thread safety.\nThe current implementation relies on the 'pm_qos_enabled' flag, which is\ninsufficient to prevent concurrent access and cannot serve as a proper\nsynchronization mechanism. This has led to data races and list\ncorruption issues.\n\nA typical race condition call trace is:\n\n[Thread A]\nufshcd_pm_qos_exit()\n  --> cpu_latency_qos_remove_request()\n    --> cpu_latency_qos_apply();\n      --> pm_qos_update_target()\n        --> plist_del              <--(1) delete plist node\n    --> memset(req, 0, sizeof(*req));\n  --> hba->pm_qos_enabled = false;\n\n[Thread B]\nufshcd_devfreq_target\n  --> ufshcd_devfreq_scale\n    --> ufshcd_scale_clks\n      --> ufshcd_pm_qos_update     <--(2) pm_qos_enabled is true\n        --> cpu_latency_qos_update_request\n          --> pm_qos_update_target\n            --> plist_del          <--(3) plist node use-after-free\n\nIntroduces a dedicated mutex to serialize PM QoS operations, preventing\ndata races and ensuring safe access to PM QoS resources, including sysfs\ninterface reads.", "datePublished": "2025-11-12T10:23:21", "dateUpdated": "2025-12-01T06:18:35", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d9df61afb8d23c475f1be3c714da2c34c156ab01", "https://git.kernel.org/stable/c/79dde5f7dc7c038eec903745dc1550cd4139980e", "https://nvd.nist.gov/vuln/detail/CVE-2025-40130"], "aliases": ["CVE-2025-40130"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "092eecfd-dc3d-3747-9b8c-a89a9b5bf52e", "product": {"name": "Linux"}, "product_version": "patch: 6.17.3"}, {"id": "7e1b65d9-5e5e-3030-90f3-0f58a73e363e", "product": {"name": "Linux"}, "product_version": "6.9"}, {"id": "b595fb67-31d1-39a9-b1a7-665f6ba7dfa1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c3469c88-25c6-3057-9a48-535b1b2d9260", "product": {"name": "Linux"}, "product_version": "patch: 6.18-rc1"}, {"id": "ccf4f97b-28c9-3d59-b99a-dc142c7b053a", "product": {"name": "Linux"}, "product_version": "2777e73fc154e2e87233bdcc0e2402b33815198e <d9df61afb8d23c475f1be3c714da2c34c156ab01"}, {"id": "ede8b8d0-8cf8-3141-b218-b8e13d08ca79", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "f4198af5-9dbe-31f1-b231-050a92e70b7f", "product": {"name": "Linux"}, "product_version": "2777e73fc154e2e87233bdcc0e2402b33815198e <79dde5f7dc7c038eec903745dc1550cd4139980e"}], "enisaIdVendor": [{"id": "16feff44-9d6d-3e92-b805-1ad0be9bfa69", "vendor": {"name": "Linux"}}], "isExploited": false}