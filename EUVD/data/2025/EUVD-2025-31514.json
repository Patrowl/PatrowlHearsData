{"id": "EUVD-2025-31514", "enisaUuid": "d8b6d869-1a4d-3ffd-8460-9f4f047b7374", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: rainshadow-cec: fix TOCTOU race condition in rain_interrupt()\n\nIn the interrupt handler rain_interrupt(), the buffer full check on\nrain->buf_len is performed before acquiring rain->buf_lock. This\ncreates a Time-of-Check to Time-of-Use (TOCTOU) race condition, as\nrain->buf_len is concurrently accessed and modified in the work\nhandler rain_irq_work_handler() under the same lock.\n\nMultiple interrupt invocations can race, with each reading buf_len\nbefore it becomes full and then proceeding. This can lead to both\ninterrupts attempting to write to the buffer, incrementing buf_len\nbeyond its capacity (DATA_SIZE) and causing a buffer overflow.\n\nFix this bug by moving the spin_lock() to before the buffer full\ncheck. This ensures that the check and the subsequent buffer modification\nare performed atomically, preventing the race condition. An corresponding\nspin_unlock() is added to the overflow path to correctly release the\nlock.\n\nThis possible bug was found by an experimental static analysis tool\ndeveloped by our team.", "datePublished": "2025-09-05T18:31:27", "dateUpdated": "2025-11-03T18:31:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/2964dbe631fd21ad7873b1752b895548d3c12496", "https://git.kernel.org/stable/c/6aaef1a75985865d8c6c5b65fb54152060faba48", "https://git.kernel.org/stable/c/fbc81e78d75bf28972bc22b1599559557b1a1b83", "https://git.kernel.org/stable/c/3c3e33b7edca7a2d6a96801f287f9faeb684d655", "https://git.kernel.org/stable/c/1c2769dc80255824542ea5a4ff1a07dcdeb1603f", "https://git.kernel.org/stable/c/ed905fe7cba03cf22ae0b84cf1b73cd1c070423a", "https://git.kernel.org/stable/c/ff9dd3db6cd4c6b54a2ecbc58151bea4ec63bc59", "https://git.kernel.org/stable/c/7af160aea26c7dc9e6734d19306128cce156ec40", "https://nvd.nist.gov/vuln/detail/CVE-2025-39713", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-39713"], "assigner": "Linux", "epss": 0.12, "enisaIdProduct": [{"id": "05c609f4-eb97-3d33-9e0f-b5c2540dd4c6", "product": {"name": "Linux"}, "product_version": "4.12"}, {"id": "0fe89702-b162-37a2-acdd-49db94011a3a", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <1c2769dc80255824542ea5a4ff1a07dcdeb1603f"}, {"id": "108842ba-521c-36ad-be6b-5011aaa1e183", "product": {"name": "Linux"}, "product_version": "patch: 6.12.44"}, {"id": "1656130c-eace-3ebd-b595-7faa30115539", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <3c3e33b7edca7a2d6a96801f287f9faeb684d655"}, {"id": "17b116c8-b0c5-33ea-8302-f94a1347c8cc", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <ff9dd3db6cd4c6b54a2ecbc58151bea4ec63bc59"}, {"id": "261a483f-b7aa-3901-8f1f-3c0db9176ef2", "product": {"name": "Linux"}, "product_version": "patch: 6.1.149"}, {"id": "2e3b89b2-7666-31fc-922f-f40c7f578cad", "product": {"name": "Linux"}, "product_version": "patch: 6.6.103"}, {"id": "3c060a5a-a433-3bb0-9859-212818d44c39", "product": {"name": "Linux"}, "product_version": "patch: 6.17"}, {"id": "49269cce-3471-3d7d-b9da-1d320c2ecdb7", "product": {"name": "Linux"}, "product_version": "patch: 6.16.4"}, {"id": "727c0c08-434d-3280-9c95-09d010cf6b04", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "7c5cc199-7cd9-3dc8-8917-ca686329f0a5", "product": {"name": "Linux"}, "product_version": "patch: 5.4.297"}, {"id": "82c3ede4-af98-3257-9b1f-953d53f92da8", "product": {"name": "Linux"}, "product_version": "patch: 5.15.190"}, {"id": "8e262a59-a02c-3c36-bccf-ecd7e4d427d6", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <2964dbe631fd21ad7873b1752b895548d3c12496"}, {"id": "9a37db3e-4b45-3f0d-bfc2-dbef4877f53c", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <fbc81e78d75bf28972bc22b1599559557b1a1b83"}, {"id": "a568875e-f4a0-3a31-bd3d-9cce9a2b8567", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <ed905fe7cba03cf22ae0b84cf1b73cd1c070423a"}, {"id": "bb478d20-32ba-326f-b82b-8a98ceca6972", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <7af160aea26c7dc9e6734d19306128cce156ec40"}, {"id": "be9dcfa5-3323-3734-a46d-482823666b40", "product": {"name": "Linux"}, "product_version": "patch: 5.10.241"}, {"id": "dfb52fc5-5a99-382a-8e23-20902f2163d0", "product": {"name": "Linux"}, "product_version": "0f314f6c2e77beb1a232be21dd6be4e1849ba5ac <6aaef1a75985865d8c6c5b65fb54152060faba48"}], "enisaIdVendor": [{"id": "83a6e67c-c16b-3552-8d52-dd79c53a7a10", "vendor": {"name": "Linux"}}], "isExploited": false}