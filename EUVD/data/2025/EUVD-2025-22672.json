{"id": "EUVD-2025-22672", "enisaUuid": "0ef72c62-c683-3434-920e-aaeeb6d60b7b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nSquashfs: check return result of sb_min_blocksize\n\nSyzkaller reports an \"UBSAN: shift-out-of-bounds in squashfs_bio_read\" bug.\n\nSyzkaller forks multiple processes which after mounting the Squashfs\nfilesystem, issues an ioctl(\"/dev/loop0\", LOOP_SET_BLOCK_SIZE, 0x8000). \nNow if this ioctl occurs at the same time another process is in the\nprocess of mounting a Squashfs filesystem on /dev/loop0, the failure\noccurs.  When this happens the following code in squashfs_fill_super()\nfails.\n\n----\nmsblk->devblksize = sb_min_blocksize(sb, SQUASHFS_DEVBLK_SIZE);\nmsblk->devblksize_log2 = ffz(~msblk->devblksize);\n----\n\nsb_min_blocksize() returns 0, which means msblk->devblksize is set to 0.\n\nAs a result, ffz(~msblk->devblksize) returns 64, and msblk->devblksize_log2\nis set to 64.\n\nThis subsequently causes the\n\nUBSAN: shift-out-of-bounds in fs/squashfs/block.c:195:36\nshift exponent 64 is too large for 64-bit type 'u64' (aka\n'unsigned long long')\n\nThis commit adds a check for a 0 return by sb_min_blocksize().", "datePublished": "2025-07-25T15:30:53", "dateUpdated": "2025-12-23T21:30:22", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/db7096ea160e40d78c67fce52e7cc51bde049497", "https://git.kernel.org/stable/c/549f9e3d7b60d53808c98b9fde49b4f46d0524a5", "https://git.kernel.org/stable/c/5c51aa862cbeed2f3887f0382a2708956710bd68", "https://git.kernel.org/stable/c/6abf6b78c6fb112eee495f5636ffcc350dd2ce25", "https://git.kernel.org/stable/c/4f99357dadbf9c979ad737156ad4c37fadf7c56b", "https://git.kernel.org/stable/c/0aff95d9bc7fb5400ca8af507429c4b067bdb425", "https://git.kernel.org/stable/c/295ab18c2dbce8d0ac6ecf7c5187e16e1ac8b282", "https://git.kernel.org/stable/c/734aa85390ea693bb7eaf2240623d41b03705c84", "https://nvd.nist.gov/vuln/detail/CVE-2025-38415", "https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html", "https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html"], "aliases": ["CVE-2025-38415"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "10ec4049-3fb7-3b81-a26f-9ef8e5a481b9", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "257555ff-08ba-3188-a52c-037d7f0b4f74", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <295ab18c2dbce8d0ac6ecf7c5187e16e1ac8b282"}, {"id": "30a587bb-f041-3b40-afba-19e10701950a", "product": {"name": "Linux"}, "product_version": "patch: 6.15.3"}, {"id": "334fa0a1-7bd7-3ea4-9db9-8fbf88bfbe91", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <4f99357dadbf9c979ad737156ad4c37fadf7c56b"}, {"id": "35d88059-7f98-3029-8292-c89c692c5b3d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.186"}, {"id": "36430772-78ec-3ee0-96c1-808c207e1663", "product": {"name": "Linux"}, "product_version": "patch: 5.4.295"}, {"id": "42ec0ad9-ecca-3988-aafa-2d855cf405fe", "product": {"name": "Linux"}, "product_version": "2.6.29"}, {"id": "48d71adf-45e5-37cc-94f9-633704afb149", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <6abf6b78c6fb112eee495f5636ffcc350dd2ce25"}, {"id": "515bd014-22c8-3bf2-bb33-d66d4a25de70", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <549f9e3d7b60d53808c98b9fde49b4f46d0524a5"}, {"id": "56d45f99-d120-3b51-b78c-0714db447a6c", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <734aa85390ea693bb7eaf2240623d41b03705c84"}, {"id": "75f9da55-469d-3aa2-b9be-689f897be15d", "product": {"name": "Linux"}, "product_version": "patch: 6.6.94"}, {"id": "84490fbd-5123-3726-acb9-747fb6310c6e", "product": {"name": "Linux"}, "product_version": "patch: 5.10.239"}, {"id": "8962fd6f-1873-309d-91a3-d8ce9b08efac", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <db7096ea160e40d78c67fce52e7cc51bde049497"}, {"id": "adab5d6a-bdde-3630-aa37-a45bb242e30b", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <0aff95d9bc7fb5400ca8af507429c4b067bdb425"}, {"id": "b5454365-0ac5-346c-a090-19159c74e9a8", "product": {"name": "Linux"}, "product_version": "0aa666190509ffab81c202c5095a166be23961ac <5c51aa862cbeed2f3887f0382a2708956710bd68"}, {"id": "b8125a20-c08e-39a1-b6b8-160e5dd7c9d8", "product": {"name": "Linux"}, "product_version": "patch: 6.12.34"}, {"id": "babcbde7-f187-37a4-94d2-d56cfc45eb8b", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "db998a80-af5f-33e9-84d3-870c54c13db2", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc1"}, {"id": "f318c1be-6e15-3b9b-987a-6158f429d239", "product": {"name": "Linux"}, "product_version": "patch: 6.1.142"}], "enisaIdVendor": [{"id": "68daa5b1-e762-309d-9e92-046d8ffb9eb9", "vendor": {"name": "Linux"}}], "isExploited": false}