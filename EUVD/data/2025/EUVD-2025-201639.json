{"id": "EUVD-2025-201639", "enisaUuid": "59d8c7e7-46d9-336e-ac08-69f48d385d2f", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\norangefs: fix xattr related buffer overflow...\n\nWilly Tarreau <w@1wt.eu> forwarded me a message from\nDisclosure <disclosure@aisle.com> with the following\nwarning:\n\n> The helper `xattr_key()` uses the pointer variable in the loop condition\n> rather than dereferencing it. As `key` is incremented, it remains non-NULL\n> (until it runs into unmapped memory), so the loop does not terminate on\n> valid C strings and will walk memory indefinitely, consuming CPU or hanging\n> the thread.\n\nI easily reproduced this with setfattr and getfattr, causing a kernel\noops, hung user processes and corrupted orangefs files. Disclosure\nsent along a diff (not a patch) with a suggested fix, which I based\nthis patch on.\n\nAfter xattr_key started working right, xfstest generic/069 exposed an\nxattr related memory leak that lead to OOM. xattr_key returns\na hashed key.  When adding xattrs to the orangefs xattr cache, orangefs\nused hash_add, a kernel hashing macro. hash_add also hashes the key using\nhash_log which resulted in additions to the xattr cache going to the wrong\nhash bucket. generic/069 tortures a single file and orangefs does a\ngetattr for the xattr \"security.capability\" every time. Orangefs\nnegative caches on xattrs which includes a kmalloc. Since adds to the\nxattr cache were going to the wrong bucket, every getattr for\n\"security.capability\" resulted in another kmalloc, none of which were\never freed.\n\nI changed the two uses of hash_add to hlist_add_head instead\nand the memory leak ceased and generic/069 quit throwing furniture.", "datePublished": "2025-12-08T00:46:31", "dateUpdated": "2025-12-20T08:51:57", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c6564ff6b53c9a8dc786b6f1c51ae7688273f931", "https://git.kernel.org/stable/c/ef892d2bf4f3fa2c8de1677dd307e678bdd3d865", "https://git.kernel.org/stable/c/15afebb9597449c444801d1ff0b8d8b311f950ab", "https://git.kernel.org/stable/c/bc812574de633cf9a9ad6974490e45f6a4bb5126", "https://git.kernel.org/stable/c/e09a096104fc65859422817fb2211f35855983fe", "https://git.kernel.org/stable/c/9127d1e90c90e5960c8bc72a4ce2c209691a7021", "https://git.kernel.org/stable/c/c2ca015ac109fd743fdde27933d59dc5ad46658e", "https://git.kernel.org/stable/c/025e880759c279ec64d0f754fe65bf45961da864", "https://nvd.nist.gov/vuln/detail/CVE-2025-40306"], "aliases": ["CVE-2025-40306"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "059dc957-d200-31e5-bb32-c88f2571b840", "product": {"name": "Linux"}, "product_version": "patch: 6.12.58"}, {"id": "0f9a89ef-6280-3b16-be51-ed319a222c93", "product": {"name": "Linux"}, "product_version": "patch: 6.17.8"}, {"id": "40b39ebd-a6ba-37d1-aef4-50aace50a4f2", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <c2ca015ac109fd743fdde27933d59dc5ad46658e"}, {"id": "5194ff2b-f139-396c-9ec7-0a11e1e3b0f2", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e09a096104fc65859422817fb2211f35855983fe"}, {"id": "55afc569-faca-3f83-ac71-fb7f2cc0d4ee", "product": {"name": "Linux"}, "product_version": "4.6"}, {"id": "58eb38bd-c4cb-31b6-9b21-28990eff15ed", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5f8a57bc-a802-38ce-ac09-c27fadb276ec", "product": {"name": "Linux"}, "product_version": "patch: 5.10.247"}, {"id": "691fe99d-bf0f-3f69-a611-646169967359", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <15afebb9597449c444801d1ff0b8d8b311f950ab"}, {"id": "6a71f313-9414-3dd7-a731-17dfa22d0323", "product": {"name": "Linux"}, "product_version": "patch: 6.18"}, {"id": "6e323df8-ab80-3da3-bf04-f154c2553b24", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9127d1e90c90e5960c8bc72a4ce2c209691a7021"}, {"id": "71fac5d4-d3ff-3196-8595-b58504288839", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <ef892d2bf4f3fa2c8de1677dd307e678bdd3d865"}, {"id": "7e511e5c-bfe1-3747-90cb-c7629f305f73", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c2ca015ac109fd743fdde27933d59dc5ad46658e"}, {"id": "aa173701-1829-38fb-959a-759f9c6cf913", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <15afebb9597449c444801d1ff0b8d8b311f950ab"}, {"id": "b43dcdf0-14fc-32ca-bac9-8de891304c16", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <c6564ff6b53c9a8dc786b6f1c51ae7688273f931"}, {"id": "bbc5abc7-82f9-309b-a000-4a425d5c7a76", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c6564ff6b53c9a8dc786b6f1c51ae7688273f931"}, {"id": "c48f5af9-829d-3b87-ab25-025dc0ac815f", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <bc812574de633cf9a9ad6974490e45f6a4bb5126"}, {"id": "c9f3a55b-a9f9-3c69-bb2b-0ceffb208715", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <9127d1e90c90e5960c8bc72a4ce2c209691a7021"}, {"id": "ca4c3351-3300-385c-b234-9f9e1e235790", "product": {"name": "Linux"}, "product_version": "patch: 6.1.159"}, {"id": "d2622212-16ca-3063-a83a-f6b95687bc75", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ef892d2bf4f3fa2c8de1677dd307e678bdd3d865"}, {"id": "d39c1705-3b9f-32b2-b79f-a6fdcd8a58bc", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <025e880759c279ec64d0f754fe65bf45961da864"}, {"id": "d5ba0726-5f1b-35ab-820b-4a5746739495", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <025e880759c279ec64d0f754fe65bf45961da864"}, {"id": "d84d8e41-04ba-3a91-a178-8d9696891f61", "product": {"name": "Linux"}, "product_version": "patch: 5.4.302"}, {"id": "deb48e74-326f-3362-afdb-65f2f8f90489", "product": {"name": "Linux"}, "product_version": "patch: 5.15.197"}, {"id": "def3885c-7e9a-3cbb-b62b-5ee6bd8bfc33", "product": {"name": "Linux"}, "product_version": "patch: 6.6.117"}, {"id": "ee4cd065-91f0-3bbc-9559-b5e46394f85e", "product": {"name": "Linux"}, "product_version": "f7ab093f74bf638ed98fd1115f3efa17e308bb7f <e09a096104fc65859422817fb2211f35855983fe"}, {"id": "f0f43609-9570-32b6-b173-a4266ea96f01", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bc812574de633cf9a9ad6974490e45f6a4bb5126"}], "enisaIdVendor": [{"id": "c794a2d3-63a4-36c1-8f7e-2d273769f656", "vendor": {"name": "Linux"}}], "isExploited": false}