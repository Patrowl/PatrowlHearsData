{"id": "EUVD-2025-205154", "enisaUuid": "d3cc266d-fed0-3e52-9ab9-390640bfb3dd", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: Fix data-race around unix_tot_inflight.\n\nunix_tot_inflight is changed under spin_lock(unix_gc_lock), but\nunix_release_sock() reads it locklessly.\n\nLet's use READ_ONCE() for unix_tot_inflight.\n\nNote that the writer side was marked by commit 9d6d7f1cb67c (\"af_unix:\nannote lockless accesses to unix_tot_inflight & gc_in_progress\")\n\nBUG: KCSAN: data-race in unix_inflight / unix_release_sock\n\nwrite (marked) to 0xffffffff871852b8 of 4 bytes by task 123 on cpu 1:\n unix_inflight+0x130/0x180 net/unix/scm.c:64\n unix_attach_fds+0x137/0x1b0 net/unix/scm.c:123\n unix_scm_to_skb net/unix/af_unix.c:1832 [inline]\n unix_dgram_sendmsg+0x46a/0x14f0 net/unix/af_unix.c:1955\n sock_sendmsg_nosec net/socket.c:724 [inline]\n sock_sendmsg+0x148/0x160 net/socket.c:747\n ____sys_sendmsg+0x4e4/0x610 net/socket.c:2493\n ___sys_sendmsg+0xc6/0x140 net/socket.c:2547\n __sys_sendmsg+0x94/0x140 net/socket.c:2576\n __do_sys_sendmsg net/socket.c:2585 [inline]\n __se_sys_sendmsg net/socket.c:2583 [inline]\n __x64_sys_sendmsg+0x45/0x50 net/socket.c:2583\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x3b/0x90 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nread to 0xffffffff871852b8 of 4 bytes by task 4891 on cpu 0:\n unix_release_sock+0x608/0x910 net/unix/af_unix.c:671\n unix_release+0x59/0x80 net/unix/af_unix.c:1058\n __sock_release+0x7d/0x170 net/socket.c:653\n sock_close+0x19/0x30 net/socket.c:1385\n __fput+0x179/0x5e0 fs/file_table.c:321\n ____fput+0x15/0x20 fs/file_table.c:349\n task_work_run+0x116/0x1a0 kernel/task_work.c:179\n resume_user_mode_work include/linux/resume_user_mode.h:49 [inline]\n exit_to_user_mode_loop kernel/entry/common.c:171 [inline]\n exit_to_user_mode_prepare+0x174/0x180 kernel/entry/common.c:204\n __syscall_exit_to_user_mode_work kernel/entry/common.c:286 [inline]\n syscall_exit_to_user_mode+0x1a/0x30 kernel/entry/common.c:297\n do_syscall_64+0x4b/0x90 arch/x86/entry/common.c:86\n entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nvalue changed: 0x00000000 -> 0x00000001\n\nReported by Kernel Concurrency Sanitizer on:\nCPU: 0 PID: 4891 Comm: systemd-coredum Not tainted 6.4.0-rc5-01219-gfa0e21fa4443 #5\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014", "datePublished": "2025-12-24T12:30:27", "dateUpdated": "2025-12-24T12:30:27", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2023-54006", "https://git.kernel.org/stable/c/20aa8325464d8905450089eed96ca102a074d853", "https://git.kernel.org/stable/c/2d8933ca863e252fb09ad0be483255e3dfeb1f54", "https://git.kernel.org/stable/c/31b46d5e7c4e295bd112960614a66a177a057dca", "https://git.kernel.org/stable/c/5d91b7891f4a9a9d69d75e9f44ab4bf1f3b11840", "https://git.kernel.org/stable/c/ade32bd8a738d7497ffe9743c46728db26740f78", "https://git.kernel.org/stable/c/afc284a4a781defbb12b2a40427fae34c3d20e17", "https://git.kernel.org/stable/c/cf29b42766ad4af2ae6a449f583796951551b48d", "https://git.kernel.org/stable/c/e5edc6e44a882c0458878ab10eaddfe60ac34e57"], "aliases": ["CVE-2023-54006", "GHSA-c5hc-c94v-v6gh"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0de22826-ee1b-386d-a977-60aaf4e6acaf", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <31b46d5e7c4e295bd112960614a66a177a057dca"}, {"id": "10dc88e5-4795-3e5c-8b1e-e323386f111a", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "249ff5e3-9a49-3849-a9ac-ded482ef212a", "product": {"name": "Linux"}, "product_version": "patch: 5.15.132"}, {"id": "3354862e-14c7-36ef-bbfb-69cd6286008c", "product": {"name": "Linux"}, "product_version": "patch: 6.5.4"}, {"id": "33c6b7da-e16e-3adc-a7c4-2b2ef6667b01", "product": {"name": "Linux"}, "product_version": "2.6.24"}, {"id": "49aa2b50-8d83-37e5-b77c-53dc49a54995", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <afc284a4a781defbb12b2a40427fae34c3d20e17"}, {"id": "52312df5-d977-3ef1-9d6d-2685f3b3f1a8", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <ade32bd8a738d7497ffe9743c46728db26740f78"}, {"id": "55141b6f-60d7-3872-9d51-8987ed427aba", "product": {"name": "Linux"}, "product_version": "patch: 5.4.257"}, {"id": "5feaf819-a87d-32d2-a86b-ce62c828de95", "product": {"name": "Linux"}, "product_version": "patch: 4.14.326"}, {"id": "674d0d8b-0482-3bfa-a8b0-b6221feaf206", "product": {"name": "Linux"}, "product_version": "patch: 4.19.295"}, {"id": "8a562386-f961-3139-b898-9e4bc136c5eb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8f10d079-4c68-3523-bbaa-27c1b4c36f36", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <5d91b7891f4a9a9d69d75e9f44ab4bf1f3b11840"}, {"id": "9d9a742e-2261-33b4-8158-ef24a4dfde01", "product": {"name": "Linux"}, "product_version": "patch: 5.10.195"}, {"id": "a7b1e051-5994-31d3-9b69-0ed2f2383221", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <2d8933ca863e252fb09ad0be483255e3dfeb1f54"}, {"id": "af03624b-9df8-3313-8cc0-10d53b2b53fc", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <e5edc6e44a882c0458878ab10eaddfe60ac34e57"}, {"id": "d0fc0ccd-72d6-35e2-bcc9-46e727141fb2", "product": {"name": "Linux"}, "product_version": "patch: 6.1.54"}, {"id": "d537bfa5-d7aa-38c7-b8ac-103fef90d708", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <cf29b42766ad4af2ae6a449f583796951551b48d"}, {"id": "f80cab7d-f0b2-3c4e-ac3c-c5cb70a4e5d3", "product": {"name": "Linux"}, "product_version": "9305cfa4443dbfb99faf35c5603ec0c0e91b5ef8 <20aa8325464d8905450089eed96ca102a074d853"}], "enisaIdVendor": [{"id": "c8e492cb-35c0-375b-bd19-2aa0f22c13bb", "vendor": {"name": "Linux"}}], "isExploited": false}