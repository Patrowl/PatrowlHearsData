{"id": "EUVD-2025-20064", "enisaUuid": "4e90e0de-2c93-37fd-be3b-4d0abb8e7c98", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: clear the dst when changing skb protocol\n\nA not-so-careful NAT46 BPF program can crash the kernel\nif it indiscriminately flips ingress packets from v4 to v6:\n\n  BUG: kernel NULL pointer dereference, address: 0000000000000000\n    ip6_rcv_core (net/ipv6/ip6_input.c:190:20)\n    ipv6_rcv (net/ipv6/ip6_input.c:306:8)\n    process_backlog (net/core/dev.c:6186:4)\n    napi_poll (net/core/dev.c:6906:9)\n    net_rx_action (net/core/dev.c:7028:13)\n    do_softirq (kernel/softirq.c:462:3)\n    netif_rx (net/core/dev.c:5326:3)\n    dev_loopback_xmit (net/core/dev.c:4015:2)\n    ip_mc_finish_output (net/ipv4/ip_output.c:363:8)\n    NF_HOOK (./include/linux/netfilter.h:314:9)\n    ip_mc_output (net/ipv4/ip_output.c:400:5)\n    dst_output (./include/net/dst.h:459:9)\n    ip_local_out (net/ipv4/ip_output.c:130:9)\n    ip_send_skb (net/ipv4/ip_output.c:1496:8)\n    udp_send_skb (net/ipv4/udp.c:1040:8)\n    udp_sendmsg (net/ipv4/udp.c:1328:10)\n\nThe output interface has a 4->6 program attached at ingress.\nWe try to loop the multicast skb back to the sending socket.\nIngress BPF runs as part of netif_rx(), pushes a valid v6 hdr\nand changes skb->protocol to v6. We enter ip6_rcv_core which\ntries to use skb_dst(). But the dst is still an IPv4 one left\nafter IPv4 mcast output.\n\nClear the dst in all BPF helpers which change the protocol.\nTry to preserve metadata dsts, those may carry non-routing\nmetadata.", "datePublished": "2025-07-04T15:31:09", "dateUpdated": "2025-11-19T21:31:14", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/bfa4d86e130a09f67607482e988313430e38f6c4", "https://git.kernel.org/stable/c/2a3ad42a57b43145839f2f233fb562247658a6d9", "https://git.kernel.org/stable/c/e9994e7b9f7bbb882d13c8191731649249150d21", "https://git.kernel.org/stable/c/ba9db6f907ac02215e30128770f85fbd7db2fcf9", "https://nvd.nist.gov/vuln/detail/CVE-2025-38192"], "aliases": ["CVE-2025-38192"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "39d2d361-77b1-3773-a321-610d2f699340", "product": {"name": "Linux"}, "product_version": "patch: 6.12.35"}, {"id": "3a643c2c-8191-34cf-8c49-a896b268cf6d", "product": {"name": "Linux"}, "product_version": "6578171a7ff0c31dc73258f93da7407510abf085 <bfa4d86e130a09f67607482e988313430e38f6c4"}, {"id": "3d134982-e576-3508-9ba9-47f7f08a8c9c", "product": {"name": "Linux"}, "product_version": "6578171a7ff0c31dc73258f93da7407510abf085 <2a3ad42a57b43145839f2f233fb562247658a6d9"}, {"id": "4871c151-ae50-33bf-8c15-d396ae6cce18", "product": {"name": "Linux"}, "product_version": "patch: 6.16-rc2"}, {"id": "592ca159-4cfb-3ef0-9e54-699d01882acc", "product": {"name": "Linux"}, "product_version": "patch: 6.6.95"}, {"id": "70515bef-8c44-39a4-be3e-2ff9759e9c8c", "product": {"name": "Linux"}, "product_version": "6578171a7ff0c31dc73258f93da7407510abf085 <e9994e7b9f7bbb882d13c8191731649249150d21"}, {"id": "7198af6a-5b57-34c2-93bd-c6c8f6ab24bf", "product": {"name": "Linux"}, "product_version": "patch: 6.15.4"}, {"id": "7f62fa08-787b-3287-9e68-61d7651ef3a8", "product": {"name": "Linux"}, "product_version": "4.8"}, {"id": "c9b570f4-adb7-3676-a385-5d36665e9d4d", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "e14333f7-470e-3a9a-8d27-8909bf590a03", "product": {"name": "Linux"}, "product_version": "patch: 6.16"}, {"id": "ffd76fc9-6437-379b-a538-4d338a3cf776", "product": {"name": "Linux"}, "product_version": "6578171a7ff0c31dc73258f93da7407510abf085 <ba9db6f907ac02215e30128770f85fbd7db2fcf9"}], "enisaIdVendor": [{"id": "c5977461-4458-35ff-9131-15edd78a889d", "vendor": {"name": "Linux"}}], "isExploited": false}