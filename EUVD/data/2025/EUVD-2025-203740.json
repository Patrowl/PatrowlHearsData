{"id": "EUVD-2025-203740", "enisaUuid": "28b09ef8-3536-3f39-baad-b675edd65b18", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncomedi: check device's attached status in compat ioctls\n\nSyzbot identified an issue [1] that crashes kernel, seemingly due to\nunexistent callback dev->get_valid_routes(). By all means, this should\nnot occur as said callback must always be set to\nget_zero_valid_routes() in __comedi_device_postconfig().\n\nAs the crash seems to appear exclusively in i386 kernels, at least,\njudging from [1] reports, the blame lies with compat versions\nof standard IOCTL handlers. Several of them are modified and\ndo not use comedi_unlocked_ioctl(). While functionality of these\nioctls essentially copy their original versions, they do not\nhave required sanity check for device's attached status. This,\nin turn, leads to a possibility of calling select IOCTLs on a\ndevice that has not been properly setup, even via COMEDI_DEVCONFIG.\n\nDoing so on unconfigured devices means that several crucial steps\nare missed, for instance, specifying dev->get_valid_routes()\ncallback.\n\nFix this somewhat crudely by ensuring device's attached status before\nperforming any ioctls, improving logic consistency between modern\nand compat functions.\n\n[1] Syzbot report:\nBUG: kernel NULL pointer dereference, address: 0000000000000000\n...\nCR2: ffffffffffffffd6 CR3: 000000006c717000 CR4: 0000000000352ef0\nCall Trace:\n <TASK>\n get_valid_routes drivers/comedi/comedi_fops.c:1322 [inline]\n parse_insn+0x78c/0x1970 drivers/comedi/comedi_fops.c:1401\n do_insnlist_ioctl+0x272/0x700 drivers/comedi/comedi_fops.c:1594\n compat_insnlist drivers/comedi/comedi_fops.c:3208 [inline]\n comedi_compat_ioctl+0x810/0x990 drivers/comedi/comedi_fops.c:3273\n __do_compat_sys_ioctl fs/ioctl.c:695 [inline]\n __se_compat_sys_ioctl fs/ioctl.c:638 [inline]\n __ia32_compat_sys_ioctl+0x242/0x370 fs/ioctl.c:638\n do_syscall_32_irqs_on arch/x86/entry/syscall_32.c:83 [inline]\n...", "datePublished": "2025-12-16T15:30:47", "dateUpdated": "2025-12-16T15:30:47", "baseScore": 0.0, "references": ["https://nvd.nist.gov/vuln/detail/CVE-2025-68257", "https://git.kernel.org/stable/c/0de7d9cd07a2671fa6089173bccc0b2afe6b93ee", "https://git.kernel.org/stable/c/573b07d2e3d473ee7eb625ef87519922cf01168d", "https://git.kernel.org/stable/c/aac80e912de306815297a3b74f0426873ffa7dc3", "https://git.kernel.org/stable/c/f6e629dfe6f590091c662a87c9fcf118b1c1c7dc"], "aliases": ["CVE-2025-68257", "GHSA-q3m2-j43g-7966"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1b37f84f-df93-3fb7-8c8f-669ea1d0e516", "product": {"name": "Linux"}, "product_version": "patch: 6.17.12"}, {"id": "4b432978-53b4-3117-93d1-1a21c0c2af28", "product": {"name": "Linux"}, "product_version": "patch: 6.18.1"}, {"id": "6b115e33-f282-3e07-b151-c1aa33022e57", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "707b2ca1-d95d-3925-bf5f-102dea539f41", "product": {"name": "Linux"}, "product_version": "3fbfd2223a271426509830e6340c386a1054cfad <573b07d2e3d473ee7eb625ef87519922cf01168d"}, {"id": "7e4f6389-8171-379a-ab3f-a1964db71e72", "product": {"name": "Linux"}, "product_version": "3fbfd2223a271426509830e6340c386a1054cfad <f6e629dfe6f590091c662a87c9fcf118b1c1c7dc"}, {"id": "80fc3970-593e-3f91-9cef-a0b95608bfc1", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "88b02bb0-1032-3868-af1e-6e5664ac19ad", "product": {"name": "Linux"}, "product_version": "patch: 6.12.62"}, {"id": "9627e191-bd77-35f6-9479-478061d697fd", "product": {"name": "Linux"}, "product_version": "patch: 6.19-rc1"}, {"id": "e445d97c-1daa-3af8-a8a8-fe4924019db7", "product": {"name": "Linux"}, "product_version": "3fbfd2223a271426509830e6340c386a1054cfad <aac80e912de306815297a3b74f0426873ffa7dc3"}, {"id": "f2744038-1ec6-3073-9b2b-eb0c28fce0d1", "product": {"name": "Linux"}, "product_version": "3fbfd2223a271426509830e6340c386a1054cfad <0de7d9cd07a2671fa6089173bccc0b2afe6b93ee"}], "enisaIdVendor": [{"id": "4b98d5c0-3e70-3d78-8541-eea2cb7d8e73", "vendor": {"name": "Linux"}}], "isExploited": false}