{"id": "EUVD-2021-34666", "enisaUuid": "2f5262e9-ac04-30ff-ac0a-828eb6a5526e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nubifs: rename_whiteout: Fix double free for whiteout_ui->data\n\n'whiteout_ui->data' will be freed twice if space budget fail for\nrename whiteout operation as following process:\n\nrename_whiteout\n  dev = kmalloc\n  whiteout_ui->data = dev\n  kfree(whiteout_ui->data)  // Free first time\n  iput(whiteout)\n    ubifs_free_inode\n      kfree(ui->data)\t    // Double free!\n\nKASAN reports:\n==================================================================\nBUG: KASAN: double-free or invalid-free in ubifs_free_inode+0x4f/0x70\nCall Trace:\n  kfree+0x117/0x490\n  ubifs_free_inode+0x4f/0x70 [ubifs]\n  i_callback+0x30/0x60\n  rcu_do_batch+0x366/0xac0\n  __do_softirq+0x133/0x57f\n\nAllocated by task 1506:\n  kmem_cache_alloc_trace+0x3c2/0x7a0\n  do_rename+0x9b7/0x1150 [ubifs]\n  ubifs_rename+0x106/0x1f0 [ubifs]\n  do_syscall_64+0x35/0x80\n\nFreed by task 1506:\n  kfree+0x117/0x490\n  do_rename.cold+0x53/0x8a [ubifs]\n  ubifs_rename+0x106/0x1f0 [ubifs]\n  do_syscall_64+0x35/0x80\n\nThe buggy address belongs to the object at ffff88810238bed8 which\nbelongs to the cache kmalloc-8 of size 8\n==================================================================\n\nLet ubifs_free_inode() free 'whiteout_ui->data'. BTW, delete unused\nassignment 'whiteout_ui->data_len = 0', process 'ubifs_evict_inode()\n-> ubifs_jnl_delete_inode() -> ubifs_jnl_write_inode()' doesn't need it\n(because 'inc_nlink(whiteout)' won't be excuted by 'goto out_release',\n and the nlink of whiteout inode is 0).", "datePublished": "2025-02-26T01:54:11", "dateUpdated": "2025-10-01T19:57:08", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/8b3c7be16f3f4dfd6e15ac651484e59d3fa36274", "https://git.kernel.org/stable/c/2b3236ecf96db7af5836e1366ce39ace8ce832fa", "https://git.kernel.org/stable/c/14276d38c89a170363e90b6ac0a53c3cf61b87fc", "https://git.kernel.org/stable/c/a90e2dbe66d2647ff95a0442ad2e86482d977fd8", "https://git.kernel.org/stable/c/2ad07009c459e56ebdcc089d850d664660fdb742", "https://git.kernel.org/stable/c/b9a937f096e608b3368c1abc920d4d640ba2c94f", "https://git.kernel.org/stable/c/6d7a158a7363c1f6604aa47ae1a280a5c65123dd", "https://git.kernel.org/stable/c/40a8f0d5e7b3999f096570edab71c345da812e3e", "https://nvd.nist.gov/vuln/detail/CVE-2021-47638"], "aliases": ["CVE-2021-47638"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "072c7fc2-3e49-326c-b94b-db64146ff31e", "product": {"name": "Linux"}, "product_version": "patch: 4.19.238"}, {"id": "1166d337-ccde-3d7d-a312-5c447266af0a", "product": {"name": "Linux"}, "product_version": "patch: 5.4.189"}, {"id": "12d4f3b2-6465-3d90-b52d-03c87ed41bcb", "product": {"name": "Linux"}, "product_version": "4.9"}, {"id": "3f6e63d7-7fbb-30ec-af1c-7ba1043fc087", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <2b3236ecf96db7af5836e1366ce39ace8ce832fa"}, {"id": "40269fe1-5076-32bf-868f-4364914ff9f1", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "47e9d71a-8c6b-3caf-aa81-c5cd44700e32", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <b9a937f096e608b3368c1abc920d4d640ba2c94f"}, {"id": "48385d18-e760-3e24-a5a2-3ad20f0cdd63", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}, {"id": "4ec07523-477b-3fb1-8f00-cb9dffcbffc9", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <14276d38c89a170363e90b6ac0a53c3cf61b87fc"}, {"id": "6b42e549-7a65-372a-9528-408aac656524", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <40a8f0d5e7b3999f096570edab71c345da812e3e"}, {"id": "a1a83c56-862c-3c0d-8c1f-7adb9d5ee74b", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "a692b26b-2b03-36c9-9efa-2236c6a2b201", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <a90e2dbe66d2647ff95a0442ad2e86482d977fd8"}, {"id": "af519bb5-affe-3d7e-85c6-0ed9c07181bb", "product": {"name": "Linux"}, "product_version": "patch: 4.14.276"}, {"id": "b413e95f-04a4-3ea3-a41e-f600b6a2e079", "product": {"name": "Linux"}, "product_version": "patch: 5.10.110"}, {"id": "b526c2b8-2d9d-3907-bbda-8fc3c76d8b8d", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <8b3c7be16f3f4dfd6e15ac651484e59d3fa36274"}, {"id": "b9d42efa-df8e-3129-89cd-fb9bdbfcef67", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <2ad07009c459e56ebdcc089d850d664660fdb742"}, {"id": "ba59a3a4-617a-38b0-919a-97e32dd0db02", "product": {"name": "Linux"}, "product_version": "9e0a1fff8db56eaaebb74b4a3ef65f86811c4798 <6d7a158a7363c1f6604aa47ae1a280a5c65123dd"}, {"id": "c4cfe77a-ccfc-3201-8679-b702616dcee9", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "dc023c62-e493-37f4-9282-812e868a0fa6", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}], "enisaIdVendor": [{"id": "7536089b-ec93-36ce-98b2-916f7a37c803", "vendor": {"name": "Linux"}}], "isExploited": false}