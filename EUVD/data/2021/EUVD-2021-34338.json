{"id": "EUVD-2021-34338", "enisaUuid": "e8470f2a-c00c-3464-bb6d-e27bcb91318c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmisc: alcor_pci: fix null-ptr-deref when there is no PCI bridge\n\nThere is an issue with the ASPM(optional) capability checking function.\nA device might be attached to root complex directly, in this case,\nbus->self(bridge) will be NULL, thus priv->parent_pdev is NULL.\nSince alcor_pci_init_check_aspm(priv->parent_pdev) checks the PCI link's\nASPM capability and populate parent_cap_off, which will be used later by\nalcor_pci_aspm_ctrl() to dynamically turn on/off device, what we can do\nhere is to avoid checking the capability if we are on the root complex.\nThis will make pdev_cap_off 0 and alcor_pci_aspm_ctrl() will simply\nreturn when bring called, effectively disable ASPM for the device.\n\n[    1.246492] BUG: kernel NULL pointer dereference, address: 00000000000000c0\n[    1.248731] RIP: 0010:pci_read_config_byte+0x5/0x40\n[    1.253998] Call Trace:\n[    1.254131]  ? alcor_pci_find_cap_offset.isra.0+0x3a/0x100 [alcor_pci]\n[    1.254476]  alcor_pci_probe+0x169/0x2d5 [alcor_pci]", "datePublished": "2024-05-21T14:35:43", "dateUpdated": "2025-12-18T11:36:55", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/d2639ffdcad463b358b6bef8645ff81715daffcb", "https://git.kernel.org/stable/c/58f69684ba03e5b0e0a3ae844a845280c0f06309", "https://git.kernel.org/stable/c/717cf5ae52322ddbdf3ac2c584b34c5970b0d174", "https://git.kernel.org/stable/c/09d154990ca82d14aed2b72796f6c8845e2e605d", "https://git.kernel.org/stable/c/3ce3e45cc333da707d4d6eb433574b990bcc26f5"], "aliases": ["CVE-2021-47333"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0006534f-7bf6-3d13-bc92-35b9b20053be", "product": {"name": "Linux"}, "product_version": "patch: 5.10.52"}, {"id": "4e6a851d-64c0-30a9-8844-e2f5e806dcea", "product": {"name": "Linux"}, "product_version": "4f556bc04e3c0de2f5c69adc9e9f2bcefcad079d <58f69684ba03e5b0e0a3ae844a845280c0f06309"}, {"id": "7f6c48ac-084c-3461-8a3f-bf319d57412f", "product": {"name": "Linux"}, "product_version": "4f556bc04e3c0de2f5c69adc9e9f2bcefcad079d <717cf5ae52322ddbdf3ac2c584b34c5970b0d174"}, {"id": "7f74166c-58d9-3015-bc40-b353a00e16a5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <58f69684ba03e5b0e0a3ae844a845280c0f06309"}, {"id": "80ec004f-085f-314f-a138-0b33338548e7", "product": {"name": "Linux"}, "product_version": "patch: 5.4.134"}, {"id": "95c59e23-9bc9-3eed-b123-04a868a6c582", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d2639ffdcad463b358b6bef8645ff81715daffcb"}, {"id": "95ff5352-1a50-3a3c-a1df-a77b46353e03", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <717cf5ae52322ddbdf3ac2c584b34c5970b0d174"}, {"id": "9720848a-4d31-3df5-bba4-53ef14b9d9d4", "product": {"name": "Linux"}, "product_version": "5.0"}, {"id": "9b704a8c-3a6e-346d-afbe-716ef2793d1a", "product": {"name": "Linux"}, "product_version": "patch: 5.14"}, {"id": "a2addf2b-220f-3045-8006-ad346e0ed4d6", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3ce3e45cc333da707d4d6eb433574b990bcc26f5"}, {"id": "a7e22fdd-1c48-3984-91b9-f0d51990acb2", "product": {"name": "Linux"}, "product_version": "patch: 5.12.19"}, {"id": "a9cb6b7c-a169-32f9-abed-0f24f6b999db", "product": {"name": "Linux"}, "product_version": "4f556bc04e3c0de2f5c69adc9e9f2bcefcad079d <3ce3e45cc333da707d4d6eb433574b990bcc26f5"}, {"id": "c1405aa2-db81-3e94-a505-abdd13792530", "product": {"name": "Linux"}, "product_version": "4f556bc04e3c0de2f5c69adc9e9f2bcefcad079d <d2639ffdcad463b358b6bef8645ff81715daffcb"}, {"id": "c45f91d9-144f-390f-93bc-b52262667024", "product": {"name": "Linux"}, "product_version": "4f556bc04e3c0de2f5c69adc9e9f2bcefcad079d <09d154990ca82d14aed2b72796f6c8845e2e605d"}, {"id": "e0d124dc-3288-34dc-a268-7bf72247f2a5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <09d154990ca82d14aed2b72796f6c8845e2e605d"}, {"id": "eb25b876-8373-3ed0-9578-199cbae1adc6", "product": {"name": "Linux"}, "product_version": "patch: 5.13.4"}, {"id": "fc4d8561-fff4-322f-97e3-99143d5419eb", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "57155ec3-246a-377d-85ff-aacc9b68ee0b", "vendor": {"name": "Linux"}}], "isExploited": false}