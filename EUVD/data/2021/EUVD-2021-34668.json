{"id": "EUVD-2021-34668", "enisaUuid": "7b992e7f-21f5-3fdb-85a8-10728fddb3e7", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nubifs: Fix read out-of-bounds in ubifs_wbuf_write_nolock()\n\nFunction ubifs_wbuf_write_nolock() may access buf out of bounds in\nfollowing process:\n\nubifs_wbuf_write_nolock():\n  aligned_len = ALIGN(len, 8);   // Assume len = 4089, aligned_len = 4096\n  if (aligned_len <= wbuf->avail) ... // Not satisfy\n  if (wbuf->used) {\n    ubifs_leb_write()  // Fill some data in avail wbuf\n    len -= wbuf->avail;   // len is still not 8-bytes aligned\n    aligned_len -= wbuf->avail;\n  }\n  n = aligned_len >> c->max_write_shift;\n  if (n) {\n    n <<= c->max_write_shift;\n    err = ubifs_leb_write(c, wbuf->lnum, buf + written,\n                          wbuf->offs, n);\n    // n > len, read out of bounds less than 8(n-len) bytes\n  }\n\n, which can be catched by KASAN:\n  =========================================================\n  BUG: KASAN: slab-out-of-bounds in ecc_sw_hamming_calculate+0x1dc/0x7d0\n  Read of size 4 at addr ffff888105594ff8 by task kworker/u8:4/128\n  Workqueue: writeback wb_workfn (flush-ubifs_0_0)\n  Call Trace:\n    kasan_report.cold+0x81/0x165\n    nand_write_page_swecc+0xa9/0x160\n    ubifs_leb_write+0xf2/0x1b0 [ubifs]\n    ubifs_wbuf_write_nolock+0x421/0x12c0 [ubifs]\n    write_head+0xdc/0x1c0 [ubifs]\n    ubifs_jnl_write_inode+0x627/0x960 [ubifs]\n    wb_workfn+0x8af/0xb80\n\nFunction ubifs_wbuf_write_nolock() accepts that parameter 'len' is not 8\nbytes aligned, the 'len' represents the true length of buf (which is\nallocated in 'ubifs_jnl_xxx', eg. ubifs_jnl_write_inode), so\nubifs_wbuf_write_nolock() must handle the length read from 'buf' carefully\nto write leb safely.\n\nFetch a reproducer in [Link].", "datePublished": "2025-02-26T01:54:10", "dateUpdated": "2025-10-01T19:57:08", "baseScore": 7.1, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H", "references": ["https://git.kernel.org/stable/c/5343575aa11c5d7044107d59d43f84aec01312b0", "https://git.kernel.org/stable/c/b80ccbec0e4804436c382d7dd60e943c386ed83a", "https://git.kernel.org/stable/c/07a209fadee7b53b46858538e1177597273862e4", "https://git.kernel.org/stable/c/a7054aaf1909cf40489c0ec1b728fdcf79c751a6", "https://git.kernel.org/stable/c/e09fa5318d51f522e1af4fbaf8f74999355980c8", "https://git.kernel.org/stable/c/3b7fb89135a20587d57f8877c02e25003e9edbdf", "https://git.kernel.org/stable/c/4f2262a334641e05f645364d5ade1f565c85f20b", "https://nvd.nist.gov/vuln/detail/CVE-2021-47636"], "aliases": ["CVE-2021-47636"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "09830822-0016-399c-94e5-9cc85bdbd4cb", "product": {"name": "Linux"}, "product_version": "patch: 5.10.110"}, {"id": "2044415f-585d-3cf4-9883-a144226debda", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <4f2262a334641e05f645364d5ade1f565c85f20b"}, {"id": "22cce2f7-2669-3b0e-89da-f5313e386c72", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <a7054aaf1909cf40489c0ec1b728fdcf79c751a6"}, {"id": "268a10e7-a531-3f01-a5b3-f9702e46805e", "product": {"name": "Linux"}, "product_version": "patch: 4.19.238"}, {"id": "47f8b0cf-b510-3285-a22a-b943d5bef02e", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <e09fa5318d51f522e1af4fbaf8f74999355980c8"}, {"id": "594933ab-0f2c-3d78-ae79-db756dc0d80f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5a444e39-2f2d-388c-b4a1-0684af062f1e", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <5343575aa11c5d7044107d59d43f84aec01312b0"}, {"id": "5f8f42fa-e502-3261-8059-23846f1a7aee", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <3b7fb89135a20587d57f8877c02e25003e9edbdf"}, {"id": "69c5c11e-a802-304a-87d8-578c02269155", "product": {"name": "Linux"}, "product_version": "patch: 5.16.19"}, {"id": "8330c917-d7eb-3b53-a0bc-bbd4ca79f743", "product": {"name": "Linux"}, "product_version": "patch: 5.17.2"}, {"id": "94dd2ece-d67e-33b6-8d43-f89917668871", "product": {"name": "Linux"}, "product_version": "patch: 5.15.33"}, {"id": "b6626c8e-67fe-3f51-98b6-9a0b22cfcd48", "product": {"name": "Linux"}, "product_version": "patch: 5.4.189"}, {"id": "db8be7fc-de68-316e-ba60-c9bd8057134c", "product": {"name": "Linux"}, "product_version": "patch: 5.18"}, {"id": "e76dc77b-c887-3fb1-9d30-31c73e349c95", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <07a209fadee7b53b46858538e1177597273862e4"}, {"id": "eb1dbfa7-acb6-3a5e-a328-1d2fb72de177", "product": {"name": "Linux"}, "product_version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d <b80ccbec0e4804436c382d7dd60e943c386ed83a"}, {"id": "f94a935f-258f-35a8-b427-8ce297e32c82", "product": {"name": "Linux"}, "product_version": "2.6.27"}], "enisaIdVendor": [{"id": "d0657082-924b-3e83-9338-2b67527a275f", "vendor": {"name": "Linux"}}], "isExploited": false}