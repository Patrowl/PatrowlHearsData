{"id": "EUVD-2021-2861", "enisaUuid": "ce659d17-a25b-3d4e-9a49-26ab53eb9592", "description": "A vulnerability due to the improper handling of direct memory access (DMA) buffers on EX4300 switches on Juniper Networks Junos OS allows an attacker sending specific unicast frames to trigger a Denial of Service (DoS) condition by exhausting DMA buffers, causing the FPC to crash and the device to restart. The DMA buffer leak is seen when receiving these specific, valid unicast frames on an interface without Layer 2 Protocol Tunneling (L2PT) or dot1x configured. Interfaces with either L2PT or dot1x configured are not vulnerable to this issue. When this issue occurs, DMA buffer usage keeps increasing and the following error log messages may be observed: Apr 14 14:29:34.360 /kernel: pid 64476 (pfex_junos), uid 0: exited on signal 11 (core dumped) Apr 14 14:29:33.790 init: pfe-manager (PID 64476) terminated by signal number 11. Core dumped! The DMA buffers on the FPC can be monitored by the executing vty command 'show heap': ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 4a46000 268435456 238230496 30204960 11 Kernel 1 18a46000 67108864 17618536 49490328 73 Bcm_sdk 2 23737000 117440512 18414552 99025960 84 DMA buf <<<<< keeps increasing 3 2a737000 16777216 16777216 0 0 DMA desc This issue affects Juniper Networks Junos OS on the EX4300: 17.3 versions prior to 17.3R3-S11; 17.4 versions prior to 17.4R2-S13, 17.4R3-S4; 18.1 versions prior to 18.1R3-S12; 18.2 versions prior to 18.2R2-S8, 18.2R3-S7; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R1-S8, 18.4R2-S7, 18.4R3-S7; 19.1 versions prior to 19.1R1-S6, 19.1R2-S2, 19.1R3-S4; 19.2 versions prior to 19.2R1-S6, 19.2R3-S2; 19.3 versions prior to 19.3R3-S2; 19.4 versions prior to 19.4R2-S3, 19.4R3-S1; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R2-S1, 20.2R3; 20.3 versions prior to 20.3R1-S1, 20.3R2.", "datePublished": "2021-04-22T19:37:07", "dateUpdated": "2024-09-17T03:22:28", "baseScore": 6.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "references": ["https://kb.juniper.net/JSA11135"], "aliases": ["CVE-2021-0242"], "assigner": "juniper", "epss": 0.08, "enisaIdProduct": [{"id": "0908e4c4-a8f9-3320-9b14-56838ef41f36", "product": {"name": "Junos OS"}, "product_version": "18.2 <18.2R2-S8, 18.2R3-S7"}, {"id": "54df75f4-5722-3ba1-94a4-c35f70c7694e", "product": {"name": "Junos OS"}, "product_version": "17.4 <17.4R2-S13, 17.4R3-S4"}, {"id": "57cde124-3558-39e4-ba32-99095c000883", "product": {"name": "Junos OS"}, "product_version": "19.3 <19.3R3-S2"}, {"id": "73800fe4-e916-3cd1-bba1-6324d5244a0d", "product": {"name": "Junos OS"}, "product_version": "20.1 <20.1R2"}, {"id": "8846381f-c9fe-3081-b621-b68f1f7afb69", "product": {"name": "Junos OS"}, "product_version": "17.3 <17.3R3-S11"}, {"id": "a2e796b0-65e8-3eda-91f7-3541050e1ecc", "product": {"name": "Junos OS"}, "product_version": "18.3 <18.3R3-S4"}, {"id": "aafeff3b-0b2b-3aa5-ae9f-c779df7490d5", "product": {"name": "Junos OS"}, "product_version": "20.2 <20.2R2-S1, 20.2R3"}, {"id": "ad01f1a0-d15e-3448-9500-aa599cb71696", "product": {"name": "Junos OS"}, "product_version": "19.1 <19.1R1-S6, 19.1R2-S2, 19.1R3-S4"}, {"id": "adbc80f8-b779-3566-8176-b8da5f84207d", "product": {"name": "Junos OS"}, "product_version": "19.4 <19.4R2-S3, 19.4R3-S1"}, {"id": "b5e3d3f6-b356-3fcb-852f-cf8ae4fd0520", "product": {"name": "Junos OS"}, "product_version": "19.2 <19.2R1-S6, 19.2R3-S2"}, {"id": "e04d063b-afaf-3324-ac08-6a33c96374f4", "product": {"name": "Junos OS"}, "product_version": "20.3 <20.3R1-S1, 20.3R2"}, {"id": "e170d074-4405-3a84-afe8-06693df8c49e", "product": {"name": "Junos OS"}, "product_version": "18.4 <18.4R1-S8, 18.4R2-S7, 18.4R3-S7"}, {"id": "e7f80241-c198-3a9e-a0e6-4fe906bb2821", "product": {"name": "Junos OS"}, "product_version": "18.1 <18.1R3-S12"}], "enisaIdVendor": [{"id": "7445f035-bce3-3c0a-88b0-4707f321442a", "vendor": {"name": "Juniper Networks"}}], "isExploited": false}