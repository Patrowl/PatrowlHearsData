{"id": "EUVD-2021-18906", "enisaUuid": "5a3a0eeb-b5fc-39bd-ac5e-c2c98eb774ce", "description": "It may be possible to have an extremely long aggregation pipeline in conjunction with a specific stage/operator and cause a stack overflow due to the size of the stack frames used by that stage. If an attacker could cause such an aggregation to occur, they could maliciously crash MongoDB in a DoS attack. This vulnerability affects MongoDB Server v4.4 versions prior to and including 4.4.28, MongoDB Server v5.0 versions prior to 5.0.4 and MongoDB Server v4.2 versions prior to 4.2.16.\n\nWorkaround:\u00a0>= v4.2.16 users and all v4.4 users can add the --setParameter internalPipelineLengthLimit=50 instead of the default 1000 to mongod at startup to prevent a crash.", "datePublished": "2022-04-12T14:15:16", "dateUpdated": "2024-09-16T20:03:21", "baseScore": 6.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://jira.mongodb.org/browse/SERVER-58203", "https://jira.mongodb.org/browse/SERVER-59299", "https://jira.mongodb.org/browse/SERVER-60218", "https://security.netapp.com/advisory/ntap-20220609-0005/"], "aliases": ["CVE-2021-32040"], "assigner": "mongodb", "epss": 0.7, "enisaIdProduct": [{"id": "51a20064-c1cf-3517-af7d-ffc919f12d93", "product": {"name": "MongoDB Server"}, "product_version": "4.4 \u22644.4.28"}, {"id": "88a8b389-f15f-3693-8dbb-0dc48cb6d382", "product": {"name": "MongoDB Server"}, "product_version": "4.2 <4.2.16"}, {"id": "91540e72-b2b7-3c52-b738-717a05c1dfcf", "product": {"name": "MongoDB Server"}, "product_version": "5.0 <5.0.4"}], "enisaIdVendor": [{"id": "f1c764bc-3de3-3c1d-b33c-9266ec85f468", "vendor": {"name": "MongoDB Inc."}}], "isExploited": false}