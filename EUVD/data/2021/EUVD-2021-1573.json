{"id": "EUVD-2021-1573", "enisaUuid": "3af6534b-2c13-37a5-857c-69a3f87f2d78", "description": "The npm package \"tar\" (aka node-tar) before versions 4.4.18, 5.0.10, and 6.1.9 has an arbitrary file creation/overwrite and arbitrary code execution vulnerability. node-tar aims to guarantee that any file whose location would be outside of the extraction target directory is not extracted. This is, in part, accomplished by sanitizing absolute paths of entries within the archive, skipping archive entries that contain `..` path portions, and resolving the sanitized paths against the extraction target directory. This logic was insufficient on Windows systems when extracting tar files that contained a path that was not an absolute path, but specified a drive letter different from the extraction target, such as `C:some\\path`. If the drive letter does not match the extraction target, for example `D:\\extraction\\dir`, then the result of `path.resolve(extractionDirectory, entryPath)` would resolve against the current working directory on the `C:` drive, rather than the extraction target directory. Additionally, a `..` portion of the path could occur immediately after the drive letter, such as `C:../foo`, and was not properly sanitized by the logic that checked for `..` within the normalized and split portions of the path. This only affects users of `node-tar` on Windows systems. These issues were addressed in releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar has been deprecated and did not receive patches for these issues. If you are still using a v3 release we recommend you update to a more recent version of node-tar. There is no reasonable way to work around this issue without performing the same path normalization procedures that node-tar now does. Users are encouraged to upgrade to the latest patched versions of node-tar, rather than attempt to sanitize paths themselves.", "datePublished": "2021-08-31T16:50:09", "dateUpdated": "2024-08-04T01:23:01", "baseScore": 8.2, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N", "references": ["https://github.com/npm/node-tar/security/advisories/GHSA-5955-9wpr-37jh", "https://nvd.nist.gov/vuln/detail/CVE-2021-37713", "https://github.com/isaacs/node-tar/commit/52b09e309bcae0c741a7eb79a17ef36e7828b946", "https://github.com/isaacs/node-tar/commit/82eac952f7c10765969ed464e549375854b26edc", "https://github.com/isaacs/node-tar/commit/875a37e3ec031186fc6599f6807341f56c584598", "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf", "https://github.com/npm/node-tar", "https://www.npmjs.com/package/tar", "https://www.oracle.com/security-alerts/cpuoct2021.html", "https://www.suse.com/security/cve/CVE-2021-37713.html", "https://advisories.mageia.org/CVE-2021-37713.html"], "aliases": ["CVE-2021-37713", "GHSA-5955-9wpr-37jh"], "assigner": "GitHub_M", "epss": 0.61, "enisaIdProduct": [{"id": "305db740-6380-37ad-a704-5f44a83c54e1", "product": {"name": "node-tar"}, "product_version": "5.0.0, < 5.0.10"}, {"id": "a52500aa-ede3-392b-abf1-d6a4d166988e", "product": {"name": "node-tar"}, "product_version": "6.0.0, < 6.1.9"}, {"id": "a955e32a-6d53-35da-a592-adadc8ffe3d9", "product": {"name": "node-tar"}, "product_version": "< 4.4.18"}], "enisaIdVendor": [{"id": "e76bca5c-39ad-3fcb-81ba-b4e7141763ce", "vendor": {"name": "npm"}}], "isExploited": false}