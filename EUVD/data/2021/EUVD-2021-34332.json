{"id": "EUVD-2021-34332", "enisaUuid": "67d2b583-8c7a-3519-9355-5a3549c3b9aa", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/arm-smmu: Fix arm_smmu_device refcount leak when arm_smmu_rpm_get fails\n\narm_smmu_rpm_get() invokes pm_runtime_get_sync(), which increases the\nrefcount of the \"smmu\" even though the return value is less than 0.\n\nThe reference counting issue happens in some error handling paths of\narm_smmu_rpm_get() in its caller functions. When arm_smmu_rpm_get()\nfails, the caller functions forget to decrease the refcount of \"smmu\"\nincreased by arm_smmu_rpm_get(), causing a refcount leak.\n\nFix this issue by calling pm_runtime_resume_and_get() instead of\npm_runtime_get_sync() in arm_smmu_rpm_get(), which can keep the refcount\nbalanced in case of failure.", "datePublished": "2024-05-21T14:35:39", "dateUpdated": "2025-12-18T11:36:47", "baseScore": 7.1, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H", "references": ["https://git.kernel.org/stable/c/3761ae0d0e549f2acdaf11f49df4ed06d256b20f", "https://git.kernel.org/stable/c/c4007596fbdabc29f858dc2e1990858a146b60b2", "https://git.kernel.org/stable/c/fbf4daa6f4105e01fbd3868006f65c163365c1e3", "https://git.kernel.org/stable/c/fe92c058199067ae90cf2a901ddf3c271893557a", "https://git.kernel.org/stable/c/1adf30f198c26539a62d761e45af72cde570413d"], "aliases": ["CVE-2021-47327"], "assigner": "Linux", "epss": 0.05, "enisaIdProduct": [{"id": "02fc261f-b4b1-39e5-8bc5-a6c7c9251051", "product": {"name": "Linux"}, "product_version": "5.0"}, {"id": "183d64da-05cc-3d5b-b553-1cf96b6862a2", "product": {"name": "Linux"}, "product_version": "d4a44f0750bb9bf7c44c22444a482756b2344a79 <1adf30f198c26539a62d761e45af72cde570413d"}, {"id": "1f08e4e9-a018-365b-8aff-d7a02c50b09d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c4007596fbdabc29f858dc2e1990858a146b60b2"}, {"id": "236a7729-4e25-3211-8417-2e581ff5a1f3", "product": {"name": "Linux"}, "product_version": "patch: 5.13.4"}, {"id": "3f349c96-a3a4-3b37-80a7-e6e4ca5ec668", "product": {"name": "Linux"}, "product_version": "patch: 5.12.19"}, {"id": "42156709-4163-3913-8f6f-601b0e135202", "product": {"name": "Linux"}, "product_version": "d4a44f0750bb9bf7c44c22444a482756b2344a79 <3761ae0d0e549f2acdaf11f49df4ed06d256b20f"}, {"id": "5a6e12df-fc65-3e46-b16b-ed660a6236da", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fbf4daa6f4105e01fbd3868006f65c163365c1e3"}, {"id": "5d9ffc87-75de-3fa9-a964-693511815975", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "6c5086e4-e0aa-305d-8bf1-7d125ffb5986", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3761ae0d0e549f2acdaf11f49df4ed06d256b20f"}, {"id": "7ca2c51f-7d48-3816-b824-ce3b0f212856", "product": {"name": "Linux"}, "product_version": "patch: 5.4.134"}, {"id": "7dad7306-d66f-31e1-8d59-d391633de2e6", "product": {"name": "Linux"}, "product_version": "d4a44f0750bb9bf7c44c22444a482756b2344a79 <fbf4daa6f4105e01fbd3868006f65c163365c1e3"}, {"id": "a0cf2bed-7ada-35ba-b579-f32f6c0ece84", "product": {"name": "Linux"}, "product_version": "patch: 5.14"}, {"id": "cd3f86ef-267b-3c72-a20d-b20500e1733d", "product": {"name": "Linux"}, "product_version": "d4a44f0750bb9bf7c44c22444a482756b2344a79 <c4007596fbdabc29f858dc2e1990858a146b60b2"}, {"id": "d70ef50c-06ba-3c63-93da-dc95ba717a3f", "product": {"name": "Linux"}, "product_version": "patch: 5.10.52"}, {"id": "df75ea2c-9b72-3ab9-a351-7dfd24b07b83", "product": {"name": "Linux"}, "product_version": "d4a44f0750bb9bf7c44c22444a482756b2344a79 <fe92c058199067ae90cf2a901ddf3c271893557a"}, {"id": "e5ca5bfe-8893-3a7e-8c47-59bcfb00476c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fe92c058199067ae90cf2a901ddf3c271893557a"}, {"id": "f377830d-f8b2-32a8-bb03-caafb0794779", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1adf30f198c26539a62d761e45af72cde570413d"}], "enisaIdVendor": [{"id": "79f64246-eb4f-3cb7-82fc-4fe93e9b07bd", "vendor": {"name": "Linux"}}], "isExploited": false}