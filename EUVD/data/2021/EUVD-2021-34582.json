{"id": "EUVD-2021-34582", "enisaUuid": "9b4f380b-9165-35a3-8831-dc751044f4f0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: scsi_debug: Fix type in min_t to avoid stack OOB\n\nChange min_t() to use type \"u32\" instead of type \"int\" to avoid stack out\nof bounds. With min_t() type \"int\" the values get sign extended and the\nlarger value gets used causing stack out of bounds.\n\nBUG: KASAN: stack-out-of-bounds in memcpy include/linux/fortify-string.h:191 [inline]\nBUG: KASAN: stack-out-of-bounds in sg_copy_buffer+0x1de/0x240 lib/scatterlist.c:976\nRead of size 127 at addr ffff888072607128 by task syz-executor.7/18707\n\nCPU: 1 PID: 18707 Comm: syz-executor.7 Not tainted 5.15.0-syzk #1\nHardware name: Red Hat KVM, BIOS 1.13.0-2\nCall Trace:\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x89/0xb5 lib/dump_stack.c:106\n print_address_description.constprop.9+0x28/0x160 mm/kasan/report.c:256\n __kasan_report mm/kasan/report.c:442 [inline]\n kasan_report.cold.14+0x7d/0x117 mm/kasan/report.c:459\n check_region_inline mm/kasan/generic.c:183 [inline]\n kasan_check_range+0x1a3/0x210 mm/kasan/generic.c:189\n memcpy+0x23/0x60 mm/kasan/shadow.c:65\n memcpy include/linux/fortify-string.h:191 [inline]\n sg_copy_buffer+0x1de/0x240 lib/scatterlist.c:976\n sg_copy_from_buffer+0x33/0x40 lib/scatterlist.c:1000\n fill_from_dev_buffer.part.34+0x82/0x130 drivers/scsi/scsi_debug.c:1162\n fill_from_dev_buffer drivers/scsi/scsi_debug.c:1888 [inline]\n resp_readcap16+0x365/0x3b0 drivers/scsi/scsi_debug.c:1887\n schedule_resp+0x4d8/0x1a70 drivers/scsi/scsi_debug.c:5478\n scsi_debug_queuecommand+0x8c9/0x1ec0 drivers/scsi/scsi_debug.c:7533\n scsi_dispatch_cmd drivers/scsi/scsi_lib.c:1520 [inline]\n scsi_queue_rq+0x16b0/0x2d40 drivers/scsi/scsi_lib.c:1699\n blk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1639\n __blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\n blk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n __blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1761\n __blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1838\n blk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\n blk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\n blk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:62\n sg_common_write.isra.18+0xeb3/0x2000 drivers/scsi/sg.c:836\n sg_new_write.isra.19+0x570/0x8c0 drivers/scsi/sg.c:774\n sg_ioctl_common+0x14d6/0x2710 drivers/scsi/sg.c:939\n sg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1165\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:874 [inline]\n __se_sys_ioctl fs/ioctl.c:860 [inline]\n __x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:860\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x3a/0x80 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x44/0xae", "datePublished": "2024-06-19T14:53:47", "dateUpdated": "2025-12-18T11:38:00", "baseScore": 6.6, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L", "references": ["https://git.kernel.org/stable/c/bdb854f134b964528fa543e0351022eb45bd7346", "https://git.kernel.org/stable/c/3085147645938eb41f0bc0e25ef9791e71f5ee4b", "https://git.kernel.org/stable/c/36e07d7ede88a1f1ef8f0f209af5b7612324ac2c"], "aliases": ["CVE-2021-47580"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2b09d532-0405-3af6-adf5-8660475ecf49", "product": {"name": "Linux"}, "product_version": "87c715dcde633f4cc4690a24a240e838181e6a9d <bdb854f134b964528fa543e0351022eb45bd7346"}, {"id": "2e7d46d7-0126-3e31-9738-7d284c7f11ea", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3085147645938eb41f0bc0e25ef9791e71f5ee4b"}, {"id": "344c6be6-e1fc-32f3-8207-2f6bcf33789e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <36e07d7ede88a1f1ef8f0f209af5b7612324ac2c"}, {"id": "37b13af5-6770-313a-9e3c-c7edd789b104", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "64186d5a-5135-3425-8aa2-e8ef1cae012d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.11"}, {"id": "644c1812-46b0-3a5d-86ad-016601b06815", "product": {"name": "Linux"}, "product_version": "patch: 5.10.88"}, {"id": "77be93f8-3341-368a-bd43-56dc34e25e30", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "99fa3d61-fe69-3f0d-9fbe-b7b28faed00b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bdb854f134b964528fa543e0351022eb45bd7346"}, {"id": "b22fa3b7-9ffa-3092-92d3-44345ce8433e", "product": {"name": "Linux"}, "product_version": "87c715dcde633f4cc4690a24a240e838181e6a9d <3085147645938eb41f0bc0e25ef9791e71f5ee4b"}, {"id": "cb63c635-3df4-3965-9596-66436c2c47d9", "product": {"name": "Linux"}, "product_version": "87c715dcde633f4cc4690a24a240e838181e6a9d <36e07d7ede88a1f1ef8f0f209af5b7612324ac2c"}, {"id": "d62dd4c2-a686-307f-9565-3d56e4557a3d", "product": {"name": "Linux"}, "product_version": "patch: 5.16"}], "enisaIdVendor": [{"id": "4b91662f-f5c3-3c4b-a727-071b09ff8f99", "vendor": {"name": "Linux"}}], "isExploited": false}