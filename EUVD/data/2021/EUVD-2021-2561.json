{"id": "EUVD-2021-2561", "enisaUuid": "3bdee8ce-5b7d-303c-9288-bcdc8ccac948", "description": "Jackalope Doctrine-DBAL is an implementation of the PHP Content Repository API (PHPCR) using a relational database to persist data. In affected versions users can provoke SQL injections if they can specify a node name or query. Upgrade to version 1.7.4 to resolve this issue. If that is not possible, you can escape all places where `$property` is used to filter `sv:name` in the class `Jackalope\\Transport\\DoctrineDBAL\\Query\\QOMWalker`: `XPath::escape($property)`. Node names and xpaths can contain `\"` or `;` according to the JCR specification. The jackalope component that translates the query object model into doctrine dbal queries does not properly escape the names and paths, so that a accordingly crafted node name can lead to an SQL injection. If queries are never done from user input, or if you validate the user input to not contain `;`, you are not affected.", "datePublished": "2021-12-13T19:50:11", "dateUpdated": "2024-08-04T04:03:08", "baseScore": 8.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H", "references": ["https://github.com/jackalope/jackalope-doctrine-dbal/security/advisories/GHSA-ph98-v78f-jqrm", "https://nvd.nist.gov/vuln/detail/CVE-2021-43822", "https://github.com/jackalope/jackalope-doctrine-dbal/commit/9d179a36d320330ddb303ea3a7c98d3a33d231db", "https://github.com/jackalope/jackalope-doctrine-dbal"], "aliases": ["CVE-2021-43822", "GHSA-ph98-v78f-jqrm"], "assigner": "GitHub_M", "epss": 0.24, "enisaIdProduct": [{"id": "9ebcbd71-f230-396f-9c90-ecbbf6d6b497", "product": {"name": "jackalope-doctrine-dbal"}, "product_version": "< 1.7.4"}], "enisaIdVendor": [{"id": "19208047-37d0-362f-888d-c8bc21d6a80a", "vendor": {"name": "jackalope"}}], "isExploited": false}