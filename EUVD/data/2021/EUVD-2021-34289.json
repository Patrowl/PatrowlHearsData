{"id": "EUVD-2021-34289", "enisaUuid": "179fc6ad-0639-38a6-989a-32d7f3afe5b3", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nisdn: mISDN: netjet: Fix crash in nj_probe:\n\n'nj_setup' in netjet.c might fail with -EIO and in this case\n'card->irq' is initialized and is bigger than zero. A subsequent call to\n'nj_release' will free the irq that has not been requested.\n\nFix this bug by deleting the previous assignment to 'card->irq' and just\nkeep the assignment before 'request_irq'.\n\nThe KASAN's log reveals it:\n\n[    3.354615 ] WARNING: CPU: 0 PID: 1 at kernel/irq/manage.c:1826\nfree_irq+0x100/0x480\n[    3.355112 ] Modules linked in:\n[    3.355310 ] CPU: 0 PID: 1 Comm: swapper/0 Not tainted\n5.13.0-rc1-00144-g25a1298726e #13\n[    3.355816 ] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS\nrel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014\n[    3.356552 ] RIP: 0010:free_irq+0x100/0x480\n[    3.356820 ] Code: 6e 08 74 6f 4d 89 f4 e8 5e ac 09 00 4d 8b 74 24 18\n4d 85 f6 75 e3 e8 4f ac 09 00 8b 75 c8 48 c7 c7 78 c1 2e 85 e8 e0 cf f5\nff <0f> 0b 48 8b 75 c0 4c 89 ff e8 72 33 0b 03 48 8b 43 40 4c 8b a0 80\n[    3.358012 ] RSP: 0000:ffffc90000017b48 EFLAGS: 00010082\n[    3.358357 ] RAX: 0000000000000000 RBX: ffff888104dc8000 RCX:\n0000000000000000\n[    3.358814 ] RDX: ffff8881003c8000 RSI: ffffffff8124a9e6 RDI:\n00000000ffffffff\n[    3.359272 ] RBP: ffffc90000017b88 R08: 0000000000000000 R09:\n0000000000000000\n[    3.359732 ] R10: ffffc900000179f0 R11: 0000000000001d04 R12:\n0000000000000000\n[    3.360195 ] R13: ffff888107dc6000 R14: ffff888107dc6928 R15:\nffff888104dc80a8\n[    3.360652 ] FS:  0000000000000000(0000) GS:ffff88817bc00000(0000)\nknlGS:0000000000000000\n[    3.361170 ] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[    3.361538 ] CR2: 0000000000000000 CR3: 000000000582e000 CR4:\n00000000000006f0\n[    3.362003 ] DR0: 0000000000000000 DR1: 0000000000000000 DR2:\n0000000000000000\n[    3.362175 ] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7:\n0000000000000400\n[    3.362175 ] Call Trace:\n[    3.362175 ]  nj_release+0x51/0x1e0\n[    3.362175 ]  nj_probe+0x450/0x950\n[    3.362175 ]  ? pci_device_remove+0x110/0x110\n[    3.362175 ]  local_pci_probe+0x45/0xa0\n[    3.362175 ]  pci_device_probe+0x12b/0x1d0\n[    3.362175 ]  really_probe+0x2a9/0x610\n[    3.362175 ]  driver_probe_device+0x90/0x1d0\n[    3.362175 ]  ? mutex_lock_nested+0x1b/0x20\n[    3.362175 ]  device_driver_attach+0x68/0x70\n[    3.362175 ]  __driver_attach+0x124/0x1b0\n[    3.362175 ]  ? device_driver_attach+0x70/0x70\n[    3.362175 ]  bus_for_each_dev+0xbb/0x110\n[    3.362175 ]  ? rdinit_setup+0x45/0x45\n[    3.362175 ]  driver_attach+0x27/0x30\n[    3.362175 ]  bus_add_driver+0x1eb/0x2a0\n[    3.362175 ]  driver_register+0xa9/0x180\n[    3.362175 ]  __pci_register_driver+0x82/0x90\n[    3.362175 ]  ? w6692_init+0x38/0x38\n[    3.362175 ]  nj_init+0x36/0x38\n[    3.362175 ]  do_one_initcall+0x7f/0x3d0\n[    3.362175 ]  ? rdinit_setup+0x45/0x45\n[    3.362175 ]  ? rcu_read_lock_sched_held+0x4f/0x80\n[    3.362175 ]  kernel_init_freeable+0x2aa/0x301\n[    3.362175 ]  ? rest_init+0x2c0/0x2c0\n[    3.362175 ]  kernel_init+0x18/0x190\n[    3.362175 ]  ? rest_init+0x2c0/0x2c0\n[    3.362175 ]  ? rest_init+0x2c0/0x2c0\n[    3.362175 ]  ret_from_fork+0x1f/0x30\n[    3.362175 ] Kernel panic - not syncing: panic_on_warn set ...\n[    3.362175 ] CPU: 0 PID: 1 Comm: swapper/0 Not tainted\n5.13.0-rc1-00144-g25a1298726e #13\n[    3.362175 ] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS\nrel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014\n[    3.362175 ] Call Trace:\n[    3.362175 ]  dump_stack+0xba/0xf5\n[    3.362175 ]  ? free_irq+0x100/0x480\n[    3.362175 ]  panic+0x15a/0x3f2\n[    3.362175 ]  ? __warn+0xf2/0x150\n[    3.362175 ]  ? free_irq+0x100/0x480\n[    3.362175 ]  __warn+0x108/0x150\n[    3.362175 ]  ? free_irq+0x100/0x480\n[    3.362175 ]  report_bug+0x119/0x1c0\n[    3.362175 ]  handle_bug+0x3b/0x80\n[    3.362175 ]  exc_invalid_op+0x18/0x70\n[    3.362175 ]  asm_exc_invalid_op+0x12/0x20\n[    3.362175 ] RIP: 0010:free_irq+0x100\n---truncated---", "datePublished": "2024-05-21T14:20:09", "dateUpdated": "2025-12-18T11:36:30", "baseScore": 4.7, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H", "references": ["https://git.kernel.org/stable/c/958cb1078ca60d214826fd90a0961a447fade59a", "https://git.kernel.org/stable/c/4c1fcb6ec964b44edbf84235134582a5ffae1521", "https://git.kernel.org/stable/c/a0a37e4454ca1c0b424edc2c9c2487c2c46a1be6", "https://git.kernel.org/stable/c/bf78e25bd3f487208e042c67c8a31706c2dba265", "https://git.kernel.org/stable/c/9d7d4649dc1c53acf76df260fd519db698ed20d7", "https://git.kernel.org/stable/c/143fc7220961220eecc04669e5909af8847bf8c8", "https://git.kernel.org/stable/c/6249193e03709ea625e10706ecaf17fea0427d3d", "https://git.kernel.org/stable/c/9f6f852550d0e1b7735651228116ae9d300f69b3"], "aliases": ["CVE-2021-47284"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "1b235ddb-caff-384f-aea9-688bf8ba5585", "product": {"name": "Linux"}, "product_version": "patch: 4.4.273"}, {"id": "24e01596-c7f9-3b7f-822c-139cf452c01e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9d7d4649dc1c53acf76df260fd519db698ed20d7"}, {"id": "2d71953e-f697-307a-b415-cac38d40b047", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <a0a37e4454ca1c0b424edc2c9c2487c2c46a1be6"}, {"id": "31fa39f1-00ae-3c47-9ccb-75839dba708e", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <bf78e25bd3f487208e042c67c8a31706c2dba265"}, {"id": "380487b3-1eb7-38da-9b20-b2c821ca3803", "product": {"name": "Linux"}, "product_version": "2.6.32"}, {"id": "481e7527-1938-322f-801c-9b04a9d18028", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <143fc7220961220eecc04669e5909af8847bf8c8"}, {"id": "49007718-47ff-32ec-83b2-a56284a31a4c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6249193e03709ea625e10706ecaf17fea0427d3d"}, {"id": "497d0722-5cc3-31d0-ad38-570fbe7640c7", "product": {"name": "Linux"}, "product_version": "patch: 5.12.11"}, {"id": "559a2f61-96f2-3c4e-be3e-e4101c374f20", "product": {"name": "Linux"}, "product_version": "patch: 5.13"}, {"id": "55e598cb-7823-34d2-a209-10977b912d6f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5677df57-7ef9-3cfd-a6c4-74e6a8b3a65f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bf78e25bd3f487208e042c67c8a31706c2dba265"}, {"id": "69f10015-f07d-3054-b066-a1794b6df037", "product": {"name": "Linux"}, "product_version": "patch: 5.10.44"}, {"id": "6bf7cbe4-a409-348a-838e-964a2e7cc79b", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <9f6f852550d0e1b7735651228116ae9d300f69b3"}, {"id": "7515de67-98ee-3982-b61f-f4975e9a63af", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <143fc7220961220eecc04669e5909af8847bf8c8"}, {"id": "754ea132-29a6-347b-853c-0c63ec0f50ad", "product": {"name": "Linux"}, "product_version": "patch: 4.14.237"}, {"id": "7b0e2efa-a923-3eeb-bbc6-22fc2a43039d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4c1fcb6ec964b44edbf84235134582a5ffae1521"}, {"id": "8967c558-d5c6-32a5-8fc7-db54d37885ed", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a0a37e4454ca1c0b424edc2c9c2487c2c46a1be6"}, {"id": "8a1b05ec-6ffa-3178-ac08-71be274a1f2d", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <9d7d4649dc1c53acf76df260fd519db698ed20d7"}, {"id": "9b0c739a-313d-3326-bfe2-3d35a25de032", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <958cb1078ca60d214826fd90a0961a447fade59a"}, {"id": "b0b30d43-220c-3f99-a59e-56cda1ed075d", "product": {"name": "Linux"}, "product_version": "patch: 5.4.126"}, {"id": "c7d67d5a-ef61-3ee0-a331-45d72eb2aacd", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <6249193e03709ea625e10706ecaf17fea0427d3d"}, {"id": "df722e12-e1e2-39c7-aa42-7ef2f1042c3a", "product": {"name": "Linux"}, "product_version": "patch: 4.19.195"}, {"id": "e36fc4b8-c745-37f6-a39c-5300e8150bf6", "product": {"name": "Linux"}, "product_version": "a900845e56617edc005fd8f35bfd5a407aaf96c8 <4c1fcb6ec964b44edbf84235134582a5ffae1521"}, {"id": "eafc2681-1194-39bb-bd97-9862e9f1eecb", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9f6f852550d0e1b7735651228116ae9d300f69b3"}, {"id": "fdc5171b-f8ca-3849-961b-f4a5bb7272dc", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <958cb1078ca60d214826fd90a0961a447fade59a"}, {"id": "ffad98ee-3ffb-3b33-b94c-af3c1e89d49a", "product": {"name": "Linux"}, "product_version": "patch: 4.9.273"}], "enisaIdVendor": [{"id": "02e2b9b5-c68a-36b4-9e6a-76be115970a2", "vendor": {"name": "Linux"}}], "isExploited": false}