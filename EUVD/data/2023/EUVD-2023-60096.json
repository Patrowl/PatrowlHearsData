{"id": "EUVD-2023-60096", "enisaUuid": "1cd0f1a8-d87b-3e00-bd69-33ffc8966ca0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblk-mq: release crypto keyslot before reporting I/O complete\n\nOnce all I/O using a blk_crypto_key has completed, filesystems can call\nblk_crypto_evict_key().  However, the block layer currently doesn't call\nblk_crypto_put_keyslot() until the request is being freed, which happens\nafter upper layers have been told (via bio_endio()) the I/O has\ncompleted.  This causes a race condition where blk_crypto_evict_key()\ncan see 'slot_refs != 0' without there being an actual bug.\n\nThis makes __blk_crypto_evict_key() hit the\n'WARN_ON_ONCE(atomic_read(&slot->slot_refs) != 0)' and return without\ndoing anything, eventually causing a use-after-free in\nblk_crypto_reprogram_all_keys().  (This is a very rare bug and has only\nbeen seen when per-file keys are being used with fscrypt.)\n\nThere are two options to fix this: either release the keyslot before\nbio_endio() is called on the request's last bio, or make\n__blk_crypto_evict_key() ignore slot_refs.  Let's go with the first\nsolution, since it preserves the ability to report bugs (via\nWARN_ON_ONCE) where a key is evicted while still in-use.", "datePublished": "2025-12-09T03:31:11", "dateUpdated": "2025-12-09T03:31:11", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/874bdf43b4a7dc5463c31508f62b3e42eb237b08", "https://git.kernel.org/stable/c/d206f79d9cd658665b37ce8134c6ec849ac7af0c", "https://git.kernel.org/stable/c/7d206ec7a04e8545828191b6ea8b49d3ea61391f", "https://git.kernel.org/stable/c/b278570e2c59d538216f8b656e97680188a8fba4", "https://git.kernel.org/stable/c/92d5d233b9ff531cf9cc36ab4251779e07adb633", "https://git.kernel.org/stable/c/9cd1e566676bbcb8a126acd921e4e194e6339603", "https://nvd.nist.gov/vuln/detail/CVE-2023-53810"], "aliases": ["CVE-2023-53810"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "27e911da-0da9-30cd-bcab-f7c6acfd8df0", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <b278570e2c59d538216f8b656e97680188a8fba4"}, {"id": "33cc9c1d-a610-37b1-ba1b-f6d2f8c760cd", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <d206f79d9cd658665b37ce8134c6ec849ac7af0c"}, {"id": "55926deb-5895-3e6b-81d4-1089adad960a", "product": {"name": "Linux"}, "product_version": "patch: 6.2.15"}, {"id": "5c4bb2dc-0cf3-3642-9af6-f765cc08d759", "product": {"name": "Linux"}, "product_version": "patch: 6.1.28"}, {"id": "7b19647e-5881-34c6-b6bf-ecd91f00d4c3", "product": {"name": "Linux"}, "product_version": "patch: 5.10.180"}, {"id": "80018fee-cba9-318f-b008-9bb00ecde22f", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <874bdf43b4a7dc5463c31508f62b3e42eb237b08"}, {"id": "9209c9f9-51d1-3a03-b7d3-0661537d3301", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "949fe658-e7f5-3906-9edb-af10620eda6d", "product": {"name": "Linux"}, "product_version": "patch: 5.15.111"}, {"id": "baea6ef7-ada0-38ca-bf5c-2250e15d93d0", "product": {"name": "Linux"}, "product_version": "patch: 6.3.2"}, {"id": "d26e9b83-3dc0-3896-b818-124c66e60c52", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d652d6ce-00d6-33a9-b7f0-6f8774206376", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <7d206ec7a04e8545828191b6ea8b49d3ea61391f"}, {"id": "f5d3817e-107d-3e14-a094-94dd5d0ea4ad", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <9cd1e566676bbcb8a126acd921e4e194e6339603"}, {"id": "f676c783-defb-3616-9754-0a790b9c7692", "product": {"name": "Linux"}, "product_version": "a892c8d52c02284076fbbacae6692aa5c5807d11 <92d5d233b9ff531cf9cc36ab4251779e07adb633"}, {"id": "ff012ec3-c1b6-3b48-a9e3-c877909b7a72", "product": {"name": "Linux"}, "product_version": "5.8"}], "enisaIdVendor": [{"id": "98f6bbff-0cb1-3102-b54c-37b87eded8d5", "vendor": {"name": "Linux"}}], "isExploited": false}