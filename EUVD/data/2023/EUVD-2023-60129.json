{"id": "EUVD-2023-60129", "enisaUuid": "b3df7a4e-ae56-3777-8854-aa898fc42a86", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: kill hooked chains to avoid loops on deduplicated compressed images\n\nAfter heavily stressing EROFS with several images which include a\nhand-crafted image of repeated patterns for more than 46 days, I found\ntwo chains could be linked with each other almost simultaneously and\nform a loop so that the entire loop won't be submitted.  As a\nconsequence, the corresponding file pages will remain locked forever.\n\nIt can be _only_ observed on data-deduplicated compressed images.\nFor example, consider two chains with five pclusters in total:\n\tChain 1:  2->3->4->5    -- The tail pcluster is 5;\n        Chain 2:  5->1->2       -- The tail pcluster is 2.\n\nChain 2 could link to Chain 1 with pcluster 5; and Chain 1 could link\nto Chain 2 at the same time with pcluster 2.\n\nSince hooked chains are all linked locklessly now, I have no idea how\nto simply avoid the race.  Instead, let's avoid hooked chains completely\nuntil I could work out a proper way to fix this and end users finally\ntell us that it's needed to add it back.\n\nActually, this optimization can be found with multi-threaded workloads\n(especially even more often on deduplicated compressed images), yet I'm\nnot sure about the overall system impacts of not having this compared\nwith implementation complexity.", "datePublished": "2025-12-09T03:31:09", "dateUpdated": "2025-12-09T03:31:10", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/d3b39ea24835ac03da1a30f93ae7c05d55a40191", "https://git.kernel.org/stable/c/b5b0d52f00e4bacb0ebdf47cd7016b0485fffad2", "https://git.kernel.org/stable/c/10c2b98a40d9044a3e97f4697ca6213bad7e19c2", "https://git.kernel.org/stable/c/967c28b23f6c89bb8eef6a046ea88afe0d7c1029", "https://nvd.nist.gov/vuln/detail/CVE-2023-53777"], "aliases": ["CVE-2023-53777"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0c8308fb-39af-3e22-b365-f9d51796ad6f", "product": {"name": "Linux"}, "product_version": "267f2492c8f71dac44399988b510f9bf6b074a51 <967c28b23f6c89bb8eef6a046ea88afe0d7c1029"}, {"id": "2f7afaac-4e21-316c-a77b-5ec3d9dbedb1", "product": {"name": "Linux"}, "product_version": "267f2492c8f71dac44399988b510f9bf6b074a51 <d3b39ea24835ac03da1a30f93ae7c05d55a40191"}, {"id": "3db3e9c8-9c4d-36b1-b050-031bbe33815e", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "61cb522d-6743-3d45-a33d-5665ffc23fe0", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "adabb8c7-8986-3862-af64-ff78cba6671c", "product": {"name": "Linux"}, "product_version": "patch: 6.1.39"}, {"id": "b61edf9f-40da-3fd6-96bc-a0cd23011b7e", "product": {"name": "Linux"}, "product_version": "patch: 6.4.4"}, {"id": "d48012c4-ad51-3896-8742-d795da1be442", "product": {"name": "Linux"}, "product_version": "patch: 6.3.13"}, {"id": "d61cf8f0-890f-3e1f-a330-ba855bc1b908", "product": {"name": "Linux"}, "product_version": "267f2492c8f71dac44399988b510f9bf6b074a51 <b5b0d52f00e4bacb0ebdf47cd7016b0485fffad2"}, {"id": "e24204a5-c99f-3900-b239-aa6e252f1522", "product": {"name": "Linux"}, "product_version": "6.0"}, {"id": "e3091064-13e8-394b-ad04-6004e20d6609", "product": {"name": "Linux"}, "product_version": "267f2492c8f71dac44399988b510f9bf6b074a51 <10c2b98a40d9044a3e97f4697ca6213bad7e19c2"}], "enisaIdVendor": [{"id": "610a3e92-d671-3119-b463-52126c56809f", "vendor": {"name": "Linux"}}], "isExploited": false}