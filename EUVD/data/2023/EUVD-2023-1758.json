{"id": "EUVD-2023-1758", "enisaUuid": "7a16bf19-99dd-326d-8f9f-e91785cad289", "description": "Grav is a flat-file content management system. Prior to version 1.7.42, there is a logic flaw in the `GravExtension.filterFilter()` function whereby validation against a denylist of unsafe functions is only performed when the argument passed to filter is a string. However, passing an array as a callable argument allows the validation check to be skipped. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. The vulnerability can be found in the `GravExtension.filterFilter()` function declared in `/system/src/Grav/Common/Twig/Extension/GravExtension.php`. Version 1.7.42 contains a patch for this issue. End users should also ensure that `twig.undefined_functions` and `twig.undefined_filters` properties in `/path/to/webroot/system/config/system.yaml` configuration file are set to `false` to disallow Twig from treating undefined filters/functions as PHP functions and executing them.", "datePublished": "2023-06-14T21:38:48", "dateUpdated": "2024-12-18T19:03:09", "baseScore": 8.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "references": ["https://github.com/getgrav/grav/security/advisories/GHSA-96xv-rmwj-6p9w", "https://nvd.nist.gov/vuln/detail/CVE-2023-34252", "https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec", "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b", "https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8", "https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5", "https://github.com/getgrav/grav", "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Twig/Extension/GravExtension.php#L1692-L1698", "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1956-L2074"], "aliases": ["CVE-2023-34252", "GHSA-96xv-rmwj-6p9w"], "assigner": "GitHub_M", "epss": 0.35, "enisaIdProduct": [{"id": "482a46b5-8007-3a6c-8e58-a4539c1f40f3", "product": {"name": "grav"}, "product_version": "< 1.7.42"}], "enisaIdVendor": [{"id": "7c93f768-a9cd-395f-b9e2-724b6f2aece2", "vendor": {"name": "getgrav"}}], "isExploited": false}