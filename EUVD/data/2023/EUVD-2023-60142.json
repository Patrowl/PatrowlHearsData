{"id": "EUVD-2023-60142", "enisaUuid": "26ab9bc1-411d-3f68-8fa3-473b1ce9781d", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nASoC: mediatek: mt8186: Fix use-after-free in driver remove path\n\nWhen devm runs function in the \"remove\" path for a device it runs them\nin the reverse order. That means that if you have parts of your driver\nthat aren't using devm or are using \"roll your own\" devm w/\ndevm_add_action_or_reset() you need to keep that in mind.\n\nThe mt8186 audio driver didn't quite get this right. Specifically, in\nmt8186_init_clock() it called mt8186_audsys_clk_register() and then\nwent on to call a bunch of other devm function. The caller of\nmt8186_init_clock() used devm_add_action_or_reset() to call\nmt8186_deinit_clock() but, because of the intervening devm functions,\nthe order was wrong.\n\nSpecifically at probe time, the order was:\n1. mt8186_audsys_clk_register()\n2. afe_priv->clk = devm_kcalloc(...)\n3. afe_priv->clk[i] = devm_clk_get(...)\n\nAt remove time, the order (which should have been 3, 2, 1) was:\n1. mt8186_audsys_clk_unregister()\n3. Free all of afe_priv->clk[i]\n2. Free afe_priv->clk\n\nThe above seemed to be causing a use-after-free. Luckily, it's easy to\nfix this by simply using devm more correctly. Let's move the\ndevm_add_action_or_reset() to the right place. In addition to fixing\nthe use-after-free, code inspection shows that this fixes a leak\n(missing call to mt8186_audsys_clk_unregister()) that would have\nhappened if any of the syscon_regmap_lookup_by_phandle() calls in\nmt8186_init_clock() had failed.", "datePublished": "2025-12-09T18:30:34", "dateUpdated": "2025-12-09T18:30:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3e56a1c04882852e3e7d6c59756a16211ebbc457", "https://git.kernel.org/stable/c/dffd9e2b57cb845930fa885aa634a847ba2130dd", "https://git.kernel.org/stable/c/a93d2afd3f77a7331271a0f25c6a11003db69b3c", "https://nvd.nist.gov/vuln/detail/CVE-2023-53854"], "aliases": ["CVE-2023-53854"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "289cb16f-6e21-35b7-bea8-f596f2c522eb", "product": {"name": "Linux"}, "product_version": "patch: 6.1.30"}, {"id": "3ec8c958-9f6d-3fa3-99f1-75d6f55f71f6", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "4fd8f5b6-ae86-306a-b16d-0a3ef0d15631", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "775f1546-5c90-39cd-a976-38679d361e74", "product": {"name": "Linux"}, "product_version": "55b423d5623ccd6785429431c2cf5f3e073b73ba <3e56a1c04882852e3e7d6c59756a16211ebbc457"}, {"id": "864b66ae-3fcc-327f-b07c-46e90a2b6cdd", "product": {"name": "Linux"}, "product_version": "patch: 6.3.4"}, {"id": "8eb4fdc1-c53e-3f8f-a059-24f685e2bcdf", "product": {"name": "Linux"}, "product_version": "6.0"}, {"id": "c4629015-1068-3fe9-812e-9ea90536c085", "product": {"name": "Linux"}, "product_version": "55b423d5623ccd6785429431c2cf5f3e073b73ba <a93d2afd3f77a7331271a0f25c6a11003db69b3c"}, {"id": "dda54f41-e6ac-33b6-8b84-b8134fe7f2bc", "product": {"name": "Linux"}, "product_version": "55b423d5623ccd6785429431c2cf5f3e073b73ba <dffd9e2b57cb845930fa885aa634a847ba2130dd"}], "enisaIdVendor": [{"id": "e59109a1-a264-3c20-ab55-41abfb393c31", "vendor": {"name": "Linux"}}], "isExploited": false}