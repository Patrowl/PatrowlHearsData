{"id": "EUVD-2023-60072", "enisaUuid": "2c6b460f-46af-3158-8cf3-e23d87622a06", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: VMX: Fix crash due to uninitialized current_vmcs\n\nKVM enables 'Enlightened VMCS' and 'Enlightened MSR Bitmap' when running as\na nested hypervisor on top of Hyper-V. When MSR bitmap is updated,\nevmcs_touch_msr_bitmap function uses current_vmcs per-cpu variable to mark\nthat the msr bitmap was changed.\n\nvmx_vcpu_create() modifies the msr bitmap via vmx_disable_intercept_for_msr\n-> vmx_msr_bitmap_l01_changed which in the end calls this function. The\nfunction checks for current_vmcs if it is null but the check is\ninsufficient because current_vmcs is not initialized. Because of this, the\ncode might incorrectly write to the structure pointed by current_vmcs value\nleft by another task. Preemption is not disabled, the current task can be\npreempted and moved to another CPU while current_vmcs is accessed multiple\ntimes from evmcs_touch_msr_bitmap() which leads to crash.\n\nThe manipulation of MSR bitmaps by callers happens only for vmcs01 so the\nsolution is to use vmx->vmcs01.vmcs instead of current_vmcs.\n\n  BUG: kernel NULL pointer dereference, address: 0000000000000338\n  PGD 4e1775067 P4D 0\n  Oops: 0002 [#1] PREEMPT SMP NOPTI\n  ...\n  RIP: 0010:vmx_msr_bitmap_l01_changed+0x39/0x50 [kvm_intel]\n  ...\n  Call Trace:\n   vmx_disable_intercept_for_msr+0x36/0x260 [kvm_intel]\n   vmx_vcpu_create+0xe6/0x540 [kvm_intel]\n   kvm_arch_vcpu_create+0x1d1/0x2e0 [kvm]\n   kvm_vm_ioctl_create_vcpu+0x178/0x430 [kvm]\n   kvm_vm_ioctl+0x53f/0x790 [kvm]\n   __x64_sys_ioctl+0x8a/0xc0\n   do_syscall_64+0x5c/0x90\n   entry_SYSCALL_64_after_hwframe+0x63/0xcd", "datePublished": "2025-12-08T03:31:03", "dateUpdated": "2025-12-08T03:31:03", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/6baebcecf09acd19e2bab1c2911dcdba5d48a1dc", "https://git.kernel.org/stable/c/6e7bc50f97c9855da83f1478f722590defd45ff2", "https://git.kernel.org/stable/c/b2de2b4d4e007f9add46ea8dc06f781835e3ea9f", "https://git.kernel.org/stable/c/3ba95cc671c025d0d2a1c7d5e2930f0ff0980cf4", "https://git.kernel.org/stable/c/93827a0a36396f2fd6368a54a020f420c8916e9b", "https://nvd.nist.gov/vuln/detail/CVE-2023-53756"], "aliases": ["CVE-2023-53756"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "02e76cd3-5449-38c2-9bf4-00da7e53d69f", "product": {"name": "Linux"}, "product_version": "patch: 5.10.175"}, {"id": "2522cfbf-3fc2-3c2e-9224-6fd738d52bf7", "product": {"name": "Linux"}, "product_version": "ceef7d10dfb6284d512c499292e6daa35ea83f90 <93827a0a36396f2fd6368a54a020f420c8916e9b"}, {"id": "31e003d7-a456-324b-8355-03ca93a361ac", "product": {"name": "Linux"}, "product_version": "ceef7d10dfb6284d512c499292e6daa35ea83f90 <6e7bc50f97c9855da83f1478f722590defd45ff2"}, {"id": "36a3473b-0ea3-3be3-a8a0-9b5606ceebbe", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "3daacde8-1707-32f0-80de-8a5e0ce6c96a", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}, {"id": "52942a08-c51b-3090-b8c5-4780f80d6415", "product": {"name": "Linux"}, "product_version": "ceef7d10dfb6284d512c499292e6daa35ea83f90 <b2de2b4d4e007f9add46ea8dc06f781835e3ea9f"}, {"id": "6b6782c7-5de6-3afc-890c-82407bd993d9", "product": {"name": "Linux"}, "product_version": "patch: 5.15.103"}, {"id": "7aff079e-bf59-331e-a286-164549afad73", "product": {"name": "Linux"}, "product_version": "4.18"}, {"id": "86b57b2a-7e5a-3a31-94a2-7b103a15271b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "9b22792f-ccd9-3885-b072-06bfbe4450a8", "product": {"name": "Linux"}, "product_version": "ceef7d10dfb6284d512c499292e6daa35ea83f90 <3ba95cc671c025d0d2a1c7d5e2930f0ff0980cf4"}, {"id": "bbb77dab-aa93-3848-b47b-39c6ab44380b", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "d65c761c-d2d0-3bcf-afc8-5ea655b2aff8", "product": {"name": "Linux"}, "product_version": "ceef7d10dfb6284d512c499292e6daa35ea83f90 <6baebcecf09acd19e2bab1c2911dcdba5d48a1dc"}], "enisaIdVendor": [{"id": "fbc9abf2-5a0f-36af-8211-109ccbad6035", "vendor": {"name": "Linux"}}], "isExploited": false}