{"id": "EUVD-2023-60290", "enisaUuid": "d3d0d010-a719-36d3-b748-772da461c48e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: core: remove unnecessary frame_sz check in bpf_xdp_adjust_tail()\n\nSyzkaller reported the following issue:\n=======================================\nToo BIG xdp->frame_sz = 131072\nWARNING: CPU: 0 PID: 5020 at net/core/filter.c:4121\n  ____bpf_xdp_adjust_tail net/core/filter.c:4121 [inline]\nWARNING: CPU: 0 PID: 5020 at net/core/filter.c:4121\n  bpf_xdp_adjust_tail+0x466/0xa10 net/core/filter.c:4103\n...\nCall Trace:\n <TASK>\n bpf_prog_4add87e5301a4105+0x1a/0x1c\n __bpf_prog_run include/linux/filter.h:600 [inline]\n bpf_prog_run_xdp include/linux/filter.h:775 [inline]\n bpf_prog_run_generic_xdp+0x57e/0x11e0 net/core/dev.c:4721\n netif_receive_generic_xdp net/core/dev.c:4807 [inline]\n do_xdp_generic+0x35c/0x770 net/core/dev.c:4866\n tun_get_user+0x2340/0x3ca0 drivers/net/tun.c:1919\n tun_chr_write_iter+0xe8/0x210 drivers/net/tun.c:2043\n call_write_iter include/linux/fs.h:1871 [inline]\n new_sync_write fs/read_write.c:491 [inline]\n vfs_write+0x650/0xe40 fs/read_write.c:584\n ksys_write+0x12f/0x250 fs/read_write.c:637\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x38/0xb0 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nxdp->frame_sz > PAGE_SIZE check was introduced in commit c8741e2bfe87\n(\"xdp: Allow bpf_xdp_adjust_tail() to grow packet size\"). But Jesper\nDangaard Brouer <jbrouer@redhat.com> noted that after introducing the\nxdp_init_buff() which all XDP driver use - it's safe to remove this\ncheck. The original intend was to catch cases where XDP drivers have\nnot been updated to use xdp.frame_sz, but that is not longer a concern\n(since xdp_init_buff).\n\nRunning the initial syzkaller repro it was discovered that the\ncontiguous physical memory allocation is used for both xdp paths in\ntun_get_user(), e.g. tun_build_skb() and tun_alloc_skb(). It was also\nstated by Jesper Dangaard Brouer <jbrouer@redhat.com> that XDP can\nwork on higher order pages, as long as this is contiguous physical\nmemory (e.g. a page).", "datePublished": "2025-12-24T15:30:40", "dateUpdated": "2025-12-24T15:30:40", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/a09c258cfa77d3ba0a7acc555c73eb6b005c4bd8", "https://git.kernel.org/stable/c/20acffcdc2b74fb7dcc4e299f7aca173df89d911", "https://git.kernel.org/stable/c/d9252d67ed2f921c230bba449ee051b5c32e4841", "https://git.kernel.org/stable/c/d14eea09edf427fa36bd446f4a3271f99164202f", "https://nvd.nist.gov/vuln/detail/CVE-2023-54155"], "aliases": ["CVE-2023-54155"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1c559c83-7fdb-3018-b323-d24b53102d66", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "643a0bd2-85ab-34ac-aa56-807e165d1f4a", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "67ddcc38-e83e-3eac-81b3-4a0f9f90b9ad", "product": {"name": "Linux"}, "product_version": "5.12"}, {"id": "6c9f7489-3a54-340e-9fc1-5cba0be78cf8", "product": {"name": "Linux"}, "product_version": "43b5169d8355ccf26d726fbc75f083b2429113e4 <d9252d67ed2f921c230bba449ee051b5c32e4841"}, {"id": "826855ff-4ab9-3b5e-a39e-ffdb16c3f5b2", "product": {"name": "Linux"}, "product_version": "43b5169d8355ccf26d726fbc75f083b2429113e4 <d14eea09edf427fa36bd446f4a3271f99164202f"}, {"id": "b08481fb-a21c-3cc0-8eb0-51aa25c52a60", "product": {"name": "Linux"}, "product_version": "43b5169d8355ccf26d726fbc75f083b2429113e4 <a09c258cfa77d3ba0a7acc555c73eb6b005c4bd8"}, {"id": "e4364593-733c-3832-be1e-6ac4b701c033", "product": {"name": "Linux"}, "product_version": "patch: 5.15.127"}, {"id": "f095a042-83c4-3a99-9ed5-fc9607071950", "product": {"name": "Linux"}, "product_version": "patch: 6.4.11"}, {"id": "fa884800-c6dd-3404-937f-829f1896dced", "product": {"name": "Linux"}, "product_version": "patch: 6.1.46"}, {"id": "fb41d4c0-37e4-3a75-a271-a3afcdd655f8", "product": {"name": "Linux"}, "product_version": "43b5169d8355ccf26d726fbc75f083b2429113e4 <20acffcdc2b74fb7dcc4e299f7aca173df89d911"}], "enisaIdVendor": [{"id": "fce0a56d-cf26-3ca2-8d93-4128bf809a5e", "vendor": {"name": "Linux"}}], "isExploited": false}