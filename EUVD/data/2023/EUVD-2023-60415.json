{"id": "EUVD-2023-60415", "enisaUuid": "12d52d87-4997-3541-aabc-d2ed991aeced", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: Fix data races around sk->sk_shutdown.\n\nKCSAN found a data race around sk->sk_shutdown where unix_release_sock()\nand unix_shutdown() update it under unix_state_lock(), OTOH unix_poll()\nand unix_dgram_poll() read it locklessly.\n\nWe need to annotate the writes and reads with WRITE_ONCE() and READ_ONCE().\n\nBUG: KCSAN: data-race in unix_poll / unix_release_sock\n\nwrite to 0xffff88800d0f8aec of 1 bytes by task 264 on cpu 0:\n unix_release_sock+0x75c/0x910 net/unix/af_unix.c:631\n unix_release+0x59/0x80 net/unix/af_unix.c:1042\n __sock_release+0x7d/0x170 net/socket.c:653\n sock_close+0x19/0x30 net/socket.c:1397\n __fput+0x179/0x5e0 fs/file_table.c:321\n ____fput+0x15/0x20 fs/file_table.c:349\n task_work_run+0x116/0x1a0 kernel/task_work.c:179\n resume_user_mode_work include/linux/resume_user_mode.h:49 [inline]\n exit_to_user_mode_loop kernel/entry/common.c:171 [inline]\n exit_to_user_mode_prepare+0x174/0x180 kernel/entry/common.c:204\n __syscall_exit_to_user_mode_work kernel/entry/common.c:286 [inline]\n syscall_exit_to_user_mode+0x1a/0x30 kernel/entry/common.c:297\n do_syscall_64+0x4b/0x90 arch/x86/entry/common.c:86\n entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nread to 0xffff88800d0f8aec of 1 bytes by task 222 on cpu 1:\n unix_poll+0xa3/0x2a0 net/unix/af_unix.c:3170\n sock_poll+0xcf/0x2b0 net/socket.c:1385\n vfs_poll include/linux/poll.h:88 [inline]\n ep_item_poll.isra.0+0x78/0xc0 fs/eventpoll.c:855\n ep_send_events fs/eventpoll.c:1694 [inline]\n ep_poll fs/eventpoll.c:1823 [inline]\n do_epoll_wait+0x6c4/0xea0 fs/eventpoll.c:2258\n __do_sys_epoll_wait fs/eventpoll.c:2270 [inline]\n __se_sys_epoll_wait fs/eventpoll.c:2265 [inline]\n __x64_sys_epoll_wait+0xcc/0x190 fs/eventpoll.c:2265\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x3b/0x90 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nvalue changed: 0x00 -> 0x03\n\nReported by Kernel Concurrency Sanitizer on:\nCPU: 1 PID: 222 Comm: dbus-broker Not tainted 6.3.0-rc7-02330-gca6270c12e20 #2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014", "datePublished": "2025-12-30T15:30:32", "dateUpdated": "2025-12-30T15:30:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/1c488f4e95b498c977fbeae784983eb4cf6085e8", "https://git.kernel.org/stable/c/196528ad484443627779540697f4fb0ef0e01c52", "https://git.kernel.org/stable/c/8307e372e7445ec7d3cd2ff107ce5078eaa02815", "https://git.kernel.org/stable/c/a41559ae3681975f1ced815d8d4c983b6b938499", "https://git.kernel.org/stable/c/e410895892f99700ce54347d42c8dbe962eea9f4", "https://git.kernel.org/stable/c/f237f79b63c9242450e6869adcd2c10445859f28", "https://git.kernel.org/stable/c/e1d09c2c2f5793474556b60f83900e088d0d366d", "https://nvd.nist.gov/vuln/detail/CVE-2023-54226"], "aliases": ["CVE-2023-54226"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0264d996-a413-3cb4-a659-12b525ae4061", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f237f79b63c9242450e6869adcd2c10445859f28"}, {"id": "08c96824-7ad5-339e-8bfa-a353751fe8ac", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "36dd002a-803c-397a-927c-312ba34d55c0", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a41559ae3681975f1ced815d8d4c983b6b938499"}, {"id": "577f2f8d-7556-3cd1-93e7-b3c2c7273b1d", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8307e372e7445ec7d3cd2ff107ce5078eaa02815"}, {"id": "6a3a4fbe-0c88-3bb2-bc43-7f804014a44e", "product": {"name": "Linux"}, "product_version": "patch: 5.10.181"}, {"id": "7779bdc2-68ba-311d-ba4e-57c6ab2a9cbd", "product": {"name": "Linux"}, "product_version": "patch: 5.15.113"}, {"id": "78f0cf4d-b018-34d5-bfc4-fae4b3117e1c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e1d09c2c2f5793474556b60f83900e088d0d366d"}, {"id": "a2997cad-d3c4-37cb-b419-81441de17d5f", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "a3830fdb-de74-3327-968c-2b1eabd08081", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e410895892f99700ce54347d42c8dbe962eea9f4"}, {"id": "a69b0188-d437-36b3-9ded-8ce7bd4fc6e4", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <196528ad484443627779540697f4fb0ef0e01c52"}, {"id": "b4761df7-41fa-36e8-9006-5a434046a31e", "product": {"name": "Linux"}, "product_version": "patch: 4.19.284"}, {"id": "cbe0c8c9-32b1-370f-8dca-8df6572f8321", "product": {"name": "Linux"}, "product_version": "patch: 5.4.244"}, {"id": "dafd756f-2154-3871-951e-4071e2d02d54", "product": {"name": "Linux"}, "product_version": "patch: 6.3.4"}, {"id": "e3defdd1-ee39-3858-8242-3bd9a196abfc", "product": {"name": "Linux"}, "product_version": "2.6.12"}, {"id": "f00d50ab-0dcb-3e10-a283-c84042cca253", "product": {"name": "Linux"}, "product_version": "patch: 6.1.30"}, {"id": "f147731f-2e8d-3179-b434-416298e21021", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1c488f4e95b498c977fbeae784983eb4cf6085e8"}], "enisaIdVendor": [{"id": "ed6edbe2-7b41-329c-9514-f89aa485fa49", "vendor": {"name": "Linux"}}], "isExploited": false}