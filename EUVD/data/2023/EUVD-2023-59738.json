{"id": "EUVD-2023-59738", "enisaUuid": "a146b251-728f-3323-b87f-49215d0d4e70", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfscache: Use wait_on_bit() to wait for the freeing of relinquished volume\n\nThe freeing of relinquished volume will wake up the pending volume\nacquisition by using wake_up_bit(), however it is mismatched with\nwait_var_event() used in fscache_wait_on_volume_collision() and it will\nnever wake up the waiter in the wait-queue because these two functions\noperate on different wait-queues.\n\nAccording to the implementation in fscache_wait_on_volume_collision(),\nif the wake-up of pending acquisition is delayed longer than 20 seconds\n(e.g., due to the delay of on-demand fd closing), the first\nwait_var_event_timeout() will timeout and the following wait_var_event()\nwill hang forever as shown below:\n\n FS-Cache: Potential volume collision new=00000024 old=00000022\n ......\n INFO: task mount:1148 blocked for more than 122 seconds.\n       Not tainted 6.1.0-rc6+ #1\n task:mount           state:D stack:0     pid:1148  ppid:1\n Call Trace:\n  <TASK>\n  __schedule+0x2f6/0xb80\n  schedule+0x67/0xe0\n  fscache_wait_on_volume_collision.cold+0x80/0x82\n  __fscache_acquire_volume+0x40d/0x4e0\n  erofs_fscache_register_volume+0x51/0xe0 [erofs]\n  erofs_fscache_register_fs+0x19c/0x240 [erofs]\n  erofs_fc_fill_super+0x746/0xaf0 [erofs]\n  vfs_get_super+0x7d/0x100\n  get_tree_nodev+0x16/0x20\n  erofs_fc_get_tree+0x20/0x30 [erofs]\n  vfs_get_tree+0x24/0xb0\n  path_mount+0x2fa/0xa90\n  do_mount+0x7c/0xa0\n  __x64_sys_mount+0x8b/0xe0\n  do_syscall_64+0x30/0x60\n  entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nConsidering that wake_up_bit() is more selective, so fix it by using\nwait_on_bit() instead of wait_var_event() to wait for the freeing of\nrelinquished volume. In addition because waitqueue_active() is used in\nwake_up_bit() and clear_bit() doesn't imply any memory barrier, use\nclear_and_wake_up_bit() to add the missing memory barrier between\ncursor->flags and waitqueue_active().", "datePublished": "2025-03-27T18:31:26", "dateUpdated": "2025-10-28T18:30:24", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3be069f42a7b79d3149194f21cdf24bf23864cac", "https://git.kernel.org/stable/c/8226e37d82f43657da34dd770e2b38f20242ada7", "https://nvd.nist.gov/vuln/detail/CVE-2023-52982"], "aliases": ["CVE-2023-52982"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "3dd66b7b-a892-3094-9a7b-49bf936c2f26", "product": {"name": "Linux"}, "product_version": "62ab63352350e881ae693a8236b35d7d0516c78b <3be069f42a7b79d3149194f21cdf24bf23864cac"}, {"id": "bbd86f9d-8bd3-37cd-9e65-c22e02455251", "product": {"name": "Linux"}, "product_version": "62ab63352350e881ae693a8236b35d7d0516c78b <8226e37d82f43657da34dd770e2b38f20242ada7"}, {"id": "eb927686-234b-328a-b92d-e385ff8e1be2", "product": {"name": "Linux"}, "product_version": "5.17"}], "enisaIdVendor": [{"id": "708612f7-85ec-35f5-b390-f67efc8d687e", "vendor": {"name": "Linux"}}], "isExploited": false}