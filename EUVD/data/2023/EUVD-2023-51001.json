{"id": "EUVD-2023-51001", "enisaUuid": "06f05f45-6422-34cc-aaa0-8d169e7b9719", "description": "The current setup of the quarantine page tables assumes that the\nquarantine domain (dom_io) has been initialized with an address width\nof DEFAULT_DOMAIN_ADDRESS_WIDTH (48) and hence 4 page table levels.\n\nHowever dom_io being a PV domain gets the AMD-Vi IOMMU page tables\nlevels based on the maximum (hot pluggable) RAM address, and hence on\nsystems with no RAM above the 512GB mark only 3 page-table levels are\nconfigured in the IOMMU.\n\nOn systems without RAM above the 512GB boundary\namd_iommu_quarantine_init() will setup page tables for the scratch\npage with 4 levels, while the IOMMU will be configured to use 3 levels\nonly, resulting in the last page table directory (PDE) effectively\nbecoming a page table entry (PTE), and hence a device in quarantine\nmode gaining write access to the page destined to be a PDE.\n\nDue to this page table level mismatch, the sink page the device gets\nread/write access to is no longer cleared between device assignment,\npossibly leading to data leaks.\n", "datePublished": "2024-01-05T16:34:49", "dateUpdated": "2025-11-04T19:25:41", "baseScore": 5.5, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "references": ["https://xenbits.xenproject.org/xsa/advisory-445.html", "https://nvd.nist.gov/vuln/detail/CVE-2023-46835", "http://xenbits.xen.org/xsa/advisory-445.html"], "aliases": ["CVE-2023-46835"], "assigner": "XEN", "epss": 0.09, "enisaIdProduct": [{"id": "481d7ec1-ceb1-33a1-bbc3-512155793dd4", "product": {"name": "Xen"}, "product_version": ""}], "enisaIdVendor": [{"id": "481d7ec1-ceb1-33a1-bbc3-512155793dd4", "vendor": {"name": "Xen"}}], "isExploited": false}