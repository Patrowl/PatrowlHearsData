{"id": "EUVD-2023-59908", "enisaUuid": "41e8fef0-1cba-34fc-87ef-7143032924f4", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrivers: staging: rtl8723bs: Fix locking in _rtw_join_timeout_handler()\n\nCommit 041879b12ddb (\"drivers: staging: rtl8192bs: Fix deadlock in\nrtw_joinbss_event_prehandle()\") besides fixing the deadlock also\nmodified _rtw_join_timeout_handler() to use spin_[un]lock_irq()\ninstead of spin_[un]lock_bh().\n\n_rtw_join_timeout_handler() calls rtw_do_join() which takes\npmlmepriv->scanned_queue.lock using spin_[un]lock_bh(). This\nspin_unlock_bh() call re-enables softirqs which triggers an oops in\nkernel/softirq.c: __local_bh_enable_ip() when it calls\nlockdep_assert_irqs_enabled():\n\n[  244.506087] WARNING: CPU: 2 PID: 0 at kernel/softirq.c:376 __local_bh_enable_ip+0xa6/0x100\n...\n[  244.509022] Call Trace:\n[  244.509048]  <IRQ>\n[  244.509100]  _rtw_join_timeout_handler+0x134/0x170 [r8723bs]\n[  244.509468]  ? __pfx__rtw_join_timeout_handler+0x10/0x10 [r8723bs]\n[  244.509772]  ? __pfx__rtw_join_timeout_handler+0x10/0x10 [r8723bs]\n[  244.510076]  call_timer_fn+0x95/0x2a0\n[  244.510200]  __run_timers.part.0+0x1da/0x2d0\n\nThis oops is causd by the switch to spin_[un]lock_irq() which disables\nthe IRQs for the entire duration of _rtw_join_timeout_handler().\n\nDisabling the IRQs is not necessary since all code taking this lock\nruns from either user contexts or from softirqs, switch back to\nspin_[un]lock_bh() to fix this.", "datePublished": "2025-09-16T15:32:33", "dateUpdated": "2025-12-02T21:31:26", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/209850f17717a3b5cc558578bef5631ac7045539", "https://git.kernel.org/stable/c/2a50e44a66d268ee5db3d177f1fdc1503dbce6e7", "https://git.kernel.org/stable/c/dc327e87c6d9bfd9ee08e76396b3c0ba848ec554", "https://git.kernel.org/stable/c/4ab1bace1dd3875371b481ef4301c4671bddea22", "https://git.kernel.org/stable/c/215792eda008f6a1e7ed9d77fa20d582d22bb114", "https://nvd.nist.gov/vuln/detail/CVE-2023-53281"], "aliases": ["CVE-2023-53281"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "09ec0c5d-7932-3ea4-a789-8b5721f63a11", "product": {"name": "Linux"}, "product_version": "patch: 6.3.2"}, {"id": "1207adf6-9fab-3758-bc78-c9b44e938a62", "product": {"name": "Linux"}, "product_version": "1f6c99b94ca3caad346876b3e22e3ca3d25bc8ee"}, {"id": "5dc158e0-a084-36eb-9060-1a81d1eb1091", "product": {"name": "Linux"}, "product_version": "041879b12ddb0c6c83ed9c0bdd10dc82a056f2fc <2a50e44a66d268ee5db3d177f1fdc1503dbce6e7"}, {"id": "6d4ca32c-c6a8-3f23-996c-2ad62435a813", "product": {"name": "Linux"}, "product_version": "patch: 6.1.28"}, {"id": "74585c1f-42e9-39d6-962d-f06acd7f7407", "product": {"name": "Linux"}, "product_version": "041879b12ddb0c6c83ed9c0bdd10dc82a056f2fc <4ab1bace1dd3875371b481ef4301c4671bddea22"}, {"id": "7b264ec6-a087-34e1-ba56-a10ca43d0c05", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "91b7e167-0ea3-381a-9193-c169b279200e", "product": {"name": "Linux"}, "product_version": "5.19"}, {"id": "9efb663f-5ca0-3238-9022-626e4198820f", "product": {"name": "Linux"}, "product_version": "041879b12ddb0c6c83ed9c0bdd10dc82a056f2fc <215792eda008f6a1e7ed9d77fa20d582d22bb114"}, {"id": "9fd1ae5d-c5c3-38c8-9e6e-c0ab1457466c", "product": {"name": "Linux"}, "product_version": "eca9748d9267a38d532464e3305a38629e9c35a9"}, {"id": "d739b787-4f09-3fe6-812c-25fa19b04fae", "product": {"name": "Linux"}, "product_version": "patch: 6.2.15"}, {"id": "d7f2a8e7-d048-3383-bfd0-02138ae13829", "product": {"name": "Linux"}, "product_version": "patch: 5.15.111"}, {"id": "ee4d3605-7a71-3f22-9a61-726c6eb283d3", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "f380caaf-eb9e-3753-a0bf-bc4048626a8a", "product": {"name": "Linux"}, "product_version": "041879b12ddb0c6c83ed9c0bdd10dc82a056f2fc <dc327e87c6d9bfd9ee08e76396b3c0ba848ec554"}, {"id": "f59c0f2f-0439-3331-b375-2aa542ae554d", "product": {"name": "Linux"}, "product_version": "ae60744d5fad840b9d056d35b4b652d95e755846 <209850f17717a3b5cc558578bef5631ac7045539"}], "enisaIdVendor": [{"id": "e10717fe-ecf9-347a-8f0a-75f9e59b00e9", "vendor": {"name": "Linux"}}], "isExploited": false}