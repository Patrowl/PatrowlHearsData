{"id": "EUVD-2023-59790", "enisaUuid": "5aefb0f6-0c31-3a0b-bad6-466168bebd83", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nskbuff: Fix a race between coalescing and releasing SKBs\n\nCommit 1effe8ca4e34 (\"skbuff: fix coalescing for page_pool fragment\nrecycling\") allowed coalescing to proceed with non page pool page and page\npool page when @from is cloned, i.e.\n\nto->pp_recycle    --> false\nfrom->pp_recycle  --> true\nskb_cloned(from)  --> true\n\nHowever, it actually requires skb_cloned(@from) to hold true until\ncoalescing finishes in this situation. If the other cloned SKB is\nreleased while the merging is in process, from_shinfo->nr_frags will be\nset to 0 toward the end of the function, causing the increment of frag\npage _refcount to be unexpectedly skipped resulting in inconsistent\nreference counts. Later when SKB(@to) is released, it frees the page\ndirectly even though the page pool page is still in use, leading to\nuse-after-free or double-free errors. So it should be prohibited.\n\nThe double-free error message below prompted us to investigate:\nBUG: Bad page state in process swapper/1  pfn:0e0d1\npage:00000000c6548b28 refcount:-1 mapcount:0 mapping:0000000000000000\nindex:0x2 pfn:0xe0d1\nflags: 0xfffffc0000000(node=0|zone=1|lastcpupid=0x1fffff)\nraw: 000fffffc0000000 0000000000000000 ffffffff00000101 0000000000000000\nraw: 0000000000000002 0000000000000000 ffffffffffffffff 0000000000000000\npage dumped because: nonzero _refcount\n\nCPU: 1 PID: 0 Comm: swapper/1 Tainted: G            E      6.2.0+\nCall Trace:\n <IRQ>\ndump_stack_lvl+0x32/0x50\nbad_page+0x69/0xf0\nfree_pcp_prepare+0x260/0x2f0\nfree_unref_page+0x20/0x1c0\nskb_release_data+0x10b/0x1a0\nnapi_consume_skb+0x56/0x150\nnet_rx_action+0xf0/0x350\n? __napi_schedule+0x79/0x90\n__do_softirq+0xc8/0x2b1\n__irq_exit_rcu+0xb9/0xf0\ncommon_interrupt+0x82/0xa0\n</IRQ>\n<TASK>\nasm_common_interrupt+0x22/0x40\nRIP: 0010:default_idle+0xb/0x20", "datePublished": "2025-09-15T15:31:24", "dateUpdated": "2025-12-02T03:31:35", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/906a6689bb0191ad2a44131a3377006aa098af59", "https://git.kernel.org/stable/c/71850b5af92da21b4862a9bc55bda61091247d00", "https://git.kernel.org/stable/c/5f692c992a3bb9a8018e3488098b401a4229e7ec", "https://git.kernel.org/stable/c/0646dc31ca886693274df5749cd0c8c1eaaeb5ca", "https://nvd.nist.gov/vuln/detail/CVE-2023-53186"], "aliases": ["CVE-2023-53186"], "assigner": "Linux", "epss": 0.01, "enisaIdProduct": [{"id": "1151a27d-a88c-3daf-941c-580961d4ce8b", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "34cef974-adeb-37ff-bb08-258ea75de642", "product": {"name": "Linux"}, "product_version": "patch: 6.2.12"}, {"id": "761aeaae-50db-3489-8372-c8a082e738f5", "product": {"name": "Linux"}, "product_version": "patch: 6.1.25"}, {"id": "a430cc01-9b09-36b5-a031-f8c93f62e7c0", "product": {"name": "Linux"}, "product_version": "53e0961da1c7bbdabd1abebb20de403ec237ec09 <71850b5af92da21b4862a9bc55bda61091247d00"}, {"id": "a48b5eb7-ceec-387c-83af-0e58d91b1f01", "product": {"name": "Linux"}, "product_version": "53e0961da1c7bbdabd1abebb20de403ec237ec09 <906a6689bb0191ad2a44131a3377006aa098af59"}, {"id": "ec895781-4f2d-3bd0-8647-2e939ac83671", "product": {"name": "Linux"}, "product_version": "53e0961da1c7bbdabd1abebb20de403ec237ec09 <0646dc31ca886693274df5749cd0c8c1eaaeb5ca"}, {"id": "f13c4415-408d-313c-9532-770f05957945", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "f455027f-e070-34ca-8983-b64e6bb2ca44", "product": {"name": "Linux"}, "product_version": "patch: 5.15.108"}, {"id": "f4ccd8c5-ae84-3e46-a78b-6f56aa06f078", "product": {"name": "Linux"}, "product_version": "53e0961da1c7bbdabd1abebb20de403ec237ec09 <5f692c992a3bb9a8018e3488098b401a4229e7ec"}, {"id": "fe0c5c77-cc76-3117-bb1e-265383b73ed1", "product": {"name": "Linux"}, "product_version": "5.15"}], "enisaIdVendor": [{"id": "b53102a4-c409-308c-a08a-fa495703af4a", "vendor": {"name": "Linux"}}], "isExploited": false}