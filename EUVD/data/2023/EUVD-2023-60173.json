{"id": "EUVD-2023-60173", "enisaUuid": "9aa31b23-6bbc-3c65-99ce-460825c6c003", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock/rq_qos: protect rq_qos apis with a new lock\n\ncommit 50e34d78815e (\"block: disable the elevator int del_gendisk\")\nmove rq_qos_exit() from disk_release() to del_gendisk(), this will\nintroduce some problems:\n\n1) If rq_qos_add() is triggered by enabling iocost/iolatency through\n   cgroupfs, then it can concurrent with del_gendisk(), it's not safe to\n   write 'q->rq_qos' concurrently.\n\n2) Activate cgroup policy that is relied on rq_qos will call\n   rq_qos_add() and blkcg_activate_policy(), and if rq_qos_exit() is\n   called in the middle, null-ptr-dereference will be triggered in\n   blkcg_activate_policy().\n\n3) blkg_conf_open_bdev() can call blkdev_get_no_open() first to find the\n   disk, then if rq_qos_exit() from del_gendisk() is done before\n   rq_qos_add(), then memory will be leaked.\n\nThis patch add a new disk level mutex 'rq_qos_mutex':\n\n1) The lock will protect rq_qos_exit() directly.\n\n2) For wbt that doesn't relied on blk-cgroup, rq_qos_add() can only be\n   called from disk initialization for now because wbt can't be\n   destructed until rq_qos_exit(), so it's safe not to protect wbt for\n   now. Hoever, in case that rq_qos dynamically destruction is supported\n   in the furture, this patch also protect rq_qos_add() from wbt_init()\n   directly, this is enough because blk-sysfs already synchronize\n   writers with disk removal.\n\n3) For iocost and iolatency, in order to synchronize disk removal and\n   cgroup configuration, the lock is held after blkdev_get_no_open()\n   from blkg_conf_open_bdev(), and is released in blkg_conf_exit().\n   In order to fix the above memory leak, disk_live() is checked after\n   holding the new lock.", "datePublished": "2025-12-09T18:30:32", "dateUpdated": "2025-12-09T18:30:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/16398b4638b5cd8c1dc95fc940a1591a801d53ce", "https://git.kernel.org/stable/c/a13bd91be22318768d55470cbc0b0f4488ef9edf", "https://nvd.nist.gov/vuln/detail/CVE-2023-53823"], "aliases": ["CVE-2023-53823"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "34367f9a-8353-3de3-9e62-1b3331861307", "product": {"name": "Linux"}, "product_version": "patch: 6.4.4"}, {"id": "570b961d-b280-32b2-90b9-910ff464c92e", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "a6e7abc1-4c26-389d-b239-53c0268698fd", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "d158fb98-6791-39c7-a022-f50214a7cc0e", "product": {"name": "Linux"}, "product_version": "50e34d78815e474d410f342fbe783b18192ca518 <16398b4638b5cd8c1dc95fc940a1591a801d53ce"}, {"id": "e0e10677-08bb-3498-abc1-7290d00bdd0a", "product": {"name": "Linux"}, "product_version": "f28699fafc047ec33299da01e928c3a0073c5cc6"}, {"id": "e279429e-f37f-3fe0-820b-233f6ee4bcb1", "product": {"name": "Linux"}, "product_version": "5.19"}, {"id": "e8d9964e-3268-30b4-bfe1-9464cb738dcb", "product": {"name": "Linux"}, "product_version": "50e34d78815e474d410f342fbe783b18192ca518 <a13bd91be22318768d55470cbc0b0f4488ef9edf"}], "enisaIdVendor": [{"id": "288ebe04-0490-30df-a3e4-649dfb804577", "vendor": {"name": "Linux"}}], "isExploited": false}