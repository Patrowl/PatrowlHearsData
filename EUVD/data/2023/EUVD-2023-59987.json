{"id": "EUVD-2023-59987", "enisaUuid": "28c19dc0-b386-3d1f-8717-744f54c0081e", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix BUG_ON condition in btrfs_cancel_balance\n\nPausing and canceling balance can race to interrupt balance lead to BUG_ON\npanic in btrfs_cancel_balance. The BUG_ON condition in btrfs_cancel_balance\ndoes not take this race scenario into account.\n\nHowever, the race condition has no other side effects. We can fix that.\n\nReproducing it with panic trace like this:\n\n  kernel BUG at fs/btrfs/volumes.c:4618!\n  RIP: 0010:btrfs_cancel_balance+0x5cf/0x6a0\n  Call Trace:\n   <TASK>\n   ? do_nanosleep+0x60/0x120\n   ? hrtimer_nanosleep+0xb7/0x1a0\n   ? sched_core_clone_cookie+0x70/0x70\n   btrfs_ioctl_balance_ctl+0x55/0x70\n   btrfs_ioctl+0xa46/0xd20\n   __x64_sys_ioctl+0x7d/0xa0\n   do_syscall_64+0x38/0x80\n   entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\n  Race scenario as follows:\n  > mutex_unlock(&fs_info->balance_mutex);\n  > --------------------\n  > .......issue pause and cancel req in another thread\n  > --------------------\n  > ret = __btrfs_balance(fs_info);\n  >\n  > mutex_lock(&fs_info->balance_mutex);\n  > if (ret == -ECANCELED && atomic_read(&fs_info->balance_pause_req)) {\n  >         btrfs_info(fs_info, \"balance: paused\");\n  >         btrfs_exclop_balance(fs_info, BTRFS_EXCLOP_BALANCE_PAUSED);\n  > }", "datePublished": "2025-09-17T15:30:38", "dateUpdated": "2025-12-11T18:30:32", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/7c93b89cd46636b5e74c12fa21dd86167bc6ea8d", "https://git.kernel.org/stable/c/a0a462a0f20926918d6009f0b4b25673e883fc98", "https://git.kernel.org/stable/c/bd7bef82ce0e929ef4cf63a34990545aaca28077", "https://git.kernel.org/stable/c/b966e9e1e250dfdb41a7f41775faea4a37af923c", "https://git.kernel.org/stable/c/ceb9ba8e30833a4823e2dc73f80ebcdf2498d01a", "https://git.kernel.org/stable/c/ae81329f7de3aa6f34ecdfa5412e72161a30e9ce", "https://git.kernel.org/stable/c/29eefa6d0d07e185f7bfe9576f91e6dba98189c2", "https://nvd.nist.gov/vuln/detail/CVE-2023-53339"], "aliases": ["CVE-2023-53339"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "01b2bc94-339e-3732-9be3-e2b8d9d4e34b", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7c93b89cd46636b5e74c12fa21dd86167bc6ea8d"}, {"id": "0c4e7404-7cc3-30ba-b7cc-6b5acb169a38", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "0f1f878b-650e-3359-8ca3-aad094ad40cb", "product": {"name": "Linux"}, "product_version": "patch: 4.19.293"}, {"id": "1e7139b8-9d47-3787-a267-f60b122b98f7", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ae81329f7de3aa6f34ecdfa5412e72161a30e9ce"}, {"id": "1edcbbc0-3904-3d14-8e05-b1a6dd2daab5", "product": {"name": "Linux"}, "product_version": "patch: 5.15.128"}, {"id": "38f5b33f-9309-3b0f-bfa0-6ba9719330f6", "product": {"name": "Linux"}, "product_version": "patch: 6.4.12"}, {"id": "39c08651-b120-3b9d-ab58-0e38933a10e5", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <29eefa6d0d07e185f7bfe9576f91e6dba98189c2"}, {"id": "6edb83c3-c26c-3ed1-bb0f-2aa97a3e4194", "product": {"name": "Linux"}, "product_version": "patch: 5.4.255"}, {"id": "bd3d0159-e860-31dc-9c1b-a5632c9d7eac", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b966e9e1e250dfdb41a7f41775faea4a37af923c"}, {"id": "bda8f98b-1095-3d54-8e9c-6671c50868ec", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bd7bef82ce0e929ef4cf63a34990545aaca28077"}, {"id": "c7f458c6-4baa-37bf-8d4e-af0aa8916bf1", "product": {"name": "Linux"}, "product_version": "patch: 6.1.47"}, {"id": "ecb06269-12d8-39e2-ad0e-102e65484a2f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ceb9ba8e30833a4823e2dc73f80ebcdf2498d01a"}, {"id": "f3f7a2eb-6621-3e61-8a6c-2ccf90eee8c5", "product": {"name": "Linux"}, "product_version": "patch: 5.10.192"}, {"id": "f629b9f9-2fc8-3926-a183-1476f76c2945", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a0a462a0f20926918d6009f0b4b25673e883fc98"}], "enisaIdVendor": [{"id": "96671d6a-cefc-3027-8f96-6f00bc30c6e6", "vendor": {"name": "Linux"}}], "isExploited": false}