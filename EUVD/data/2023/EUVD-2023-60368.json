{"id": "EUVD-2023-60368", "enisaUuid": "e57da73a-04cd-336e-ae0d-e24f037e5220", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/ntfs3: Fix memory leak if ntfs_read_mft failed\n\nLabel ATTR_ROOT in ntfs_read_mft() sets is_root = true and\nni->ni_flags |= NI_FLAG_DIR, then next attr will goto label ATTR_ALLOC\nand alloc ni->dir.alloc_run. However two states are not always\nconsistent and can make memory leak.\n\n 1) attr_name in ATTR_ROOT does not fit the condition it will set\n is_root = true but NI_FLAG_DIR is not set.\n 2) next attr_name in ATTR_ALLOC fits the condition and alloc\n ni->dir.alloc_run\n 3) in cleanup function ni_clear(), when NI_FLAG_DIR is set, it frees\n ni->dir.alloc_run, otherwise it frees ni->file.run\n 4) because NI_FLAG_DIR is not set in this case, ni->dir.alloc_run is\n leaked as kmemleak reported:\n\nunreferenced object 0xffff888003bc5480 (size 64):\n  backtrace:\n    [<000000003d42e6b0>] __kmalloc_node+0x4e/0x1c0\n    [<00000000d8e19b8a>] kvmalloc_node+0x39/0x1f0\n    [<00000000fc3eb5b8>] run_add_entry+0x18a/0xa40 [ntfs3]\n    [<0000000011c9f978>] run_unpack+0x75d/0x8e0 [ntfs3]\n    [<00000000e7cf1819>] run_unpack_ex+0xbc/0x500 [ntfs3]\n    [<00000000bbf0a43d>] ntfs_iget5+0xb25/0x2dd0 [ntfs3]\n    [<00000000a6e50693>] ntfs_fill_super+0x218d/0x3580 [ntfs3]\n    [<00000000b9170608>] get_tree_bdev+0x3fb/0x710\n    [<000000004833798a>] vfs_get_tree+0x8e/0x280\n    [<000000006e20b8e6>] path_mount+0xf3c/0x1930\n    [<000000007bf15a5f>] do_mount+0xf3/0x110\n    ...\n\nFix this by always setting is_root and NI_FLAG_DIR together.", "datePublished": "2025-12-24T15:30:37", "dateUpdated": "2025-12-24T15:30:37", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3030f2b9b3329db3948c1a145a5493ca6f617d50", "https://git.kernel.org/stable/c/1bc6bb657dfb0ab3b94ef6d477ca241bf7b6ec06", "https://git.kernel.org/stable/c/93bf79f989688852deade1550fb478b0a4d8daa8", "https://git.kernel.org/stable/c/3bb0d3eb475f01744ce6d6e998dfbd80220852a1", "https://git.kernel.org/stable/c/bfa434c60157c9793e9b12c9b68ade02aff9f803", "https://nvd.nist.gov/vuln/detail/CVE-2023-54077"], "aliases": ["CVE-2023-54077"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1b342851-7687-38a5-9ece-f19ce07d147a", "product": {"name": "Linux"}, "product_version": "82cae269cfa953032fbb8980a7d554d60fb00b17 <93bf79f989688852deade1550fb478b0a4d8daa8"}, {"id": "2890cfd6-b531-3a38-b233-a5a0f11deed7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.111"}, {"id": "29b6d071-331e-3b1d-aace-708faa6850c3", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "30bfb280-6ccf-3571-964e-a90ab513a80b", "product": {"name": "Linux"}, "product_version": "patch: 6.3.2"}, {"id": "459729bf-23eb-33d1-93df-d3f68ee16fd0", "product": {"name": "Linux"}, "product_version": "patch: 6.2.15"}, {"id": "6b10563a-be7a-390e-a569-2850cd2493bd", "product": {"name": "Linux"}, "product_version": "82cae269cfa953032fbb8980a7d554d60fb00b17 <1bc6bb657dfb0ab3b94ef6d477ca241bf7b6ec06"}, {"id": "89d96a0c-e9dc-3300-ac78-3144a93cb595", "product": {"name": "Linux"}, "product_version": "82cae269cfa953032fbb8980a7d554d60fb00b17 <3bb0d3eb475f01744ce6d6e998dfbd80220852a1"}, {"id": "974637a3-cfdd-3e88-a7bc-57432efca3cd", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "c53a7937-f1c3-35a8-b3c5-deb6f2cfe5da", "product": {"name": "Linux"}, "product_version": "patch: 6.1.28"}, {"id": "dbb4073f-6d56-318e-8fde-c048a8a3ceac", "product": {"name": "Linux"}, "product_version": "82cae269cfa953032fbb8980a7d554d60fb00b17 <bfa434c60157c9793e9b12c9b68ade02aff9f803"}, {"id": "fa7ea333-76af-3bc6-8518-a5f7db0f9f23", "product": {"name": "Linux"}, "product_version": "82cae269cfa953032fbb8980a7d554d60fb00b17 <3030f2b9b3329db3948c1a145a5493ca6f617d50"}, {"id": "fc255a0e-b4b4-3e54-af6f-f1b654e2a313", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "c62e80cb-ea8c-346c-af51-6ab425442f76", "vendor": {"name": "Linux"}}], "isExploited": false}