{"id": "EUVD-2023-60115", "enisaUuid": "ffed4343-1b80-34ff-8185-d8103a79cb47", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd: fix warning for holder mismatch from export_rdev()\n\nCommit a1d767191096 (\"md: use mddev->external to select holder in\nexport_rdev()\") fix the problem that 'claim_rdev' is used for\nblkdev_get_by_dev() while 'rdev' is used for blkdev_put().\n\nHowever, if mddev->external is changed from 0 to 1, then 'rdev' is used\nfor blkdev_get_by_dev() while 'claim_rdev' is used for blkdev_put(). And\nthis problem can be reporduced reliably by following:\n\nNew file: mdadm/tests/23rdev-lifetime\n\ndevname=${dev0##*/}\ndevt=`cat /sys/block/$devname/dev`\npid=\"\"\nruntime=2\n\nclean_up_test() {\n        pill -9 $pid\n        echo clear > /sys/block/md0/md/array_state\n}\n\ntrap 'clean_up_test' EXIT\n\nadd_by_sysfs() {\n        while true; do\n                echo $devt > /sys/block/md0/md/new_dev\n        done\n}\n\nremove_by_sysfs(){\n        while true; do\n                echo remove > /sys/block/md0/md/dev-${devname}/state\n        done\n}\n\necho md0 > /sys/module/md_mod/parameters/new_array || die \"create md0 failed\"\n\nadd_by_sysfs &\npid=\"$pid $!\"\n\nremove_by_sysfs &\npid=\"$pid $!\"\n\nsleep $runtime\nexit 0\n\nTest cmd:\n\n./test --save-logs --logdir=/tmp/ --keep-going --dev=loop --tests=23rdev-lifetime\n\nTest result:\n\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 960 at block/bdev.c:618 blkdev_put+0x27c/0x330\nModules linked in: multipath md_mod loop\nCPU: 0 PID: 960 Comm: test Not tainted 6.5.0-rc2-00121-g01e55c376936-dirty #50\nRIP: 0010:blkdev_put+0x27c/0x330\nCall Trace:\n <TASK>\n export_rdev.isra.23+0x50/0xa0 [md_mod]\n mddev_unlock+0x19d/0x300 [md_mod]\n rdev_attr_store+0xec/0x190 [md_mod]\n sysfs_kf_write+0x52/0x70\n kernfs_fop_write_iter+0x19a/0x2a0\n vfs_write+0x3b5/0x770\n ksys_write+0x74/0x150\n __x64_sys_write+0x22/0x30\n do_syscall_64+0x40/0x90\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nFix the problem by recording if 'rdev' is used as holder.", "datePublished": "2025-12-09T03:31:11", "dateUpdated": "2025-12-09T03:31:11", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/99fcd427178d0f58f5520f8f01df727f8eaeb2c7", "https://git.kernel.org/stable/c/99892147f028d711f9d40fefad4f33632593864c", "https://nvd.nist.gov/vuln/detail/CVE-2023-53791"], "aliases": ["CVE-2023-53791"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "675f38a2-6fbe-375e-acc4-18254d272b62", "product": {"name": "Linux"}, "product_version": "a1d7671910965ca9f8f0377e7e3bfd1179fba4d8 <99fcd427178d0f58f5520f8f01df727f8eaeb2c7"}, {"id": "7631bfef-b947-3709-a05d-7eb2fb94b337", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "86cea8bb-3f9b-3b92-bec2-bfc548e6885b", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c1a1d7e5-010a-3596-b246-5e1ed62f759a", "product": {"name": "Linux"}, "product_version": "patch: 6.5.5"}, {"id": "f58245e4-8feb-3fbc-876c-a185b4e27e60", "product": {"name": "Linux"}, "product_version": "6.5"}, {"id": "f956513a-2d55-382e-9b41-428faa19bb66", "product": {"name": "Linux"}, "product_version": "a1d7671910965ca9f8f0377e7e3bfd1179fba4d8 <99892147f028d711f9d40fefad4f33632593864c"}], "enisaIdVendor": [{"id": "f11741f6-1bdb-39d2-8153-b4780610eda7", "vendor": {"name": "Linux"}}], "isExploited": false}