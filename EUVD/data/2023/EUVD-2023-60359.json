{"id": "EUVD-2023-60359", "enisaUuid": "13f42bb5-c237-3d93-aaba-8f044090b012", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Add preempt_count_{sub,add} into btf id deny list\n\nThe recursion check in __bpf_prog_enter* and __bpf_prog_exit*\nleave preempt_count_{sub,add} unprotected. When attaching trampoline to\nthem we get panic as follows,\n\n[  867.843050] BUG: TASK stack guard page was hit at 0000000009d325cf (stack is 0000000046a46a15..00000000537e7b28)\n[  867.843064] stack guard page: 0000 [#1] PREEMPT SMP NOPTI\n[  867.843067] CPU: 8 PID: 11009 Comm: trace Kdump: loaded Not tainted 6.2.0+ #4\n[  867.843100] Call Trace:\n[  867.843101]  <TASK>\n[  867.843104]  asm_exc_int3+0x3a/0x40\n[  867.843108] RIP: 0010:preempt_count_sub+0x1/0xa0\n[  867.843135]  __bpf_prog_enter_recur+0x17/0x90\n[  867.843148]  bpf_trampoline_6442468108_0+0x2e/0x1000\n[  867.843154]  ? preempt_count_sub+0x1/0xa0\n[  867.843157]  preempt_count_sub+0x5/0xa0\n[  867.843159]  ? migrate_enable+0xac/0xf0\n[  867.843164]  __bpf_prog_exit_recur+0x2d/0x40\n[  867.843168]  bpf_trampoline_6442468108_0+0x55/0x1000\n...\n[  867.843788]  preempt_count_sub+0x5/0xa0\n[  867.843793]  ? migrate_enable+0xac/0xf0\n[  867.843829]  __bpf_prog_exit_recur+0x2d/0x40\n[  867.843837] BUG: IRQ stack guard page was hit at 0000000099bd8228 (stack is 00000000b23e2bc4..000000006d95af35)\n[  867.843841] BUG: IRQ stack guard page was hit at 000000005ae07924 (stack is 00000000ffd69623..0000000014eb594c)\n[  867.843843] BUG: IRQ stack guard page was hit at 00000000028320f0 (stack is 00000000034b6438..0000000078d1bcec)\n[  867.843842]  bpf_trampoline_6442468108_0+0x55/0x1000\n...\n\nThat is because in __bpf_prog_exit_recur, the preempt_count_{sub,add} are\ncalled after prog->active is decreased.\n\nFixing this by adding these two functions into btf ids deny list.", "datePublished": "2025-12-24T13:06:16", "dateUpdated": "2026-01-05T10:33:42", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/095018267c87b8bfbbb12eeb1c0ebf2359e1782c", "https://git.kernel.org/stable/c/60039bf72f81638baa28652a11a68e9b0b7b5b2d", "https://git.kernel.org/stable/c/b9168d41b83d182f34ba927ee822edaee18d5fc8", "https://git.kernel.org/stable/c/c11bd046485d7bf1ca200db0e7d0bdc4bafdd395", "https://nvd.nist.gov/vuln/detail/CVE-2023-54086"], "aliases": ["CVE-2023-54086"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0be4a250-6cfb-37c3-a529-e7fe1524c0ba", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "0f00dae6-9259-3445-8ef4-d8d2a353ac05", "product": {"name": "Linux"}, "product_version": "5.13"}, {"id": "15497219-a3ea-3801-b17f-cdc066c885c9", "product": {"name": "Linux"}, "product_version": "patch: 6.1.30"}, {"id": "5e398f52-f58c-3acf-93bf-4751371fa56a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <60039bf72f81638baa28652a11a68e9b0b7b5b2d"}, {"id": "64a9cbc2-cb11-3978-bbb1-08346fcd3861", "product": {"name": "Linux"}, "product_version": "35e3815fa8102fab4dee75f3547472c66581125d <c11bd046485d7bf1ca200db0e7d0bdc4bafdd395"}, {"id": "8dd3ae56-f524-335c-9d95-f42f45b94985", "product": {"name": "Linux"}, "product_version": "f5e770c0c60ab8812574a2e0d163b0efa816a825"}, {"id": "8ecb4cf9-e7ab-3336-8bdf-f5dd1cd36021", "product": {"name": "Linux"}, "product_version": "patch: 5.15.113"}, {"id": "92905d32-e1a5-3f51-a2dd-35593a23b207", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "93d897e7-0e22-3e63-8d1d-9473caea7df1", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c11bd046485d7bf1ca200db0e7d0bdc4bafdd395"}, {"id": "a01ecc86-f18c-3211-9cee-66b2aee2724c", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b9168d41b83d182f34ba927ee822edaee18d5fc8"}, {"id": "cc66aad7-9f74-39d1-a972-7c891787c8ff", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <095018267c87b8bfbbb12eeb1c0ebf2359e1782c"}, {"id": "d7dc7e34-8840-3d06-8e48-96caaf4a491b", "product": {"name": "Linux"}, "product_version": "35e3815fa8102fab4dee75f3547472c66581125d <60039bf72f81638baa28652a11a68e9b0b7b5b2d"}, {"id": "ef6b8c88-1b43-3855-ba1f-cf0a9e56ad2e", "product": {"name": "Linux"}, "product_version": "35e3815fa8102fab4dee75f3547472c66581125d <b9168d41b83d182f34ba927ee822edaee18d5fc8"}, {"id": "f1021111-8010-3005-937a-bcd0e8a36f1a", "product": {"name": "Linux"}, "product_version": "patch: 6.3.4"}, {"id": "f3efb608-c9fa-35d4-b775-b47a9050f721", "product": {"name": "Linux"}, "product_version": "35e3815fa8102fab4dee75f3547472c66581125d <095018267c87b8bfbbb12eeb1c0ebf2359e1782c"}], "enisaIdVendor": [{"id": "c0c4d6b4-f615-3cee-b996-5d4e6a78ed89", "vendor": {"name": "Linux"}}], "isExploited": false}