{"id": "EUVD-2023-60019", "enisaUuid": "3b2cd559-9684-3d06-9576-160cf84033d5", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nring-buffer: Handle race between rb_move_tail and rb_check_pages\n\nIt seems a data race between ring_buffer writing and integrity check.\nThat is, RB_FLAG of head_page is been updating, while at same time\nRB_FLAG was cleared when doing integrity check rb_check_pages():\n\n  rb_check_pages()            rb_handle_head_page():\n  --------                    --------\n  rb_head_page_deactivate()\n                              rb_head_page_set_normal()\n  rb_head_page_activate()\n\nWe do intergrity test of the list to check if the list is corrupted and\nit is still worth doing it. So, let's refactor rb_check_pages() such that\nwe no longer clear and set flag during the list sanity checking.\n\n[1] and [2] are the test to reproduce and the crash report respectively.\n\n1:\n``` read_trace.sh\n  while true;\n  do\n    # the \"trace\" file is closed after read\n    head -1 /sys/kernel/tracing/trace > /dev/null\n  done\n```\n``` repro.sh\n  sysctl -w kernel.panic_on_warn=1\n  # function tracer will writing enough data into ring_buffer\n  echo function > /sys/kernel/tracing/current_tracer\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n  ./read_trace.sh &\n```\n\n2:\n------------[ cut here ]------------\nWARNING: CPU: 9 PID: 62 at kernel/trace/ring_buffer.c:2653\nrb_move_tail+0x450/0x470\nModules linked in:\nCPU: 9 PID: 62 Comm: ksoftirqd/9 Tainted: G        W          6.2.0-rc6+\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nrel-1.15.0-0-g2dd4b9b3f840-prebuilt.qemu.org 04/01/2014\nRIP: 0010:rb_move_tail+0x450/0x470\nCode: ff ff 4c 89 c8 f0 4d 0f b1 02 48 89 c2 48 83 e2 fc 49 39 d0 75 24\n83 e0 03 83 f8 02 0f 84 e1 fb ff ff 48 8b 57 10 f0 ff 42 08 <0f> 0b 83\nf8 02 0f 84 ce fb ff ff e9 db\nRSP: 0018:ffffb5564089bd00 EFLAGS: 00000203\nRAX: 0000000000000000 RBX: ffff9db385a2bf81 RCX: ffffb5564089bd18\nRDX: ffff9db281110100 RSI: 0000000000000fe4 RDI: ffff9db380145400\nRBP: ffff9db385a2bf80 R08: ffff9db385a2bfc0 R09: ffff9db385a2bfc2\nR10: ffff9db385a6c000 R11: ffff9db385a2bf80 R12: 0000000000000000\nR13: 00000000000003e8 R14: ffff9db281110100 R15: ffffffffbb006108\nFS:  0000000000000000(0000) GS:ffff9db3bdcc0000(0000)\nknlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00005602323024c8 CR3: 0000000022e0c000 CR4: 00000000000006e0\nCall Trace:\n <TASK>\n ring_buffer_lock_reserve+0x136/0x360\n ? __do_softirq+0x287/0x2df\n ? __pfx_rcu_softirq_qs+0x10/0x10\n trace_function+0x21/0x110\n ? __pfx_rcu_softirq_qs+0x10/0x10\n ? __do_softirq+0x287/0x2df\n function_trace_call+0xf6/0x120\n 0xffffffffc038f097\n ? rcu_softirq_qs+0x5/0x140\n rcu_softirq_qs+0x5/0x140\n __do_softirq+0x287/0x2df\n run_ksoftirqd+0x2a/0x30\n smpboot_thread_fn+0x188/0x220\n ? __pfx_smpboot_thread_fn+0x10/0x10\n kthread+0xe7/0x110\n ? __pfx_kthread+0x10/0x10\n ret_from_fork+0x2c/0x50\n </TASK>\n---[ end trace 0000000000000000 ]---\n\n[ crash report and test reproducer credit goes to Zheng Yejian]", "datePublished": "2025-10-22T15:31:11", "dateUpdated": "2025-10-22T15:31:11", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/6e02a43acd0691791df79ce538f2dd497a6c9b76", "https://git.kernel.org/stable/c/d41db100bc386b9433a3fc87026f5e8b453653e3", "https://git.kernel.org/stable/c/9674390ac540ed06768e3fbc2dba553929fbd736", "https://git.kernel.org/stable/c/09b1bf25f7f7a8f2bf8cd4278bba9c3172db8013", "https://git.kernel.org/stable/c/8843e06f67b14f71c044bf6267b2387784c7e198", "https://nvd.nist.gov/vuln/detail/CVE-2023-53709"], "aliases": ["CVE-2023-53709"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "056c7916-d4cd-34fd-98ec-8716dd43f633", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "28a5d250-932f-30b9-9c93-c21cec31b4a2", "product": {"name": "Linux"}, "product_version": "1039221cc2787dee51a7ffbf9b0e79d192dadf76 <d41db100bc386b9433a3fc87026f5e8b453653e3"}, {"id": "4dd6cef5-19fc-32f7-8a1f-027cdb989c9b", "product": {"name": "Linux"}, "product_version": "patch: 5.10.173"}, {"id": "56068f3f-6c02-35da-a141-163caeed93f8", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "70accf74-5451-3630-bfad-b6dc3b5ac7f4", "product": {"name": "Linux"}, "product_version": "5.7"}, {"id": "8a4f3145-1543-3e11-9199-9dd26ca0c01d", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "8ef63b08-0c03-3182-b1a7-9c49798b3d1a", "product": {"name": "Linux"}, "product_version": "1039221cc2787dee51a7ffbf9b0e79d192dadf76 <9674390ac540ed06768e3fbc2dba553929fbd736"}, {"id": "aafab608-ea89-34c6-ba17-accba0eb6108", "product": {"name": "Linux"}, "product_version": "patch: 5.15.99"}, {"id": "c9272430-fd28-379e-80ac-97a038071373", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}, {"id": "ccad3650-34b3-3e0b-bc78-3f91d00b89dc", "product": {"name": "Linux"}, "product_version": "1039221cc2787dee51a7ffbf9b0e79d192dadf76 <8843e06f67b14f71c044bf6267b2387784c7e198"}, {"id": "dd338fc2-a15f-3c81-876e-07a7563ccffc", "product": {"name": "Linux"}, "product_version": "1039221cc2787dee51a7ffbf9b0e79d192dadf76 <6e02a43acd0691791df79ce538f2dd497a6c9b76"}, {"id": "e01ffaa7-17b0-3639-8172-81f6f04df471", "product": {"name": "Linux"}, "product_version": "1039221cc2787dee51a7ffbf9b0e79d192dadf76 <09b1bf25f7f7a8f2bf8cd4278bba9c3172db8013"}], "enisaIdVendor": [{"id": "68f3c6c0-cd3f-3658-a279-7d77f5154efc", "vendor": {"name": "Linux"}}], "isExploited": false}