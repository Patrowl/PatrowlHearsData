{"id": "EUVD-2023-60383", "enisaUuid": "baa752d6-d074-357d-b390-000e539843f0", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncifs: fix potential oops in cifs_oplock_break\n\nWith deferred close we can have closes that race with lease breaks,\nand so with the current checks for whether to send the lease response,\noplock_response(), this can mean that an unmount (kill_sb) can occur\njust before we were checking if the tcon->ses is valid.  See below:\n\n[Fri Aug  4 04:12:50 2023] RIP: 0010:cifs_oplock_break+0x1f7/0x5b0 [cifs]\n[Fri Aug  4 04:12:50 2023] Code: 7d a8 48 8b 7d c0 c0 e9 02 48 89 45 b8 41 89 cf e8 3e f5 ff ff 4c 89 f7 41 83 e7 01 e8 82 b3 03 f2 49 8b 45 50 48 85 c0 74 5e <48> 83 78 60 00 74 57 45 84 ff 75 52 48 8b 43 98 48 83 eb 68 48 39\n[Fri Aug  4 04:12:50 2023] RSP: 0018:ffffb30607ddbdf8 EFLAGS: 00010206\n[Fri Aug  4 04:12:50 2023] RAX: 632d223d32612022 RBX: ffff97136944b1e0 RCX: 0000000080100009\n[Fri Aug  4 04:12:50 2023] RDX: 0000000000000001 RSI: 0000000080100009 RDI: ffff97136944b188\n[Fri Aug  4 04:12:50 2023] RBP: ffffb30607ddbe58 R08: 0000000000000001 R09: ffffffffc08e0900\n[Fri Aug  4 04:12:50 2023] R10: 0000000000000001 R11: 000000000000000f R12: ffff97136944b138\n[Fri Aug  4 04:12:50 2023] R13: ffff97149147c000 R14: ffff97136944b188 R15: 0000000000000000\n[Fri Aug  4 04:12:50 2023] FS:  0000000000000000(0000) GS:ffff9714f7c00000(0000) knlGS:0000000000000000\n[Fri Aug  4 04:12:50 2023] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[Fri Aug  4 04:12:50 2023] CR2: 00007fd8de9c7590 CR3: 000000011228e000 CR4: 0000000000350ef0\n[Fri Aug  4 04:12:50 2023] Call Trace:\n[Fri Aug  4 04:12:50 2023]  <TASK>\n[Fri Aug  4 04:12:50 2023]  process_one_work+0x225/0x3d0\n[Fri Aug  4 04:12:50 2023]  worker_thread+0x4d/0x3e0\n[Fri Aug  4 04:12:50 2023]  ? process_one_work+0x3d0/0x3d0\n[Fri Aug  4 04:12:50 2023]  kthread+0x12a/0x150\n[Fri Aug  4 04:12:50 2023]  ? set_kthread_struct+0x50/0x50\n[Fri Aug  4 04:12:50 2023]  ret_from_fork+0x22/0x30\n[Fri Aug  4 04:12:50 2023]  </TASK>\n\nTo fix this change the ordering of the checks before sending the oplock_response\nto first check if the openFileList is empty.", "datePublished": "2025-12-30T15:30:33", "dateUpdated": "2025-12-30T15:30:34", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b99f490ea87ebcca3a429fd8837067feb56a4c7c", "https://git.kernel.org/stable/c/5ee28bcfbaacf289eb25c662a2862542ea6ce6a7", "https://git.kernel.org/stable/c/6b67a6d2e50634fe127e656147c81915955e9f5e", "https://git.kernel.org/stable/c/e8f5f849ffce24490eb9449e98312b66c0dba76f", "https://nvd.nist.gov/vuln/detail/CVE-2023-54258"], "aliases": ["CVE-2023-54258"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2dece8e8-9b9f-3438-bd8c-04b5a35d745a", "product": {"name": "Linux"}, "product_version": "5.15.121 <5.15.128"}, {"id": "7771375b-d634-308d-b96b-3160cae4ad28", "product": {"name": "Linux"}, "product_version": "6.1.39 <6.1.47"}, {"id": "847b9324-8603-3f24-9f00-6bfc0a3317cf", "product": {"name": "Linux"}, "product_version": "cff7fb969edaeff2bc80c8a8f7cf7b0c8df32da7"}, {"id": "88e172f6-512a-377c-ab39-fe1fdd8bd205", "product": {"name": "Linux"}, "product_version": "1bf709b9625001eefdd41048c5f4c7544ee33394 <5ee28bcfbaacf289eb25c662a2862542ea6ce6a7"}, {"id": "ba9affb2-2d9a-3778-9d87-344a095de482", "product": {"name": "Linux"}, "product_version": "3b4c15171c3ce9120c81f5564b9367d8d0f4219c <6b67a6d2e50634fe127e656147c81915955e9f5e"}, {"id": "c2337cce-a429-35c4-a1e4-9e419125b71a", "product": {"name": "Linux"}, "product_version": "da787d5b74983f7525d1eb4b9c0b4aff2821511a <e8f5f849ffce24490eb9449e98312b66c0dba76f"}, {"id": "cfc41c3d-8f69-3be6-8f12-2c85b2dd48d7", "product": {"name": "Linux"}, "product_version": "6.4.4 <6.4.12"}, {"id": "f6927266-1663-3be8-9fe3-08f152484529", "product": {"name": "Linux"}, "product_version": "63fb45ddc491895c4b36664e0c2c3b548545ae93 <b99f490ea87ebcca3a429fd8837067feb56a4c7c"}], "enisaIdVendor": [{"id": "ba632c99-825d-3c36-b427-634010411256", "vendor": {"name": "Linux"}}], "isExploited": false}