{"id": "EUVD-2023-59972", "enisaUuid": "d67a7d1e-8661-3af1-a240-14424487ad05", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nskbuff: skb_segment, Call zero copy functions before using skbuff frags\n\nCommit bf5c25d60861 (\"skbuff: in skb_segment, call zerocopy functions\nonce per nskb\") added the call to zero copy functions in skb_segment().\nThe change introduced a bug in skb_segment() because skb_orphan_frags()\nmay possibly change the number of fragments or allocate new fragments\naltogether leaving nrfrags and frag to point to the old values. This can\ncause a panic with stacktrace like the one below.\n\n[  193.894380] BUG: kernel NULL pointer dereference, address: 00000000000000bc\n[  193.895273] CPU: 13 PID: 18164 Comm: vh-net-17428 Kdump: loaded Tainted: G           O      5.15.123+ #26\n[  193.903919] RIP: 0010:skb_segment+0xb0e/0x12f0\n[  194.021892] Call Trace:\n[  194.027422]  <TASK>\n[  194.072861]  tcp_gso_segment+0x107/0x540\n[  194.082031]  inet_gso_segment+0x15c/0x3d0\n[  194.090783]  skb_mac_gso_segment+0x9f/0x110\n[  194.095016]  __skb_gso_segment+0xc1/0x190\n[  194.103131]  netem_enqueue+0x290/0xb10 [sch_netem]\n[  194.107071]  dev_qdisc_enqueue+0x16/0x70\n[  194.110884]  __dev_queue_xmit+0x63b/0xb30\n[  194.121670]  bond_start_xmit+0x159/0x380 [bonding]\n[  194.128506]  dev_hard_start_xmit+0xc3/0x1e0\n[  194.131787]  __dev_queue_xmit+0x8a0/0xb30\n[  194.138225]  macvlan_start_xmit+0x4f/0x100 [macvlan]\n[  194.141477]  dev_hard_start_xmit+0xc3/0x1e0\n[  194.144622]  sch_direct_xmit+0xe3/0x280\n[  194.147748]  __dev_queue_xmit+0x54a/0xb30\n[  194.154131]  tap_get_user+0x2a8/0x9c0 [tap]\n[  194.157358]  tap_sendmsg+0x52/0x8e0 [tap]\n[  194.167049]  handle_tx_zerocopy+0x14e/0x4c0 [vhost_net]\n[  194.173631]  handle_tx+0xcd/0xe0 [vhost_net]\n[  194.176959]  vhost_worker+0x76/0xb0 [vhost]\n[  194.183667]  kthread+0x118/0x140\n[  194.190358]  ret_from_fork+0x1f/0x30\n[  194.193670]  </TASK>\n\nIn this case calling skb_orphan_frags() updated nr_frags leaving nrfrags\nlocal variable in skb_segment() stale. This resulted in the code hitting\ni >= nrfrags prematurely and trying to move to next frag_skb using\nlist_skb pointer, which was NULL, and caused kernel panic. Move the call\nto zero copy functions before using frags and nr_frags.", "datePublished": "2025-09-17T15:30:38", "dateUpdated": "2025-12-11T15:30:30", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/fcab3f661dbfd88e27ddbbe65368f3fa2d823175", "https://git.kernel.org/stable/c/d44403ec0676317b7f7edf2a035bb219fee3304e", "https://git.kernel.org/stable/c/8836c266201c29a5acb4f582227686f47b65ad61", "https://git.kernel.org/stable/c/d5790386595d06ea9decfd9ba5f1ea48cf09aa02", "https://git.kernel.org/stable/c/04c3eee4e13f60bf6f9a366ad39f88a01a57166e", "https://git.kernel.org/stable/c/f99006e840a4dbc8f5a34cecc6b5b26c73ef49bb", "https://git.kernel.org/stable/c/6c26ed3c6abe86ddab0510529000b970b05c9b40", "https://git.kernel.org/stable/c/2ea35288c83b3d501a88bc17f2df8f176b5cc96f", "https://nvd.nist.gov/vuln/detail/CVE-2023-53354"], "aliases": ["CVE-2023-53354"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0979530a-238c-386f-b7a1-8f1ef64ee025", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <8836c266201c29a5acb4f582227686f47b65ad61"}, {"id": "185bea3e-8e63-3a02-968f-5c065d947b1c", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1c203b23-4f8a-3fb2-9296-f496effcab1f", "product": {"name": "Linux"}, "product_version": "4.16"}, {"id": "1f789a71-981b-36c7-ad96-45b1ed2bdda8", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <d5790386595d06ea9decfd9ba5f1ea48cf09aa02"}, {"id": "257b379c-dd35-388a-bde7-94fe37305c1b", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <d44403ec0676317b7f7edf2a035bb219fee3304e"}, {"id": "2a8b33dd-f95d-3772-b89c-8d4e4a3a4d7a", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <04c3eee4e13f60bf6f9a366ad39f88a01a57166e"}, {"id": "6b319949-c129-34eb-ab60-01be924f71d5", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <f99006e840a4dbc8f5a34cecc6b5b26c73ef49bb"}, {"id": "71e4b4b4-b7d7-3ad5-bd94-ce08be2c0dd7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.132"}, {"id": "8601c080-437f-3efc-9a99-c35b24dde06d", "product": {"name": "Linux"}, "product_version": "patch: 6.1.53"}, {"id": "8d605ce7-dd86-308d-bfb8-1ad004c6f46f", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <2ea35288c83b3d501a88bc17f2df8f176b5cc96f"}, {"id": "9961eab3-52c2-3571-ae11-c88475c87274", "product": {"name": "Linux"}, "product_version": "patch: 4.19.295"}, {"id": "a741427c-4d96-3280-a179-ffde3e281c41", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <6c26ed3c6abe86ddab0510529000b970b05c9b40"}, {"id": "ad2138e2-5498-39e7-aa9b-2bb99d3720d9", "product": {"name": "Linux"}, "product_version": "bf5c25d608613eaf4dcdba5a9cac5b2afe67d635 <fcab3f661dbfd88e27ddbbe65368f3fa2d823175"}, {"id": "b278b04e-0ab3-38bd-a5dc-4426422b7a13", "product": {"name": "Linux"}, "product_version": "patch: 6.4.16"}, {"id": "bc0aa0dc-8f37-3984-9355-d09ac83009b8", "product": {"name": "Linux"}, "product_version": "patch: 5.4.257"}, {"id": "dcd9fc7f-d2a6-387e-a247-5f679a37c9d0", "product": {"name": "Linux"}, "product_version": "patch: 6.5.3"}, {"id": "e25cd581-c0f5-3edd-a2bc-cba7b39ebd6c", "product": {"name": "Linux"}, "product_version": "patch: 5.10.195"}, {"id": "e9676e00-a925-3ce2-82f9-f36c68f417e1", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}], "enisaIdVendor": [{"id": "d79e5996-f99c-3c4b-8288-0255e97586f4", "vendor": {"name": "Linux"}}], "isExploited": false}