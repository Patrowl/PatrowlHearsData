{"id": "EUVD-2023-60333", "enisaUuid": "efef2e16-6a68-3212-b608-d15f29e4b53c", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nkcm: Fix memory leak in error path of kcm_sendmsg()\n\nsyzbot reported a memory leak like below:\n\nBUG: memory leak\nunreferenced object 0xffff88810b088c00 (size 240):\n  comm \"syz-executor186\", pid 5012, jiffies 4294943306 (age 13.680s)\n  hex dump (first 32 bytes):\n    00 89 08 0b 81 88 ff ff 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [<ffffffff83e5d5ff>] __alloc_skb+0x1ef/0x230 net/core/skbuff.c:634\n    [<ffffffff84606e59>] alloc_skb include/linux/skbuff.h:1289 [inline]\n    [<ffffffff84606e59>] kcm_sendmsg+0x269/0x1050 net/kcm/kcmsock.c:815\n    [<ffffffff83e479c6>] sock_sendmsg_nosec net/socket.c:725 [inline]\n    [<ffffffff83e479c6>] sock_sendmsg+0x56/0xb0 net/socket.c:748\n    [<ffffffff83e47f55>] ____sys_sendmsg+0x365/0x470 net/socket.c:2494\n    [<ffffffff83e4c389>] ___sys_sendmsg+0xc9/0x130 net/socket.c:2548\n    [<ffffffff83e4c536>] __sys_sendmsg+0xa6/0x120 net/socket.c:2577\n    [<ffffffff84ad7bb8>] do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n    [<ffffffff84ad7bb8>] do_syscall_64+0x38/0xb0 arch/x86/entry/common.c:80\n    [<ffffffff84c0008b>] entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nIn kcm_sendmsg(), kcm_tx_msg(head)->last_skb is used as a cursor to append\nnewly allocated skbs to 'head'. If some bytes are copied, an error occurred,\nand jumped to out_error label, 'last_skb' is left unmodified. A later\nkcm_sendmsg() will use an obsoleted 'last_skb' reference, corrupting the\n'head' frag_list and causing the leak.\n\nThis patch fixes this issue by properly updating the last allocated skb in\n'last_skb'.", "datePublished": "2025-12-24T15:30:38", "dateUpdated": "2025-12-24T15:30:38", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/8dc7eb757b1652b82725f32e0c89a1e9f6c0e13b", "https://git.kernel.org/stable/c/5e5554389397e98fafb9efe395d8b4830dd5f042", "https://git.kernel.org/stable/c/479c71cda14b3c3a6515773faa39055333eaa2b7", "https://git.kernel.org/stable/c/33db24ad811b3576a0c2f8862506763f2be925b0", "https://git.kernel.org/stable/c/97275339c34cfbccd65e87bc38fd910ae66c48ba", "https://git.kernel.org/stable/c/16989de75497574b5fafd174c0c233d5a86858b7", "https://git.kernel.org/stable/c/af8085e0fc3207ecbf8b9e7a635c790e36d058c6", "https://git.kernel.org/stable/c/c821a88bd720b0046433173185fd841a100d44ad", "https://nvd.nist.gov/vuln/detail/CVE-2023-54112"], "aliases": ["CVE-2023-54112"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "062b3ede-ae1b-3c5c-a82f-220f25ab0cac", "product": {"name": "Linux"}, "product_version": "patch: 4.19.295"}, {"id": "163c22fb-ba82-380d-9005-7a353253be62", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <33db24ad811b3576a0c2f8862506763f2be925b0"}, {"id": "1b8b5dd5-4b75-3860-870d-364c498bbcac", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "2c188f22-d7e8-3397-86e3-a2b5efd73eab", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <97275339c34cfbccd65e87bc38fd910ae66c48ba"}, {"id": "331b3ac2-d4de-3e01-977e-1ea82efdb3ee", "product": {"name": "Linux"}, "product_version": "patch: 5.4.257"}, {"id": "3ac379cb-55c9-3e50-867d-06d98d0abc8d", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <c821a88bd720b0046433173185fd841a100d44ad"}, {"id": "4656000b-b47f-38cc-94d2-4868d7d70008", "product": {"name": "Linux"}, "product_version": "patch: 4.14.326"}, {"id": "4f4c5786-b10c-3b88-91ae-e2b4fff341d6", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <8dc7eb757b1652b82725f32e0c89a1e9f6c0e13b"}, {"id": "538f762d-f1e6-39af-9291-92d43fee3869", "product": {"name": "Linux"}, "product_version": "patch: 6.1.54"}, {"id": "629aa0a9-b452-30e1-a88b-b67a97194fb0", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <5e5554389397e98fafb9efe395d8b4830dd5f042"}, {"id": "673fbed6-77fb-31fb-9c59-102c23fe5160", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <af8085e0fc3207ecbf8b9e7a635c790e36d058c6"}, {"id": "af5f5d41-9a79-37dd-afc2-2c240179fa88", "product": {"name": "Linux"}, "product_version": "patch: 5.10.195"}, {"id": "ba7ae843-3241-3671-886f-7473592cb20b", "product": {"name": "Linux"}, "product_version": "4.6"}, {"id": "bd3402eb-2358-3fdf-94e5-8919dd92c638", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <479c71cda14b3c3a6515773faa39055333eaa2b7"}, {"id": "c2a4b4bf-6408-3e1c-82e1-fa0618ccb245", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "cd5ab5af-adba-304d-983b-766b2cec0926", "product": {"name": "Linux"}, "product_version": "patch: 6.5.4"}, {"id": "d689bab6-c3db-3f38-8ad9-6bac4eae5df7", "product": {"name": "Linux"}, "product_version": "patch: 5.15.132"}, {"id": "df477064-9562-3ee9-9dd4-da51ef57af58", "product": {"name": "Linux"}, "product_version": "ab7ac4eb9832e32a09f4e8042705484d2fb0aad3 <16989de75497574b5fafd174c0c233d5a86858b7"}], "enisaIdVendor": [{"id": "3933fb85-79e0-37fe-a543-16b3fb40d111", "vendor": {"name": "Linux"}}], "isExploited": false}