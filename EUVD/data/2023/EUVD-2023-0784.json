{"id": "EUVD-2023-0784", "enisaUuid": "e405ee14-e37b-3ae5-af23-fcc7e7036252", "description": "TYPO3 is a free and open source Content Management Framework released under the GNU General Public License. In affected versions the TYPO3 core component `GeneralUtility::getIndpEnv()` uses the unfiltered server environment variable `PATH_INFO`, which allows attackers to inject malicious content. In combination with the TypoScript setting `config.absRefPrefix=auto`, attackers can inject malicious HTML code to pages that have not been rendered and cached, yet. As a result, injected values would be cached and delivered to other website visitors (persisted cross-site scripting). Individual code which relies on the resolved value of `GeneralUtility::getIndpEnv('SCRIPT_NAME')` and corresponding usages (as shown below) are vulnerable as well. Additional investigations confirmed that at least Apache web server deployments using CGI (FPM, FCGI/FastCGI, and similar) are affected. However, there still might be the risk that other scenarios like nginx, IIS, or Apache/mod_php are vulnerable. The usage of server environment variable `PATH_INFO` has been removed from corresponding processings in `GeneralUtility::getIndpEnv()`. Besides that, the public property `TypoScriptFrontendController::$absRefPrefix` is encoded for both being used as a URI component and for being used as a prefix in an HTML context. This mitigates the cross-site scripting vulnerability. Users are advised to update to TYPO3 versions 8.7.51 ELTS, 9.5.40 ELTS, 10.4.35 LTS, 11.5.23 LTS and 12.2.0 which fix this problem. For users who are unable to patch in a timely manner the TypoScript setting `config.absRefPrefix` should at least be set to a static path value, instead of using auto - e.g. `config.absRefPrefix=/`. This workaround **does not fix all aspects of the vulnerability**, and is just considered to be an intermediate mitigation to the most prominent manifestation.", "datePublished": "2023-02-07T18:14:29", "dateUpdated": "2024-08-02T11:03:19", "baseScore": 8.8, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:L", "references": ["https://github.com/TYPO3/typo3/security/advisories/GHSA-r4f8-f93x-5qh3", "https://nvd.nist.gov/vuln/detail/CVE-2023-24814", "https://github.com/TYPO3/typo3/commit/0005a6fd86ab97eff8bf2e3a5828bf0e7cb6263a", "https://docs.typo3.org/m/typo3/reference-typoscript/main/en-us/Setup/Config/Index.html#absrefprefix", "https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/CVE-2023-24814.yaml", "https://github.com/TYPO3/typo3", "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/core/Classes/Utility/GeneralUtility.php#L2481-L2484", "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/frontend/Classes/Controller/TypoScriptFrontendController.php#L2547-L2549", "https://typo3.org/security/advisory/typo3-core-sa-2023-001", "https://typo3.org/security/advisory/typo3-psa-2023-001"], "aliases": ["CVE-2023-24814", "GHSA-r4f8-f93x-5qh3"], "assigner": "GitHub_M", "epss": 0.3, "enisaIdProduct": [{"id": "0e76f3da-e78b-31d1-aec7-6533fe7180ad", "product": {"name": "typo3"}, "product_version": "9.0.0, < 9.5.40"}, {"id": "46652670-9639-364f-9e40-2bda3006c50a", "product": {"name": "typo3"}, "product_version": "11.0.0, < 11.5.23"}, {"id": "79503689-e7be-3eb9-9f95-f1dc5c12818b", "product": {"name": "typo3"}, "product_version": "12.0.0, < 12.2.0"}, {"id": "84958984-ceb7-3465-8b29-865d720b80c3", "product": {"name": "typo3"}, "product_version": "10.0.0, < 10.4.36"}, {"id": "cc58ca6c-2583-3ddd-ac02-a1e7b1d9e1b5", "product": {"name": "typo3"}, "product_version": "8.7.0, < 8.7.51"}], "enisaIdVendor": [{"id": "d7c350a4-9830-3edb-905a-5c3384e6383c", "vendor": {"name": "TYPO3"}}], "isExploited": false}