{"id": "EUVD-2023-60328", "enisaUuid": "c6442db8-fc91-31ef-9bf9-54818edfa382", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ns390/dcssblk: fix kernel crash with list_add corruption\n\nCommit fb08a1908cb1 (\"dax: simplify the dax_device <-> gendisk\nassociation\") introduced new logic for gendisk association, requiring\ndrivers to explicitly call dax_add_host() and dax_remove_host().\n\nFor dcssblk driver, some dax_remove_host() calls were missing, e.g. in\ndevice remove path. The commit also broke error handling for out_dax case\nin device add path, resulting in an extra put_device() w/o the previous\nget_device() in that case.\n\nThis lead to stale xarray entries after device add / remove cycles. In the\ncase when a previously used struct gendisk pointer (xarray index) would be\nused again, because blk_alloc_disk() happened to return such a pointer, the\nxa_insert() in dax_add_host() would fail and go to out_dax, doing the extra\nput_device() in the error path. In combination with an already flawed error\nhandling in dcssblk (device_register() cleanup), which needs to be\naddressed in a separate patch, this resulted in a missing device_del() /\nklist_del(), and eventually in the kernel crash with list_add corruption on\na subsequent device_add() / klist_add().\n\nFix this by adding the missing dax_remove_host() calls, and also move the\nput_device() in the error path to restore the previous logic.", "datePublished": "2025-12-24T15:30:38", "dateUpdated": "2025-12-24T15:30:38", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/6489ec0107860345bc57dcde39e63dfb05ac5c11", "https://git.kernel.org/stable/c/b7ad75c77349beb4983b9f27108d9b3f33ae1413", "https://git.kernel.org/stable/c/b5c531a9a7d8e047c90c909f09cef06a9f8e62f4", "https://git.kernel.org/stable/c/c8f40a0bccefd613748d080147469a4652d6e74c", "https://nvd.nist.gov/vuln/detail/CVE-2023-54117"], "aliases": ["CVE-2023-54117"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1d4a5b5b-8f5e-3b6c-a65b-a5503b8c0732", "product": {"name": "Linux"}, "product_version": "patch: 6.1.53"}, {"id": "59f034e0-2944-31c8-8167-8de92a9f7a98", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5a71b3a5-a5a2-319f-b970-5e9f40119ff9", "product": {"name": "Linux"}, "product_version": "fb08a1908cb119a4585611d91461ab6d27756b14 <6489ec0107860345bc57dcde39e63dfb05ac5c11"}, {"id": "69950e30-5b3c-36ee-afa8-1eeef18577c2", "product": {"name": "Linux"}, "product_version": "patch: 6.4.16"}, {"id": "6c37e792-3972-3b5b-a579-b3e10ecb8500", "product": {"name": "Linux"}, "product_version": "fb08a1908cb119a4585611d91461ab6d27756b14 <b5c531a9a7d8e047c90c909f09cef06a9f8e62f4"}, {"id": "88a5386f-2b54-3ca5-a5f3-763ad809a8b4", "product": {"name": "Linux"}, "product_version": "fb08a1908cb119a4585611d91461ab6d27756b14 <c8f40a0bccefd613748d080147469a4652d6e74c"}, {"id": "9b88d433-7167-3b03-bb3b-c2fc6fc93704", "product": {"name": "Linux"}, "product_version": "fb08a1908cb119a4585611d91461ab6d27756b14 <b7ad75c77349beb4983b9f27108d9b3f33ae1413"}, {"id": "b59ceccf-86e3-37de-a4e8-85beadbe05f1", "product": {"name": "Linux"}, "product_version": "5.17"}, {"id": "d377105f-e109-3c6f-a48c-665279ff7963", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "fdc12df5-f678-35ea-afb2-4e1f5d56c436", "product": {"name": "Linux"}, "product_version": "patch: 6.5.3"}], "enisaIdVendor": [{"id": "a94edf58-42ca-335c-85ea-41fd8bd440d6", "vendor": {"name": "Linux"}}], "isExploited": false}