{"id": "EUVD-2023-0265", "enisaUuid": "2ef77d29-ca90-34d2-a710-aa6d3e332046", "description": "Vyer is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM). In versions 0.2.15, 0.2.16 and 0.3.0, named re-entrancy locks are allocated incorrectly. Each function using a named re-entrancy lock gets a unique lock regardless of the key, allowing cross-function re-entrancy in contracts compiled with the susceptible versions. A specific set of conditions is required to result in misbehavior of affected contracts, specifically: a `.vy` contract compiled with `vyper` versions `0.2.15`, `0.2.16`, or `0.3.0`; a primary function that utilizes the `@nonreentrant` decorator with a specific `key` and does not strictly follow the check-effects-interaction pattern (i.e. contains an external call to an untrusted party before storage updates); and a secondary function that utilizes the same `key` and would be affected by the improper state caused by the primary function. Version 0.3.1 contains a fix for this issue.", "datePublished": "2023-08-07T10:15:00", "dateUpdated": "2023-08-17T06:22:33", "baseScore": 9.1, "baseScoreVersion": "4.0", "baseScoreVector": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:H/VA:H/SC:N/SI:H/SA:H/E:A", "references": ["https://github.com/vyperlang/vyper/security/advisories/GHSA-5824-cm3x-3c38", "https://github.com/vyperlang/vyper/security/advisories/GHSA-5824-cm3x-3c38", "https://github.com/vyperlang/vyper/security/advisories/GHSA-5824-cm3x-3c38", "https://hackmd.io/@LlamaRisk/BJzSKHNjn", "https://hackmd.io/@LlamaRisk/BJzSKHNjn", "https://hackmd.io/@vyperlang/HJUgNMhs2", "https://hackmd.io/@vyperlang/HJUgNMhs2", "https://github.com/vyperlang/vyper/pull/2514", "https://github.com/vyperlang/vyper/pull/2439", "https://nvd.nist.gov/vuln/detail/CVE-2023-39363", "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-142.yaml"], "aliases": ["CVE-2023-39363", "GHSA-5824-cm3x-3c38", "PYSEC-2023-142"], "assigner": "GitHub_M", "epss": 0.07, "enisaIdProduct": [{"id": "04b782b5-53b9-3b4d-83da-95baaba1edcd", "product": {"name": "vyper"}, "product_version": "= 0.3.0"}, {"id": "17613bab-559f-348e-b59b-b023f5bb9f77", "product": {"name": "vyper"}, "product_version": "= 0.2.16"}, {"id": "4317d54c-2b5e-3fc6-8a80-3873c18363d5", "product": {"name": "vyper"}, "product_version": "= 0.2.15"}], "enisaIdVendor": [{"id": "49f7c655-220d-3e37-b4e4-5dae81ee022b", "vendor": {"name": "vyperlang"}}], "isExploited": false}