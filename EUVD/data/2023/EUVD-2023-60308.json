{"id": "EUVD-2023-60308", "enisaUuid": "a2982cf5-0731-399c-98b7-9522054808f5", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvfio/type1: fix cap_migration information leak\n\nFix an information leak where an uninitialized hole in struct\nvfio_iommu_type1_info_cap_migration on the stack is exposed to userspace.\n\nThe definition of struct vfio_iommu_type1_info_cap_migration contains a hole as\nshown in this pahole(1) output:\n\n  struct vfio_iommu_type1_info_cap_migration {\n          struct vfio_info_cap_header header;              /*     0     8 */\n          __u32                      flags;                /*     8     4 */\n\n          /* XXX 4 bytes hole, try to pack */\n\n          __u64                      pgsize_bitmap;        /*    16     8 */\n          __u64                      max_dirty_bitmap_size; /*    24     8 */\n\n          /* size: 32, cachelines: 1, members: 4 */\n          /* sum members: 28, holes: 1, sum holes: 4 */\n          /* last cacheline: 32 bytes */\n  };\n\nThe cap_mig variable is filled in without initializing the hole:\n\n  static int vfio_iommu_migration_build_caps(struct vfio_iommu *iommu,\n                         struct vfio_info_cap *caps)\n  {\n      struct vfio_iommu_type1_info_cap_migration cap_mig;\n\n      cap_mig.header.id = VFIO_IOMMU_TYPE1_INFO_CAP_MIGRATION;\n      cap_mig.header.version = 1;\n\n      cap_mig.flags = 0;\n      /* support minimum pgsize */\n      cap_mig.pgsize_bitmap = (size_t)1 << __ffs(iommu->pgsize_bitmap);\n      cap_mig.max_dirty_bitmap_size = DIRTY_BITMAP_SIZE_MAX;\n\n      return vfio_info_add_capability(caps, &cap_mig.header, sizeof(cap_mig));\n  }\n\nThe structure is then copied to a temporary location on the heap. At this point\nit's already too late and ioctl(VFIO_IOMMU_GET_INFO) copies it to userspace\nlater:\n\n  int vfio_info_add_capability(struct vfio_info_cap *caps,\n                   struct vfio_info_cap_header *cap, size_t size)\n  {\n      struct vfio_info_cap_header *header;\n\n      header = vfio_info_cap_add(caps, size, cap->id, cap->version);\n      if (IS_ERR(header))\n          return PTR_ERR(header);\n\n      memcpy(header + 1, cap + 1, size - sizeof(*header));\n\n      return 0;\n  }\n\nThis issue was found by code inspection.", "datePublished": "2025-12-24T15:30:39", "dateUpdated": "2025-12-24T15:30:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/ad83d83dd891244de0d07678b257dc976db7c132", "https://git.kernel.org/stable/c/13fd667db999bffb557c5de7adb3c14f1713dd51", "https://git.kernel.org/stable/c/f6f300ecc196d243c02adeb9ee0c62c677c24bfb", "https://git.kernel.org/stable/c/cbac29a1caa49a34e131394e1f4d924a76d8b0c9", "https://git.kernel.org/stable/c/1b5feb8497cdb5b9962db2700814bffbc030fb4a", "https://git.kernel.org/stable/c/cd24e2a60af633f157d7e59c0a6dba64f131c0b1", "https://nvd.nist.gov/vuln/detail/CVE-2023-54137"], "aliases": ["CVE-2023-54137"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "3b883e1b-9d5e-320f-b817-7d93567ce4d3", "product": {"name": "Linux"}, "product_version": "patch: 6.4.16"}, {"id": "43b88aee-3a4c-3a65-b521-aac395f6995c", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <13fd667db999bffb557c5de7adb3c14f1713dd51"}, {"id": "5b1db7e4-9b26-3853-9d14-0b9f9222821e", "product": {"name": "Linux"}, "product_version": "patch: 6.5.3"}, {"id": "64d3c2d3-c54e-3eff-90f4-8be3965dd818", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <cd24e2a60af633f157d7e59c0a6dba64f131c0b1"}, {"id": "6bdf21a0-f604-3df4-9e32-58f90cb09feb", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <cbac29a1caa49a34e131394e1f4d924a76d8b0c9"}, {"id": "715bf408-1728-3264-b6fa-680a3ced1bac", "product": {"name": "Linux"}, "product_version": "patch: 5.15.132"}, {"id": "83b316fa-0ce6-36db-9904-5f91ceefa828", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "8523eedd-2db6-3faa-a1dc-9959fb9e8af5", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "95b68bd1-1b38-3d3b-95d7-36b54126c2a8", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <f6f300ecc196d243c02adeb9ee0c62c677c24bfb"}, {"id": "a560164e-e87b-37c6-b213-d7670f40c5f4", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <ad83d83dd891244de0d07678b257dc976db7c132"}, {"id": "adcfdddd-1d51-341d-878e-a8b256b0f280", "product": {"name": "Linux"}, "product_version": "ad721705d09c62f0d108a6b4f59867ebfd592c90 <1b5feb8497cdb5b9962db2700814bffbc030fb4a"}, {"id": "ae8bf10f-f50a-3bb3-833a-445bb6cb121b", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "fa468a8f-bf84-33e4-9eba-5cedd39946f0", "product": {"name": "Linux"}, "product_version": "patch: 6.1.53"}, {"id": "fce6e816-35d2-3c4f-9f6c-2dca37800ae5", "product": {"name": "Linux"}, "product_version": "patch: 5.10.195"}], "enisaIdVendor": [{"id": "44196541-5b68-38de-8d62-2e798808be4d", "vendor": {"name": "Linux"}}], "isExploited": false}