{"id": "EUVD-2023-60460", "enisaUuid": "d1fe3143-e480-3cea-b9f1-39a78b096963", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix issue in verifying allow_ptr_leaks\n\nAfter we converted the capabilities of our networking-bpf program from\ncap_sys_admin to cap_net_admin+cap_bpf, our networking-bpf program\nfailed to start. Because it failed the bpf verifier, and the error log\nis \"R3 pointer comparison prohibited\".\n\nA simple reproducer as follows,\n\nSEC(\"cls-ingress\")\nint ingress(struct __sk_buff *skb)\n{\n\tstruct iphdr *iph = (void *)(long)skb->data + sizeof(struct ethhdr);\n\n\tif ((long)(iph + 1) > (long)skb->data_end)\n\t\treturn TC_ACT_STOLEN;\n\treturn TC_ACT_OK;\n}\n\nPer discussion with Yonghong and Alexei [1], comparison of two packet\npointers is not a pointer leak. This patch fixes it.\n\nOur local kernel is 6.1.y and we expect this fix to be backported to\n6.1.y, so stable is CCed.\n\n[1]. https://lore.kernel.org/bpf/CAADnVQ+Nmspr7Si+pxWn8zkE7hX-7s93ugwC+94aXSy4uQ9vBg@mail.gmail.com/", "datePublished": "2025-12-30T12:08:52", "dateUpdated": "2026-01-05T10:51:18", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/c96c67991aac6401b4c6996093bccb704bb2ea4b", "https://git.kernel.org/stable/c/5927f0172d2809d8fc09c1ba667280b0387e9f73", "https://git.kernel.org/stable/c/acfdc8b77016c8e648aadc283177546c88083dd3", "https://git.kernel.org/stable/c/d75e30dddf73449bc2d10bb8e2f1a2c446bc67a2", "https://nvd.nist.gov/vuln/detail/CVE-2023-54181"], "aliases": ["CVE-2023-54181"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "1bf8ee43-f6a1-3575-a63a-5d0dd684b0c1", "product": {"name": "Linux"}, "product_version": "5.8"}, {"id": "2973370f-5126-329e-ad79-280353bb2805", "product": {"name": "Linux"}, "product_version": "patch: 6.4.16"}, {"id": "4b1d10bd-f6b2-3828-85a1-1fd3bfbc90c8", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5aae7712-d293-3401-adba-db61f8268428", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c96c67991aac6401b4c6996093bccb704bb2ea4b"}, {"id": "6ddd8214-b672-36f4-b1f0-b0bff0b2bd98", "product": {"name": "Linux"}, "product_version": "2c78ee898d8f10ae6fb2fa23a3fbaec96b1b7366 <d75e30dddf73449bc2d10bb8e2f1a2c446bc67a2"}, {"id": "8d69e6eb-4950-333b-9f5c-00f94f71540a", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <acfdc8b77016c8e648aadc283177546c88083dd3"}, {"id": "9fab9a5a-8eaa-316d-abfc-5700a9546660", "product": {"name": "Linux"}, "product_version": "2c78ee898d8f10ae6fb2fa23a3fbaec96b1b7366 <acfdc8b77016c8e648aadc283177546c88083dd3"}, {"id": "b2340868-737b-369f-8c8a-5127130a0a00", "product": {"name": "Linux"}, "product_version": "2c78ee898d8f10ae6fb2fa23a3fbaec96b1b7366 <c96c67991aac6401b4c6996093bccb704bb2ea4b"}, {"id": "b60d37dd-4d9d-353a-8bc5-61820d9b457e", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5927f0172d2809d8fc09c1ba667280b0387e9f73"}, {"id": "d16384b5-d08a-3d36-bf78-145fdaa28cc4", "product": {"name": "Linux"}, "product_version": "2c78ee898d8f10ae6fb2fa23a3fbaec96b1b7366 <5927f0172d2809d8fc09c1ba667280b0387e9f73"}, {"id": "d3d1e253-41df-3583-a515-92d5748dba11", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "eeb16367-039c-35d5-9bb3-c120ba385fee", "product": {"name": "Linux"}, "product_version": "patch: 6.1.53"}, {"id": "f80b1be0-6f48-3d13-8c7c-3b70683c3494", "product": {"name": "Linux"}, "product_version": "patch: 6.5.3"}, {"id": "ffffd64d-0cca-3c19-9dc3-644a5c9e435f", "product": {"name": "Linux"}, "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d75e30dddf73449bc2d10bb8e2f1a2c446bc67a2"}], "enisaIdVendor": [{"id": "5c137d8c-fa36-3ebe-9543-38433bb0e01a", "vendor": {"name": "Linux"}}], "isExploited": false}