{"id": "EUVD-2023-60305", "enisaUuid": "d3fb5aed-5703-3979-b088-76e572c0d744", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix WARNING in mark_buffer_dirty due to discarded buffer reuse\n\nA syzbot stress test using a corrupted disk image reported that\nmark_buffer_dirty() called from __nilfs_mark_inode_dirty() or\nnilfs_palloc_commit_alloc_entry() may output a kernel warning, and can\npanic if the kernel is booted with panic_on_warn.\n\nThis is because nilfs2 keeps buffer pointers in local structures for some\nmetadata and reuses them, but such buffers may be forcibly discarded by\nnilfs_clear_dirty_page() in some critical situations.\n\nThis issue is reported to appear after commit 28a65b49eb53 (\"nilfs2: do\nnot write dirty data after degenerating to read-only\"), but the issue has\npotentially existed before.\n\nFix this issue by checking the uptodate flag when attempting to reuse an\ninternally held buffer, and reloading the metadata instead of reusing the\nbuffer if the flag was lost.", "datePublished": "2025-12-24T15:30:39", "dateUpdated": "2025-12-24T15:30:39", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/473795610594f261e98920f0945550314df36f07", "https://git.kernel.org/stable/c/d95e403588738c7ec38f52b9f490b15e7745d393", "https://git.kernel.org/stable/c/99a73016a5e12a09586a96f998e91f9ea145cd00", "https://git.kernel.org/stable/c/f1d637b63d8a27ac3386f186a694907f2717fc13", "https://git.kernel.org/stable/c/b911bef132a06de01a745c6a24172d6db7216333", "https://git.kernel.org/stable/c/4da07e958bfda2d69d83db105780e8916e3ac02e", "https://git.kernel.org/stable/c/46c11be2dca295742a5508ea910a77f7733fb7f4", "https://git.kernel.org/stable/c/b308b3eabc429649b5501d36290cea403fbd746c", "https://git.kernel.org/stable/c/cdaac8e7e5a059f9b5e816cda257f08d0abffacd", "https://nvd.nist.gov/vuln/detail/CVE-2023-54140"], "aliases": ["CVE-2023-54140"], "assigner": "Linux", "epss": 0.04, "enisaIdProduct": [{"id": "02a1c116-55bf-3654-8339-7a2b4de5dd5e", "product": {"name": "Linux"}, "product_version": "patch: 6.6"}, {"id": "0542b197-1948-3f1c-9c5f-5b2577418165", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <b911bef132a06de01a745c6a24172d6db7216333"}, {"id": "122a847d-d683-3c52-b0ad-2e438781c602", "product": {"name": "Linux"}, "product_version": "patch: 6.4.15"}, {"id": "1c085faf-1f62-35d1-8a64-02a51c516b90", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <4da07e958bfda2d69d83db105780e8916e3ac02e"}, {"id": "1e607b92-63db-33e0-bb56-18737e2e28b8", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <d95e403588738c7ec38f52b9f490b15e7745d393"}, {"id": "202a6591-493e-3dd9-ae7d-0c4454597437", "product": {"name": "Linux"}, "product_version": "patch: 4.14.326"}, {"id": "2c1c23a3-65f2-3b91-ac0e-fb77ddaf7d74", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <f1d637b63d8a27ac3386f186a694907f2717fc13"}, {"id": "2dd1dc54-5ee4-3306-a3ec-fc822afcbca6", "product": {"name": "Linux"}, "product_version": "patch: 5.15.131"}, {"id": "30c4fbd2-4a76-3774-aba3-4f553c18267b", "product": {"name": "Linux"}, "product_version": "patch: 4.19.295"}, {"id": "395a7037-573a-3289-8452-0451f333759c", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <99a73016a5e12a09586a96f998e91f9ea145cd00"}, {"id": "5c6b4f73-c727-3815-b1cd-20985a5b77cb", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "5d907757-fef2-3f75-9b81-822c17df6175", "product": {"name": "Linux"}, "product_version": "patch: 5.10.195"}, {"id": "5fc2acc0-1150-39e6-8e1b-ab67dbc37fa9", "product": {"name": "Linux"}, "product_version": "patch: 5.4.257"}, {"id": "7cac625c-d8e7-331e-8087-2d2df7e7214e", "product": {"name": "Linux"}, "product_version": "patch: 6.1.52"}, {"id": "84c2cd06-7726-3340-b9fd-99e79cbb6d3f", "product": {"name": "Linux"}, "product_version": "patch: 6.5.2"}, {"id": "9a6c09eb-dfa3-304d-bb1b-7f877433724d", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <b308b3eabc429649b5501d36290cea403fbd746c"}, {"id": "9e9a2789-405b-3380-ab02-3e8fdcd222e0", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <473795610594f261e98920f0945550314df36f07"}, {"id": "bb7241db-2300-3aa7-9a78-8ea30277e94b", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <cdaac8e7e5a059f9b5e816cda257f08d0abffacd"}, {"id": "ee9defe6-4fde-38fd-8f3c-e201af45fd90", "product": {"name": "Linux"}, "product_version": "8c26c4e2694a163d525976e804d81cd955bbb40c <46c11be2dca295742a5508ea910a77f7733fb7f4"}, {"id": "f0a7ff84-d58b-333b-947f-1b36a3131485", "product": {"name": "Linux"}, "product_version": "3.10"}], "enisaIdVendor": [{"id": "6d0beff9-0611-3bfb-9260-c416f26a0eca", "vendor": {"name": "Linux"}}], "isExploited": false}