{"id": "EUVD-2023-0219", "enisaUuid": "b17def81-31cd-380d-bf4a-3c07497a9dcf", "description": "In Apache Spark versions prior to 3.4.0, applications using spark-submit can specify a 'proxy-user' to run as, limiting privileges. The application can execute code with the privileges of the submitting user, however, by providing malicious configuration-related classes on the classpath. This affects architectures relying on proxy-user, for example those using Apache Livy to manage submitted applications.\\n\\nUpdate to Apache Spark 3.4.0 or later, and ensure that \\nspark.submit.proxyUser.allowCustomClasspathInClusterMode is set to its \\ndefault of \\\"false\\\", and is not overridden by submitted applications.\\n\\n\\n", "datePublished": "2023-04-17T08:15:00", "dateUpdated": "2023-05-04T03:49:47", "baseScore": 6.4, "baseScoreVersion": "3.1", "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "references": ["https://lists.apache.org/thread/yllfl25xh5tbotjmg93zrq4bzwhqc0gv", "https://lists.apache.org/thread/yllfl25xh5tbotjmg93zrq4bzwhqc0gv", "https://nvd.nist.gov/vuln/detail/CVE-2023-22946", "https://github.com/apache/spark/pull/39474", "https://github.com/apache/spark/pull/41428", "https://github.com/apache/spark/commit/909da96e1471886a01a9e1def93630c4fd40e74a", "https://github.com/degant/spark/commit/bfba57724d2520e0fcaa7990f7257c21d11cd75a", "https://github.com/pypa/advisory-database/tree/main/vulns/pyspark/PYSEC-2023-44.yaml", "https://issues.apache.org/jira/browse/SPARK-41958"], "aliases": ["CVE-2023-22946", "PYSEC-2023-44"], "assigner": "apache", "epss": 0.18, "enisaIdProduct": [{"id": "c700e065-2271-3cc6-a418-cce63c08f76a", "product": {"name": "Apache Spark"}, "product_version": "0 <3.4.0"}], "enisaIdVendor": [{"id": "350088e6-81f9-35b5-83f9-cb4f70111e90", "vendor": {"name": "Apache Software Foundation"}}], "isExploited": false}