{"id": "EUVD-2023-59804", "enisaUuid": "c0a2cb3d-3f43-335d-a55c-535610d34f47", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfsverity: reject FS_IOC_ENABLE_VERITY on mode 3 fds\n\nCommit 56124d6c87fd (\"fsverity: support enabling with tree block size <\nPAGE_SIZE\") changed FS_IOC_ENABLE_VERITY to use __kernel_read() to read\nthe file's data, instead of direct pagecache accesses.\n\nAn unintended consequence of this is that the\n'WARN_ON_ONCE(!(file->f_mode & FMODE_READ))' in __kernel_read() became\nreachable by fuzz tests.  This happens if FS_IOC_ENABLE_VERITY is called\non a fd opened with access mode 3, which means \"ioctl access only\".\n\nArguably, FS_IOC_ENABLE_VERITY should work on ioctl-only fds.  But\nioctl-only fds are a weird Linux extension that is rarely used and that\nfew people even know about.  (The documentation for FS_IOC_ENABLE_VERITY\neven specifically says it requires O_RDONLY.)  It's probably not\nworthwhile to make the ioctl internally open a new fd just to handle\nthis case.  Thus, just reject the ioctl on such fds for now.", "datePublished": "2025-09-15T15:31:23", "dateUpdated": "2025-12-02T21:31:25", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/85c039cff3c359967cafe90443c02321e950b216", "https://git.kernel.org/stable/c/04839139213cf60d4c5fc792214a08830e294ff8", "https://nvd.nist.gov/vuln/detail/CVE-2023-53172"], "aliases": ["CVE-2023-53172"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "04b858e4-af3d-3129-a50a-0a033ce612fa", "product": {"name": "Linux"}, "product_version": "56124d6c87fd749477425110d2564166621a89c4 <04839139213cf60d4c5fc792214a08830e294ff8"}, {"id": "7570cb1c-9b2c-33c3-b25a-7a32d87a1481", "product": {"name": "Linux"}, "product_version": "56124d6c87fd749477425110d2564166621a89c4 <85c039cff3c359967cafe90443c02321e950b216"}, {"id": "bce78474-a70c-35d4-a181-ce9b242e6db3", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c7753311-bae8-3584-bf14-0b1da6d8c74c", "product": {"name": "Linux"}, "product_version": "patch: 6.3.1"}, {"id": "e2390afb-023c-3833-b2ef-26fa92c733eb", "product": {"name": "Linux"}, "product_version": "patch: 6.4"}, {"id": "ff367b2f-85a8-3101-93d0-19dedea87c72", "product": {"name": "Linux"}, "product_version": "6.3"}], "enisaIdVendor": [{"id": "08d03ef3-4340-37ac-958f-6e2e517679bc", "vendor": {"name": "Linux"}}], "isExploited": false}