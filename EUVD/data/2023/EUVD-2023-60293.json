{"id": "EUVD-2023-60293", "enisaUuid": "52edce9a-1a3d-32ad-80d8-18f124bfde4b", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: j1939: prevent deadlock by moving j1939_sk_errqueue()\n\nThis commit addresses a deadlock situation that can occur in certain\nscenarios, such as when running data TP/ETP transfer and subscribing to\nthe error queue while receiving a net down event. The deadlock involves\nlocks in the following order:\n\n3\n  j1939_session_list_lock ->  active_session_list_lock\n  j1939_session_activate\n  ...\n  j1939_sk_queue_activate_next -> sk_session_queue_lock\n  ...\n  j1939_xtp_rx_eoma_one\n\n2\n  j1939_sk_queue_drop_all  ->  sk_session_queue_lock\n  ...\n  j1939_sk_netdev_event_netdown -> j1939_socks_lock\n  j1939_netdev_notify\n\n1\n  j1939_sk_errqueue -> j1939_socks_lock\n  __j1939_session_cancel -> active_session_list_lock\n  j1939_tp_rxtimer\n\n       CPU0                    CPU1\n       ----                    ----\n  lock(&priv->active_session_list_lock);\n                               lock(&jsk->sk_session_queue_lock);\n                               lock(&priv->active_session_list_lock);\n  lock(&priv->j1939_socks_lock);\n\nThe solution implemented in this commit is to move the\nj1939_sk_errqueue() call out of the active_session_list_lock context,\nthus preventing the deadlock situation.", "datePublished": "2025-12-24T15:30:40", "dateUpdated": "2025-12-24T15:30:40", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/8a581b71cf686b4cd1a85c9c2dfc2fb88382c3b4", "https://git.kernel.org/stable/c/ace6aa2ab5ba5869563ca689bbd912100514ae7b", "https://git.kernel.org/stable/c/f09ce9d765de1f064ce3919f57c6beb061744784", "https://git.kernel.org/stable/c/d1366b283d94ac4537a4b3a1e8668da4df7ce7e9", "https://nvd.nist.gov/vuln/detail/CVE-2023-54152"], "aliases": ["CVE-2023-54152"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "3ed7fd87-1b37-3918-8947-dbc787f6c7c9", "product": {"name": "Linux"}, "product_version": "5.15"}, {"id": "43ae971b-26cf-3fd6-ade3-1bc5114b58e3", "product": {"name": "Linux"}, "product_version": "patch: 6.2.10"}, {"id": "441ee110-0175-3865-92e5-90167b785ac9", "product": {"name": "Linux"}, "product_version": "patch: 6.1.23"}, {"id": "58f2a74f-e52b-394f-8d34-dfa5ce1cec65", "product": {"name": "Linux"}, "product_version": "patch: 5.15.106"}, {"id": "606e2649-e5e2-3d29-b599-1a5c7184a2f1", "product": {"name": "Linux"}, "product_version": "5b9272e93f2efe3f6cda60cc2c26817b2ce49386 <d1366b283d94ac4537a4b3a1e8668da4df7ce7e9"}, {"id": "b881de1e-42fe-3806-90aa-7b1c5d4e2731", "product": {"name": "Linux"}, "product_version": "5b9272e93f2efe3f6cda60cc2c26817b2ce49386 <f09ce9d765de1f064ce3919f57c6beb061744784"}, {"id": "d634d57c-70b1-31d8-a963-e60e6ac91f05", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "d6f8b70e-ed3c-3b10-b115-71d834390c06", "product": {"name": "Linux"}, "product_version": "5b9272e93f2efe3f6cda60cc2c26817b2ce49386 <ace6aa2ab5ba5869563ca689bbd912100514ae7b"}, {"id": "d70d1c6e-9b4b-3ee0-9838-c558fa64bc35", "product": {"name": "Linux"}, "product_version": "5b9272e93f2efe3f6cda60cc2c26817b2ce49386 <8a581b71cf686b4cd1a85c9c2dfc2fb88382c3b4"}, {"id": "e9cbb8ff-4c74-3dcc-9ff6-0f932b3a712d", "product": {"name": "Linux"}, "product_version": "patch: 0"}], "enisaIdVendor": [{"id": "dad8e785-e4a8-3473-a01e-be49bcf2274c", "vendor": {"name": "Linux"}}], "isExploited": false}