{"id": "EUVD-2023-60483", "enisaUuid": "3dc875eb-0764-39a4-b450-727519069b05", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndriver core: fix potential null-ptr-deref in device_add()\n\nI got the following null-ptr-deref report while doing fault injection test:\n\nBUG: kernel NULL pointer dereference, address: 0000000000000058\nCPU: 2 PID: 278 Comm: 37-i2c-ds2482 Tainted: G    B   W        N 6.1.0-rc3+\nRIP: 0010:klist_put+0x2d/0xd0\nCall Trace:\n <TASK>\n klist_remove+0xf1/0x1c0\n device_release_driver_internal+0x196/0x210\n bus_remove_device+0x1bd/0x240\n device_add+0xd3d/0x1100\n w1_add_master_device+0x476/0x490 [wire]\n ds2482_probe+0x303/0x3e0 [ds2482]\n\nThis is how it happened:\n\nw1_alloc_dev()\n  // The dev->driver is set to w1_master_driver.\n  memcpy(&dev->dev, device, sizeof(struct device));\n  device_add()\n    bus_add_device()\n    dpm_sysfs_add() // It fails, calls bus_remove_device.\n\n    // error path\n    bus_remove_device()\n      // The dev->driver is not null, but driver is not bound.\n      __device_release_driver()\n        klist_remove(&dev->p->knode_driver) <-- It causes null-ptr-deref.\n\n    // normal path\n    bus_probe_device() // It's not called yet.\n      device_bind_driver()\n\nIf dev->driver is set, in the error path after calling bus_add_device()\nin device_add(), bus_remove_device() is called, then the device will be\ndetached from driver. But device_bind_driver() is not called yet, so it\ncauses null-ptr-deref while access the 'knode_driver'. To fix this, set\ndev->driver to null in the error path before calling bus_remove_device().", "datePublished": "2025-12-30T15:30:36", "dateUpdated": "2025-12-30T15:30:36", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/2c59650d078b1b3f1ea50d5f8ee9fcc537dc02d3", "https://git.kernel.org/stable/c/7cf515bf9e8c2908dc170ecf2df117162a16c9c5", "https://git.kernel.org/stable/c/17982304806c5c10924e73f7ca5556e0d7378452", "https://git.kernel.org/stable/c/f6837f34a34973ef6600c08195ed300e24e97317", "https://nvd.nist.gov/vuln/detail/CVE-2023-54321"], "aliases": ["CVE-2023-54321"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "2bd291dc-01d7-30c3-b285-0257fb9b3446", "product": {"name": "Linux"}, "product_version": "57eee3d23e8833ca18708b374c648235691942ba <17982304806c5c10924e73f7ca5556e0d7378452"}, {"id": "2c1d7231-fa43-3db9-9115-02c963dcd6ce", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "2cabec3c-2d8c-3644-ba9b-e8865d3cd65f", "product": {"name": "Linux"}, "product_version": "57eee3d23e8833ca18708b374c648235691942ba <2c59650d078b1b3f1ea50d5f8ee9fcc537dc02d3"}, {"id": "4bd790bb-41a9-3303-a2e0-2fe2fa337e09", "product": {"name": "Linux"}, "product_version": "57eee3d23e8833ca18708b374c648235691942ba <f6837f34a34973ef6600c08195ed300e24e97317"}, {"id": "637b076e-54d2-3e97-951b-3fc7a1c6d08c", "product": {"name": "Linux"}, "product_version": "2.6.26"}, {"id": "8f557170-9bef-3789-a897-1f05c38d305d", "product": {"name": "Linux"}, "product_version": "patch: 6.2.3"}, {"id": "9c52b75c-c4d1-390b-a308-78d24fd0c9a0", "product": {"name": "Linux"}, "product_version": "patch: 6.1.16"}, {"id": "beba3147-d2d0-3b41-a09c-2762eff5f957", "product": {"name": "Linux"}, "product_version": "patch: 6.3"}, {"id": "c4ddb27e-a485-3067-9b51-aa290506b112", "product": {"name": "Linux"}, "product_version": "57eee3d23e8833ca18708b374c648235691942ba <7cf515bf9e8c2908dc170ecf2df117162a16c9c5"}, {"id": "ffc1f262-4491-3a84-afe6-f61767104242", "product": {"name": "Linux"}, "product_version": "patch: 5.15.99"}], "enisaIdVendor": [{"id": "cee21f25-4752-3a0c-9abb-5c587cb88141", "vendor": {"name": "Linux"}}], "isExploited": false}