{"id": "EUVD-2023-60468", "enisaUuid": "bd69edcd-79e0-3006-aa94-a880d012b1ad", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Disable preemption in bpf_event_output\n\nWe received report [1] of kernel crash, which is caused by\nusing nesting protection without disabled preemption.\n\nThe bpf_event_output can be called by programs executed by\nbpf_prog_run_array_cg function that disabled migration but\nkeeps preemption enabled.\n\nThis can cause task to be preempted by another one inside the\nnesting protection and lead eventually to two tasks using same\nperf_sample_data buffer and cause crashes like:\n\n  BUG: kernel NULL pointer dereference, address: 0000000000000001\n  #PF: supervisor instruction fetch in kernel mode\n  #PF: error_code(0x0010) - not-present page\n  ...\n  ? perf_output_sample+0x12a/0x9a0\n  ? finish_task_switch.isra.0+0x81/0x280\n  ? perf_event_output+0x66/0xa0\n  ? bpf_event_output+0x13a/0x190\n  ? bpf_event_output_data+0x22/0x40\n  ? bpf_prog_dfc84bbde731b257_cil_sock4_connect+0x40a/0xacb\n  ? xa_load+0x87/0xe0\n  ? __cgroup_bpf_run_filter_sock_addr+0xc1/0x1a0\n  ? release_sock+0x3e/0x90\n  ? sk_setsockopt+0x1a1/0x12f0\n  ? udp_pre_connect+0x36/0x50\n  ? inet_dgram_connect+0x93/0xa0\n  ? __sys_connect+0xb4/0xe0\n  ? udp_setsockopt+0x27/0x40\n  ? __pfx_udp_push_pending_frames+0x10/0x10\n  ? __sys_setsockopt+0xdf/0x1a0\n  ? __x64_sys_connect+0xf/0x20\n  ? do_syscall_64+0x3a/0x90\n  ? entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nFixing this by disabling preemption in bpf_event_output.\n\n[1] https://github.com/cilium/cilium/issues/26756", "datePublished": "2025-12-30T15:30:30", "dateUpdated": "2025-12-30T15:30:30", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/3048cb0dc0cc9dc74ed93690dffef00733bcad5b", "https://git.kernel.org/stable/c/c81bdf8f9f2b002d217c3d5357cdea9f2b82ff90", "https://git.kernel.org/stable/c/36dd8ca330b76585640ed32255a3c99f901e1502", "https://git.kernel.org/stable/c/063c9ce8e74e07bf94f99cd13146f42867875e8b", "https://git.kernel.org/stable/c/d62cc390c2e99ae267ffe4b8d7e2e08b6c758c32", "https://nvd.nist.gov/vuln/detail/CVE-2023-54173"], "aliases": ["CVE-2023-54173"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "0d62fe95-2fd0-36d9-b140-6e657b7bfa96", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "1d9e850a-7d89-3204-8292-dcba6388ca43", "product": {"name": "Linux"}, "product_version": "patch: 6.4.10"}, {"id": "32c5128b-72c9-3f05-acf8-8e7cbff020d4", "product": {"name": "Linux"}, "product_version": "5.7"}, {"id": "43a300fc-57d3-3ee8-8384-6d3ab2405bf9", "product": {"name": "Linux"}, "product_version": "patch: 5.15.126"}, {"id": "6ef56cb9-bb65-3ae6-a8f8-3aa401e24e3d", "product": {"name": "Linux"}, "product_version": "2a916f2f546ca1c1e3323e2a4269307f6d9890eb <c81bdf8f9f2b002d217c3d5357cdea9f2b82ff90"}, {"id": "713cd70f-20fe-341a-b5c0-cc31d4460589", "product": {"name": "Linux"}, "product_version": "patch: 6.1.45"}, {"id": "7cdb7f15-0b09-3c32-a6e4-12dfc88140f1", "product": {"name": "Linux"}, "product_version": "2a916f2f546ca1c1e3323e2a4269307f6d9890eb <063c9ce8e74e07bf94f99cd13146f42867875e8b"}, {"id": "9e231d9a-74e6-3a9d-afb4-126fcb04ccec", "product": {"name": "Linux"}, "product_version": "patch: 5.10.190"}, {"id": "a47827af-df42-3350-bfcd-a8936d9960b8", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}, {"id": "c26283f7-6a74-3657-ae50-146f5c323496", "product": {"name": "Linux"}, "product_version": "2a916f2f546ca1c1e3323e2a4269307f6d9890eb <3048cb0dc0cc9dc74ed93690dffef00733bcad5b"}, {"id": "cca0dd95-c9fb-3a1b-8728-f513f328efa8", "product": {"name": "Linux"}, "product_version": "2a916f2f546ca1c1e3323e2a4269307f6d9890eb <d62cc390c2e99ae267ffe4b8d7e2e08b6c758c32"}, {"id": "ea1e163b-0ff4-3888-ba43-9e2698805fe9", "product": {"name": "Linux"}, "product_version": "2a916f2f546ca1c1e3323e2a4269307f6d9890eb <36dd8ca330b76585640ed32255a3c99f901e1502"}], "enisaIdVendor": [{"id": "1b76116b-7e11-3c56-a8e8-fe98d9bc85a8", "vendor": {"name": "Linux"}}], "isExploited": false}