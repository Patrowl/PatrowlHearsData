{"id": "EUVD-2023-59697", "enisaUuid": "11859119-8d51-3c1b-bdc3-256a37d106e5", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: nfc: Fix use-after-free in local_cleanup()\n\nFix a use-after-free that occurs in kfree_skb() called from\nlocal_cleanup(). This could happen when killing nfc daemon (e.g. neard)\nafter detaching an nfc device.\nWhen detaching an nfc device, local_cleanup() called from\nnfc_llcp_unregister_device() frees local->rx_pending and decreases\nlocal->ref by kref_put() in nfc_llcp_local_put().\nIn the terminating process, nfc daemon releases all sockets and it leads\nto decreasing local->ref. After the last release of local->ref,\nlocal_cleanup() called from local_release() frees local->rx_pending\nagain, which leads to the bug.\n\nSetting local->rx_pending to NULL in local_cleanup() could prevent\nuse-after-free when local_cleanup() is called twice.\n\nFound by a modified version of syzkaller.\n\nBUG: KASAN: use-after-free in kfree_skb()\n\nCall Trace:\ndump_stack_lvl (lib/dump_stack.c:106)\nprint_address_description.constprop.0.cold (mm/kasan/report.c:306)\nkasan_check_range (mm/kasan/generic.c:189)\nkfree_skb (net/core/skbuff.c:955)\nlocal_cleanup (net/nfc/llcp_core.c:159)\nnfc_llcp_local_put.part.0 (net/nfc/llcp_core.c:172)\nnfc_llcp_local_put (net/nfc/llcp_core.c:181)\nllcp_sock_destruct (net/nfc/llcp_sock.c:959)\n__sk_destruct (net/core/sock.c:2133)\nsk_destruct (net/core/sock.c:2181)\n__sk_free (net/core/sock.c:2192)\nsk_free (net/core/sock.c:2203)\nllcp_sock_release (net/nfc/llcp_sock.c:646)\n__sock_release (net/socket.c:650)\nsock_close (net/socket.c:1365)\n__fput (fs/file_table.c:306)\ntask_work_run (kernel/task_work.c:179)\nptrace_notify (kernel/signal.c:2354)\nsyscall_exit_to_user_mode_prepare (kernel/entry/common.c:278)\nsyscall_exit_to_user_mode (kernel/entry/common.c:296)\ndo_syscall_64 (arch/x86/entry/common.c:86)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:106)\n\nAllocated by task 4719:\nkasan_save_stack (mm/kasan/common.c:45)\n__kasan_slab_alloc (mm/kasan/common.c:325)\nslab_post_alloc_hook (mm/slab.h:766)\nkmem_cache_alloc_node (mm/slub.c:3497)\n__alloc_skb (net/core/skbuff.c:552)\npn533_recv_response (drivers/nfc/pn533/usb.c:65)\n__usb_hcd_giveback_urb (drivers/usb/core/hcd.c:1671)\nusb_giveback_urb_bh (drivers/usb/core/hcd.c:1704)\ntasklet_action_common.isra.0 (kernel/softirq.c:797)\n__do_softirq (kernel/softirq.c:571)\n\nFreed by task 1901:\nkasan_save_stack (mm/kasan/common.c:45)\nkasan_set_track (mm/kasan/common.c:52)\nkasan_save_free_info (mm/kasan/genericdd.c:518)\n__kasan_slab_free (mm/kasan/common.c:236)\nkmem_cache_free (mm/slub.c:3809)\nkfree_skbmem (net/core/skbuff.c:874)\nkfree_skb (net/core/skbuff.c:931)\nlocal_cleanup (net/nfc/llcp_core.c:159)\nnfc_llcp_unregister_device (net/nfc/llcp_core.c:1617)\nnfc_unregister_device (net/nfc/core.c:1179)\npn53x_unregister_nfc (drivers/nfc/pn533/pn533.c:2846)\npn533_usb_disconnect (drivers/nfc/pn533/usb.c:579)\nusb_unbind_interface (drivers/usb/core/driver.c:458)\ndevice_release_driver_internal (drivers/base/dd.c:1279)\nbus_remove_device (drivers/base/bus.c:529)\ndevice_del (drivers/base/core.c:3665)\nusb_disable_device (drivers/usb/core/message.c:1420)\nusb_disconnect (drivers/usb/core.c:2261)\nhub_event (drivers/usb/core/hub.c:5833)\nprocess_one_work (arch/x86/include/asm/jump_label.h:27 include/linux/jump_label.h:212 include/trace/events/workqueue.h:108 kernel/workqueue.c:2281)\nworker_thread (include/linux/list.h:282 kernel/workqueue.c:2423)\nkthread (kernel/kthread.c:319)\nret_from_fork (arch/x86/entry/entry_64.S:301)", "datePublished": "2025-03-27T16:43:49", "dateUpdated": "2025-03-27T16:43:49", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/b09ae26f08aaf2d85f96ea7f90ddd3387f62216f", "https://git.kernel.org/stable/c/54f7be61584b8ec4c6df405f479495b9397bae4a", "https://git.kernel.org/stable/c/a59cdbda3714e11aa3ab579132864c4c8c6d54f9", "https://git.kernel.org/stable/c/ad1baab3a5c03692d22ce446f38596a126377f6a", "https://git.kernel.org/stable/c/7f129927feaf7c10b1c38bbce630172e9a08c834", "https://git.kernel.org/stable/c/d3605282ec3502ec8847915eb2cf1f340493ff79", "https://git.kernel.org/stable/c/4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6"], "aliases": ["CVE-2023-53023"], "assigner": "Linux", "epss": 0.03, "enisaIdProduct": [{"id": "0b04491e-7ac4-3133-98fb-a996e82b837b", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <d3605282ec3502ec8847915eb2cf1f340493ff79"}, {"id": "4125b78b-5fd8-3513-af10-f4b607d498a1", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <ad1baab3a5c03692d22ce446f38596a126377f6a"}, {"id": "56a1c10f-bc59-3926-b48b-bd9834b46d88", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <b09ae26f08aaf2d85f96ea7f90ddd3387f62216f"}, {"id": "75539ffc-1d13-3dfc-bdcb-17f3114e9ffd", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <a59cdbda3714e11aa3ab579132864c4c8c6d54f9"}, {"id": "87cbe762-a877-33ed-aeae-e4967133b825", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <54f7be61584b8ec4c6df405f479495b9397bae4a"}, {"id": "8c447994-614f-3d65-a384-6e2af9963ff4", "product": {"name": "Linux"}, "product_version": "3.9"}, {"id": "bb9fce62-15b6-3f4c-965d-f2a76d3c5f0c", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6"}, {"id": "bca594dd-6b49-3fff-b6e8-741741963b40", "product": {"name": "Linux"}, "product_version": "3536da06db0baa675f32de608c0a4c0f5ef0e9ff <7f129927feaf7c10b1c38bbce630172e9a08c834"}], "enisaIdVendor": [{"id": "ff880258-931c-38fb-ab8e-909bdc3f1714", "vendor": {"name": "Linux"}}], "isExploited": false}