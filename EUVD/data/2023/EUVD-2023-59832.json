{"id": "EUVD-2023-59832", "enisaUuid": "6c20449c-b244-3f37-bae2-61b798470197", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: use RCU for hci_conn_params and iterate safely in hci_sync\n\nhci_update_accept_list_sync iterates over hdev->pend_le_conns and\nhdev->pend_le_reports, and waits for controller events in the loop body,\nwithout holding hdev lock.\n\nMeanwhile, these lists and the items may be modified e.g. by\nle_scan_cleanup. This can invalidate the list cursor or any other item\nin the list, resulting to invalid behavior (eg use-after-free).\n\nUse RCU for the hci_conn_params action lists. Since the loop bodies in\nhci_sync block and we cannot use RCU or hdev->lock for the whole loop,\ncopy list items first and then iterate on the copy. Only the flags field\nis written from elsewhere, so READ_ONCE/WRITE_ONCE should guarantee we\nread valid values.\n\nFree params everywhere with hci_conn_params_free so the cleanup is\nguaranteed to be done properly.\n\nThis fixes the following, which can be triggered e.g. by BlueZ new\nmgmt-tester case \"Add + Remove Device Nowait - Success\", or by changing\nhci_le_set_cig_params to always return false, and running iso-tester:\n\n==================================================================\nBUG: KASAN: slab-use-after-free in hci_update_passive_scan_sync (net/bluetooth/hci_sync.c:2536 net/bluetooth/hci_sync.c:2723 net/bluetooth/hci_sync.c:2841)\nRead of size 8 at addr ffff888001265018 by task kworker/u3:0/32\n\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.2-1.fc38 04/01/2014\nWorkqueue: hci0 hci_cmd_sync_work\nCall Trace:\n<TASK>\ndump_stack_lvl (./arch/x86/include/asm/irqflags.h:134 lib/dump_stack.c:107)\nprint_report (mm/kasan/report.c:320 mm/kasan/report.c:430)\n? __virt_addr_valid (./include/linux/mmzone.h:1915 ./include/linux/mmzone.h:2011 arch/x86/mm/physaddr.c:65)\n? hci_update_passive_scan_sync (net/bluetooth/hci_sync.c:2536 net/bluetooth/hci_sync.c:2723 net/bluetooth/hci_sync.c:2841)\nkasan_report (mm/kasan/report.c:538)\n? hci_update_passive_scan_sync (net/bluetooth/hci_sync.c:2536 net/bluetooth/hci_sync.c:2723 net/bluetooth/hci_sync.c:2841)\nhci_update_passive_scan_sync (net/bluetooth/hci_sync.c:2536 net/bluetooth/hci_sync.c:2723 net/bluetooth/hci_sync.c:2841)\n? __pfx_hci_update_passive_scan_sync (net/bluetooth/hci_sync.c:2780)\n? mutex_lock (kernel/locking/mutex.c:282)\n? __pfx_mutex_lock (kernel/locking/mutex.c:282)\n? __pfx_mutex_unlock (kernel/locking/mutex.c:538)\n? __pfx_update_passive_scan_sync (net/bluetooth/hci_sync.c:2861)\nhci_cmd_sync_work (net/bluetooth/hci_sync.c:306)\nprocess_one_work (./arch/x86/include/asm/preempt.h:27 kernel/workqueue.c:2399)\nworker_thread (./include/linux/list.h:292 kernel/workqueue.c:2538)\n? __pfx_worker_thread (kernel/workqueue.c:2480)\nkthread (kernel/kthread.c:376)\n? __pfx_kthread (kernel/kthread.c:331)\nret_from_fork (arch/x86/entry/entry_64.S:314)\n</TASK>\n\nAllocated by task 31:\nkasan_save_stack (mm/kasan/common.c:46)\nkasan_set_track (mm/kasan/common.c:52)\n__kasan_kmalloc (mm/kasan/common.c:374 mm/kasan/common.c:383)\nhci_conn_params_add (./include/linux/slab.h:580 ./include/linux/slab.h:720 net/bluetooth/hci_core.c:2277)\nhci_connect_le_scan (net/bluetooth/hci_conn.c:1419 net/bluetooth/hci_conn.c:1589)\nhci_connect_cis (net/bluetooth/hci_conn.c:2266)\niso_connect_cis (net/bluetooth/iso.c:390)\niso_sock_connect (net/bluetooth/iso.c:899)\n__sys_connect (net/socket.c:2003 net/socket.c:2020)\n__x64_sys_connect (net/socket.c:2027)\ndo_syscall_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120)\n\nFreed by task 15:\nkasan_save_stack (mm/kasan/common.c:46)\nkasan_set_track (mm/kasan/common.c:52)\nkasan_save_free_info (mm/kasan/generic.c:523)\n__kasan_slab_free (mm/kasan/common.c:238 mm/kasan/common.c:200 mm/kasan/common.c:244)\n__kmem_cache_free (mm/slub.c:1807 mm/slub.c:3787 mm/slub.c:3800)\nhci_conn_params_del (net/bluetooth/hci_core.c:2323)\nle_scan_cleanup (net/bluetooth/hci_conn.c:202)\nprocess_one_work (./arch/x86/include/asm/preempt.\n---truncated---", "datePublished": "2025-09-15T15:31:30", "dateUpdated": "2025-12-03T18:30:20", "baseScore": 0.0, "references": ["https://git.kernel.org/stable/c/13ad45ad14df992a6754a130a19abc8c142d54e2", "https://git.kernel.org/stable/c/cef88a0fd8e9c2e838162fbb742b3e713b811a7e", "https://git.kernel.org/stable/c/195ef75e19287b4bc413da3e3e3722b030ac881e", "https://nvd.nist.gov/vuln/detail/CVE-2023-53252"], "aliases": ["CVE-2023-53252"], "assigner": "Linux", "epss": 0.02, "enisaIdProduct": [{"id": "014ec670-095b-3943-ad48-bb95ba3e6d83", "product": {"name": "Linux"}, "product_version": "e8907f76544ffe225ab95d70f7313267b1d0c76d <cef88a0fd8e9c2e838162fbb742b3e713b811a7e"}, {"id": "112ab2c7-4363-3d5f-9fe6-5eaf94cb8e51", "product": {"name": "Linux"}, "product_version": "patch: 6.1.42"}, {"id": "270cc4d7-7149-35a3-afe4-87131f7ad490", "product": {"name": "Linux"}, "product_version": "5.17"}, {"id": "330f4ca4-7981-35f0-8b80-39dc2b82bb3b", "product": {"name": "Linux"}, "product_version": "e8907f76544ffe225ab95d70f7313267b1d0c76d <13ad45ad14df992a6754a130a19abc8c142d54e2"}, {"id": "b768059f-9aba-3f9b-9216-51ec336c6d24", "product": {"name": "Linux"}, "product_version": "patch: 0"}, {"id": "c0a2b6d5-86aa-33a6-a21c-9f2a05c60572", "product": {"name": "Linux"}, "product_version": "patch: 6.4.7"}, {"id": "feca8980-3590-39ab-a0ca-54d2fc2ef314", "product": {"name": "Linux"}, "product_version": "e8907f76544ffe225ab95d70f7313267b1d0c76d <195ef75e19287b4bc413da3e3e3722b030ac881e"}, {"id": "ffece5f4-e62c-37c7-b465-a2947349dc89", "product": {"name": "Linux"}, "product_version": "patch: 6.5"}], "enisaIdVendor": [{"id": "5a9cabbe-260c-38db-beb5-4330e5d2116e", "vendor": {"name": "Linux"}}], "isExploited": false}